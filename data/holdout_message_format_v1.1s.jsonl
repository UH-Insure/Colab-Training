{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/low-level\/operations.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for the McEliece KEM low-level Operations module, defining the functions crypto_kem_enc and crypto_kem_dec (and their helper hash functions) with appropriate types and ensuring they match the intended McEliece KEM encryption and decryption behavior."},{"role":"assistant","content":"```cryptol\nmodule Operations where\n\nimport Types\nimport Encrypt\nimport Decrypt\n\ncompute_hash_2e : SYS_N8_plus1_t -> [32]base_t\ncompute_hash_2e in = undefined\ncompute_hash_1e : pm_t -> [32]base_t\ncompute_hash_1e in = undefined\n\ncrypto_hash_32b_1 : SYS_N8_plus1_t -> [32]base_t\ncrypto_hash_32b_1 in = undefined\n\ncrypto_hash_32b_2 : pm_t -> g_key_t\ncrypto_hash_32b_2 in = undefined\n\n(two_e : SYS_N8_plus1_t) = [ 2 | x <- [0..870]]\n\ncrypto_kem_enc : g_ct_t -> g_key_t -> g_pk_t -> SYS_N8_plus2_t\n    -> (g_ct_t, g_key_t)\ncrypto_kem_enc c0 key pk e =  (c2, key2) where\n        (e :  SYS_N8_plus2_t) = zero\n        (c1 : g_ct_t) = encrypt c0 pk e\n        (c2 : g_ct_t) = (take `{194} c1 ) # (compute_hash_2e two_e)\n    (one_ec : pm_t) = ([1])#(take `{870} e)#c2\n    (key2 : g_key_t) = compute_hash_1e one_ec\n\ncrypto_kem_dec : g_ct_t -> g_sk_t -> g_key_t\ncrypto_kem_dec c sk = key where\n        (e : SYS_N8_t, ret_decrypt : gf_t) = decrypt sk c\n        (conf : [32]base_t) = crypto_hash_32b_1 two_e\n    loop_i i rc =\n        if (i<32)\n        then loop_i i' rc' where\n            i' = i+1\n            rc' = rc || ((conf@i) ^ c@(SYND_BYTES + i))\n        else rc\n    (ret_confirm : base_16t) = loop_i 0 0\n    (m_0 : base_16t) = ret_decrypt || ret_confirm\n    (m_1 : base_16t) = m_0 - 1\n    (m : base_16t) = m_1 >> 8\n    x_1 = [(~m && 0) || (m && 1)]\n    x_2 = [(~m && (sk@i)) || (m && (e@i)) | i <- [0..(870-1)]]\n    x_3 = [(c@i) | i <- [0..(194-1+32)]]\n    (preimage: pm_t) = x_1 # x_2 # x_3\n        (key : g_key_t) = crypto_hash_32b_2 preimage\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/util.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Specify the Cryptol types and full implementations for load2, bitrev, store8, load8, and transpose_64x64 used in a McEliece KEM utility module, matching the shown bitwise behavior and using the imported Types definitions."},{"role":"assistant","content":"```cryptol\nmodule Util where\n\nimport Types\n\nload2 : secretkey_t -> [32] -> gf_t\nload2 src sk_index = (a && (cvt_16 GFMASK)) where\n    (a: base_16t) = src@(1+sk_index)\n    b = a << 8\n    c = b || src@(0+sk_index)\n\nbitrev : [32] -> ([32],  [32])\nbitrev a = (cvt_32 a_4, cvt_32(a_4>>3)) where\n    a_0 = cvt_16 a\n    a_1 = ((a_0 && 0x00FF) << 8) || ((a_0 && 0xFF00) >> 8)\n    a_2 = ((a_1 && 0x0F0F) << 4) || ((a_1 && 0xF0F0) >> 4)\n    a_3 = ((a_2 && 0x3333) << 2) || ((a_2 && 0xCCCC) >> 2)\n    a_4 = ((a_3 && 0x5555) << 1) || ((a_3 && 0xAAAA) >> 1)\n\nstore8 out in = out\nload8 in = zero\ntranspose_64x64 in = zero\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Asymmetric\/Signature\/ECDSA\/ECDSA_tests.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module that defines the same ECDSA test properties for NIST curves P-192, P-224, P-256, P-384, and P-521, including point decompression, point addition\/subtraction, doubling, scalar and joint scalar multiplication, and mp_mod_sqrt correctness, matching the constants and structure shown."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Asymmetric::Signature::ECDSA::ECDSA_tests where\n\nimport Common::utils\n\nimport Primitive::Asymmetric::Signature::ECDSA::p192 as p192\nimport Primitive::Asymmetric::Signature::ECDSA::p224 as p224\nimport Primitive::Asymmetric::Signature::ECDSA::p256 as p256\nimport Primitive::Asymmetric::Signature::ECDSA::p384 as p384\nimport Primitive::Asymmetric::Signature::ECDSA::p521 as p521\n\nproperty p192_G_compress = p192::G_compress 0x00000003188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012\n\np192_S = {x = BVtoZ 0xd458e7d127ae671b0c330266d246769353a012073e97acf8,\n          y = BVtoZ 0x325930500d851f336bddc050cf7fb11b5673a1645086df3b}\n\np192_T = {x = BVtoZ 0xf22c4395213e9ebe67ddecdd87fdbd01be16fb059b9753a4,\n          y = BVtoZ 0x264424096af2b3597796db48f8dfb41fa9cecc97691a9c79}\n\nproperty p192_decompress_S = p192::affine_decompress_correct p192_S\nproperty p192_decompress_T = p192::affine_decompress_correct p192_T\n\nproperty p192_full_add_example =\n  p192::full_add_example R p192_S p192_T\n  where R = {x = BVtoZ 0x48e1e4096b9b8e5ca9d0f1f077b8abf58e843894de4d0290,\n             y = BVtoZ 0x408fa77c797cd7dbfb16aa48a3648d3d63c94117d7b6aa4b}\n\nproperty p192_full_subtract_example =\n  p192::full_subtract_example R p192_S p192_T\n  where R = {x = BVtoZ 0xfc9683cc5abfb4fe0cc8cc3bc9f61eabc4688f11e9f64a2e,\n             y = BVtoZ 0x093e31d00fb78269732b1bd2a73c23cdd31745d0523d816b}\n\nproperty p192_double_example =\n  p192::double_example R p192_S\n  where R = {x = BVtoZ 0x30c5bc6b8c7da25354b373dc14dd8a0eba42d25a3f6e6962,\n             y = BVtoZ 0x0dde14bc4249a721c407aedbf011e2ddbbcb2968c9d889cf}\n\nproperty p192_scalar_multiply_example0 =\n  p192::scalar_multiply_example R p192_S d\n  where d = BVtoZ 0xa78a236d60baec0c5dd41b33a542463a8255391af64c74ee\n        R = {x = BVtoZ 0x1faee4205a4f669d2d0a8f25e3bcec9a62a6952965bf6d31,\n             y = BVtoZ 0x5ff2cdfa508a2581892367087c696f179e7a4d7e8260fb06}\n\np192_S' = {x = BVtoZ 0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012,\n           y = BVtoZ 0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811}\n\nproperty p192_scalar_multiply_example1=\n    p192::scalar_multiply_example R p192_S' d\n    where d = BVtoZ 0xe14f37b3d1374ff8b03f41b9b3fdd2f0ebccf275d660d7f3\n          R = {x = BVtoZ 0x07008ea40b08dbe76432096e80a2494c94982d2d5bcf98e6,\n               y = BVtoZ 0x76fab681d00b414ea636ba215de26d98c41bd7f2e4d65477}\n\nproperty p192_joint_scalar_multiply_example =\n  p192::joint_scalar_multiply_example R p192_S p192_T d e\n  where d = BVtoZ 0xa78a236d60baec0c5dd41b33a542463a8255391af64c74ee\n        e = BVtoZ 0xc4be3d53ec3089e71e4de8ceab7cce889bc393cd85b972bc\n        R = {x = BVtoZ 0x019f64eed8fa9b72b7dfea82c17c9bfa60ecb9e1778b5bde,\n             y = BVtoZ 0x16590c5fcd8655fa4ced33fb800e2a7e3c61f35d83503644}\n\nproperty mp_mod_sqrt_192_correct = p192::mp_mod_sqrt_correct\n\nproperty p224_G_compress = p224::G_compress 0x00000002b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21\n\np224_S = {x = BVtoZ 0x6eca814ba59a930843dc814edd6c97da95518df3c6fdf16e9a10bb5b,\n          y = BVtoZ 0xef4b497f0963bc8b6aec0ca0f259b89cd80994147e05dc6b64d7bf22}\n\np224_T = {x = BVtoZ 0xb72b25aea5cb03fb88d7e842002969648e6ef23c5d39ac903826bd6d,\n          y = BVtoZ 0xc42a8a4d34984f0b71b5b4091af7dceb33ea729c1a2dc8b434f10c34}\n\nproperty p224_full_add_example =\n  p224::full_add_example R p224_S p224_T\n  where R = {x = BVtoZ 0x236f26d9e84c2f7d776b107bd478ee0a6d2bcfcaa2162afae8d2fd15,\n             y = BVtoZ 0xe53cc0a7904ce6c3746f6a97471297a0b7d5cdf8d536ae25bb0fda70}\n\nproperty p224_full_subtract_example =\n  p224::full_subtract_example R p224_S p224_T\n  where R = {x = BVtoZ 0xdb4112bcc8f34d4f0b36047bca1054f3615413852a7931335210b332,\n             y = BVtoZ 0x90c6e8304da4813878c1540b2396f411facf787a520a0ffb55a8d961}\n\nproperty p224_double_example =\n  p224::double_example R p224_S\n  where R = {x = BVtoZ 0xa9c96f2117dee0f27ca56850ebb46efad8ee26852f165e29cb5cdfc7,\n             y = BVtoZ 0xadf18c84cf77ced4d76d4930417d9579207840bf49bfbf5837dfdd7d}\n\nproperty p224_scalar_multiply_example =\n  p224::scalar_multiply_example R p224_S d\n  where d = BVtoZ 0xa78ccc30eaca0fcc8e36b2dd6fbb03df06d37f52711e6363aaf1d73b\n        R = {x = BVtoZ 0x96a7625e92a8d72bff1113abdb95777e736a14c6fdaacc392702bca4,\n             y = BVtoZ 0x0f8e5702942a3c5e13cd2fd5801915258b43dfadc70d15dbada3ed10}\n\nproperty p224_joint_scalar_multiply_example =\n  p224::joint_scalar_multiply_example R p224_S p224_T d e\n  where d = BVtoZ 0xa78ccc30eaca0fcc8e36b2dd6fbb03df06d37f52711e6363aaf1d73b\n        e = BVtoZ 0x54d549ffc08c96592519d73e71e8e0703fc8177fa88aa77a6ed35736\n        R = {x = BVtoZ 0xdbfe2958c7b2cda1302a67ea3ffd94c918c5b350ab838d52e288c83e,\n             y = BVtoZ 0x2f521b83ac3b0549ff4895abcc7f0c5a861aacb87acbc5b8147bb18b}\n\nproperty mp_mod_sqrt_224_correct = p224::mp_mod_sqrt_correct\n\nproperty p256_G_compress = p256::G_compress 0x000000036b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296\n\np256_S = {x = BVtoZ 0xde2444bebc8d36e682edd27e0f271508617519b3221a8fa0b77cab3989da97c9,\n          y = BVtoZ 0xc093ae7ff36e5380fc01a5aad1e66659702de80f53cec576b6350b243042a256}\n\np256_T = {x = BVtoZ 0x55a8b00f8da1d44e62f6b3b25316212e39540dc861c89575bb8cf92e35e0986b,\n          y = BVtoZ 0x5421c3209c2d6c704835d82ac4c3dd90f61a8a52598b9e7ab656e9d8c8b24316}\n\nproperty p256_full_add_example =\n  p256::full_add_example R p256_S p256_T\n  where R = {x = BVtoZ 0x72b13dd4354b6b81745195e98cc5ba6970349191ac476bd4553cf35a545a067e,\n             y = BVtoZ 0x8d585cbb2e1327d75241a8a122d7620dc33b13315aa5c9d46d013011744ac264}\n\nproperty p256_full_subtract_example =\n  p256::full_subtract_example R p256_S p256_T\n  where R = {x = BVtoZ 0xc09ce680b251bb1d2aad1dbf6129deab837419f8f1c73ea13e7dc64ad6be6021,\n             y = BVtoZ 0x1a815bf700bd88336b2f9bad4edab1723414a022fdf6c3f4ce30675fb1975ef3}\n\nproperty p256_double_example =\n  p256::double_example R p256_S\n  where R = {x = BVtoZ 0x7669e6901606ee3ba1a8eef1e0024c33df6c22f3b17481b82a860ffcdb6127b0,\n             y = BVtoZ 0xfa878162187a54f6c39f6ee0072f33de389ef3eecd03023de10ca2c1db61d0c7}\n\nproperty p256_scalar_multiply_example =\n  p256::scalar_multiply_example R p256_S d\n  where d = BVtoZ 0xc51e4753afdec1e6b6c6a5b992f43f8dd0c7a8933072708b6522468b2ffb06fd\n        R = {x = BVtoZ 0x51d08d5f2d4278882946d88d83c97d11e62becc3cfc18bedacc89ba34eeca03f,\n             y = BVtoZ 0x75ee68eb8bf626aa5b673ab51f6e744e06f8fcf8a6c0cf3035beca956a7b41d5}\n\nproperty p256_joint_scalar_multiply_example =\n  p256::joint_scalar_multiply_example R p256_S p256_T d e\n  where d = BVtoZ 0xc51e4753afdec1e6b6c6a5b992f43f8dd0c7a8933072708b6522468b2ffb06fd\n        e = BVtoZ 0xd37f628ece72a462f0145cbefe3f0b355ee8332d37acdd83a358016aea029db7\n        R = {x = BVtoZ 0xd867b4679221009234939221b8046245efcf58413daacbeff857b8588341f6b8,\n             y = BVtoZ 0xf2504055c03cede12d22720dad69c745106b6607ec7e50dd35d54bd80f615275}\n\nproperty mp_mod_sqrt_256_correct = p256::mp_mod_sqrt_correct\n\nproperty p384_G_compress = p384::G_compress 0x00000003aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7\n\np384_S = {x = BVtoZ 0xfba203b81bbd23f2b3be971cc23997e1ae4d89e69cb6f92385dda82768ada415ebab4167459da98e62b1332d1e73cb0e,\n          y = BVtoZ 0x5ffedbaefdeba603e7923e06cdb5d0c65b22301429293376d5c6944e3fa6259f162b4788de6987fd59aed5e4b5285e45}\n\np384_T = {x = BVtoZ 0xaacc05202e7fda6fc73d82f0a66220527da8117ee8f8330ead7d20ee6f255f582d8bd38c5a7f2b40bcdb68ba13d81051,\n          y = BVtoZ 0x84009a263fefba7c2c57cffa5db3634d286131afc0fca8d25afa22a7b5dce0d9470da89233cee178592f49b6fecb5092}\n\nproperty p384_full_add_example =\n  p384::full_add_example R p384_S p384_T\n  where R = {x = BVtoZ 0x12dc5ce7acdfc5844d939f40b4df012e68f865b89c3213ba97090a247a2fc009075cf471cd2e85c489979b65ee0b5eed,\n             y = BVtoZ 0x167312e58fe0c0afa248f2854e3cddcb557f983b3189b67f21eee01341e7e9fe67f6ee81b36988efa406945c8804a4b0}\n\nproperty p384_full_subtract_example =\n  p384::full_subtract_example R p384_S p384_T\n  where R = {x = BVtoZ 0x6afdaf8da8b11c984cf177e551cee542cda4ac2f25cd522d0cd710f88059c6565aef78f6b5ed6cc05a6666def2a2fb59,\n             y = BVtoZ 0x7bed0e158ae8cc70e847a60347ca1548c348decc6309f48b59bd5afc9a9b804e7f7876178cb5a7eb4f6940a9c73e8e5e}\n\nproperty p384_double_example =\n  p384::double_example R p384_S\n  where R = {x = BVtoZ 0x2a2111b1e0aa8b2fc5a1975516bc4d58017ff96b25e1bdff3c229d5fac3bacc319dcbec29f9478f42dee597b4641504c,\n             y = BVtoZ 0xfa2e3d9dc84db8954ce8085ef28d7184fddfd1344b4d4797343af9b5f9d837520b450f726443e4114bd4e5bdb2f65ddd}\n\nproperty p384_scalar_multiply_example =\n  p384::scalar_multiply_example R p384_S d\n  where d = BVtoZ 0xa4ebcae5a665983493ab3e626085a24c104311a761b5a8fdac052ed1f111a5c44f76f45659d2d111a61b5fdd97583480\n        R = {x = BVtoZ 0xe4f77e7ffeb7f0958910e3a680d677a477191df166160ff7ef6bb5261f791aa7b45e3e653d151b95dad3d93ca0290ef2,\n             y = BVtoZ 0xac7dee41d8c5f4a7d5836960a773cfc1376289d3373f8cf7417b0c6207ac32e913856612fc9ff2e357eb2ee05cf9667f}\n\nproperty p384_joint_scalar_multiply_example =\n  p384::joint_scalar_multiply_example R p384_S p384_T d e\n  where d = BVtoZ 0xa4ebcae5a665983493ab3e626085a24c104311a761b5a8fdac052ed1f111a5c44f76f45659d2d111a61b5fdd97583480\n        e = BVtoZ 0xafcf88119a3a76c87acbd6008e1349b29f4ba9aa0e12ce89bcfcae2180b38d81ab8cf15095301a182afbc6893e75385d\n        R = {x = BVtoZ 0x917ea28bcd641741ae5d18c2f1bd917ba68d34f0f0577387dc81260462aea60e2417b8bdc5d954fc729d211db23a02dc,\n             y = BVtoZ 0x1a29f7ce6d074654d77b40888c73e92546c8f16a5ff6bcbd307f758d4aee684beff26f6742f597e2585c86da908f7186}\n\nproperty mp_mod_sqrt_384_correct = p384::mp_mod_sqrt_correct\n\nproperty p521_G_compress = p521::G_compress 0x04c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66\n\np521_S = {x = BVtoZ 0x000001d5c693f66c08ed03ad0f031f937443458f601fd098d3d0227b4bf62873af50740b0bb84aa157fc847bcf8dc16a8b2b8bfd8e2d0a7d39af04b089930ef6dad5c1b4,\n          y = BVtoZ 0x00000144b7770963c63a39248865ff36b074151eac33549b224af5c8664c54012b818ed037b2b7c1a63ac89ebaa11e07db89fcee5b556e49764ee3fa66ea7ae61ac01823}\n\np521_T = {x = BVtoZ 0x000000f411f2ac2eb971a267b80297ba67c322dba4bb21cec8b70073bf88fc1ca5fde3ba09e5df6d39acb2c0762c03d7bc224a3e197feaf760d6324006fe3be9a548c7d5,\n          y = BVtoZ 0x000001fdf842769c707c93c630df6d02eff399a06f1b36fb9684f0b373ed064889629abb92b1ae328fdb45534268384943f0e9222afe03259b32274d35d1b9584c65e305}\n\nproperty p521_full_add_example =\n  p521::full_add_example R p521_S p521_T\n  where R = {x = BVtoZ 0x000001264ae115ba9cbc2ee56e6f0059e24b52c8046321602c59a339cfb757c89a59c358a9a8e1f86d384b3f3b255ea3f73670c6dc9f45d46b6a196dc37bbe0f6b2dd9e9,\n             y = BVtoZ 0x00000062a9c72b8f9f88a271690bfa017a6466c31b9cadc2fc544744aeb817072349cfddc5ad0e81b03f1897bd9c8c6efbdf68237dc3bb00445979fb373b20c9a967ac55}\n\nproperty p521_full_subtract_example =\n  p521::full_subtract_example R p521_S p521_T\n  where R = {x = BVtoZ 0x000001292cb58b1795ba477063fef7cd22e42c20f57ae94ceaad86e0d21ff22918b0dd3b076d63be253de24bc20c6da290fa54d83771a225deecf9149f79a8e614c3c4cd,\n             y = BVtoZ 0x000001695e3821e72c7cacaadcf62909cd83463a21c6d03393c527c643b36239c46af117ab7c7ad19a4c8cf0ae95ed51729885461aa2ce2700a6365bca3733d2920b2267}\n\nproperty p521_double_example =\n  p521::double_example R p521_S\n  where R = {x = BVtoZ 0x0000012879442f2450c119e7119a5f738be1f1eba9e9d7c6cf41b325d9ce6d643106e9d61124a91a96bcf201305a9dee55fa79136dc700831e54c3ca4ff2646bd3c36bc6,\n             y = BVtoZ 0x0000019864a8b8855c2479cbefe375ae553e2393271ed36fadfc4494fc0583f6bd03598896f39854abeae5f9a6515a021e2c0eef139e71de610143f53382f4104dccb543}\n\nproperty p521_scalar_multiply_example =\n  p521::scalar_multiply_example R p521_S d\n  where d = BVtoZ 0x000001eb7f81785c9629f136a7e8f8c674957109735554111a2a866fa5a166699419bfa9936c78b62653964df0d6da940a695c7294d41b2d6600de6dfcf0edcfc89fdcb1\n        R = {x = BVtoZ 0x00000091b15d09d0ca0353f8f96b93cdb13497b0a4bb582ae9ebefa35eee61bf7b7d041b8ec34c6c00c0c0671c4ae063318fb75be87af4fe859608c95f0ab4774f8c95bb,\n             y = BVtoZ 0x00000130f8f8b5e1abb4dd94f6baaf654a2d5810411e77b7423965e0c7fd79ec1ae563c207bd255ee9828eb7a03fed565240d2cc80ddd2cecbb2eb50f0951f75ad87977f}\n\nproperty p521_joint_scalar_multiply_example =\n  p521::joint_scalar_multiply_example R p521_S p521_T d e\n  where d = BVtoZ 0x000001eb7f81785c9629f136a7e8f8c674957109735554111a2a866fa5a166699419bfa9936c78b62653964df0d6da940a695c7294d41b2d6600de6dfcf0edcfc89fdcb1\n        e = BVtoZ 0x00000137e6b73d38f153c3a7575615812608f2bab3229c92e21c0d1c83cfad9261dbb17bb77a63682000031b9122c2f0cdab2af72314be95254de4291a8f85f7c70412e3\n        R = {x = BVtoZ 0x0000009d3802642b3bea152beb9e05fba247790f7fc168072d363340133402f2585588dc1385d40ebcb8552f8db02b23d687cae46185b27528adb1bf9729716e4eba653d,\n             y = BVtoZ 0x0000000fe44344e79da6f49d87c1063744e5957d9ac0a505bafa8281c9ce9ff25ad53f8da084a2deb0923e46501de5797850c61b229023dd9cf7fc7f04cd35ebb026d89d}\n\nproperty mp_mod_sqrt_521_correct = p521::mp_mod_sqrt_correct\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/MAC\/HMAC.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module implementing the HMAC construction with a SHA-256-based instance `hmacSHA256`, including the helper function `kinit` and the generic `hmac` function with the given polymorphic sizes and type constraints."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Symmetric::MAC::HMAC where\n\nimport Primitive::Keyless::Hash::SHA256\n\nhmacSHA256 : {pwBytes, msgBytes}\n             (fin pwBytes, fin msgBytes\n             , 32 >= width msgBytes\n             , 64 >= width (8*pwBytes)\n             , 64 >= width (8 * (64 + msgBytes))\n             ) => [pwBytes][8] -> [msgBytes][8] -> [256]\nhmacSHA256 = hmac `{blockLength=64} SHA256 SHA256 SHA256\n\nkinit : { pwBytes, blockLength, digest }\n        ( fin pwBytes, fin blockLength, fin digest )\n     => ([pwBytes][8] -> [8*digest])\n     -> [pwBytes][8]\n     -> [blockLength][8]\nkinit hash key =\n  if `pwBytes > (`blockLength : [max (width pwBytes) (width blockLength)])\n  then take `{blockLength} (split (hash key) # (zero : [blockLength][8]))\n  else take `{blockLength} (key # (zero : [blockLength][8]))\n\nhmac : { msgBytes, pwBytes, digest, blockLength }\n       ( fin pwBytes, fin digest, fin blockLength )\n    => ([blockLength + msgBytes][8] -> [8*digest])\n    -> ([blockLength + digest][8] -> [8*digest])\n    -> ([pwBytes][8] -> [8*digest])\n    -> [pwBytes][8]\n    -> [msgBytes][8]\n    -> [digest*8]\nhmac hash hash2 hash3 key message = hash2 (okey # internal)\n where\n   ks : [blockLength][8]\n   ks = kinit hash3 key\n   okey = [k ^ 0x5C | k <- ks]\n   ikey = [k ^ 0x36 | k <- ks]\n   internal = split (hash (ikey # message))\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/SubByteSBox.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol module `Primitive::Symmetric::Cipher::Block::AES::SubByteSBox` implementing the AES SubBytes and InvSubBytes transformations with functions `SubByte : GF28 -> GF28` and `InvSubByte : GF28 -> GF28`, using `sbox` and `sboxInv` over `GF28` elements."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Symmetric::Cipher::Block::AES::SubByteSBox where\n\nimport Primitive::Symmetric::Cipher::Block::AES::GF28\nimport Primitive::Symmetric::Cipher::Block::AES::SBox\n\nSubByte : GF28 -> GF28\nSubByte b = sbox @ b\n\nInvSubByte : GF28 -> GF28\nInvSubByte b = sboxInv @ b\n```"}]}
{"filename":"BLST-Verification\/tests\/FrobeniusTests.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module that defines properties `fp2_frobenius_prop`, `f6_frobenius_prop`, and `f12_frobenius_prop` asserting that `fp2_frobenius`, `fp6_frobenius`, and `fp12_frobenius` equal `F_expt` over `P::Fp_2`, `P::Fp_6`, and `P::Fp_12` (after normalization) using the prime `p : [381] = P::p`."},{"role":"assistant","content":"```cryptol\nimport Parameters as P\nimport Frobenius\nimport FieldExtras\n\np: [381]\np = `P::p\n\nproperty fp2_frobenius_prop x =\n  fp2_frobenius x' == F_expt P::Fp_2 x' p where x' = P::Fp_2.normalize x\n\nproperty f6_frobenius_prop x =\n  fp6_frobenius x' == F_expt P::Fp_6 x' p where x' = P::Fp_6.normalize x\n\nproperty f12_frobenius_prop x =\n  fp12_frobenius x' == F_expt P::Fp_12 x' p where x' = P::Fp_12.normalize x\n```"}]}
{"filename":"BLST-Verification\/spec\/CoreVerifyPKInG1.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `core_verify_pk_in_g1` that verifies a BLS signature in G1 by comparing two `bls_ate_pairing` results (one using the public key and `hash_to_curve_opt(msg, dst)`, and the other using the base point `BP` and the signature), returning an `Fp_12.is_equal` boolean."},{"role":"assistant","content":"```cryptol\nmodule CoreVerifyPKInG1 where\n\nimport Parameters\nimport HashToCurveE2\nimport Pairing\n\ncore_verify_pk_in_g1 pk sig msg dst = Fp_12.is_equal(c1, c2) where\n    c1 = bls_ate_pairing pk (hash_to_curve_opt (msg, dst))\n    c2 = bls_ate_pairing BP sig\n```"}]}
{"filename":"BLST-Verification\/spec\/Pairing.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module `Pairing` that specifies the BLS optimal ate pairing over the BN curve, including `bls_ate_pairing`, `ate_pairing`, the Miller loop (`miller_step`, `line_function`), and the final exponentiation using Frobenius maps, with appropriate types and intermediate helpers."},{"role":"assistant","content":"```cryptol\nmodule Pairing where\n\nimport Parameters as P\nimport ShortWeierstrassCurve as EC\nimport FieldExtras\nimport Frobenius\n\nc12: EC::EllipticCurve t12\nc12 = { base_field = P::Fp_12, a = P::Fp_12.field_zero, b = P::Fp_to_Fp_12 P::b }\n\nphi_1: EC::AffinePoint t1 -> EC::AffinePoint t12\nphi_1 (x,y) = (P::Fp_to_Fp_12 x, P::Fp_to_Fp_12 y)\n\nalpha: t2\nalpha = f2.half (f2.sub (f2.field_unit, P::u))\n\nw3_times: t2 -> t12\nw3_times x = [[z,x,z],[z,z,z]] where z = f2.field_zero\n\nw4_times: t2 -> t12\nw4_times x = [[z,z,z],[x,z,z]] where z = f2.field_zero\n\nphi_2: EC::AffinePoint t2 -> EC::AffinePoint t12\nphi_2 (x,y) = (x',y') where\n    x' = w4_times (f2.mul (x, alpha))\n    y' = w3_times (f2.mul (y, alpha))\n\nprivate\n    twice x = f12.add (x,x)\n    thrice x = f12.add (x, twice x)\n\nline_function: (t12,t12) -> (t12,t12) -> (t12,t12) -> t12\nline_function A B P = ret where\n    (A1,A2) = A\n    (B1,B2) = B\n    (P1,P2) = P\n    ret = if A == EC::neg c12 B           then f12.sub (P1, A1)           else f12.sub (f12.add (f12.mul (l, f12.sub (P1, A1)), A2), P2)\n    l = if A == B\n        then f12.div (thrice (f12.sq A1), twice A2)\n        else f12.div (f12.sub (B2, A2), f12.sub (B1, A1))\n\nnegative_t:[64]\nnegative_t = <| x^^63 + x^^62 + x^^60 + x^^57 + x^^48 + x^^16 |>\n\nbls_ate_pairing: EC::AffinePoint t1 -> EC::AffinePoint t2 -> t12\nbls_ate_pairing p q = ate_pairing (phi_1 p) (phi_2 q)\n\nate_pairing: EC::AffinePoint t12 -> EC::AffinePoint t12 -> t12\nate_pairing P Q = final_exponentiation (ate_pairing' P Q)\n\n\/\/ skipping the final exponentation\nate_pairing': EC::AffinePoint t12 -> EC::AffinePoint t12 -> t12\nate_pairing' P Q =  last_f where\n   negQ = EC::neg c12 Q\n   (last_f, _) = f_Ts ! 0\n   f_Ts = [(f12.field_unit, negQ)] #\n          [ miller_step P negQ fT ci | fT <- f_Ts | ci <- tail negative_t]\n\n\/\/ in the Miller loop, c_i is only ever 0 or -1, here represented by False and True\n\/\/ We only subtract Q, never add, so we take -Q as a parameter\nmiller_step:  EC::AffinePoint t12 -> EC::AffinePoint t12 -> (t12, EC::AffinePoint t12)\n              -> Bit -> (t12, EC::AffinePoint t12)\nmiller_step P negQ (f, T) ci = (f', T') where\n    f0 = f12.mul (f12.sq f, line_function T T P)\n    T0 = EC::double c12 T\n    (f', T') = if ci\n               then (f12.mul (f0, line_function T0 negQ P),\n                     EC::add c12 T0 negQ)\n               else (f0, T0)\n\n\/\/ final exponentiation\n\ntype r = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001\ntype final_exponent = (P::p^^12 - 1) \/ r\ntype small_final_e =  (P::p^^4 - P::p^^2 +1)\/r\n\n\/\/ Use the Frobenius mapping to compute x^(p^6-1)*(p^2+1)\nfinal_exp_frobenius_map : t12 -> t12\nfinal_exp_frobenius_map x = x2 where\n  x1 = f12.div (fp12_conjugate x, x) \/\/ = x^(p^6 - 1)\n  x2 = f12.mul (fp12_frobenius (fp12_frobenius x1), x1) \/\/ x1^(p^2+1)\n\nfinal_exponentiation: t12 -> t12\n\/* We could most simply define\n\n  final_expt x = k_expt`{6} f12 x (`final_exponent:[4314])\n\n  but is it rather inefficient to do so.  Instead, as noted in [1] and [2]\n  we can use the factorization\n\n     p^12-1 = (p^8+p^6 - p^2-1)*(p^4-p^2+1)\n            = (p^6-1)*(p^2+1)*(p^4-p^2+1)\n\n  and r since divides p^4-p^2+1, we can first use the Frobenius mapping to\n  easily compute x^(p^6-1)*(p^2+1), then complete the calculation\n  raising this to (p^4-p^2+1)\/r.\n\n  For that last exponentiation, we use a (2^5)-ary breakdown of the exponent,\n  noting that 2^5 = 32 is pretty close the the square root of 1268, the number of\n  bits in the exponent.\n\n  [1] Beauchat et al.  \"High-Speed Software Implementation of the Optimal\n      Ate airing over Barreto-Naehrig Curves\"\n\n  [2] Scott et al. \"On the final exponentiation for calculating pairings on\n      ordinary elliptic curves.\" eprint.iacr.org\/2008\/490\n *\/\nfinal_exponentiation x = k_expt`{5} f12 (final_exp_frobenius_map x) (`small_final_e:[1268+2])\n```"}]}
{"filename":"BLST-Verification\/spec\/implementation\/Keygen.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Specify and verify in Cryptol the BLS key generation procedure `KeyGen_rep` using HKDF-SHA256 and Montgomery arithmetic, including the properties `keygen_finish_integer`, `keygen_finish_bv`, and `le_bytes_from_limbs_rep4_prop` over the defined 256\/512-bit representations."},{"role":"assistant","content":"```cryptol\nmodule implementation::Keygen where\n\nimport Parameters as P\nimport Primitive::Keyless::Hash::SHA256\nimport Primitive::Symmetric::KDF::HKDF256\nimport rfc8017\n\nimport Common::bv\n\nimport implementation::Types\nimport implementation::Field\n\npow256_abs: Pow256 -> [256]\npow256_abs x = join (reverse x)\n\nr_modulus = toInteger P::r \nr_R = 2^^256\n\nr_R_inv = toInteger 0x1bbe869330009d577204078a4f77266aab6fca8f09dc705f13f75b69fe75c040\n\nr_RR = 2^^512\n\nr_R_reduced = r_R % r_modulus\nr_RR_reduced = r_RR % r_modulus\nr_R_inv_reduced = r_R_inv % r_modulus\n\nr_to_mont x = (x*r_R) % r_modulus\n\nr_from_mont x = (x*r_R_inv) % r_modulus\n\nr_add_mont x y = (x+y) % r_modulus\n\nr_mul_mont x y = (x*y*r_R_inv) % r_modulus\n\nproperty keygen_finish_integer x = r_mul_mont (r_from_mont x) (2^^512 % r_modulus) == (x % r_modulus)\n\nbv_r = (fromInteger r_modulus):[256] bv_R = (fromInteger r_R_reduced):[256]\nbv_R_inv = (fromInteger r_R_inv):[256] bv_RR = (fromInteger r_RR_reduced):[256]\n\nmul_mont_r_bv: [256] -> [256] -> [256]\nmul_mont_r_bv a b = safe_mod (bv_r, safe_product (zext a, safe_product (b, bv_R_inv)))\n\nredc_r_bv: [512] -> [256]\nredc_r_bv x = safe_mod (bv_r, safe_product (x, zext bv_R_inv))\n\nproperty keygen_finish_bv x =\n  safe_mod (bv_r, x) == mul_mont_r_bv (redc_r_bv x) bv_RR\n\nmul_mont_256_rep: Vec256 -> Vec256 -> Vec256\nmul_mont_256_rep x y = vec256_rep (mul_mont_r_bv (vec256_abs x) (vec256_abs y))\n\nr_redc_rep: Vec512 -> Vec256\nr_redc_rep x = vec256_rep (redc_r_bv (vec512_abs x))\n\nr_RR_rep: Vec256 r_RR_rep = [14526898881837571181, 3129137299524312099, 419701826671360399, 524908885293268753]\n\nlimbs_from_be_bytes_rep48: [48][8] -> [6]Limb\nlimbs_from_be_bytes_rep48 bytes = reverse (split (join bytes))\n\nle_bytes_from_limbs_rep4: Vec256 -> Pow256\nle_bytes_from_limbs_rep4 limbs = reverse (split (join (reverse limbs)))\n\nproperty le_bytes_from_limbs_rep4_prop limbs =\n    pow256_abs (le_bytes_from_limbs_rep4 limbs) == vec256_abs limbs\n\nKeyGenStep_rep: {IKM_len, info_len} (validHMACSizes 20 (1+IKM_len)\n                                    , validHMACSizes 32 (35+info_len)\n                                    ) =>\n        [256] -> [IKM_len][8] -> [info_len][8] -> Vec256\nKeyGenStep_rep salt IKM key_info = SK where\n    type L = (3 * 256) \/^ 16     PRK = HKDF_Extract (split salt) (IKM # [0])     OKM = HKDF_Expand`{L=L} PRK (key_info # I2OSP`{xLen=2} `L)\n    OKM_vec = (limbs_from_be_bytes_rep48 OKM) # [0,0]\n    SK = mul_mont_256_rep (r_redc_rep OKM_vec) r_RR_rep\n\nKeyGenLoop_rep: {IKM_len, info_len} (validHMACSizes 20 (1+IKM_len)\n                                    , validHMACSizes 32 (35+info_len)\n                                    ) =>\n        [256] -> [IKM_len][8] -> [info_len][8] -> [inf]Vec256\nKeyGenLoop_rep salt IKM info = keys where\n    salts = [salt] # [sha salt' | salt' <- salts]\n    keys = [zero] #\n                      [if k == zero then key_gen_step salt' else k | k <- keys | salt' <- salts]\n    key_gen_step s = KeyGenStep_rep s IKM info\n\nKeyGen_rep: {IKM_len, info_len} ( validHMACSizes 20 (1+IKM_len)\n                                , validHMACSizes 32 (35+info_len)\n                                ) =>\n        ([IKM_len][8], [info_len][8]) -> Pow256\nKeyGen_rep (IKM, key_info) = le_bytes_from_limbs_rep4 SK_vec where\n    SK_vec = (KeyGenLoop_rep (sha (join \"BLS-SIG-KEYGEN-SALT-\")) IKM key_info) @ 4\n```"}]}
{"filename":"cryptol\/cryptol-remote-api\/python\/tests\/cryptol\/test-files\/Names.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module `Names` that defines the given parameters, types, functions, primitive declarations, and the property `enc_correct : [64] -> Bit` asserting `x == enc (enc x)` for all 64-bit inputs, matching the structure implied by the excerpt."},{"role":"assistant","content":"```cryptol\nmodule Names where\n\nparameter\n  key : [64]\n\nenc : [64] -> [64]\nenc x = x ^ key\n\nenc_correct : [64] -> Bit\nproperty enc_correct x =\n  x == enc (enc x)\n\nprimitive prim : [64] -> [64]\n\n(-!) : [64] -> [64] -> [64]\nx -! y = if y > x then 0 else x - y\n\nparameter\n  type a : #\n\ntype b = a\n\ntype constraint fin_b = fin b\n\nprimitive type c : *\n\nnewtype d = { un_d : c }\n\nsubmodule M where\n```"}]}
{"filename":"cryptol\/tests\/regression\/word-update.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define bitvector update functions `update` and `updateEnd` on 16-bit words and properties `wordUpdate`, `wordUpdate2`, `wordUpdateEnd`, and `wordUpdateEnd2` that verify these functions match both mask-based and index-based formulations for indices `y < 16`."},{"role":"assistant","content":"```cryptol\nproperty wordUpdate (x:[16]) (y:[8]) (b:Bit) =\n  y < 16 ==> update x y b == if b then x || msk else x && ~msk\n\n where\n msk = 0b1000000000000000 >> y\n\nproperty wordUpdate2 (x:[16]) (y:[8]) (b:Bit) =\n  y < 16 ==> update x y b == x'\n\n where\n x' = [ if i == y then b else x@i | i <- [0 .. 15] ]\n\nproperty wordUpdateEnd (x:[16]) (y:[8]) (b:Bit) =\n  y < 16 ==> updateEnd x y b == if b then x || msk else x && ~msk\n\n where\n msk = 0b0000000000000001 << y\n\nproperty wordUpdateEnd2 (x:[16]) (y:[8]) (b:Bit) =\n  y < 16 ==> updateEnd x y b == x'\n\n where\n x' = [ if i == y then b else x!i | i <- reverse [0 .. 15] ]\n```"}]}
{"filename":"cryptol\/tests\/regression\/check24.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `xor : {a} ([a], [a]) -> [a]` as element-wise inequality on two sequences, and define `check24` as a property asserting that for all 4-bit `x` and `y`, `xor` equals the built-in bitwise XOR `(^)` and that this holds for all values."},{"role":"assistant","content":"```cryptol\nxor : {a} ([a], [a]) -> [a]\nxor (xs, ys) = [ x != y | x <- xs | y <- ys ]\n\ncheck24 = [ xor`{4} (x, y) == (x ^ y) | x <- [ 0 .. 15 ], y <- [ 0 .. 15 ] ] == ~zero\n```"}]}
{"filename":"cryptol\/tests\/regression\/check28.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the sequence `xs` as given and the value `check28` that asserts the list comprehension `[ x == y | (x,y) <- xs ]` is equal to `~zero`."},{"role":"assistant","content":"```cryptol\nxs = [(1,1),(2,2),(3,3),(4,4),(5,5),(6,6),(7,7)]\ncheck28 = [ x==y | (x,y) <- xs ] == ~zero\n```"}]}
{"filename":"cryptol\/tests\/issues\/issue_1812.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, reproduce these parameterized sequence type declarations and their constant zero definitions, ensuring that the arithmetic in the sequence length expressions is well-typed and equivalent (e.g., for f\/g, ff\/gg, jj\/kk)."},{"role":"assistant","content":"```cryptol\nf : {h} (fin h) => [2^^h + (2^^h - 2^^h)]\nf = g`{h}\n\ng : {h} (fin h) => [2^^h]\ng = zero\n\nff : {h} (fin h) => [(2^^h + 2^^h) - 2^^h]\nff = gg`{h}\n\ngg : {h} (fin h) => [2^^h]\ngg = zero\n\njj : {h} (fin h) => [2 ^^ (1 + h) - 1]\njj = kk`{h}\n\nkk : {h} (fin h, 2 ^^ (1 + h) - 1 >= 2 ^^ h - 1) => [2 ^^ h - 1 + 2 ^^ h]\nkk = zero\n```"}]}
{"filename":"cryptol\/tests\/modsys\/functors\/T011.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the submodules A, S, F, I, and M as given, using a type alias T = [8], an interface submodule S exposing x : T, a functor submodule F using x to define y = 2 * x, and an instantiation M = F { I } with I.x = 28."},{"role":"assistant","content":"```cryptol\nsubmodule A where\n  type T = [8]\n\ninterface submodule S where\n  import submodule A\n  x : T\n\nsubmodule F where\n  import interface submodule S\n\n  y = 2 * x\n\nsubmodule I where\n  x = 28\n\nsubmodule M = submodule F { submodule I }\n\nimport submodule M as M\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Asymmetric\/Signature\/ML_DSA\/ML_DSA.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Specify the ML-DSA key generation, signing, and verification API and define the property MLDSAIsCorrect that states a signature produced by Sign with keys from KeyGen always verifies with Verify for all messages and contexts within the given type constraints."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Asymmetric::Signature::ML_DSA::ML_DSA where\n\nimport interface Primitive::Asymmetric::Signature::ML_DSA::Parameters as P\nimport Primitive::Asymmetric::Signature::ML_DSA::OptimizedSpecification { interface P }\n\nKeyGen : Option ([32]Byte) -> Option (PublicKey, PrivateKey)\nKeyGen maybe_\u03be = case maybe_\u03be of\n    None -> None\n    Some \u03be -> Some (KeyGen_internal \u03be)\n\nSign : {m, c} (fin m, fin c) =>\n    PrivateKey -> [m] -> [c]Byte -> Option ([32]Byte) -> Option (Signature)\nSign sk M ctx maybe_rnd\n        | c > 255 => None\n        | c <= 255 => case maybe_rnd of\n        None -> None\n        Some rnd -> sigma where\n                                                            M' = join (IntegerToBytes`{1} 0 # IntegerToBytes`{1} `c # ctx) # M\n            \/\/ Step 11.\n            sigma = Some (Sign_internal sk M' rnd)\n\nVerify : {m, c} (fin m, fin c) =>\n    PublicKey -> [m] -> Signature -> [c]Byte -> Option Bool\nVerify pk M sigma ctx\n    | c > 255 => None\n    | c <= 255 => Some (Verify_internal pk M' sigma) where\n        \/\/ Step 10. We use `join` instead of `BytesToBits`, which produces\n        \/\/ the same byte string, but with the bits in each byte reversed.\n        \/\/ I think we have to do this to support the later call to `HBits`,\n        \/\/ which expects the bit-order and byte-order to be the same.\n        M' = join (IntegerToBytes`{1} 0 # IntegerToBytes`{1} `c # ctx) # M\n\nsubmodule TestAPI where\n    import Primitive::Asymmetric::Signature::ML_DSA::OptimizedSpecification { interface P } as Spec\n\n    KeyGen_internal = Spec::KeyGen_internal\n    Sign_internal = Spec::Sign_internal\n    Verify_internal = Spec::Verify_internal\n\nMLDSAIsCorrect : {m} (fin m) => [32]Byte -> [32]Byte -> [m] -> [255]Byte -> Bit\nproperty MLDSAIsCorrect \u03be rnd M ctx = sigVerifies where\n    maybe_keys = KeyGen (Some \u03be)\n    maybe_sigVerifies = case maybe_keys of\n        None -> None\n        Some keys -> case (Sign sk M ctx (Some rnd)) of\n                None -> None\n                Some sig -> Verify pk M sig ctx\n            where (pk, sk) = keys\n    sigVerifies = case maybe_sigVerifies of\n        None -> False\n        Some v -> v\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Asymmetric\/Signature\/XMSS\/Parameters.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module that fully specifies the XMSS parameter interface `Primitive::Asymmetric::Signature::XMSS::Parameters`, including types `h`, `n`, `MessageUpperBound`, `PaddingWidth`, constants `oid`, and hash functions `H` and `H_msg` with the given constraints and signatures."},{"role":"assistant","content":"```cryptol\ninterface module Primitive::Asymmetric::Signature::XMSS::Parameters where\n\ntype h : #\ntype constraint (fin h)\n\ntype constraint (h <= 32)\n\ntype constraint (h >= 1)\n\ntype n : #\ntype constraint (fin n)\n\nH : [n][8] -> [2 * n][8] -> [n][8]\n\ntype MessageUpperBound : #\n\ntype PaddingWidth : #\n\noid : [32]\n\nH_msg : {m} (fin m, width (PaddingWidth + 8 * m) < MessageUpperBound)\n    => [3 * n][8] -> [m][8] -> [n][8]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Asymmetric\/Signature\/XMSS\/Instantiations\/XMSS_SHA2_10_256.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module `Primitive::Asymmetric::Signature::XMSS::Instantiations::XMSS_SHA2_10_256` that instantiates the generic XMSS specification with the `XMSS_SHA2_10_256_Parameters` parameter set and the `WOTSP_SHA2_256` WOTS instantiation."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Asymmetric::Signature::XMSS::Instantiations::XMSS_SHA2_10_256 =\n    Primitive::Asymmetric::Signature::XMSS::Specification {\n        Parameters = Primitive::Asymmetric::Signature::XMSS::ParameterSets::XMSS_SHA2_10_256_Parameters,\n        WOTS = Primitive::Asymmetric::Signature::WOTS::Instantiations::WOTSP_SHA2_256\n\n    }\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Keyless\/Hash\/SHA3\/KeccakBitOrdering.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Specify the Keccak\/SHA3 bit and byte ordering utilities, including toBytes, fromBytes, reverseBitOrdering, h2b, b2h, and properties proving involution and mutual inversion (e.g., h2bAndb2hInvert, b2hAndh2bInvert, and example properties)."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Keyless::Hash::SHA3::KeccakBitOrdering where\n\ntoBytes : {n} (fin n) => [8*n] -> [n][8]\ntoBytes s = reverse (split (reverse s))\n\nfromBytes : {n} (fin n) => [n][8] -> [8*n]\nfromBytes bs = reverse (join (reverse bs))\n\nreverseBitOrdering : {m} [m] -> [m]\nreverseBitOrdering msg\n    | m == inf => join (map reverse (groupBy`{8} msg))\n    | fin m => (flipped_full_bytes # flipped_remainder) where\n                        type Bytes = 8 * (m \/ 8)\n        flipped_full_bytes = join (map reverse (groupBy`{each=8, parts=m \/ 8} (take`{Bytes} msg)))\n        flipped_remainder = reverse (drop`{Bytes} msg)\n\nreverseBitOrderingInvolutes : {m} (fin m) => [m] -> Bit\nproperty reverseBitOrderingInvolutes msg = reReverse == msg where\n    reReverse = reverseBitOrdering (reverseBitOrdering msg)\n\ntruncate : {n, m} (fin m, fin n, m >= n, m % (2 * HexDigit) == 0) => [m] -> [n]\ntruncate msg = reverseBitOrdering (take (reverseBitOrdering msg))\n\nreverseMatchesh2b : {m} (fin m, m > 0) => [2 * m * HexDigit] -> Bool\nproperty reverseMatchesh2b msg = h2b msg == reverseBitOrdering msg\n\ntruncateAndReverseMatchesh2b : {m, n} (fin m, m > 0, n > 0, 2 * HexDigit * m >= n) => [2 * m * HexDigit] -> Bool\nproperty truncateAndReverseMatchesh2b msg = h2b_result == rt_result where\n    h2b_result = h2b`{n} msg\n    rt_result = reverseBitOrdering (truncate`{n} msg)\n\nreverseMatchesb2h : {n} (fin n, n > 0) => [2 * n * HexDigit] -> Bool\nreverseMatchesb2h msg = b2h msg == reverseBitOrdering msg\n\nreverseAndTruncateMatchesb2h : {n} (fin n, n > 0) => [n] -> Bool\nproperty reverseAndTruncateMatchesb2h bits = b2h_result == rev_result where\n    b2h_result = truncate`{n} (b2h bits)\n    rev_result = reverseBitOrdering bits\n\ntype HexDigit = 4\n\nh2b: {n, m} (fin m, m > 0, n > 0, n <= 8 * m) => [2 * m * HexDigit] -> [n]\nh2b msg = S where\n        H = groupBy`{HexDigit} msg\n            H8 = map zext H : [2 * m][8]\n        hs = [16 * H8 @ (2 * i) + H8 @ (2 * i + 1) | i <- [0..m-1]]\n            bs = map reverse hs\n        T = join bs\n        S = take`{n} T\n\nproperty h2bExampleWorks = h2b`{14} H == S where\n    H = 0xA32E\n    S = 0b11000101011101\n\nb2h : {n} (fin n, n > 0) => [n] -> [2 * (n \/^ 8) * HexDigit]\nb2h S = H where\n            T = S # (zero : [(8 - (n % 8)) % 8])     type m = n \/^ 8\n        b = [[ T@(8 * i + j) | j <- [0..7]] | i <- [0..m-1]]\n        h = [reverse bs | bs <- b]\n        Hs = [split`{2, HexDigit} hi | hi <- h]\n    H = join (join Hs)\n\nzero_length_is_correct : Integer -> Bool\nproperty zero_length_is_correct n = (-n) % 8 == (8 - (n % 8)) % 8\n\nh2bAndb2hInvert : {m} (fin m, m > 0) => [2 * m * HexDigit] -> Bool\nproperty h2bAndb2hInvert msg = b2h (h2b`{2 * m * HexDigit} msg) == msg\n\nh2bAndb2hInvertForShortStrings : {m, n} (fin m, m > 0, n > 0, n \/^ (2 * HexDigit) == m) => [n] -> Bool\nproperty h2bAndb2hInvertForShortStrings msg = b2h (h2b`{n} hexMsg) == hexMsg where\n    hexMsg = reverseBitOrdering ((reverseBitOrdering msg) # zero) : [2 * m * HexDigit]\n\nb2hAndh2bInvert: {n} (fin n, n > 0) => [n] -> Bool\nproperty b2hAndh2bInvert msg = h2b (b2h msg) == msg\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Keyless\/Hash\/SHA2\/Tests\/SHA224.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write Cryptol properties that verify a SHA224::hash function against known test vectors for inputs \"abc\", the empty string, the 448-bit alphabet string, and the 896-bit alphabet string, matching the specified SHA-224 digest outputs."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Keyless::Hash::SHA2::Tests::SHA224 where\nimport Primitive::Keyless::Hash::SHA2::Instantiations::SHA224 as SHA224\n\nproperty abcWorks = SHA224::hash (join \"abc\") == output where\n    output = join [\n        0x23097d22, 0x3405d822, 0x8642a477, 0xbda255b3,\n        0x2aadbce4, 0xbda0b3f7, 0xe36c9da7\n    ]\n\nproperty emptyStringWorks = SHA224::hash [] == output where\n    output = join [\n        0xd14a028c, 0x2a3a2bc9, 0x476102bb, 0x288234c4,\n        0x15a2b01f, 0x828ea62a, 0xc5b3e42f\n    ]\n\nproperty alphabet448 = SHA224::hash input == output where\n    input = join \"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq\"\n    output = join [\n        0x75388b16, 0x512776cc, 0x5dba5da1, 0xfd890150,\n        0xb0c6455c, 0xb4f58b19, 0x52522525\n    ]\n\nproperty alphabet896 = SHA224::hash input == output where\n    input = join \"abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu\"\n    output = join [\n        0xc97ca9a5, 0x59850ce9, 0x7a04a96d, 0xef6d99a9,\n        0xe0e0e2ab, 0x14e6b8df, 0x265fc0b3\n    ]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/MAC\/HMAC\/Tests\/HMAC_SHA2_384.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module that defines the given test vector record types and properties to verify HMAC-SHA-384 and its 192-bit truncation against the RFC 4868 section 2.7.1 and 2.7.2.2 test vectors, using an imported HMAC_SHA384 instantiation."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Symmetric::MAC::HMAC::Tests::HMAC_SHA2_384 where\n\nimport Primitive::Symmetric::MAC::HMAC::Instantiations::HMAC_SHA384 as H384\n\ntype PrfParams K D =\n  { Key : [K][8]\n  , Data: [D][8]\n  , PRF_HMAC_SHA_384 : [384]\n  }\n\nprf_test : {K, D} (K < 256, D < 256) => PrfParams K D -> Bit\nprf_test params =\n  H384::hmac params.Key params.Data == split params.PRF_HMAC_SHA_384\n\nproperty rfc_4868_2_7_1_1 = prf_test\n  { Key = repeat`{20} 0x0b\n  , Data = \"Hi There\"\n  , PRF_HMAC_SHA_384 =\n      0xafd03944d84895626b0825f4ab46907f #\n      0x15f9dadbe4101ec682aa034c7cebc59c #\n      0xfaea9ea9076ede7f4af152e8b2fa9cb6\n  }\n\nproperty rfc_4868_2_7_1_2 = prf_test\n  { Key = \"Jefe\"\n  , Data = \"what do ya want for nothing?\"\n  , PRF_HMAC_SHA_384 =\n      0xaf45d2e376484031617f78d2b58a6b1b #\n      0x9c7ef464f5a01b47e42ec3736322445e #\n      0x8e2240ca5e69e2c78b3239ecfab21649\n  }\n\nproperty rfc_4868_2_7_1_3 = prf_test\n  { Key = repeat`{20} 0xaa\n  , Data = repeat`{50} 0xdd\n  , PRF_HMAC_SHA_384 =\n      0x88062608d3e6ad8a0aa2ace014c8a86f #\n      0x0aa635d947ac9febe83ef4e55966144b #\n      0x2a5ab39dc13814b94e3ab6e101a34f27\n  }\n\nproperty rfc_4868_2_7_1_4 = prf_test\n  { Key = split 0x0102030405060708090a0b0c0d0e0f10111213141516171819\n  , Data = repeat`{50} 0xcd\n  , PRF_HMAC_SHA_384 =\n      0x3e8a69b7783c25851933ab6290af6ca7 #\n      0x7a9981480850009cc5577c6e1f573b4e #\n      0x6801dd23c4a7d679ccf8a386c674cffb\n  }\n\nproperty rfc_4868_2_7_1_5 = prf_test\n  { Key = repeat`{131} 0xaa\n  , Data = \"Test Using Larger Than Block-Size Key - Hash Key First\"\n  , PRF_HMAC_SHA_384 =\n      0x4ece084485813e9088d2c63a041bc5b4 #\n      0x4f9ef1012a2b588f3cd11f05033ac4c6 #\n      0x0c2ef6ab4030fe8296248df163f44952\n  }\n\nproperty rfc_4868_2_7_1_6 = prf_test\n  { Key = repeat`{131} 0xaa\n  , Data = \"This is a test using a larger than block-size key and a larger than block-size data. The key needs to be hashed before being used by the HMAC algorithm.\"\n  , PRF_HMAC_SHA_384 =\n      0x6617178e941f020d351e2f254e8fd32c #\n      0x602420feb0b8fb9adccebb82461e99c5 #\n      0xa678cc31e799176d3860e6110c46523e\n  }\n\ntype AuthTest384 T =\n  { Key : [48][8]\n  , Data : [T][8]\n  , PRF_HMAC_SHA_384 : [384]\n  , HMAC_SHA_384_192 : [192]\n  }\n\nsha2_384_auth_test : {T} (T < 256) => AuthTest384 T -> Bit\nsha2_384_auth_test params =\n  H384::hmac params.Key params.Data == split params.PRF_HMAC_SHA_384 \/\\\n  H384::hmac_truncate params.Key params.Data == split params.HMAC_SHA_384_192\n\nproperty rfc_4868_2_7_2_2_1 = sha2_384_auth_test\n  { Key = repeat`{48} 0x0b\n  , Data = \"Hi There\"\n  , PRF_HMAC_SHA_384 =\n      0xb6a8d5636f5c6a7224f9977dcf7ee6c7 #\n      0xfb6d0c48cbdee9737a959796489bddbc #\n      0x4c5df61d5b3297b4fb68dab9f1b582c2\n  , HMAC_SHA_384_192 =\n      0xb6a8d5636f5c6a7224f9977dcf7ee6c7 #\n      0xfb6d0c48cbdee973\n  }\n\nproperty rfc_4868_2_7_2_2_2 = sha2_384_auth_test\n  { Key = \"JefeJefeJefeJefeJefeJefeJefeJefeJefeJefeJefeJefe\"\n  , Data = \"what do ya want for nothing?\"\n  , PRF_HMAC_SHA_384 =\n      0x2c7353974f1842fd66d53c452ca42122 #\n      0xb28c0b594cfb184da86a368e9b8e16f5 #\n      0x349524ca4e82400cbde0686d403371c9\n  , HMAC_SHA_384_192 =\n      0x2c7353974f1842fd66d53c452ca42122 #\n      0xb28c0b594cfb184d\n  }\n\nproperty rfc_4868_2_7_2_2_3 = sha2_384_auth_test\n  { Key = repeat`{48} 0xaa\n  , Data = repeat`{50} 0xdd\n  , PRF_HMAC_SHA_384 =\n      0x809f439be00274321d4a538652164b53 #\n      0x554a508184a0c3160353e3428597003d #\n      0x35914a18770f9443987054944b7c4b4a\n  , HMAC_SHA_384_192 =\n      0x809f439be00274321d4a538652164b53 #\n      0x554a508184a0c316\n  }\n\nproperty rfc_4868_2_7_2_2_4 = sha2_384_auth_test\n  { Key =\n      split 0x0102030405060708090a0b0c0d0e0f10 #\n      split 0x1112131415161718191a1b1c1d1e1f20 #\n      split 0x0a0b0c0d0e0f10111213141516171819\n  , Data = repeat`{50} 0xcd\n  , PRF_HMAC_SHA_384 =\n      0x5b540085c6e6358096532b2493609ed1 #\n      0xcb298f774f87bb5c2ebf182c83cc7428 #\n      0x707fb92eab2536a5812258228bc96687\n  , HMAC_SHA_384_192 =\n      0x5b540085c6e6358096532b2493609ed1 #\n      0xcb298f774f87bb5c\n  }\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/CipherInterface.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define an interface module `Primitive::Symmetric::Cipher::Block::CipherInterface` with type synonyms `KeySize`, `BlockSize`, a finiteness constraint on both, and functions `encrypt` and `decrypt` of type `[KeySize] -> [BlockSize] -> [BlockSize]`."},{"role":"assistant","content":"```cryptol\ninterface module Primitive::Symmetric::Cipher::Block::CipherInterface where\n  type KeySize : #\n  type BlockSize : #\n  type constraint (fin BlockSize, fin KeySize)\n  encrypt : [KeySize] -> [BlockSize] -> [BlockSize]\n  decrypt : [KeySize] -> [BlockSize] -> [BlockSize]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/CFB.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Specify the CFB (Cipher Feedback) block cipher mode over an abstract block cipher interface, including encrypt and decrypt functions parameterized by segment size and a property encryptCorrect stating decrypt K IV (encrypt K IV Ps) == Ps for all keys, IVs, and plaintext segments."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Symmetric::Cipher::Block::Modes::CFB where\nimport interface Primitive::Symmetric::Cipher::Block::CipherInterface as C\n\nencrypt : {s, n} (fin s, fin n, s >= 0, s <= C::BlockSize)\n    => [C::KeySize] -> [C::BlockSize] -> [n][s] -> [n][s]\nencrypt K IV Ps = Cs\n    where\n        CIPH_K = C::encrypt K\n        Is = [ (drop`{s} I_j_1) # C_j_1\n             | I_j_1 <- [IV] # Is\n             | C_j_1 <- Cs\n             ]\n        Cs = [ P_j ^ (take`{s} (CIPH_K I_j))\n             | P_j <- Ps\n             | I_j <- [IV] # Is\n             ]\n\ndecrypt : {s, n} (fin s, fin n, s >= 0, s <= C::BlockSize)\n    => [C::KeySize] -> [C::BlockSize] -> [n][s] -> [n][s]\ndecrypt K IV Cs = Ps\n    where\n        CIPH_K = C::encrypt K\n        Is = [ (drop`{s} I_j_1) # C_j_1\n             | I_j_1 <- [IV] # Is\n             | C_j_1 <- Cs\n             ]\n        Ps = [ C_j ^ (take`{s} (CIPH_K I_j))\n             | C_j <- Cs\n             | I_j <- [IV] # Is\n             ]\n\nencryptCorrect : {s, n} (fin n, s >= 0, s <= C::BlockSize)\n    => [C::KeySize] -> [C::BlockSize] -> [n][s] -> Bool\nproperty encryptCorrect K IV Ps = (decrypt K IV (encrypt K IV Ps)) == Ps\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Simon\/Instantiations\/Simon128_128.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module `Primitive::Symmetric::Cipher::Block::Simon::Instantiations::Simon128_128` that instantiates the generic Simon block cipher specification for the Simon-128\/128 variant with type parameters `n = 64`, `m = 2`, `T = 68`, and `j = 2`."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Symmetric::Cipher::Block::Simon::Instantiations::Simon128_128 =\n  Primitive::Symmetric::Cipher::Block::Simon::Specification where\n    type n = 64\n    type m = 2\n    type T = 68\n    type j = 2\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Simon\/Instantiations\/Simon128_256.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module `Primitive::Symmetric::Cipher::Block::Simon::Instantiations::Simon128_256` instantiating the generic Simon block cipher specification for the Simon-128\/256 variant with parameters `n=64`, `m=4`, `T=72`, and `j=4`."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Symmetric::Cipher::Block::Simon::Instantiations::Simon128_256 =\n  Primitive::Symmetric::Cipher::Block::Simon::Specification where\n    type n = 64\n    type m = 4\n    type T = 72\n    type j = 4\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_CTR.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module Primitive::Symmetric::Cipher::Block::Modes::Tests::AES256_CTR that imports Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_CTR and defines properties aes256_ctr_encrypt_vector and aes256_ctr_decrypt_vector checking AES-256 CTR encrypt\/decrypt against the given NIST test vectors."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Symmetric::Cipher::Block::Modes::Tests::AES256_CTR where\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_CTR as AES256_CTR\n\nproperty aes256_ctr_encrypt_vector = (AES256_CTR::encrypt k ic plaintext) == ciphertext\n    where\n    k = 0x603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4\n    ic = 0xf0f1f2f3f4f5f6f7f8f9fafbfcfdfeff\n    plaintext = [\n        0x6bc1bee22e409f96e93d7e117393172a,\n        0xae2d8a571e03ac9c9eb76fac45af8e51,\n        0x30c81c46a35ce411e5fbc1191a0a52ef,\n        0xf69f2445df4f9b17ad2b417be66c3710]\n    ciphertext = [\n        0x601ec313775789a5b7a7f504bbf3d228,\n        0xf443e3ca4d62b59aca84e990cacaf5c5,\n        0x2b0930daa23de94ce87017ba2d84988d,\n        0xdfc9c58db67aada613c2dd08457941a6]\n\nproperty aes256_ctr_decrypt_vector = (AES256_CTR::decrypt k ic ciphertext) == plaintext\n    where\n    k = 0x603deb1015ca71be2b73aef0857d77811f352c073b6108d72d9810a30914dff4\n    ic = 0xf0f1f2f3f4f5f6f7f8f9fafbfcfdfeff\n    ciphertext = [\n        0x601ec313775789a5b7a7f504bbf3d228,\n        0xf443e3ca4d62b59aca84e990cacaf5c5,\n        0x2b0930daa23de94ce87017ba2d84988d,\n        0xdfc9c58db67aada613c2dd08457941a6]\n    plaintext = [\n        0x6bc1bee22e409f96e93d7e117393172a,\n        0xae2d8a571e03ac9c9eb76fac45af8e51,\n        0x30c81c46a35ce411e5fbc1191a0a52ef,\n        0xf69f2445df4f9b17ad2b417be66c3710]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Instantiations\/AES192_CFB.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module `Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES192_CFB` that instantiates the generic CFB block cipher mode with the AES-192 block cipher implementation."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES192_CFB =\n    Primitive::Symmetric::Cipher::Block::Modes::CFB {\n        Primitive::Symmetric::Cipher::Block::AES::Instantiations::AES192\n    }\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Instantiations\/AES128_CFB.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module AES128_CFB that instantiates the generic CFB block cipher mode with AES-128, exposing the resulting AES-128 CFB encryption and decryption functions and any necessary types for keys, blocks, and IVs."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES128_CFB =\n    Primitive::Symmetric::Cipher::Block::Modes::CFB {\n        Primitive::Symmetric::Cipher::Block::AES::Instantiations::AES128\n    }\n```"}]}
{"filename":"formal-verso\/lib\/HostValues.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Specify and verify in Cryptol the HostValues module\u2019s heap-based host value store, including VecRepresentation and MapRepresentation constructors, allocation and lookup functions, and define a property that map_representation_equiv correctly characterizes when two MapRepresentation values are equivalent for a given element comparator and heap."},{"role":"assistant","content":"```cryptol\nmodule HostValues where\n\nimport Array\n\nimport Option as Option\n\ntype Handle = [32]\ntype RawRawVal = [64]\ntype Heap = HostHeap\n\narrayScatterConstant : {a, b, n} fin n => Array a b -> [n] a -> b -> Array a b\narrayScatterConstant arr ks v = arrs ! 0\n   where arrs = [arr] # [arrayUpdate arr' k v | arr' <- arrs | k <- ks]\n\narrayScatterVals : {a, b, n} fin n => Array a b -> [n] a -> [n] b -> Array a b\narrayScatterVals arr ks vs = arrs ! 0\n   where arrs = [arr] # [arrayUpdate arr' k v | arr' <- arrs | k <- ks | v <- vs]\n\ntype StringRepresentation = ()\n\nstring_representation_dummy : StringRepresentation\nstring_representation_dummy = ()\n\ninvalid_string_representation : StringRepresentation\ninvalid_string_representation = ()\n\ntype VecData = Array [32] RawRawVal\nnewtype VecRepresentation = {\n   data: VecData,\n   size: [32]\n}\n\nvec_representation_empty : VecRepresentation\nvec_representation_empty =\n   VecRepresentation { data = arrayConstant 0, size = 0 }\n\nvec_representation_singleton : RawRawVal -> VecRepresentation\nvec_representation_singleton n =\n   VecRepresentation { data = arr, size = 1 }\n   where arr = arrayUpdate (arrayConstant 0) 0 n\n\nvec_representation_pair : RawRawVal -> RawRawVal -> VecRepresentation\nvec_representation_pair n m =\n   VecRepresentation { data = arr, size = 2 }\n   where arr = arrayUpdate (arrayUpdate (arrayConstant 0) 0 n) 1 m\n\nvec_representation_triple : RawRawVal -> RawRawVal -> RawRawVal -> VecRepresentation\nvec_representation_triple n m o =\n   VecRepresentation { data = arr, size = 3 }\n   where arr = arrayUpdate (arrayUpdate (arrayUpdate (arrayConstant 0) 0 n) 1 m) 2 o\n\nvec_representation_quad : RawRawVal -> RawRawVal -> RawRawVal -> RawRawVal -> VecRepresentation\nvec_representation_quad n m o p =\n   VecRepresentation { data = arr, size = 4 }\n   where arr = arrayUpdate (arrayUpdate (arrayUpdate (arrayUpdate (arrayConstant 0) 0 n) 1 m) 2 o) 3 p\n\nvec_representation_quint : RawRawVal -> RawRawVal -> RawRawVal -> RawRawVal -> RawRawVal -> VecRepresentation\nvec_representation_quint n m o p q =\n   VecRepresentation { data = arr, size = 5 }\n   where arr = arrayUpdate (arrayUpdate (arrayUpdate (arrayUpdate (arrayUpdate (arrayConstant 0) 0 n) 1 m) 2 o) 3 p) 4 q\n\nvec_representation_n: [32] -> RawRawVal -> VecRepresentation\nvec_representation_n n v =\n   if n == 0 then vec_representation_empty\n   else vec_representation_addtail (vec_representation_n (n - 1) v) v\n\nvec_representation_seq: {n} n <= 0xffffffff => [n] RawRawVal -> VecRepresentation\nvec_representation_seq seq =\n   VecRepresentation { data = arr, size = `n }\n   where arr = arrayRangeUpdate (arrayConstant 0) 0 seq\n\ninvalid_vec_representation : VecRepresentation\ninvalid_vec_representation = vec_representation_empty\n\nvec_representation_get_default : VecRepresentation -> [32] -> RawRawVal -> RawRawVal\nvec_representation_get_default rep n dfl =\n   if n < rep.size then arrayLookup rep.data n else dfl\n\nvec_representation_getall : {n} n <= 0xffffffff => VecRepresentation -> RawRawVal -> [n] RawRawVal\nvec_representation_getall rep dfl = vals\n   where vals @ i = vec_representation_get_default rep i dfl\n\nprivate\n   vec_representation_equiv_at :\n          (RawRawVal -> RawRawVal -> Heap -> Bool) ->\n          VecRepresentation -> VecRepresentation -> Heap ->\n          [32] ->\n          Bool\n   vec_representation_equiv_at subcmp rep1 rep2 heap i =\n      if i >= rep1.size then True\n      | subcmp x1 x2 heap == False then False\n      else vec_representation_equiv_at subcmp rep1 rep2 heap (i + 1)\n      where\n         x1 = arrayLookup rep1.data i\n         x2 = arrayLookup rep2.data i\n\nvec_representation_equiv :\n       (RawRawVal -> RawRawVal -> Heap -> Bool) ->\n       VecRepresentation -> VecRepresentation -> Heap ->\n       Bool\nvec_representation_equiv subcmp rep1 rep2 heap =\n   if rep1.size != rep2.size then False\n   else vec_representation_equiv_at subcmp rep1 rep2 heap 0\n\nvec_representation_addtail : VecRepresentation -> RawRawVal -> VecRepresentation\nvec_representation_addtail rep v =\n   VecRepresentation { data = data', size = size' }\n   where\n      data' = arrayUpdate rep.data rep.size v\n      size' = rep.size + 1\n\ntype MapHere = Array RawRawVal Bool\ntype MapData = Array RawRawVal RawRawVal\nnewtype MapRepresentation = {\n   here: MapHere,\n   data: MapData\n}\n\nmap_representation_empty: MapRepresentation\nmap_representation_empty =\n   MapRepresentation { here = arrayConstant False, data = arrayConstant 0 }\n\nmap_representation_add: RawRawVal -> RawRawVal -> MapRepresentation -> MapRepresentation\nmap_representation_add k v rep =\n   MapRepresentation { here = here', data = data' }\n   where\n      here' = arrayUpdate rep.here k True\n      data' = arrayUpdate rep.data k v\n\nmap_representation_singleton: RawRawVal -> RawRawVal -> MapRepresentation\nmap_representation_singleton k v =\n   map_representation_add k v map_representation_empty\n\nmap_representation_pair: RawRawVal -> RawRawVal -> RawRawVal -> RawRawVal -> MapRepresentation\nmap_representation_pair k1 v1 k2 v2 =\n   map_representation_add k2 v2 (map_representation_singleton k1 v1)\n\nmap_representation_seq: {n} n <= 0xffffffff => [n] RawRawVal -> [n] RawRawVal -> MapRepresentation\nmap_representation_seq ks vs =\n   MapRepresentation { here = here, data = data }\n   where\n      here = arrayScatterConstant empty.here ks True\n      data = arrayScatterVals empty.data ks vs\n      empty = map_representation_empty\n\ninvalid_map_representation : MapRepresentation\ninvalid_map_representation = map_representation_empty\n\nmap_representation_has_key : RawRawVal -> MapRepresentation -> Bool\nmap_representation_has_key k rep =\n   arrayLookup rep.here k\n\nmap_representation_get_default : RawRawVal -> MapRepresentation -> RawRawVal -> RawRawVal\nmap_representation_get_default k rep dfl =\n   if arrayLookup rep.here k == False then dfl\n   else arrayLookup rep.data k\n\nmap_representation_multiget_default : {n} [n] RawRawVal -> MapRepresentation -> RawRawVal -> [n] RawRawVal\nmap_representation_multiget_default ks rep dfl = result\n   where result @ i = map_representation_get_default (ks @ i) rep dfl\n\nmap_representation_equiv :\n       (RawRawVal -> RawRawVal -> Heap -> Bool) ->\n       MapRepresentation -> MapRepresentation -> Heap ->\n       Bool\nmap_representation_equiv _subcmp _rep1 _rep2 _heap =\n      error \"map_representation_equiv: not yet implemented\"\n\nprivate\n\n   type TypeTag = [2]\n   TagU64 = 0\n   TagString = 1\n   TagVec = 2\n   TagMap = 3\n\n   newtype HostHeap = {\n            types: Array Handle TypeTag,\n      values_u64: Array Handle [64],\n      values_string: Array Handle StringRepresentation,\n                        values_vecdata: Array Handle VecData,\n      values_vecsize: Array Handle [32],\n      values_maphere: Array Handle MapHere,\n      values_mapdata: Array Handle MapData,\n      next: Handle\n   }\n\nheap_has_space : Heap -> [32] -> Bool\nheap_has_space h headroom = h.next + headroom >= h.next\n\nempty_heap : Heap\nempty_heap =\n   HostHeap {\n      types = arrayConstant 0,\n      values_u64 = arrayConstant 0,\n      values_string = arrayConstant string_representation_dummy,\n      values_vecdata = arrayConstant (arrayConstant 0),\n      values_vecsize = arrayConstant 0,\n      values_maphere = arrayConstant (arrayConstant False),\n      values_mapdata = arrayConstant (arrayConstant 0),\n      next = 0\n   }\n\nalloc_u64 : [64] -> Heap -> (Heap, Handle)\nalloc_u64 n s = (s', handle)\n   where\n      handle = s.next\n      types' = arrayUpdate s.types handle TagU64\n      values_u64' = arrayUpdate s.values_u64 handle n\n      s' = HostHeap {\n         types = types',\n         values_u64 = values_u64',\n         values_string = s.values_string,\n         values_vecdata = s.values_vecdata,\n         values_vecsize = s.values_vecsize,\n         values_maphere = s.values_maphere,\n         values_mapdata = s.values_mapdata,\n         next = s.next + 1\n      }\n\nalloc_string : StringRepresentation -> Heap -> (Heap, Handle)\nalloc_string rep s = (s', handle)\n   where\n      handle = s.next\n      types' = arrayUpdate s.types handle TagString\n      values_string' = arrayUpdate s.values_string handle rep\n      s' = HostHeap {\n         types = types',\n         values_u64 = s.values_u64,\n         values_string = values_string',\n         values_vecdata = s.values_vecdata,\n         values_vecsize = s.values_vecsize,\n         values_maphere = s.values_maphere,\n         values_mapdata = s.values_mapdata,\n         next = s.next + 1\n      }\n\nalloc_vec : VecRepresentation -> Heap -> (Heap, Handle)\nalloc_vec rep s = (s', handle)\n   where\n      handle = s.next\n      types' = arrayUpdate s.types handle TagVec\n            values_vecdata' = arrayUpdate s.values_vecdata handle rep.data\n      values_vecsize' = arrayUpdate s.values_vecsize handle rep.size\n      s' = HostHeap {\n         types = types',\n         values_u64 = s.values_u64,\n         values_string = s.values_string,\n         values_vecdata = values_vecdata',\n         values_vecsize = values_vecsize',\n         values_maphere = s.values_maphere,\n         values_mapdata = s.values_mapdata,\n         next = s.next + 1\n      }\n\nalloc_map : MapRepresentation -> Heap -> (Heap, Handle)\nalloc_map rep s = (s', handle)\n   where\n      handle = s.next\n      types' = arrayUpdate s.types handle TagMap\n      values_maphere' = arrayUpdate s.values_maphere handle rep.here\n      values_mapdata' = arrayUpdate s.values_mapdata handle rep.data\n      s' = HostHeap {\n         types = types',\n         values_u64 = s.values_u64,\n         values_string = s.values_string,\n         values_vecdata = s.values_vecdata,\n         values_vecsize = s.values_vecsize,\n         values_maphere = values_maphere',\n         values_mapdata = values_mapdata',\n         next = s.next + 1\n      }\n\npresent_as_u64 : Handle -> Heap -> Bool\npresent_as_u64 h s =\n   if h >= s.next then False\n   | arrayLookup s.types h != TagU64 then False\n   else True\n\npresent_as_string : Handle -> Heap -> Bool\npresent_as_string h s =\n   if h >= s.next then False\n   | arrayLookup s.types h != TagString then False\n   else True\n\npresent_as_vec : Handle -> Heap -> Bool\npresent_as_vec h s =\n   if h >= s.next then False\n   | arrayLookup s.types h != TagVec then False\n   else True\n\npresent_as_map : Handle -> Heap -> Bool\npresent_as_map h s =\n   if h >= s.next then False\n   | arrayLookup s.types h != TagMap then False\n   else True\n\nlookup_u64 : Handle -> Heap -> Option::T [64]\nlookup_u64 h s =\n   if h >= s.next then Option::none' 0\n   | arrayLookup s.types h != TagU64 then Option::none' 0\n   else Option::some (arrayLookup s.values_u64 h)\n\nlookup_string : Handle -> Heap -> Option::T StringRepresentation\nlookup_string h s =\n   if h >= s.next then Option::none' invalid_string_representation\n   | arrayLookup s.types h != TagString then Option::none' invalid_string_representation\n   else Option::some (arrayLookup s.values_string h)\n\nlookup_vec : Handle -> Heap -> Option::T VecRepresentation\nlookup_vec h s =\n   if h >= s.next then Option::none' invalid_vec_representation\n   | arrayLookup s.types h != TagVec then Option::none' invalid_vec_representation\n   else\n      Option::some rep\n      where\n         data = arrayLookup s.values_vecdata h\n         size = arrayLookup s.values_vecsize h\n                  rep = VecRepresentation { data = data, size = size }\n\nlookup_map : Handle -> Heap -> Option::T MapRepresentation\nlookup_map h s =\n   if h >= s.next then Option::none' invalid_map_representation\n   | arrayLookup s.types h != TagMap then Option::none' invalid_map_representation\n   else\n      Option::some rep\n      where\n         here = arrayLookup s.values_maphere h\n         data = arrayLookup s.values_mapdata h\n         rep = MapRepresentation { here = here, data = data }\n```"}]}
{"filename":"hand_crafted\/AES128TBOX-1.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of the AES-128 S-box over GF(2^8), including gf28Mult, gf28Pow, gf28Inverse, aesAffine, aesSBox, the 16\u00d716 aesSBoxTable, and a property cell00 asserting aesSBoxTable @ 0 @ 0 == 0x63."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\n\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\n\ngf28Pow : GF28 -> [8] -> GF28\ngf28Pow n k =\n  if k == 0 then 1\n  else\n    (if (k && 1) == 1 then gf28Mult n w\n     else w\n       where v = gf28Pow n (k >> 1)\n             w = gf28Mult v v)\n\ngf28Inverse : GF28 -> GF28\ngf28Inverse x = gf28Pow x 254\n\naesAffine : [8] -> [8]\naesAffine b = c\n  where\n        rol : {n} (fin n) => [n] -> [n]\n    rol x = x <<< 1  \n            c = b ^ (b <<< 1) ^ (b <<< 2) ^ (b <<< 3) ^ (b <<< 4) ^ 0x63\n\naesSBox : [8] -> [8]\naesSBox x = aesAffine y\n  where\n        y = if x == 0x00 then 0x00 else gf28Inverse x\n\naesSBoxTable : [16][16][8]\naesSBoxTable = [ [ aesSBox (r * 16 + c) | c <- [0..15]] |  r <- [0..15]]\n\nproperty cell00 = aesSBoxTable @ 0 @ 0 == 0x63\n```"}]}
{"filename":"SAW-course\/src\/lab6A\/saf.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the functions `usaf : [1][8] -> [10][8] -> [1][8]` and `saf : [1][8] -> [10][8] -> [1][8]` in Cryptol as given, and add a property that they are equal for all inputs `a` and `b` where `0 <= a@0 <= 9`."},{"role":"assistant","content":"```cryptol\nusaf: [1][8] -> [10][8] -> [1][8]\nusaf a b = [(b@(a@0))]\n\nsaf : [1][8] -> [10][8] -> [1][8]\nsaf a b = if a@0 > 9 then [0]\n          else if a@0 < 0 then [0]\n\t\t\t else [(b@(a@0))]\n```"}]}
{"filename":"SAW-course\/src\/lab2C\/solutions.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the given Circle\/Displacement\/BMI record types and functions (areaCircle, nudgeCircle, calcBMI, calcBMIimp), along with example constants, matching the behavior and types implied by the code excerpt."},{"role":"assistant","content":"```cryptol\nimport Float\n\ntype Circle = { radius : Rational, left : Float16, top : Float16 }\ntype Displacement = { left : Float16, top : Float16 }\n\naCircle : Circle\naCircle = { radius=(ratio 5 2), left=20, top=16}\n\nareaCircle : Circle -> Rational\nareaCircle b = (b.radius * b.radius * (ratio 355 113))\n\nc = areaCircle { radius=(ratio 5 2), left=0, top=0 }\n\naCircleArea = areaCircle aCircle\n\nnudgeCircle : Circle -> Displacement -> Circle\nnudgeCircle circle d =\n   { radius = circle.radius, left = circle.left+d.left, top = circle.top+d.top }\n\ndisp : Displacement\ndisp = { left= 12, top=2 }\n\nnewDisp : Displacement \nnewDisp = { left = -32, top=2 }\n\nmovedaCircle = nudgeCircle aCircle disp\nsecondTry = nudgeCircle aCircle newDisp\n\ntype BMI = { weight : Float16, height : Float16 }\ntype BMIimp = { weight : Float16, feet : Float16, inches : Float16 }\n\ncalcBMI : BMI -> Float16\ncalcBMI bmi = bmi.weight \/. bmi.height \/. bmi.height * 10000\n\ncalcBMIimp : BMIimp -> Float16\ncalcBMIimp bmi = bmi.weight \/. (bmi.feet*12+bmi.inches) \/. (bmi.feet*12+bmi.inches) * 703\n\nt1 = { weight=80, height=174 }\nt2 = { weight=180.0, feet=5.0, inches=8.5 }\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Asymmetric\/Signature\/ecdsa.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of ECDSA over the NIST P-384 curve, including functions for key initialization, signing, and public verification, plus properties that check the provided P-384 test vectors for point add\/subtract\/double, scalar multiplication, and twin multiplication."},{"role":"assistant","content":"```cryptol\nmodule Primitive::Asymmetric::Signature::ecdsa where\n\nimport Common::bv\nimport Common::mod_arith\nimport Common::mul_java\n\nimport Common::Field \nimport Common::EC::ec_point_ops\nimport Common::EC::ref_ec_mul\nimport Common::EC::p384_field\nimport Common::EC::p384_ec_point_ops\nimport Common::EC::p384_ec_mul\n\ntest_params : ([384], AffinePoint [384], [384], AffinePoint [384])\ntest_params =\n  (0xe74872524f90425d832a4f264e1f7b9209ec7456e9b4c467d8eac6c68f973ea7fea24f4d3fa8498bb1e26f933eaa261b\n  , { x=0xbbab93c429707b2afe9ac285314d7b40c4ee31531b13291aa9058307cdd038b572fdf2f3a84dc912804fa426fe531a3c\n    , y=0x4c2cffaa333bfd82b575918bb979bf51480c836082c097a03fed5454877b37d2f44f0401d212c16b05052bd383047b31\n    }\n  , 0xd4356773f2b311955542c5835696b9dca9d0e59197d5746bbf7dc079a666d955f74114662e38d31196bf94b060cc0c80\n  , { x=0xd40c63c65b413d0741c56e884f0dca63b822a6f6879d36f9261d9b4a270d5d79a9be790fdfb871b5d6ae9204da692663\n    , y=0x4d6b2b937c85b3c0c3cd2df85e9307cc89e0093f336af3b4531aa126bbdbec466562d8aa0dc1cf360fc1f1d0951e3ad1\n    })\n\ntype Curve fv gv = {\n    point_ops : PointOps fv gv\n  , base : AffinePoint fv\n  , affinify : JacobianPoint fv -> AffinePoint fv\n  , mul : (gv, AffinePoint fv) -> JacobianPoint fv\n  , twin_mul : (gv, AffinePoint fv, gv, AffinePoint fv) -> JacobianPoint fv\n  }\n\ninitialize_public_key : {fv} (Curve [fv] [fv], [fv]) -> AffinePoint [fv]\ninitialize_public_key(c, k) = c.affinify(c.mul(k, c.base))\n\necdsa_sign : {fv} (fin fv, fv >= 1) => (Curve [fv] [fv], [fv], [fv], [fv]) -> ([fv], [fv])\necdsa_sign(c,d,e,k) = if is_zero(r) || is_zero(s) then (0,0) else (r, s)\n  where\n    g = c.point_ops.group_field\n    is_zero(x) = g.is_equal(x, g.field_zero)\n\n    j = (c.affinify(c.mul(k, c.base))).x\n\n    r = g.norm(j)\n    s = g.div(g.add(g.norm(e), g.mul(d, r)), k)\n\necdsa_public_verify : {fv} (fin fv, fv >= 1)\n   => (Curve [fv] [fv], [fv], ([fv], [fv]), AffinePoint [fv]) -> Bit\necdsa_public_verify(c, e, (r, s), q)\n\n   = in_range(s) && (v == r)\n  where\n    f = c.point_ops.field\n    g = c.point_ops.group_field\n    mul(x,y) = g.mul(x, y)\n    div(x,y) = g.div(x, y)\n    is_zero(x) = g.is_equal(x, g.field_zero)\n    in_range(x) = ~is_zero(x) && g.is_val(x)\n    s_inv = div(1, s)\n    u1 = mul(e, s_inv)\n    u2 = mul(r, s_inv)\n    r2 = c.twin_mul(u1, c.base, u2, q)\n\n    j = f.mul(r2.x, f.sq(f.div(f.field_unit, r2.z)))\n\n    v = g.norm(j)\n\necdsa_public_verify_imp :\n  (Curve [384] [384], [384], ([384], [384]), AffinePoint [384]) -> Bit\necdsa_public_verify_imp(c, e, (r, s), q)\n   = in_range(r) && in_range(s) &&\n     ~is_zero(r2.z) &&\n     (g.is_equal(j, r2.x) || ((carrybits == False) && (g.is_equal(k, r2.x))))\n  where\n    f = c.point_ops.field\n    g = c.point_ops.group_field\n    mul(x,y) = g.mul(x, y)\n    div(x,y) = g.div(x, y)\n    is_zero(x) = g.is_equal(x, g.field_zero)\n    in_range(x) = ~is_zero(x) && g.is_val(x)\n    s_inv = div(1, s)\n    u1 = mul(g.norm(e), s_inv)\n    u2 = mul(r, s_inv)\n    r2 = c.twin_mul(u1, c.base, u2, q)\n    r2zsq = f.sq(r2.z)\n    j = f.mul(r, r2zsq)\n    summ = r + p384_group_size\n    carrybits = (summ < r) && (summ < p384_group_size)\n    k = f.mul(summ, r2zsq)\n\ntype RsltWithCarry a b = { carrybits : a , rslt : b }\n\np384_incFieldPrime : [384] -> RsltWithCarry [32] [384]\np384_incFieldPrime x = { carrybits = zero # [(bs @ 0)]\n                       , rslt = drop(bs) : [384]\n                       }\n  where bs = safe_add(x, p384_prime)\n\np384_decFieldPrime : [384] -> RsltWithCarry [32] [384]\np384_decFieldPrime x = { carrybits = if (bs @ 0) then -1 else 0\n                       , rslt = drop(bs) : [384]\n                       }\n  where bs = safe_sub(x, p384_prime)\n\np384_field_cube(x)       = p384_field_mul(x, p384_field_sq(x))\n\np384_base : AffinePoint [384]\np384_base = nzAffinePoint(\n  join [0xaa87ca22, 0xbe8b0537, 0x8eb1c71e, 0xf320ad74, 0x6e1d3b62, 0x8ba79b98\n       ,0x59f741e0, 0x82542a38, 0x5502f25d, 0xbf55296c, 0x3a545e38, 0x72760ab7],\n  join [0x3617de4a, 0x96262c6f, 0x5d9e98bf, 0x9292dc29, 0xf8f41dbd, 0x289a147c\n       ,0xe9da3113, 0xb5f0b8c0, 0x0a60b1ce, 0x1d7e819d, 0x7a431d7c, 0x90ea0e5f])\n\np384_group_add : ([384],[384]) -> [384]\np384_group_add = p384_group_field.add\n\np384_curve : Curve [384] [384]\np384_curve =\n  { point_ops = p384_point_ops\n  , base = p384_base\n  , affinify = \\x -> ec_affinify(p384_field, x)\n  , mul = p384_ec_mul\n  , twin_mul = p384_ec_twin_mul\n  }\n\np384_ecdsa_sign : ([384], [384], [384]) -> { r:[384], s:[384] }\np384_ecdsa_sign(d,e,k) = { r = rr, s = ss }\n  where (rr, ss) = ecdsa_sign(p384_curve,d,e,k)\n\np384_ecdsa_public_verify : ([384], [384], [384], AffinePoint [384]) -> Bit\np384_ecdsa_public_verify(e,pr,ps,q) =\n  ecdsa_public_verify_imp(p384_curve,e,(pr,ps),q)\n\np384_a : [384]\np384_a = p384_prime - 3\n\np384_b : [384]\np384_b = 0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef\n\np384_jacobify : AffinePoint [384] -> JacobianPoint [384]\np384_jacobify p = { x = p.x, y = p.y, z = 1 }\n\np384_base4 : JacobianPoint [384]\np384_base4 = p384_ec_double(p384_ec_double(p384_jacobify(p384_base)))\n\np384_base3 : AffinePoint [384]\np384_base3 = p384_affinify(p384_ec_full_sub(p384_base4, p384_base))\n\np384_base5 : AffinePoint [384]\np384_base5 = p384_affinify(p384_ec_full_add(p384_base4, p384_base))\n\np384_is_affine_point : AffinePoint [384] -> Bit\np384_is_affine_point p =\n  p384_field_sq(p.y) ==\n  p384_field_add(p384_field_cube(p.x),\n                 p384_field_add(p384_field_mul(p384_a, p.x), p384_b))\n\np384_s : AffinePoint [384]\np384_s = nzAffinePoint(\n  join [0xfba203b8, 0x1bbd23f2, 0xb3be971c, 0xc23997e1, 0xae4d89e6, 0x9cb6f923,\n        0x85dda827, 0x68ada415, 0xebab4167, 0x459da98e, 0x62b1332d, 0x1e73cb0e],\n  join [0x5ffedbae, 0xfdeba603, 0xe7923e06, 0xcdb5d0c6, 0x5b223014, 0x29293376,\n        0xd5c6944e, 0x3fa6259f, 0x162b4788, 0xde6987fd, 0x59aed5e4, 0xb5285e45])\n\np384_t : AffinePoint [384]\np384_t = nzAffinePoint(\n  join [0xaacc0520, 0x2e7fda6f, 0xc73d82f0, 0xa6622052, 0x7da8117e, 0xe8f8330e,\n        0xad7d20ee, 0x6f255f58, 0x2d8bd38c, 0x5a7f2b40, 0xbcdb68ba, 0x13d81051],\n  join [0x84009a26, 0x3fefba7c, 0x2c57cffa, 0x5db3634d, 0x286131af, 0xc0fca8d2,\n        0x5afa22a7, 0xb5dce0d9, 0x470da892, 0x33cee178, 0x592f49b6, 0xfecb5092])\n\np384_d =\n  join [0xa4ebcae5, 0xa6659834, 0x93ab3e62, 0x6085a24c, 0x104311a7, 0x61b5a8fd,\n        0xac052ed1, 0xf111a5c4, 0x4f76f456, 0x59d2d111, 0xa61b5fdd, 0x97583480]\n\np384_e =\n  join [0xafcf8811, 0x9a3a76c8, 0x7acbd600, 0x8e1349b2, 0x9f4ba9aa, 0x0e12ce89,\n        0xbcfcae21, 0x80b38d81, 0xab8cf150, 0x95301a18, 0x2afbc689, 0x3e75385d]\n\np384_projectify : AffinePoint [384] -> JacobianPoint [384]\np384_projectify(p) = ec_projectify(f,p)\n  where f = p384_curve.point_ops.field\n\np384_affinify : JacobianPoint [384] -> AffinePoint [384]\np384_affinify(p) = ec_affinify(f,p)\n  where f = p384_curve.point_ops.field\n\ntest_p384_s_plus_t : AffinePoint [384]\ntest_p384_s_plus_t = p384_affinify(add(p384_projectify(s),t))\n  where s = p384_s\n        t = p384_t\n        add = p384_curve.point_ops.add\n\nexpected_p384_s_plus_t : AffinePoint [384]\nexpected_p384_s_plus_t =\n  { x = join [0x12dc5ce7, 0xacdfc584, 0x4d939f40, 0xb4df012e, 0x68f865b8, 0x9c3213ba,\n              0x97090a24, 0x7a2fc009, 0x075cf471, 0xcd2e85c4, 0x89979b65, 0xee0b5eed]\n  , y = join [0x167312e5, 0x8fe0c0af, 0xa248f285, 0x4e3cddcb, 0x557f983b, 0x3189b67f,\n              0x21eee013, 0x41e7e9fe, 0x67f6ee81, 0xb36988ef, 0xa406945c, 0x8804a4b0]\n  }\n\ntest_p384_s_minus_t : AffinePoint [384]\ntest_p384_s_minus_t = p384_affinify(sub(p384_projectify(s),t))\n  where s = p384_s\n        t = p384_t\n        sub = p384_curve.point_ops.sub\n\nexpected_p384_s_minus_t : AffinePoint [384]\nexpected_p384_s_minus_t =\n  { x = join [0x6afdaf8d, 0xa8b11c98, 0x4cf177e5, 0x51cee542, 0xcda4ac2f, 0x25cd522d,\n              0x0cd710f8, 0x8059c656, 0x5aef78f6, 0xb5ed6cc0, 0x5a6666de, 0xf2a2fb59]\n  , y = join [0x7bed0e15, 0x8ae8cc70, 0xe847a603, 0x47ca1548, 0xc348decc, 0x6309f48b,\n              0x59bd5afc, 0x9a9b804e, 0x7f787617, 0x8cb5a7eb, 0x4f6940a9, 0xc73e8e5e]\n  }\n\ntest_p384_double_s : AffinePoint [384]\ntest_p384_double_s = p384_affinify(dbl(p384_projectify(s)))\n  where s = p384_s\n        dbl = p384_curve.point_ops.double\n\nexpected_p384_double_s : AffinePoint [384]\nexpected_p384_double_s =\n  { x = join [0x2a2111b1, 0xe0aa8b2f, 0xc5a19755, 0x16bc4d58, 0x017ff96b, 0x25e1bdff,\n              0x3c229d5f, 0xac3bacc3, 0x19dcbec2, 0x9f9478f4, 0x2dee597b, 0x4641504c]\n  , y = join [0xfa2e3d9d, 0xc84db895, 0x4ce8085e, 0xf28d7184, 0xfddfd134, 0x4b4d4797,\n              0x343af9b5, 0xf9d83752, 0x0b450f72, 0x6443e411, 0x4bd4e5bd, 0xb2f65ddd]\n  }\n\ntest_p384_ds : AffinePoint [384]\ntest_p384_ds = p384_affinify(mul(p384_d, p384_s))\n  where mul = p384_curve.mul\n\nexpected_p384_ds : AffinePoint [384]\nexpected_p384_ds =\n  { x = join [0xe4f77e7f, 0xfeb7f095, 0x8910e3a6, 0x80d677a4, 0x77191df1, 0x66160ff7,\n              0xef6bb526, 0x1f791aa7, 0xb45e3e65, 0x3d151b95, 0xdad3d93c, 0xa0290ef2]\n  , y = join [0xac7dee41, 0xd8c5f4a7, 0xd5836960, 0xa773cfc1, 0x376289d3, 0x373f8cf7,\n              0x417b0c62, 0x07ac32e9, 0x13856612, 0xfc9ff2e3, 0x57eb2ee0, 0x5cf9667f]\n  }\n\ntest_p384_ds_et : AffinePoint [384]\ntest_p384_ds_et = p384_affinify(twin_mul(p384_d, p384_s, p384_e, p384_t))\n  where twin_mul = p384_curve.twin_mul\n\nexpected_p384_ds_et : AffinePoint [384]\nexpected_p384_ds_et =\n  { x = join [0x917ea28b, 0xcd641741, 0xae5d18c2, 0xf1bd917b, 0xa68d34f0, 0xf0577387,\n              0xdc812604, 0x62aea60e, 0x2417b8bd, 0xc5d954fc, 0x729d211d, 0xb23a02dc]\n  , y = join [0x1a29f7ce, 0x6d074654, 0xd77b4088, 0x8c73e925, 0x46c8f16a, 0x5ff6bcbd,\n              0x307f758d, 0x4aee684b, 0xeff26f67, 0x42f597e2, 0x585c86da, 0x908f7186]\n  }\n\nproperty test_plus =\n  test_p384_s_plus_t  == expected_p384_s_plus_t\n\nproperty test_minus =\n  test_p384_s_minus_t == expected_p384_s_minus_t\n\nproperty test_double =\n  test_p384_double_s  == expected_p384_double_s\n\nproperty test_ds =\n  test_p384_ds    == expected_p384_ds\n\nproperty test_ds_et =\n  test_p384_ds_et == expected_p384_ds_et\n```"}]}
{"filename":"saw-script\/intTests\/test_newtype\/complex.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the newtype CplxInt over Integer with complex addition, multiplication, equality, and properties cplxAddAssoc, cplxMulAssoc, and cplxMulDistrib verifying associativity of addition, associativity of multiplication, and left distributivity of multiplication over addition."},{"role":"assistant","content":"```cryptol\ntype Int = Integer\n\nnewtype CplxInt =\n  { real : Int, imag : Int }\n\nembedQ : Int -> CplxInt\nembedQ x = CplxInt{ real = x, imag = 0 }\n\ncplxAdd : CplxInt -> CplxInt -> CplxInt\ncplxAdd x y = CplxInt { real = r, imag = i }\n  where\n  r = x.real + y.real\n  i = x.imag + y.imag\n\ncplxMul : CplxInt -> CplxInt -> CplxInt\ncplxMul x y = CplxInt { real = r, imag = i }\n  where\n  r = x.real * y.real - x.imag * y.imag\n  i = x.real * y.imag + x.imag * y.real\n\ncplxEq : CplxInt -> CplxInt -> Bit\ncplxEq x y = (x.real == y.real) && (x.imag == y.imag)\n\ncplxAddAssoc : CplxInt -> CplxInt -> CplxInt -> Bit\ncplxAddAssoc x y z =\n  cplxEq (cplxAdd (cplxAdd x y) z)\n         (cplxAdd x (cplxAdd y z))\n\ncplxMulAssoc : CplxInt -> CplxInt -> CplxInt -> Bit\ncplxMulAssoc x y z =\n  cplxEq (cplxMul (cplxMul x y) z)\n         (cplxMul x (cplxMul y z))\n\ncplxMulDistrib : CplxInt -> CplxInt -> CplxInt -> Bit\ncplxMulDistrib x y z =\n  cplxEq (cplxMul x (cplxAdd y z))\n         (cplxAdd (cplxMul x y) (cplxMul x z))\n```"}]}
{"filename":"saw-script\/intTests\/test_fold_rewrite_proof\/tupletest.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that includes the given tuple-based fold functions and a property `foldFunctionInverse` stating that `foldFunction' (foldFunction x y z) y z == x` for all 8-bit `x` and 16-bit `y`, `z`, suitable for formal verification."},{"role":"assistant","content":"```cryptol\nmodule tupletest where\n\nfoldFunction : [8] -> [16] -> [16] -> [8]\nfoldFunction x y z = output.0\n  where\n    output = foldl fnc (x, y, z) [0 .. 15]\n\nfnc : ([8], [16], [16]) -> [4] -> ([8], [16], [16])\nfnc (x, y, z) i = returnTup\n  where\n    returnTup = (x ^ take y' ^ take z', y', z')\n    y' = y <<< i\n    z' = z >>> i\n\nfoldFunction' : [8] -> [16] -> [16] -> [8]\nfoldFunction' x y z = output.0\n  where\n    output = foldl fnc' (x, y, z) [15, 14 .. 0]\n\nfnc' : ([8], [16], [16]) -> [4] -> ([8], [16], [16])\nfnc' (x, y, z) i = returnTup\n  where\n    returnTup = (x ^ take y ^ take z, y', z')\n    y' = y >>> i\n    z' = z <<< i\n\nproperty foldFunctionInverse x y z =\n    foldFunction' (foldFunction x y z) y z == x\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/035_invMixColumns.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the AES-128 inverse MixColumns transformation over GF(2^8) using precomputed multiplication tables (for 0x0e, 0x0b, 0x0d, 0x09), including the types GF28, State, the helper functions gf28Mult, toBytes, fromBytes, and a function invMixColumns : State -> State matching the standard AES inverse MixColumns step."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ntype Nb = 4\ntype State = [4][Nb * 8]\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\ntoBytes : [32] -> [4]GF28\ntoBytes x = split`{4} x\nfromBytes : [4]GF28 -> [32]\nfromBytes xs = join xs\nmETable = [gf28Mult 0x0e i | i <- [0 .. 255]]\nmBTable = [gf28Mult 0x0b i | i <- [0 .. 255]]\nmDTable = [gf28Mult 0x0d i | i <- [0 .. 255]]\nm9Table = [gf28Mult 0x09 i | i <- [0 .. 255]]\nmE i = mETable @ i\nmB i = mBTable @ i\nmD i = mDTable @ i\nm9 i = m9Table @ i\ntables =\n  [[mE, mB, mD, m9],\n  [m9, mE, mB, mD],\n  [mD, m9, mE, mB],\n  [mB, mD, m9, mE]]\ninvMixColumns : State -> State\ninvMixColumns state =\n  [fromBytes ce | ce <- transpose\n                 (mmult [toBytes se | se <- state])]\n  where\n    dollar f x = f x\n    dot f fs = foldr1 (^) (zipWith dollar f fs)\n    mmult n = [[(dot r) ne | ne <- n] | r <- tables]\nfoldr : {a, b, n} (fin n) => (a -> b -> b) -> b -> [n]a -> b\nfoldr f acc xs =\n  ys ! 0\n  where\n    ys = [acc] # [f x a | a <- ys | x <- reverse xs]\nfoldr1 : {a, b} (fin b) => (a -> a -> a) -> [1 + b]a -> a\nfoldr1 f xs = foldr f (xs @ 0) (tail xs)\nzipWith : {a, b, c, n} (a -> b -> c) -> [n]a -> [n]b -> [n]c\nzipWith f xs ys = [f x y | x <- xs | y <- ys]\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/041_doRounds.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function `doRounds` and supporting types and functions (`Nb`, `State`, `RoundKey`, `addRoundKey`) as given, where `doRounds` iteratively applies a round function `rnd` over an initial key, a sequence of round keys, and a final key, and verify with a `property` that for any choice of `rnd`, initial key, round keys, final key, and input state, `doRounds` produces the same final state as computing the initial AddRoundKey followed by the same sequence of `rnd` applications unrolled explicitly."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype State = [4][Nb * 8]\ntype RoundKey = State\naddRoundKey : RoundKey -> State -> State\naddRoundKey k s = k ^ s\ndoRounds : {a, b}\n  (fin b) =>\n    (Bit -> State -> a -> State) ->\n    (RoundKey, [b]a, a) -> State -> State\ndoRounds rnd (ikey, rkeys, fkey) sIn =\n  rnd True (rs ! 0) fkey\n  where\n    s0 = addRoundKey ikey sIn\n    rs = [s0] # [rnd False s k | s <- rs | k <- rkeys]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/048_sbox6.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the DES S-box 6 constant `sbox6 : [4][16][4]` with the given 4\u00d716 table of 4-bit values exactly as specified here."},{"role":"assistant","content":"```cryptol\nsbox6 : [4][16][4]\nsbox6 =\n  [[12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],\n  [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],\n  [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],\n  [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/058_testsPass.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the DES block cipher as a value `DES : Cipher 64 64` (with `encrypt`\/`decrypt` wired through the DES round function, key schedule, permutations, and S-boxes as in the NIST standard) and a property `testsPass` that checks `DES.encrypt` on given test message\/key pairs matches the expected ciphertexts."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Cipher\n\n\nDES : Cipher 64 64\nDES =\n  {encrypt = \\key pt -> des (expandKey key) pt,\n  decrypt = \\key ct -> des (reverse (expandKey key)) ct}\ndes keys pt =\n  (swap (split lst)) @@ FPz\n  where\n    pt' = pt @@ IPz\n    iv = [round (k, split lr) | k <- keys | lr <- [pt'] # iv]\n    lst = iv @ (length keys - 1)\nround : ([48], [2][32]) -> [64]\nround (k, [l, r]) = r # (l ^ f (r, k))\nf (r, k) = (SBox (k ^ (r @@ EPz))) @@ PPz\nswap [a, b] = b # a\nexpandKey : [64] -> [16][48]\nexpandKey key = expand (split (key @@ KPz))\nexpand : [2][28] -> [16][48]\nexpand [kl, kr] =\n  [((kl <<< i) # (kr <<< i)) @@ CPz | i <- sums\n                                     [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1]]\nsums : [16][8] -> [16][8]\nsums xs = ys where ys = [x + y | x <- xs | y <- [0] # ys]\nzeroBasify XP = [i - 1 | i <- XP]\nKPz = zeroBasify KP\nCPz = zeroBasify CP\nPPz = zeroBasify PP\nEPz = zeroBasify EP\nIPz = zeroBasify IP\nFPz = zeroBasify FP\nKP : [56][6]\nKP =\n  [57,\n  49,\n  41,\n  33,\n  25,\n  17,\n  9,\n  1,\n  58,\n  50,\n  42,\n  34,\n  26,\n  18,\n  10,\n  2,\n  59,\n  51,\n  43,\n  35,\n  27,\n  19,\n  11,\n  3,\n  60,\n  52,\n  44,\n  36,\n  63,\n  55,\n  47,\n  39,\n  31,\n  23,\n  15,\n  7,\n  62,\n  54,\n  46,\n  38,\n  30,\n  22,\n  14,\n  6,\n  61,\n  53,\n  45,\n  37,\n  29,\n  21,\n  13,\n  5,\n  28,\n  20,\n  12,\n  4]\nCP : [48][6]\nCP =\n  [14,\n  17,\n  11,\n  24,\n  1,\n  5,\n  3,\n  28,\n  15,\n  6,\n  21,\n  10,\n  23,\n  19,\n  12,\n  4,\n  26,\n  8,\n  16,\n  7,\n  27,\n  20,\n  13,\n  2,\n  41,\n  52,\n  31,\n  37,\n  47,\n  55,\n  30,\n  40,\n  51,\n  45,\n  33,\n  48,\n  44,\n  49,\n  39,\n  56,\n  34,\n  53,\n  46,\n  42,\n  50,\n  36,\n  29,\n  32]\nPP : [32][6]\nPP =\n  [16,\n  7,\n  20,\n  21,\n  29,\n  12,\n  28,\n  17,\n  1,\n  15,\n  23,\n  26,\n  5,\n  18,\n  31,\n  10,\n  2,\n  8,\n  24,\n  14,\n  32,\n  27,\n  3,\n  9,\n  19,\n  13,\n  30,\n  6,\n  22,\n  11,\n  4,\n  25]\nEP : [48][6]\nEP =\n  [32,\n  1,\n  2,\n  3,\n  4,\n  5,\n  4,\n  5,\n  6,\n  7,\n  8,\n  9,\n  8,\n  9,\n  10,\n  11,\n  12,\n  13,\n  12,\n  13,\n  14,\n  15,\n  16,\n  17,\n  16,\n  17,\n  18,\n  19,\n  20,\n  21,\n  20,\n  21,\n  22,\n  23,\n  24,\n  25,\n  24,\n  25,\n  26,\n  27,\n  28,\n  29,\n  28,\n  29,\n  30,\n  31,\n  32,\n  1]\nIP : [64][7]\nIP =\n  [58,\n  50,\n  42,\n  34,\n  26,\n  18,\n  10,\n  2,\n  60,\n  52,\n  44,\n  36,\n  28,\n  20,\n  12,\n  4,\n  62,\n  54,\n  46,\n  38,\n  30,\n  22,\n  14,\n  6,\n  64,\n  56,\n  48,\n  40,\n  32,\n  24,\n  16,\n  8,\n  57,\n  49,\n  41,\n  33,\n  25,\n  17,\n  9,\n  1,\n  59,\n  51,\n  43,\n  35,\n  27,\n  19,\n  11,\n  3,\n  61,\n  53,\n  45,\n  37,\n  29,\n  21,\n  13,\n  5,\n  63,\n  55,\n  47,\n  39,\n  31,\n  23,\n  15,\n  7]\nFP : [64][7]\nFP =\n  [40,\n  8,\n  48,\n  16,\n  56,\n  24,\n  64,\n  32,\n  39,\n  7,\n  47,\n  15,\n  55,\n  23,\n  63,\n  31,\n  38,\n  6,\n  46,\n  14,\n  54,\n  22,\n  62,\n  30,\n  37,\n  5,\n  45,\n  13,\n  53,\n  21,\n  61,\n  29,\n  36,\n  4,\n  44,\n  12,\n  52,\n  20,\n  60,\n  28,\n  35,\n  3,\n  43,\n  11,\n  51,\n  19,\n  59,\n  27,\n  34,\n  2,\n  42,\n  10,\n  50,\n  18,\n  58,\n  26,\n  33,\n  1,\n  41,\n  9,\n  49,\n  17,\n  57,\n  25]\nSBox : [48] -> [32]\nSBox x = join [sbox (n, b) | n <- [1 .. 8] | b <- split x]\nsbox : ([4], [6]) -> [4]\nsbox (n, x) =\n  (s @ [b1, b6] @ [b2, b3, b4, b5])\n  where\n    s = sboxes @ (n - 1)\n    b1 = x @ 0\n    b2 = x @ 1\n    b3 = x @ 2\n    b4 = x @ 3\n    b5 = x @ 4\n    b6 = x @ 5\nsboxes = [sbox1, sbox2, sbox3, sbox4, sbox5, sbox6, sbox7, sbox8]\nsbox1 : [4][16][4]\nsbox1 =\n  [[14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],\n  [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],\n  [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],\n  [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13]]\nsbox2 : [4][16][4]\nsbox2 =\n  [[15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],\n  [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],\n  [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],\n  [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9]]\nsbox3 : [4][16][4]\nsbox3 =\n  [[10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8],\n  [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1],\n  [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7],\n  [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12]]\nsbox4 : [4][16][4]\nsbox4 =\n  [[7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15],\n  [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9],\n  [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4],\n  [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14]]\nsbox5 : [4][16][4]\nsbox5 =\n  [[2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9],\n  [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6],\n  [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14],\n  [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3]]\nsbox6 : [4][16][4]\nsbox6 =\n  [[12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],\n  [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],\n  [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],\n  [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13]]\nsbox7 : [4][16][4]\nsbox7 =\n  [[4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1],\n  [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6],\n  [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2],\n  [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12]]\nsbox8 : [4][16][4]\nsbox8 =\n  [[13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7],\n  [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2],\n  [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8],\n  [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11]]\ntestmsgs =\n  [0x1122334455667788,\n  0x99aabbccddeeff00,\n  0x41ad068548809d02,\n  0xb10f843097a0f932]\ntestkeys =\n  [0x752878397493cb70,\n  0x752878397493cb70,\n  0x0001020304050607,\n  0x2bd6459f82c5b300]\ntestct =\n  [0xb5219ee81aa7499d,\n  0x2196687e13973856,\n  0x0011223344556677,\n  0xea024714ad5c4d84]\n\/* pragma testsPass : property *\/\ntestsPass =\n  and\n    [DES.encrypt key msg == ct | key <- testkeys\n                               | msg <- testmsgs\n                               | ct <- testct]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/020_rfctest03.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property rfctest03 that verifies the given ChaCha20 stream cipher implementation (using qround, cdround, core, kexp, iround, stream, and encrypt over types Round, Block, Key, Nonce, and Counter) correctly encrypts the specified msg with the given key and counter to produce the expected out test vector."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\niround : [64] -> Round -> Round\niround n r =\n  (iterate once r) @ n\n  where\n    once\n      [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n       x15] =\n      [x0,\n      x1,\n      x2,\n      x3,\n      x4,\n      x5,\n      x6,\n      x7,\n      x8,\n      x9,\n      x10,\n      x11,\n      x12 + 1,\n      x13,\n      x14,\n      x15]\nstream : {n} (fin n) => Key -> Counter -> Nonce -> [n][8]\nstream k c n =\n  take`{n} (join rounds)\n  where\n    key = kexp k c n\n    rounds = [core (iround i key) | i <- [0, 1 ...]]\nencrypt : {n}\n  (fin n) =>\n    Key -> Counter -> Nonce -> [n][8] -> [n][8]\nencrypt k c n m = m ^ (stream k c n)\nrfctest03 =\n  encrypt key 42 (zero # [2]) msg == out\n  where\n    key =\n      [0x1c,\n      0x92,\n      0x40,\n      0xa5,\n      0xeb,\n      0x55,\n      0xd3,\n      0x8a,\n      0xf3,\n      0x33,\n      0x88,\n      0x86,\n      0x04,\n      0xf6,\n      0xb5,\n      0xf0,\n      0x47,\n      0x39,\n      0x17,\n      0xc1,\n      0x40,\n      0x2b,\n      0x80,\n      0x09,\n      0x9d,\n      0xca,\n      0x5c,\n      0xbc,\n      0x20,\n      0x70,\n      0x75,\n      0xc0]\n    out =\n      [0x27,\n      0x54,\n      0x77,\n      0x61,\n      0x73,\n      0x20,\n      0x62,\n      0x72,\n      0x69,\n      0x6c,\n      0x6c,\n      0x69,\n      0x67,\n      0x2c,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x73,\n      0x6c,\n      0x69,\n      0x74,\n      0x68,\n      0x79,\n      0x20,\n      0x74,\n      0x6f,\n      0x76,\n      0x65,\n      0x73,\n      0x0a,\n      0x44,\n      0x69,\n      0x64,\n      0x20,\n      0x67,\n      0x79,\n      0x72,\n      0x65,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x67,\n      0x69,\n      0x6d,\n      0x62,\n      0x6c,\n      0x65,\n      0x20,\n      0x69,\n      0x6e,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x77,\n      0x61,\n      0x62,\n      0x65,\n      0x3a,\n      0x0a,\n      0x41,\n      0x6c,\n      0x6c,\n      0x20,\n      0x6d,\n      0x69,\n      0x6d,\n      0x73,\n      0x79,\n      0x20,\n      0x77,\n      0x65,\n      0x72,\n      0x65,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x62,\n      0x6f,\n      0x72,\n      0x6f,\n      0x67,\n      0x6f,\n      0x76,\n      0x65,\n      0x73,\n      0x2c,\n      0x0a,\n      0x41,\n      0x6e,\n      0x64,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x6d,\n      0x6f,\n      0x6d,\n      0x65,\n      0x20,\n      0x72,\n      0x61,\n      0x74,\n      0x68,\n      0x73,\n      0x20,\n      0x6f,\n      0x75,\n      0x74,\n      0x67,\n      0x72,\n      0x61,\n      0x62,\n      0x65,\n      0x2e]\n    msg =\n      [0x62,\n      0xe6,\n      0x34,\n      0x7f,\n      0x95,\n      0xed,\n      0x87,\n      0xa4,\n      0x5f,\n      0xfa,\n      0xe7,\n      0x42,\n      0x6f,\n      0x27,\n      0xa1,\n      0xdf,\n      0x5f,\n      0xb6,\n      0x91,\n      0x10,\n      0x04,\n      0x4c,\n      0x0d,\n      0x73,\n      0x11,\n      0x8e,\n      0xff,\n      0xa9,\n      0x5b,\n      0x01,\n      0xe5,\n      0xcf,\n      0x16,\n      0x6d,\n      0x3d,\n      0xf2,\n      0xd7,\n      0x21,\n      0xca,\n      0xf9,\n      0xb2,\n      0x1e,\n      0x5f,\n      0xb1,\n      0x4c,\n      0x61,\n      0x68,\n      0x71,\n      0xfd,\n      0x84,\n      0xc5,\n      0x4f,\n      0x9d,\n      0x65,\n      0xb2,\n      0x83,\n      0x19,\n      0x6c,\n      0x7f,\n      0xe4,\n      0xf6,\n      0x05,\n      0x53,\n      0xeb,\n      0xf3,\n      0x9c,\n      0x64,\n      0x02,\n      0xc4,\n      0x22,\n      0x34,\n      0xe3,\n      0x2a,\n      0x35,\n      0x6b,\n      0x3e,\n      0x76,\n      0x43,\n      0x12,\n      0xa6,\n      0x1a,\n      0x55,\n      0x32,\n      0x05,\n      0x57,\n      0x16,\n      0xea,\n      0xd6,\n      0x96,\n      0x25,\n      0x68,\n      0xf8,\n      0x7d,\n      0x3f,\n      0x3f,\n      0x77,\n      0x04,\n      0xc6,\n      0xa8,\n      0xd1,\n      0xbc,\n      0xd1,\n      0xbf,\n      0x4d,\n      0x50,\n      0xd6,\n      0x15,\n      0x4b,\n      0x6d,\n      0xa7,\n      0x31,\n      0xb1,\n      0x87,\n      0xb5,\n      0x8d,\n      0xfd,\n      0x72,\n      0x8a,\n      0xfa,\n      0x36,\n      0x75,\n      0x7a,\n      0x79,\n      0x7a,\n      0xc1,\n      0x88,\n      0xd1]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/021_rfctest02.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of the ChaCha20 stream cipher with types Round = [16][32], Block = [64][8], Key = [32][8], Nonce = [12][8], Counter = [32], functions qround, cdround, kexp, iround, core, stream, encrypt, and a property rfctest02 that checks encrypt (zero # [1]) 1 (zero # [2]) msg equals the given RFC test vector out for the provided msg bytes."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\niround : [64] -> Round -> Round\niround n r =\n  (iterate once r) @ n\n  where\n    once\n      [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n       x15] =\n      [x0,\n      x1,\n      x2,\n      x3,\n      x4,\n      x5,\n      x6,\n      x7,\n      x8,\n      x9,\n      x10,\n      x11,\n      x12 + 1,\n      x13,\n      x14,\n      x15]\nstream : {n} (fin n) => Key -> Counter -> Nonce -> [n][8]\nstream k c n =\n  take`{n} (join rounds)\n  where\n    key = kexp k c n\n    rounds = [core (iround i key) | i <- [0, 1 ...]]\nencrypt : {n}\n  (fin n) =>\n    Key -> Counter -> Nonce -> [n][8] -> [n][8]\nencrypt k c n m = m ^ (stream k c n)\nrfctest02 =\n  encrypt (zero # [1]) 1 (zero # [2]) msg == out\n  where\n    out =\n      [0xa3,\n      0xfb,\n      0xf0,\n      0x7d,\n      0xf3,\n      0xfa,\n      0x2f,\n      0xde,\n      0x4f,\n      0x37,\n      0x6c,\n      0xa2,\n      0x3e,\n      0x82,\n      0x73,\n      0x70,\n      0x41,\n      0x60,\n      0x5d,\n      0x9f,\n      0x4f,\n      0x4f,\n      0x57,\n      0xbd,\n      0x8c,\n      0xff,\n      0x2c,\n      0x1d,\n      0x4b,\n      0x79,\n      0x55,\n      0xec,\n      0x2a,\n      0x97,\n      0x94,\n      0x8b,\n      0xd3,\n      0x72,\n      0x29,\n      0x15,\n      0xc8,\n      0xf3,\n      0xd3,\n      0x37,\n      0xf7,\n      0xd3,\n      0x70,\n      0x05,\n      0x0e,\n      0x9e,\n      0x96,\n      0xd6,\n      0x47,\n      0xb7,\n      0xc3,\n      0x9f,\n      0x56,\n      0xe0,\n      0x31,\n      0xca,\n      0x5e,\n      0xb6,\n      0x25,\n      0x0d,\n      0x40,\n      0x42,\n      0xe0,\n      0x27,\n      0x85,\n      0xec,\n      0xec,\n      0xfa,\n      0x4b,\n      0x4b,\n      0xb5,\n      0xe8,\n      0xea,\n      0xd0,\n      0x44,\n      0x0e,\n      0x20,\n      0xb6,\n      0xe8,\n      0xdb,\n      0x09,\n      0xd8,\n      0x81,\n      0xa7,\n      0xc6,\n      0x13,\n      0x2f,\n      0x42,\n      0x0e,\n      0x52,\n      0x79,\n      0x50,\n      0x42,\n      0xbd,\n      0xfa,\n      0x77,\n      0x73,\n      0xd8,\n      0xa9,\n      0x05,\n      0x14,\n      0x47,\n      0xb3,\n      0x29,\n      0x1c,\n      0xe1,\n      0x41,\n      0x1c,\n      0x68,\n      0x04,\n      0x65,\n      0x55,\n      0x2a,\n      0xa6,\n      0xc4,\n      0x05,\n      0xb7,\n      0x76,\n      0x4d,\n      0x5e,\n      0x87,\n      0xbe,\n      0xa8,\n      0x5a,\n      0xd0,\n      0x0f,\n      0x84,\n      0x49,\n      0xed,\n      0x8f,\n      0x72,\n      0xd0,\n      0xd6,\n      0x62,\n      0xab,\n      0x05,\n      0x26,\n      0x91,\n      0xca,\n      0x66,\n      0x42,\n      0x4b,\n      0xc8,\n      0x6d,\n      0x2d,\n      0xf8,\n      0x0e,\n      0xa4,\n      0x1f,\n      0x43,\n      0xab,\n      0xf9,\n      0x37,\n      0xd3,\n      0x25,\n      0x9d,\n      0xc4,\n      0xb2,\n      0xd0,\n      0xdf,\n      0xb4,\n      0x8a,\n      0x6c,\n      0x91,\n      0x39,\n      0xdd,\n      0xd7,\n      0xf7,\n      0x69,\n      0x66,\n      0xe9,\n      0x28,\n      0xe6,\n      0x35,\n      0x55,\n      0x3b,\n      0xa7,\n      0x6c,\n      0x5c,\n      0x87,\n      0x9d,\n      0x7b,\n      0x35,\n      0xd4,\n      0x9e,\n      0xb2,\n      0xe6,\n      0x2b,\n      0x08,\n      0x71,\n      0xcd,\n      0xac,\n      0x63,\n      0x89,\n      0x39,\n      0xe2,\n      0x5e,\n      0x8a,\n      0x1e,\n      0x0e,\n      0xf9,\n      0xd5,\n      0x28,\n      0x0f,\n      0xa8,\n      0xca,\n      0x32,\n      0x8b,\n      0x35,\n      0x1c,\n      0x3c,\n      0x76,\n      0x59,\n      0x89,\n      0xcb,\n      0xcf,\n      0x3d,\n      0xaa,\n      0x8b,\n      0x6c,\n      0xcc,\n      0x3a,\n      0xaf,\n      0x9f,\n      0x39,\n      0x79,\n      0xc9,\n      0x2b,\n      0x37,\n      0x20,\n      0xfc,\n      0x88,\n      0xdc,\n      0x95,\n      0xed,\n      0x84,\n      0xa1,\n      0xbe,\n      0x05,\n      0x9c,\n      0x64,\n      0x99,\n      0xb9,\n      0xfd,\n      0xa2,\n      0x36,\n      0xe7,\n      0xe8,\n      0x18,\n      0xb0,\n      0x4b,\n      0x0b,\n      0xc3,\n      0x9c,\n      0x1e,\n      0x87,\n      0x6b,\n      0x19,\n      0x3b,\n      0xfe,\n      0x55,\n      0x69,\n      0x75,\n      0x3f,\n      0x88,\n      0x12,\n      0x8c,\n      0xc0,\n      0x8a,\n      0xaa,\n      0x9b,\n      0x63,\n      0xd1,\n      0xa1,\n      0x6f,\n      0x80,\n      0xef,\n      0x25,\n      0x54,\n      0xd7,\n      0x18,\n      0x9c,\n      0x41,\n      0x1f,\n      0x58,\n      0x69,\n      0xca,\n      0x52,\n      0xc5,\n      0xb8,\n      0x3f,\n      0xa3,\n      0x6f,\n      0xf2,\n      0x16,\n      0xb9,\n      0xc1,\n      0xd3,\n      0x00,\n      0x62,\n      0xbe,\n      0xbc,\n      0xfd,\n      0x2d,\n      0xc5,\n      0xbc,\n      0xe0,\n      0x91,\n      0x19,\n      0x34,\n      0xfd,\n      0xa7,\n      0x9a,\n      0x86,\n      0xf6,\n      0xe6,\n      0x98,\n      0xce,\n      0xd7,\n      0x59,\n      0xc3,\n      0xff,\n      0x9b,\n      0x64,\n      0x77,\n      0x33,\n      0x8f,\n      0x3d,\n      0xa4,\n      0xf9,\n      0xcd,\n      0x85,\n      0x14,\n      0xea,\n      0x99,\n      0x82,\n      0xcc,\n      0xaf,\n      0xb3,\n      0x41,\n      0xb2,\n      0x38,\n      0x4d,\n      0xd9,\n      0x02,\n      0xf3,\n      0xd1,\n      0xab,\n      0x7a,\n      0xc6,\n      0x1d,\n      0xd2,\n      0x9c,\n      0x6f,\n      0x21,\n      0xba,\n      0x5b,\n      0x86,\n      0x2f,\n      0x37,\n      0x30,\n      0xe3,\n      0x7c,\n      0xfd,\n      0xc4,\n      0xfd,\n      0x80,\n      0x6c,\n      0x22,\n      0xf2,\n      0x21]\n    msg =\n      [0x41,\n      0x6e,\n      0x79,\n      0x20,\n      0x73,\n      0x75,\n      0x62,\n      0x6d,\n      0x69,\n      0x73,\n      0x73,\n      0x69,\n      0x6f,\n      0x6e,\n      0x20,\n      0x74,\n      0x6f,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x69,\n      0x6e,\n      0x74,\n      0x65,\n      0x6e,\n      0x64,\n      0x65,\n      0x64,\n      0x20,\n      0x62,\n      0x79,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x43,\n      0x6f,\n      0x6e,\n      0x74,\n      0x72,\n      0x69,\n      0x62,\n      0x75,\n      0x74,\n      0x6f,\n      0x72,\n      0x20,\n      0x66,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x75,\n      0x62,\n      0x6c,\n      0x69,\n      0x63,\n      0x61,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x61,\n      0x6c,\n      0x6c,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x61,\n      0x72,\n      0x74,\n      0x20,\n      0x6f,\n      0x66,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x49,\n      0x6e,\n      0x74,\n      0x65,\n      0x72,\n      0x6e,\n      0x65,\n      0x74,\n      0x2d,\n      0x44,\n      0x72,\n      0x61,\n      0x66,\n      0x74,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x52,\n      0x46,\n      0x43,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x61,\n      0x6e,\n      0x79,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x20,\n      0x6d,\n      0x61,\n      0x64,\n      0x65,\n      0x20,\n      0x77,\n      0x69,\n      0x74,\n      0x68,\n      0x69,\n      0x6e,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x63,\n      0x6f,\n      0x6e,\n      0x74,\n      0x65,\n      0x78,\n      0x74,\n      0x20,\n      0x6f,\n      0x66,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x61,\n      0x63,\n      0x74,\n      0x69,\n      0x76,\n      0x69,\n      0x74,\n      0x79,\n      0x20,\n      0x69,\n      0x73,\n      0x20,\n      0x63,\n      0x6f,\n      0x6e,\n      0x73,\n      0x69,\n      0x64,\n      0x65,\n      0x72,\n      0x65,\n      0x64,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x22,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x43,\n      0x6f,\n      0x6e,\n      0x74,\n      0x72,\n      0x69,\n      0x62,\n      0x75,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x22,\n      0x2e,\n      0x20,\n      0x53,\n      0x75,\n      0x63,\n      0x68,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x73,\n      0x20,\n      0x69,\n      0x6e,\n      0x63,\n      0x6c,\n      0x75,\n      0x64,\n      0x65,\n      0x20,\n      0x6f,\n      0x72,\n      0x61,\n      0x6c,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x73,\n      0x20,\n      0x69,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x73,\n      0x65,\n      0x73,\n      0x73,\n      0x69,\n      0x6f,\n      0x6e,\n      0x73,\n      0x2c,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x77,\n      0x65,\n      0x6c,\n      0x6c,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x77,\n      0x72,\n      0x69,\n      0x74,\n      0x74,\n      0x65,\n      0x6e,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x65,\n      0x6c,\n      0x65,\n      0x63,\n      0x74,\n      0x72,\n      0x6f,\n      0x6e,\n      0x69,\n      0x63,\n      0x20,\n      0x63,\n      0x6f,\n      0x6d,\n      0x6d,\n      0x75,\n      0x6e,\n      0x69,\n      0x63,\n      0x61,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x73,\n      0x20,\n      0x6d,\n      0x61,\n      0x64,\n      0x65,\n      0x20,\n      0x61,\n      0x74,\n      0x20,\n      0x61,\n      0x6e,\n      0x79,\n      0x20,\n      0x74,\n      0x69,\n      0x6d,\n      0x65,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x6c,\n      0x61,\n      0x63,\n      0x65,\n      0x2c,\n      0x20,\n      0x77,\n      0x68,\n      0x69,\n      0x63,\n      0x68,\n      0x20,\n      0x61,\n      0x72,\n      0x65,\n      0x20,\n      0x61,\n      0x64,\n      0x64,\n      0x72,\n      0x65,\n      0x73,\n      0x73,\n      0x65,\n      0x64,\n      0x20,\n      0x74,\n      0x6f]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/004_mct_ecb_decrypt_128.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type AESTestVector 128 and the function mct_ecb_decrypt_128 : [128] -> [128] -> [100](AESTestVector 128) implementing the AES-128 Monte Carlo Test for ECB decryption using aesDecryptBlock and aes128DecryptSchedule from SuiteB, including generation of 100 test vectors from an initial key and ciphertext as described."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_128 : [128] -> [128] -> [100](AESTestVector 128)\nmct_ecb_decrypt_128 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][128]\n    keys =\n      [initialKey] # [k ^ (xs ! 0) | xs <- take`{99}\n                                    (groupBy`{1000} pts)\n                                   | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES128)\n    schedules = map aes128DecryptSchedule keys\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/014_mct_ecb_decrypt_192.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the function `mct_ecb_decrypt_192 : [192] -> [128] -> [100](AESTestVector 192)` and any required types and helpers so that it models the AES-192 Monte Carlo Test for ECB decryption, producing 100 test vectors of key, plaintext, and ciphertext derived from iterative AES-192 decryption and key schedule updates."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_192 : [192] -> [128] -> [100](AESTestVector 192)\nmct_ecb_decrypt_192 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][192]\n    keys =\n      [initialKey] # [k ^ ((drop`{64}\n        (xs ! 1)) # xs ! 0) | xs <- take`{99} (groupBy`{1000} pts)\n                            | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES192)\n    schedules = map aes192DecryptSchedule keys\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/070_tcId1069.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property tcId1069 that verifies the AES256_KeyWrap padded authenticated-encryption function KWP_AE, instantiated from Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap, maps the 8-bit plaintext 0xe0 under the 256-bit key 0x2644ccf9d7c419a437c954c8141cbb2d60f57de10a5393554a14ccc72229e286 to the ciphertext 0xda510b1d9a10255380655980a3a73536, using a helper predicate check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct and asserting testPassed == check_KWP_AE key pt ct."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1069 : property *\/\ntcId1069 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x2644ccf9d7c419a437c954c8141cbb2d60f57de10a5393554a14ccc72229e286\n    pt = 0xe0\n    ct = 0xda510b1d9a10255380655980a3a73536\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/081_tcId1080.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1080` that checks, for AES-256 Key Wrap with padding in AE mode, that encrypting the plaintext `0x06` under the key `0x3ea9325069ed93a96c331bdd6dd766ec64bbba83a72c69ed75df55043fb0bfd1` with `KWP_AE` produces the expected ciphertext `0x40a9c42012ba38211b800e6e313b6876`, using the helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1080 : property *\/\ntcId1080 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x3ea9325069ed93a96c331bdd6dd766ec64bbba83a72c69ed75df55043fb0bfd1\n    pt = 0x06\n    ct = 0x40a9c42012ba38211b800e6e313b6876\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/058_pi16'.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function `pi16' : [16][64] -> [16][64]` that permutes a 16-word (64-bit each) Threefish state using the index order `[0, 15, 2, 11, 6, 13, 4, 9, 14, 1, 8, 5, 10, 3, 12, 7 : [4]]`, and add a property that this permutation is bijective (has an inverse)."},{"role":"assistant","content":"```cryptol\npi16' : [16][64] -> [16][64]\npi16' xs =\n  xs @@ [0, 15, 2, 11, 6, 13, 4, 9, 14, 1, 8, 5, 10, 3, 12, 7 : [4]]\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/016_range.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias `Dom n = {lo : [n], sz : [n]}` and the functions `interval : {n} (fin n) => [n] -> [n] -> Dom n` and `range : {n} (fin n) => [n] -> [n] -> Dom n` where `interval l s = {lo = l, sz = s}` and `range lo hi = interval lo (hi - lo)`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nrange : {n} (fin n) => [n] -> [n] -> Dom n\nrange lo hi = interval lo (hi - lo)\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/024_top.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias `Dom n = {lo : [n], sz : [n]}`, the function `interval : {n} (fin n) => [n] -> [n] -> Dom n` with `interval l s = {lo = l, sz = s}`, and the constant `top : {n} (fin n) => Dom n` defined as `top = interval 0 (~0)`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\ntop : {n} (fin n) => Dom n\ntop = interval 0 (~0)\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/198_o4.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type `Dom n = {lo : [n], sz : [n]}`, the functions `mem : {n} (fin n) => Dom n -> [n] -> Bit`, `ubounds : {n} (fin n) => Dom n -> ([n], [n])`, `ule : {n} (fin n) => Dom n -> Dom n -> Bit`, the property `correct_ule : {n} (fin n, n >= 1) => Dom n -> Dom n -> [n] -> [n] -> Bit` expressing that `ule a b` implies `x <= y` for all `x` and `y` in the respective domains, and a property instance `o4 = correct_ule` specialized to `n = 16`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nule : {n} (fin n) => Dom n -> Dom n -> Bit\nule a b = (ubounds a).1 <= (ubounds b).0\ncorrect_ule : {n}\n  (fin n, n >= 1) =>\n    Dom n -> Dom n -> [n] -> [n] -> Bit\ncorrect_ule a b x y = ule a b ==> mem a x ==> mem b y ==> x <= y\n\/* pragma o4 : property *\/\no4 = correct_ule`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/249_i08.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type `Dom n = {lo : [n], sz : [n]}`, functions `interval`, `singleton`, `neg`, `singleton_neg` as in the excerpt, and the property `i08` that asserts `singleton_neg` instantiated at width 16 (i.e., `singleton_neg`{16}) holds for all 16-bit inputs, suitable for verification with a solver."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nsingleton : {n} (fin n) => [n] -> Dom n\nsingleton x = interval x 0\nneg : {n} (fin n) => Dom n -> Dom n\nneg a = interval (-(a.lo + a.sz)) a.sz\nsingleton_neg : {n} (fin n) => [n] -> Bit\nsingleton_neg x = neg (singleton x) == singleton (-x)\n\/* pragma i08 : property *\/\ni08 = singleton_neg`{16}\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/035_Salsa20_passes_tests.cry","filetype":"cryptol","set":"holdout","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property `Salsa20_passes_tests` that checks the given Salsa20 core implementation (using `quarterround`, `rowround`, `columnround`, `doubleround`, `littleendian`, `littleendian_state`, `littleendian_state_inverse`, `Salsa20_rounds`, and `Salsa20 : [32] -> [64][8] -> [64][8]`) satisfies the three specified 20-round test vectors by equating its outputs to the provided 64-byte expected sequences and conjoining the results."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\nrowround : [16][32] -> [16][32]\nrowround\n  [y0, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13, y14,\n   y15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [z0, z1, z2, z3] = quarterround [y0, y1, y2, y3]\n    [z5, z6, z7, z4] = quarterround [y5, y6, y7, y4]\n    [z10, z11, z8, z9] = quarterround [y10, y11, y8, y9]\n    [z15, z12, z13, z14] = quarterround [y15, y12, y13, y14]\ncolumnround : [16][32] -> [16][32]\ncolumnround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [y0,\n  y1,\n  y2,\n  y3,\n  y4,\n  y5,\n  y6,\n  y7,\n  y8,\n  y9,\n  y10,\n  y11,\n  y12,\n  y13,\n  y14,\n  y15]\n  where\n    [y0, y4, y8, y12] = quarterround [x0, x4, x8, x12]\n    [y5, y9, y13, y1] = quarterround [x5, x9, x13, x1]\n    [y10, y14, y2, y6] = quarterround [x10, x14, x2, x6]\n    [y15, y3, y7, y11] = quarterround [x15, x3, x7, x11]\ndoubleround : [16][32] -> [16][32]\ndoubleround xs = rowround (columnround (xs))\nlittleendian : [4][8] -> [32]\nlittleendian b = join (reverse b)\nlittleendian_inverse : {n} (fin n) => [8 * n] -> [n][8]\nlittleendian_inverse b = reverse (split b)\nlittleendian_state : [64][8] -> [16][32]\nlittleendian_state b = [littleendian xi | xi <- split b]\nlittleendian_state_inverse : [16][32] -> [64][8]\nlittleendian_state_inverse w = join (map littleendian_inverse w)\nSalsa20 : [32] -> [64][8] -> [64][8]\nSalsa20 count xs =\n  littleendian_state_inverse (Salsa20_rounds count xw xw)\n  where\n    xw = littleendian_state xs\nSalsa20_rounds : [32] -> [16][32] -> [16][32] -> [16][32]\nSalsa20_rounds count xw xw' =\n  xw + zs @ (count \/ 2)\n  where\n    zs = [xw'] # [doubleround zi | zi <- zs]\n\/* pragma Salsa20_passes_tests : property *\/\nSalsa20_passes_tests =\n  (Salsa20 20\n    [0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0] == [0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0]) \/\\ (Salsa20 20\n    [211,\n    159,\n    13,\n    115,\n    76,\n    55,\n    82,\n    183,\n    3,\n    117,\n    222,\n    37,\n    191,\n    187,\n    234,\n    136,\n    49,\n    237,\n    179,\n    48,\n    1,\n    106,\n    178,\n    219,\n    175,\n    199,\n    166,\n    48,\n    86,\n    16,\n    179,\n    207,\n    31,\n    240,\n    32,\n    63,\n    15,\n    83,\n    93,\n    161,\n    116,\n    147,\n    48,\n    113,\n    238,\n    55,\n    204,\n    36,\n    79,\n    201,\n    235,\n    79,\n    3,\n    81,\n    156,\n    47,\n    203,\n    26,\n    244,\n    243,\n    88,\n    118,\n    104,\n    54] == [109,\n  42,\n  178,\n  168,\n  156,\n  240,\n  248,\n  238,\n  168,\n  196,\n  190,\n  203,\n  26,\n  110,\n  170,\n  154,\n  29,\n  29,\n  150,\n  26,\n  150,\n  30,\n  235,\n  249,\n  190,\n  163,\n  251,\n  48,\n  69,\n  144,\n  51,\n  57,\n  118,\n  40,\n  152,\n  157,\n  180,\n  57,\n  27,\n  94,\n  107,\n  42,\n  236,\n  35,\n  27,\n  111,\n  114,\n  114,\n  219,\n  236,\n  232,\n  135,\n  111,\n  155,\n  110,\n  18,\n  24,\n  232,\n  95,\n  158,\n  179,\n  19,\n  48,\n  202]) \/\\ (Salsa20 20\n    [88,\n    118,\n    104,\n    54,\n    79,\n    201,\n    235,\n    79,\n    3,\n    81,\n    156,\n    47,\n    203,\n    26,\n    244,\n    243,\n    191,\n    187,\n    234,\n    136,\n    211,\n    159,\n    13,\n    115,\n    76,\n    55,\n    82,\n    183,\n    3,\n    117,\n    222,\n    37,\n    86,\n    16,\n    179,\n    207,\n    49,\n    237,\n    179,\n    48,\n    1,\n    106,\n    178,\n    219,\n    175,\n    199,\n    166,\n    48,\n    238,\n    55,\n    204,\n    36,\n    31,\n    240,\n    32,\n    63,\n    15,\n    83,\n    93,\n    161,\n    116,\n    147,\n    48,\n    113] == [179,\n  19,\n  48,\n  202,\n  219,\n  236,\n  232,\n  135,\n  111,\n  155,\n  110,\n  18,\n  24,\n  232,\n  95,\n  158,\n  26,\n  110,\n  170,\n  154,\n  109,\n  42,\n  178,\n  168,\n  156,\n  240,\n  248,\n  238,\n  168,\n  196,\n  190,\n  203,\n  69,\n  144,\n  51,\n  57,\n  29,\n  29,\n  150,\n  26,\n  150,\n  30,\n  235,\n  249,\n  190,\n  163,\n  251,\n  48,\n  27,\n  111,\n  114,\n  114,\n  118,\n  40,\n  152,\n  157,\n  180,\n  57,\n  27,\n  94,\n  107,\n  42,\n  236,\n  35])\n```"}]}
