{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/035_invMixColumns.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the AES-128 inverse MixColumns transformation over GF(2^8) using precomputed multiplication tables (for 0x0e, 0x0b, 0x0d, 0x09), including the types GF28, State, the helper functions gf28Mult, toBytes, fromBytes, and a function invMixColumns : State -> State matching the standard AES inverse MixColumns step."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ntype Nb = 4\ntype State = [4][Nb * 8]\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\ntoBytes : [32] -> [4]GF28\ntoBytes x = split`{4} x\nfromBytes : [4]GF28 -> [32]\nfromBytes xs = join xs\nmETable = [gf28Mult 0x0e i | i <- [0 .. 255]]\nmBTable = [gf28Mult 0x0b i | i <- [0 .. 255]]\nmDTable = [gf28Mult 0x0d i | i <- [0 .. 255]]\nm9Table = [gf28Mult 0x09 i | i <- [0 .. 255]]\nmE i = mETable @ i\nmB i = mBTable @ i\nmD i = mDTable @ i\nm9 i = m9Table @ i\ntables =\n  [[mE, mB, mD, m9],\n  [m9, mE, mB, mD],\n  [mD, m9, mE, mB],\n  [mB, mD, m9, mE]]\ninvMixColumns : State -> State\ninvMixColumns state =\n  [fromBytes ce | ce <- transpose\n                 (mmult [toBytes se | se <- state])]\n  where\n    dollar f x = f x\n    dot f fs = foldr1 (^) (zipWith dollar f fs)\n    mmult n = [[(dot r) ne | ne <- n] | r <- tables]\nfoldr : {a, b, n} (fin n) => (a -> b -> b) -> b -> [n]a -> b\nfoldr f acc xs =\n  ys ! 0\n  where\n    ys = [acc] # [f x a | a <- ys | x <- reverse xs]\nfoldr1 : {a, b} (fin b) => (a -> a -> a) -> [1 + b]a -> a\nfoldr1 f xs = foldr f (xs @ 0) (tail xs)\nzipWith : {a, b, c, n} (a -> b -> c) -> [n]a -> [n]b -> [n]c\nzipWith f xs ys = [f x y | x <- xs | y <- ys]\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/041_doRounds.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function `doRounds` and supporting types and functions (`Nb`, `State`, `RoundKey`, `addRoundKey`) as given, where `doRounds` iteratively applies a round function `rnd` over an initial key, a sequence of round keys, and a final key, and verify with a `property` that for any choice of `rnd`, initial key, round keys, final key, and input state, `doRounds` produces the same final state as computing the initial AddRoundKey followed by the same sequence of `rnd` applications unrolled explicitly."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype State = [4][Nb * 8]\ntype RoundKey = State\naddRoundKey : RoundKey -> State -> State\naddRoundKey k s = k ^ s\ndoRounds : {a, b}\n  (fin b) =>\n    (Bit -> State -> a -> State) ->\n    (RoundKey, [b]a, a) -> State -> State\ndoRounds rnd (ikey, rkeys, fkey) sIn =\n  rnd True (rs ! 0) fkey\n  where\n    s0 = addRoundKey ikey sIn\n    rs = [s0] # [rnd False s k | s <- rs | k <- rkeys]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/048_sbox6.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the DES S-box 6 constant `sbox6 : [4][16][4]` with the given 4\u00d716 table of 4-bit values exactly as specified here."},{"role":"assistant","content":"```cryptol\nsbox6 : [4][16][4]\nsbox6 =\n  [[12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],\n  [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],\n  [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],\n  [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/058_testsPass.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the DES block cipher as a value `DES : Cipher 64 64` (with `encrypt`\/`decrypt` wired through the DES round function, key schedule, permutations, and S-boxes as in the NIST standard) and a property `testsPass` that checks `DES.encrypt` on given test message\/key pairs matches the expected ciphertexts."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Cipher\n\n\nDES : Cipher 64 64\nDES =\n  {encrypt = \\key pt -> des (expandKey key) pt,\n  decrypt = \\key ct -> des (reverse (expandKey key)) ct}\ndes keys pt =\n  (swap (split lst)) @@ FPz\n  where\n    pt' = pt @@ IPz\n    iv = [round (k, split lr) | k <- keys | lr <- [pt'] # iv]\n    lst = iv @ (length keys - 1)\nround : ([48], [2][32]) -> [64]\nround (k, [l, r]) = r # (l ^ f (r, k))\nf (r, k) = (SBox (k ^ (r @@ EPz))) @@ PPz\nswap [a, b] = b # a\nexpandKey : [64] -> [16][48]\nexpandKey key = expand (split (key @@ KPz))\nexpand : [2][28] -> [16][48]\nexpand [kl, kr] =\n  [((kl <<< i) # (kr <<< i)) @@ CPz | i <- sums\n                                     [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1]]\nsums : [16][8] -> [16][8]\nsums xs = ys where ys = [x + y | x <- xs | y <- [0] # ys]\nzeroBasify XP = [i - 1 | i <- XP]\nKPz = zeroBasify KP\nCPz = zeroBasify CP\nPPz = zeroBasify PP\nEPz = zeroBasify EP\nIPz = zeroBasify IP\nFPz = zeroBasify FP\nKP : [56][6]\nKP =\n  [57,\n  49,\n  41,\n  33,\n  25,\n  17,\n  9,\n  1,\n  58,\n  50,\n  42,\n  34,\n  26,\n  18,\n  10,\n  2,\n  59,\n  51,\n  43,\n  35,\n  27,\n  19,\n  11,\n  3,\n  60,\n  52,\n  44,\n  36,\n  63,\n  55,\n  47,\n  39,\n  31,\n  23,\n  15,\n  7,\n  62,\n  54,\n  46,\n  38,\n  30,\n  22,\n  14,\n  6,\n  61,\n  53,\n  45,\n  37,\n  29,\n  21,\n  13,\n  5,\n  28,\n  20,\n  12,\n  4]\nCP : [48][6]\nCP =\n  [14,\n  17,\n  11,\n  24,\n  1,\n  5,\n  3,\n  28,\n  15,\n  6,\n  21,\n  10,\n  23,\n  19,\n  12,\n  4,\n  26,\n  8,\n  16,\n  7,\n  27,\n  20,\n  13,\n  2,\n  41,\n  52,\n  31,\n  37,\n  47,\n  55,\n  30,\n  40,\n  51,\n  45,\n  33,\n  48,\n  44,\n  49,\n  39,\n  56,\n  34,\n  53,\n  46,\n  42,\n  50,\n  36,\n  29,\n  32]\nPP : [32][6]\nPP =\n  [16,\n  7,\n  20,\n  21,\n  29,\n  12,\n  28,\n  17,\n  1,\n  15,\n  23,\n  26,\n  5,\n  18,\n  31,\n  10,\n  2,\n  8,\n  24,\n  14,\n  32,\n  27,\n  3,\n  9,\n  19,\n  13,\n  30,\n  6,\n  22,\n  11,\n  4,\n  25]\nEP : [48][6]\nEP =\n  [32,\n  1,\n  2,\n  3,\n  4,\n  5,\n  4,\n  5,\n  6,\n  7,\n  8,\n  9,\n  8,\n  9,\n  10,\n  11,\n  12,\n  13,\n  12,\n  13,\n  14,\n  15,\n  16,\n  17,\n  16,\n  17,\n  18,\n  19,\n  20,\n  21,\n  20,\n  21,\n  22,\n  23,\n  24,\n  25,\n  24,\n  25,\n  26,\n  27,\n  28,\n  29,\n  28,\n  29,\n  30,\n  31,\n  32,\n  1]\nIP : [64][7]\nIP =\n  [58,\n  50,\n  42,\n  34,\n  26,\n  18,\n  10,\n  2,\n  60,\n  52,\n  44,\n  36,\n  28,\n  20,\n  12,\n  4,\n  62,\n  54,\n  46,\n  38,\n  30,\n  22,\n  14,\n  6,\n  64,\n  56,\n  48,\n  40,\n  32,\n  24,\n  16,\n  8,\n  57,\n  49,\n  41,\n  33,\n  25,\n  17,\n  9,\n  1,\n  59,\n  51,\n  43,\n  35,\n  27,\n  19,\n  11,\n  3,\n  61,\n  53,\n  45,\n  37,\n  29,\n  21,\n  13,\n  5,\n  63,\n  55,\n  47,\n  39,\n  31,\n  23,\n  15,\n  7]\nFP : [64][7]\nFP =\n  [40,\n  8,\n  48,\n  16,\n  56,\n  24,\n  64,\n  32,\n  39,\n  7,\n  47,\n  15,\n  55,\n  23,\n  63,\n  31,\n  38,\n  6,\n  46,\n  14,\n  54,\n  22,\n  62,\n  30,\n  37,\n  5,\n  45,\n  13,\n  53,\n  21,\n  61,\n  29,\n  36,\n  4,\n  44,\n  12,\n  52,\n  20,\n  60,\n  28,\n  35,\n  3,\n  43,\n  11,\n  51,\n  19,\n  59,\n  27,\n  34,\n  2,\n  42,\n  10,\n  50,\n  18,\n  58,\n  26,\n  33,\n  1,\n  41,\n  9,\n  49,\n  17,\n  57,\n  25]\nSBox : [48] -> [32]\nSBox x = join [sbox (n, b) | n <- [1 .. 8] | b <- split x]\nsbox : ([4], [6]) -> [4]\nsbox (n, x) =\n  (s @ [b1, b6] @ [b2, b3, b4, b5])\n  where\n    s = sboxes @ (n - 1)\n    b1 = x @ 0\n    b2 = x @ 1\n    b3 = x @ 2\n    b4 = x @ 3\n    b5 = x @ 4\n    b6 = x @ 5\nsboxes = [sbox1, sbox2, sbox3, sbox4, sbox5, sbox6, sbox7, sbox8]\nsbox1 : [4][16][4]\nsbox1 =\n  [[14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],\n  [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],\n  [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],\n  [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13]]\nsbox2 : [4][16][4]\nsbox2 =\n  [[15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],\n  [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],\n  [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],\n  [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9]]\nsbox3 : [4][16][4]\nsbox3 =\n  [[10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8],\n  [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1],\n  [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7],\n  [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12]]\nsbox4 : [4][16][4]\nsbox4 =\n  [[7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15],\n  [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9],\n  [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4],\n  [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14]]\nsbox5 : [4][16][4]\nsbox5 =\n  [[2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9],\n  [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6],\n  [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14],\n  [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3]]\nsbox6 : [4][16][4]\nsbox6 =\n  [[12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],\n  [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],\n  [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],\n  [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13]]\nsbox7 : [4][16][4]\nsbox7 =\n  [[4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1],\n  [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6],\n  [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2],\n  [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12]]\nsbox8 : [4][16][4]\nsbox8 =\n  [[13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7],\n  [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2],\n  [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8],\n  [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11]]\ntestmsgs =\n  [0x1122334455667788,\n  0x99aabbccddeeff00,\n  0x41ad068548809d02,\n  0xb10f843097a0f932]\ntestkeys =\n  [0x752878397493cb70,\n  0x752878397493cb70,\n  0x0001020304050607,\n  0x2bd6459f82c5b300]\ntestct =\n  [0xb5219ee81aa7499d,\n  0x2196687e13973856,\n  0x0011223344556677,\n  0xea024714ad5c4d84]\n\/* pragma testsPass : property *\/\ntestsPass =\n  and\n    [DES.encrypt key msg == ct | key <- testkeys\n                               | msg <- testmsgs\n                               | ct <- testct]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/020_rfctest03.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property rfctest03 that verifies the given ChaCha20 stream cipher implementation (using qround, cdround, core, kexp, iround, stream, and encrypt over types Round, Block, Key, Nonce, and Counter) correctly encrypts the specified msg with the given key and counter to produce the expected out test vector."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\niround : [64] -> Round -> Round\niround n r =\n  (iterate once r) @ n\n  where\n    once\n      [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n       x15] =\n      [x0,\n      x1,\n      x2,\n      x3,\n      x4,\n      x5,\n      x6,\n      x7,\n      x8,\n      x9,\n      x10,\n      x11,\n      x12 + 1,\n      x13,\n      x14,\n      x15]\nstream : {n} (fin n) => Key -> Counter -> Nonce -> [n][8]\nstream k c n =\n  take`{n} (join rounds)\n  where\n    key = kexp k c n\n    rounds = [core (iround i key) | i <- [0, 1 ...]]\nencrypt : {n}\n  (fin n) =>\n    Key -> Counter -> Nonce -> [n][8] -> [n][8]\nencrypt k c n m = m ^ (stream k c n)\nrfctest03 =\n  encrypt key 42 (zero # [2]) msg == out\n  where\n    key =\n      [0x1c,\n      0x92,\n      0x40,\n      0xa5,\n      0xeb,\n      0x55,\n      0xd3,\n      0x8a,\n      0xf3,\n      0x33,\n      0x88,\n      0x86,\n      0x04,\n      0xf6,\n      0xb5,\n      0xf0,\n      0x47,\n      0x39,\n      0x17,\n      0xc1,\n      0x40,\n      0x2b,\n      0x80,\n      0x09,\n      0x9d,\n      0xca,\n      0x5c,\n      0xbc,\n      0x20,\n      0x70,\n      0x75,\n      0xc0]\n    out =\n      [0x27,\n      0x54,\n      0x77,\n      0x61,\n      0x73,\n      0x20,\n      0x62,\n      0x72,\n      0x69,\n      0x6c,\n      0x6c,\n      0x69,\n      0x67,\n      0x2c,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x73,\n      0x6c,\n      0x69,\n      0x74,\n      0x68,\n      0x79,\n      0x20,\n      0x74,\n      0x6f,\n      0x76,\n      0x65,\n      0x73,\n      0x0a,\n      0x44,\n      0x69,\n      0x64,\n      0x20,\n      0x67,\n      0x79,\n      0x72,\n      0x65,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x67,\n      0x69,\n      0x6d,\n      0x62,\n      0x6c,\n      0x65,\n      0x20,\n      0x69,\n      0x6e,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x77,\n      0x61,\n      0x62,\n      0x65,\n      0x3a,\n      0x0a,\n      0x41,\n      0x6c,\n      0x6c,\n      0x20,\n      0x6d,\n      0x69,\n      0x6d,\n      0x73,\n      0x79,\n      0x20,\n      0x77,\n      0x65,\n      0x72,\n      0x65,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x62,\n      0x6f,\n      0x72,\n      0x6f,\n      0x67,\n      0x6f,\n      0x76,\n      0x65,\n      0x73,\n      0x2c,\n      0x0a,\n      0x41,\n      0x6e,\n      0x64,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x6d,\n      0x6f,\n      0x6d,\n      0x65,\n      0x20,\n      0x72,\n      0x61,\n      0x74,\n      0x68,\n      0x73,\n      0x20,\n      0x6f,\n      0x75,\n      0x74,\n      0x67,\n      0x72,\n      0x61,\n      0x62,\n      0x65,\n      0x2e]\n    msg =\n      [0x62,\n      0xe6,\n      0x34,\n      0x7f,\n      0x95,\n      0xed,\n      0x87,\n      0xa4,\n      0x5f,\n      0xfa,\n      0xe7,\n      0x42,\n      0x6f,\n      0x27,\n      0xa1,\n      0xdf,\n      0x5f,\n      0xb6,\n      0x91,\n      0x10,\n      0x04,\n      0x4c,\n      0x0d,\n      0x73,\n      0x11,\n      0x8e,\n      0xff,\n      0xa9,\n      0x5b,\n      0x01,\n      0xe5,\n      0xcf,\n      0x16,\n      0x6d,\n      0x3d,\n      0xf2,\n      0xd7,\n      0x21,\n      0xca,\n      0xf9,\n      0xb2,\n      0x1e,\n      0x5f,\n      0xb1,\n      0x4c,\n      0x61,\n      0x68,\n      0x71,\n      0xfd,\n      0x84,\n      0xc5,\n      0x4f,\n      0x9d,\n      0x65,\n      0xb2,\n      0x83,\n      0x19,\n      0x6c,\n      0x7f,\n      0xe4,\n      0xf6,\n      0x05,\n      0x53,\n      0xeb,\n      0xf3,\n      0x9c,\n      0x64,\n      0x02,\n      0xc4,\n      0x22,\n      0x34,\n      0xe3,\n      0x2a,\n      0x35,\n      0x6b,\n      0x3e,\n      0x76,\n      0x43,\n      0x12,\n      0xa6,\n      0x1a,\n      0x55,\n      0x32,\n      0x05,\n      0x57,\n      0x16,\n      0xea,\n      0xd6,\n      0x96,\n      0x25,\n      0x68,\n      0xf8,\n      0x7d,\n      0x3f,\n      0x3f,\n      0x77,\n      0x04,\n      0xc6,\n      0xa8,\n      0xd1,\n      0xbc,\n      0xd1,\n      0xbf,\n      0x4d,\n      0x50,\n      0xd6,\n      0x15,\n      0x4b,\n      0x6d,\n      0xa7,\n      0x31,\n      0xb1,\n      0x87,\n      0xb5,\n      0x8d,\n      0xfd,\n      0x72,\n      0x8a,\n      0xfa,\n      0x36,\n      0x75,\n      0x7a,\n      0x79,\n      0x7a,\n      0xc1,\n      0x88,\n      0xd1]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/021_rfctest02.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of the ChaCha20 stream cipher with types Round = [16][32], Block = [64][8], Key = [32][8], Nonce = [12][8], Counter = [32], functions qround, cdround, kexp, iround, core, stream, encrypt, and a property rfctest02 that checks encrypt (zero # [1]) 1 (zero # [2]) msg equals the given RFC test vector out for the provided msg bytes."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\niround : [64] -> Round -> Round\niround n r =\n  (iterate once r) @ n\n  where\n    once\n      [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n       x15] =\n      [x0,\n      x1,\n      x2,\n      x3,\n      x4,\n      x5,\n      x6,\n      x7,\n      x8,\n      x9,\n      x10,\n      x11,\n      x12 + 1,\n      x13,\n      x14,\n      x15]\nstream : {n} (fin n) => Key -> Counter -> Nonce -> [n][8]\nstream k c n =\n  take`{n} (join rounds)\n  where\n    key = kexp k c n\n    rounds = [core (iround i key) | i <- [0, 1 ...]]\nencrypt : {n}\n  (fin n) =>\n    Key -> Counter -> Nonce -> [n][8] -> [n][8]\nencrypt k c n m = m ^ (stream k c n)\nrfctest02 =\n  encrypt (zero # [1]) 1 (zero # [2]) msg == out\n  where\n    out =\n      [0xa3,\n      0xfb,\n      0xf0,\n      0x7d,\n      0xf3,\n      0xfa,\n      0x2f,\n      0xde,\n      0x4f,\n      0x37,\n      0x6c,\n      0xa2,\n      0x3e,\n      0x82,\n      0x73,\n      0x70,\n      0x41,\n      0x60,\n      0x5d,\n      0x9f,\n      0x4f,\n      0x4f,\n      0x57,\n      0xbd,\n      0x8c,\n      0xff,\n      0x2c,\n      0x1d,\n      0x4b,\n      0x79,\n      0x55,\n      0xec,\n      0x2a,\n      0x97,\n      0x94,\n      0x8b,\n      0xd3,\n      0x72,\n      0x29,\n      0x15,\n      0xc8,\n      0xf3,\n      0xd3,\n      0x37,\n      0xf7,\n      0xd3,\n      0x70,\n      0x05,\n      0x0e,\n      0x9e,\n      0x96,\n      0xd6,\n      0x47,\n      0xb7,\n      0xc3,\n      0x9f,\n      0x56,\n      0xe0,\n      0x31,\n      0xca,\n      0x5e,\n      0xb6,\n      0x25,\n      0x0d,\n      0x40,\n      0x42,\n      0xe0,\n      0x27,\n      0x85,\n      0xec,\n      0xec,\n      0xfa,\n      0x4b,\n      0x4b,\n      0xb5,\n      0xe8,\n      0xea,\n      0xd0,\n      0x44,\n      0x0e,\n      0x20,\n      0xb6,\n      0xe8,\n      0xdb,\n      0x09,\n      0xd8,\n      0x81,\n      0xa7,\n      0xc6,\n      0x13,\n      0x2f,\n      0x42,\n      0x0e,\n      0x52,\n      0x79,\n      0x50,\n      0x42,\n      0xbd,\n      0xfa,\n      0x77,\n      0x73,\n      0xd8,\n      0xa9,\n      0x05,\n      0x14,\n      0x47,\n      0xb3,\n      0x29,\n      0x1c,\n      0xe1,\n      0x41,\n      0x1c,\n      0x68,\n      0x04,\n      0x65,\n      0x55,\n      0x2a,\n      0xa6,\n      0xc4,\n      0x05,\n      0xb7,\n      0x76,\n      0x4d,\n      0x5e,\n      0x87,\n      0xbe,\n      0xa8,\n      0x5a,\n      0xd0,\n      0x0f,\n      0x84,\n      0x49,\n      0xed,\n      0x8f,\n      0x72,\n      0xd0,\n      0xd6,\n      0x62,\n      0xab,\n      0x05,\n      0x26,\n      0x91,\n      0xca,\n      0x66,\n      0x42,\n      0x4b,\n      0xc8,\n      0x6d,\n      0x2d,\n      0xf8,\n      0x0e,\n      0xa4,\n      0x1f,\n      0x43,\n      0xab,\n      0xf9,\n      0x37,\n      0xd3,\n      0x25,\n      0x9d,\n      0xc4,\n      0xb2,\n      0xd0,\n      0xdf,\n      0xb4,\n      0x8a,\n      0x6c,\n      0x91,\n      0x39,\n      0xdd,\n      0xd7,\n      0xf7,\n      0x69,\n      0x66,\n      0xe9,\n      0x28,\n      0xe6,\n      0x35,\n      0x55,\n      0x3b,\n      0xa7,\n      0x6c,\n      0x5c,\n      0x87,\n      0x9d,\n      0x7b,\n      0x35,\n      0xd4,\n      0x9e,\n      0xb2,\n      0xe6,\n      0x2b,\n      0x08,\n      0x71,\n      0xcd,\n      0xac,\n      0x63,\n      0x89,\n      0x39,\n      0xe2,\n      0x5e,\n      0x8a,\n      0x1e,\n      0x0e,\n      0xf9,\n      0xd5,\n      0x28,\n      0x0f,\n      0xa8,\n      0xca,\n      0x32,\n      0x8b,\n      0x35,\n      0x1c,\n      0x3c,\n      0x76,\n      0x59,\n      0x89,\n      0xcb,\n      0xcf,\n      0x3d,\n      0xaa,\n      0x8b,\n      0x6c,\n      0xcc,\n      0x3a,\n      0xaf,\n      0x9f,\n      0x39,\n      0x79,\n      0xc9,\n      0x2b,\n      0x37,\n      0x20,\n      0xfc,\n      0x88,\n      0xdc,\n      0x95,\n      0xed,\n      0x84,\n      0xa1,\n      0xbe,\n      0x05,\n      0x9c,\n      0x64,\n      0x99,\n      0xb9,\n      0xfd,\n      0xa2,\n      0x36,\n      0xe7,\n      0xe8,\n      0x18,\n      0xb0,\n      0x4b,\n      0x0b,\n      0xc3,\n      0x9c,\n      0x1e,\n      0x87,\n      0x6b,\n      0x19,\n      0x3b,\n      0xfe,\n      0x55,\n      0x69,\n      0x75,\n      0x3f,\n      0x88,\n      0x12,\n      0x8c,\n      0xc0,\n      0x8a,\n      0xaa,\n      0x9b,\n      0x63,\n      0xd1,\n      0xa1,\n      0x6f,\n      0x80,\n      0xef,\n      0x25,\n      0x54,\n      0xd7,\n      0x18,\n      0x9c,\n      0x41,\n      0x1f,\n      0x58,\n      0x69,\n      0xca,\n      0x52,\n      0xc5,\n      0xb8,\n      0x3f,\n      0xa3,\n      0x6f,\n      0xf2,\n      0x16,\n      0xb9,\n      0xc1,\n      0xd3,\n      0x00,\n      0x62,\n      0xbe,\n      0xbc,\n      0xfd,\n      0x2d,\n      0xc5,\n      0xbc,\n      0xe0,\n      0x91,\n      0x19,\n      0x34,\n      0xfd,\n      0xa7,\n      0x9a,\n      0x86,\n      0xf6,\n      0xe6,\n      0x98,\n      0xce,\n      0xd7,\n      0x59,\n      0xc3,\n      0xff,\n      0x9b,\n      0x64,\n      0x77,\n      0x33,\n      0x8f,\n      0x3d,\n      0xa4,\n      0xf9,\n      0xcd,\n      0x85,\n      0x14,\n      0xea,\n      0x99,\n      0x82,\n      0xcc,\n      0xaf,\n      0xb3,\n      0x41,\n      0xb2,\n      0x38,\n      0x4d,\n      0xd9,\n      0x02,\n      0xf3,\n      0xd1,\n      0xab,\n      0x7a,\n      0xc6,\n      0x1d,\n      0xd2,\n      0x9c,\n      0x6f,\n      0x21,\n      0xba,\n      0x5b,\n      0x86,\n      0x2f,\n      0x37,\n      0x30,\n      0xe3,\n      0x7c,\n      0xfd,\n      0xc4,\n      0xfd,\n      0x80,\n      0x6c,\n      0x22,\n      0xf2,\n      0x21]\n    msg =\n      [0x41,\n      0x6e,\n      0x79,\n      0x20,\n      0x73,\n      0x75,\n      0x62,\n      0x6d,\n      0x69,\n      0x73,\n      0x73,\n      0x69,\n      0x6f,\n      0x6e,\n      0x20,\n      0x74,\n      0x6f,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x69,\n      0x6e,\n      0x74,\n      0x65,\n      0x6e,\n      0x64,\n      0x65,\n      0x64,\n      0x20,\n      0x62,\n      0x79,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x43,\n      0x6f,\n      0x6e,\n      0x74,\n      0x72,\n      0x69,\n      0x62,\n      0x75,\n      0x74,\n      0x6f,\n      0x72,\n      0x20,\n      0x66,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x75,\n      0x62,\n      0x6c,\n      0x69,\n      0x63,\n      0x61,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x61,\n      0x6c,\n      0x6c,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x61,\n      0x72,\n      0x74,\n      0x20,\n      0x6f,\n      0x66,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x49,\n      0x6e,\n      0x74,\n      0x65,\n      0x72,\n      0x6e,\n      0x65,\n      0x74,\n      0x2d,\n      0x44,\n      0x72,\n      0x61,\n      0x66,\n      0x74,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x52,\n      0x46,\n      0x43,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x61,\n      0x6e,\n      0x79,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x20,\n      0x6d,\n      0x61,\n      0x64,\n      0x65,\n      0x20,\n      0x77,\n      0x69,\n      0x74,\n      0x68,\n      0x69,\n      0x6e,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x63,\n      0x6f,\n      0x6e,\n      0x74,\n      0x65,\n      0x78,\n      0x74,\n      0x20,\n      0x6f,\n      0x66,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x61,\n      0x63,\n      0x74,\n      0x69,\n      0x76,\n      0x69,\n      0x74,\n      0x79,\n      0x20,\n      0x69,\n      0x73,\n      0x20,\n      0x63,\n      0x6f,\n      0x6e,\n      0x73,\n      0x69,\n      0x64,\n      0x65,\n      0x72,\n      0x65,\n      0x64,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x22,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x43,\n      0x6f,\n      0x6e,\n      0x74,\n      0x72,\n      0x69,\n      0x62,\n      0x75,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x22,\n      0x2e,\n      0x20,\n      0x53,\n      0x75,\n      0x63,\n      0x68,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x73,\n      0x20,\n      0x69,\n      0x6e,\n      0x63,\n      0x6c,\n      0x75,\n      0x64,\n      0x65,\n      0x20,\n      0x6f,\n      0x72,\n      0x61,\n      0x6c,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x73,\n      0x20,\n      0x69,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x73,\n      0x65,\n      0x73,\n      0x73,\n      0x69,\n      0x6f,\n      0x6e,\n      0x73,\n      0x2c,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x77,\n      0x65,\n      0x6c,\n      0x6c,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x77,\n      0x72,\n      0x69,\n      0x74,\n      0x74,\n      0x65,\n      0x6e,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x65,\n      0x6c,\n      0x65,\n      0x63,\n      0x74,\n      0x72,\n      0x6f,\n      0x6e,\n      0x69,\n      0x63,\n      0x20,\n      0x63,\n      0x6f,\n      0x6d,\n      0x6d,\n      0x75,\n      0x6e,\n      0x69,\n      0x63,\n      0x61,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x73,\n      0x20,\n      0x6d,\n      0x61,\n      0x64,\n      0x65,\n      0x20,\n      0x61,\n      0x74,\n      0x20,\n      0x61,\n      0x6e,\n      0x79,\n      0x20,\n      0x74,\n      0x69,\n      0x6d,\n      0x65,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x6c,\n      0x61,\n      0x63,\n      0x65,\n      0x2c,\n      0x20,\n      0x77,\n      0x68,\n      0x69,\n      0x63,\n      0x68,\n      0x20,\n      0x61,\n      0x72,\n      0x65,\n      0x20,\n      0x61,\n      0x64,\n      0x64,\n      0x72,\n      0x65,\n      0x73,\n      0x73,\n      0x65,\n      0x64,\n      0x20,\n      0x74,\n      0x6f]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/004_mct_ecb_decrypt_128.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type AESTestVector 128 and the function mct_ecb_decrypt_128 : [128] -> [128] -> [100](AESTestVector 128) implementing the AES-128 Monte Carlo Test for ECB decryption using aesDecryptBlock and aes128DecryptSchedule from SuiteB, including generation of 100 test vectors from an initial key and ciphertext as described."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_128 : [128] -> [128] -> [100](AESTestVector 128)\nmct_ecb_decrypt_128 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][128]\n    keys =\n      [initialKey] # [k ^ (xs ! 0) | xs <- take`{99}\n                                    (groupBy`{1000} pts)\n                                   | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES128)\n    schedules = map aes128DecryptSchedule keys\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/014_mct_ecb_decrypt_192.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the function `mct_ecb_decrypt_192 : [192] -> [128] -> [100](AESTestVector 192)` and any required types and helpers so that it models the AES-192 Monte Carlo Test for ECB decryption, producing 100 test vectors of key, plaintext, and ciphertext derived from iterative AES-192 decryption and key schedule updates."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_192 : [192] -> [128] -> [100](AESTestVector 192)\nmct_ecb_decrypt_192 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][192]\n    keys =\n      [initialKey] # [k ^ ((drop`{64}\n        (xs ! 1)) # xs ! 0) | xs <- take`{99} (groupBy`{1000} pts)\n                            | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES192)\n    schedules = map aes192DecryptSchedule keys\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/070_tcId1069.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property tcId1069 that verifies the AES256_KeyWrap padded authenticated-encryption function KWP_AE, instantiated from Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap, maps the 8-bit plaintext 0xe0 under the 256-bit key 0x2644ccf9d7c419a437c954c8141cbb2d60f57de10a5393554a14ccc72229e286 to the ciphertext 0xda510b1d9a10255380655980a3a73536, using a helper predicate check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct and asserting testPassed == check_KWP_AE key pt ct."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1069 : property *\/\ntcId1069 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x2644ccf9d7c419a437c954c8141cbb2d60f57de10a5393554a14ccc72229e286\n    pt = 0xe0\n    ct = 0xda510b1d9a10255380655980a3a73536\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/081_tcId1080.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1080` that checks, for AES-256 Key Wrap with padding in AE mode, that encrypting the plaintext `0x06` under the key `0x3ea9325069ed93a96c331bdd6dd766ec64bbba83a72c69ed75df55043fb0bfd1` with `KWP_AE` produces the expected ciphertext `0x40a9c42012ba38211b800e6e313b6876`, using the helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1080 : property *\/\ntcId1080 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x3ea9325069ed93a96c331bdd6dd766ec64bbba83a72c69ed75df55043fb0bfd1\n    pt = 0x06\n    ct = 0x40a9c42012ba38211b800e6e313b6876\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/058_pi16'.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function `pi16' : [16][64] -> [16][64]` that permutes a 16-word (64-bit each) Threefish state using the index order `[0, 15, 2, 11, 6, 13, 4, 9, 14, 1, 8, 5, 10, 3, 12, 7 : [4]]`, and add a property that this permutation is bijective (has an inverse)."},{"role":"assistant","content":"```cryptol\npi16' : [16][64] -> [16][64]\npi16' xs =\n  xs @@ [0, 15, 2, 11, 6, 13, 4, 9, 14, 1, 8, 5, 10, 3, 12, 7 : [4]]\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/016_range.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias `Dom n = {lo : [n], sz : [n]}` and the functions `interval : {n} (fin n) => [n] -> [n] -> Dom n` and `range : {n} (fin n) => [n] -> [n] -> Dom n` where `interval l s = {lo = l, sz = s}` and `range lo hi = interval lo (hi - lo)`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nrange : {n} (fin n) => [n] -> [n] -> Dom n\nrange lo hi = interval lo (hi - lo)\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/024_top.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias `Dom n = {lo : [n], sz : [n]}`, the function `interval : {n} (fin n) => [n] -> [n] -> Dom n` with `interval l s = {lo = l, sz = s}`, and the constant `top : {n} (fin n) => Dom n` defined as `top = interval 0 (~0)`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\ntop : {n} (fin n) => Dom n\ntop = interval 0 (~0)\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/198_o4.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type `Dom n = {lo : [n], sz : [n]}`, the functions `mem : {n} (fin n) => Dom n -> [n] -> Bit`, `ubounds : {n} (fin n) => Dom n -> ([n], [n])`, `ule : {n} (fin n) => Dom n -> Dom n -> Bit`, the property `correct_ule : {n} (fin n, n >= 1) => Dom n -> Dom n -> [n] -> [n] -> Bit` expressing that `ule a b` implies `x <= y` for all `x` and `y` in the respective domains, and a property instance `o4 = correct_ule` specialized to `n = 16`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nule : {n} (fin n) => Dom n -> Dom n -> Bit\nule a b = (ubounds a).1 <= (ubounds b).0\ncorrect_ule : {n}\n  (fin n, n >= 1) =>\n    Dom n -> Dom n -> [n] -> [n] -> Bit\ncorrect_ule a b x y = ule a b ==> mem a x ==> mem b y ==> x <= y\n\/* pragma o4 : property *\/\no4 = correct_ule`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/249_i08.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type `Dom n = {lo : [n], sz : [n]}`, functions `interval`, `singleton`, `neg`, `singleton_neg` as in the excerpt, and the property `i08` that asserts `singleton_neg` instantiated at width 16 (i.e., `singleton_neg`{16}) holds for all 16-bit inputs, suitable for verification with a solver."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nsingleton : {n} (fin n) => [n] -> Dom n\nsingleton x = interval x 0\nneg : {n} (fin n) => Dom n -> Dom n\nneg a = interval (-(a.lo + a.sz)) a.sz\nsingleton_neg : {n} (fin n) => [n] -> Bit\nsingleton_neg x = neg (singleton x) == singleton (-x)\n\/* pragma i08 : property *\/\ni08 = singleton_neg`{16}\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/035_Salsa20_passes_tests.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property `Salsa20_passes_tests` that checks the given Salsa20 core implementation (using `quarterround`, `rowround`, `columnround`, `doubleround`, `littleendian`, `littleendian_state`, `littleendian_state_inverse`, `Salsa20_rounds`, and `Salsa20 : [32] -> [64][8] -> [64][8]`) satisfies the three specified 20-round test vectors by equating its outputs to the provided 64-byte expected sequences and conjoining the results."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\nrowround : [16][32] -> [16][32]\nrowround\n  [y0, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13, y14,\n   y15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [z0, z1, z2, z3] = quarterround [y0, y1, y2, y3]\n    [z5, z6, z7, z4] = quarterround [y5, y6, y7, y4]\n    [z10, z11, z8, z9] = quarterround [y10, y11, y8, y9]\n    [z15, z12, z13, z14] = quarterround [y15, y12, y13, y14]\ncolumnround : [16][32] -> [16][32]\ncolumnround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [y0,\n  y1,\n  y2,\n  y3,\n  y4,\n  y5,\n  y6,\n  y7,\n  y8,\n  y9,\n  y10,\n  y11,\n  y12,\n  y13,\n  y14,\n  y15]\n  where\n    [y0, y4, y8, y12] = quarterround [x0, x4, x8, x12]\n    [y5, y9, y13, y1] = quarterround [x5, x9, x13, x1]\n    [y10, y14, y2, y6] = quarterround [x10, x14, x2, x6]\n    [y15, y3, y7, y11] = quarterround [x15, x3, x7, x11]\ndoubleround : [16][32] -> [16][32]\ndoubleround xs = rowround (columnround (xs))\nlittleendian : [4][8] -> [32]\nlittleendian b = join (reverse b)\nlittleendian_inverse : {n} (fin n) => [8 * n] -> [n][8]\nlittleendian_inverse b = reverse (split b)\nlittleendian_state : [64][8] -> [16][32]\nlittleendian_state b = [littleendian xi | xi <- split b]\nlittleendian_state_inverse : [16][32] -> [64][8]\nlittleendian_state_inverse w = join (map littleendian_inverse w)\nSalsa20 : [32] -> [64][8] -> [64][8]\nSalsa20 count xs =\n  littleendian_state_inverse (Salsa20_rounds count xw xw)\n  where\n    xw = littleendian_state xs\nSalsa20_rounds : [32] -> [16][32] -> [16][32] -> [16][32]\nSalsa20_rounds count xw xw' =\n  xw + zs @ (count \/ 2)\n  where\n    zs = [xw'] # [doubleround zi | zi <- zs]\n\/* pragma Salsa20_passes_tests : property *\/\nSalsa20_passes_tests =\n  (Salsa20 20\n    [0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0] == [0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0]) \/\\ (Salsa20 20\n    [211,\n    159,\n    13,\n    115,\n    76,\n    55,\n    82,\n    183,\n    3,\n    117,\n    222,\n    37,\n    191,\n    187,\n    234,\n    136,\n    49,\n    237,\n    179,\n    48,\n    1,\n    106,\n    178,\n    219,\n    175,\n    199,\n    166,\n    48,\n    86,\n    16,\n    179,\n    207,\n    31,\n    240,\n    32,\n    63,\n    15,\n    83,\n    93,\n    161,\n    116,\n    147,\n    48,\n    113,\n    238,\n    55,\n    204,\n    36,\n    79,\n    201,\n    235,\n    79,\n    3,\n    81,\n    156,\n    47,\n    203,\n    26,\n    244,\n    243,\n    88,\n    118,\n    104,\n    54] == [109,\n  42,\n  178,\n  168,\n  156,\n  240,\n  248,\n  238,\n  168,\n  196,\n  190,\n  203,\n  26,\n  110,\n  170,\n  154,\n  29,\n  29,\n  150,\n  26,\n  150,\n  30,\n  235,\n  249,\n  190,\n  163,\n  251,\n  48,\n  69,\n  144,\n  51,\n  57,\n  118,\n  40,\n  152,\n  157,\n  180,\n  57,\n  27,\n  94,\n  107,\n  42,\n  236,\n  35,\n  27,\n  111,\n  114,\n  114,\n  219,\n  236,\n  232,\n  135,\n  111,\n  155,\n  110,\n  18,\n  24,\n  232,\n  95,\n  158,\n  179,\n  19,\n  48,\n  202]) \/\\ (Salsa20 20\n    [88,\n    118,\n    104,\n    54,\n    79,\n    201,\n    235,\n    79,\n    3,\n    81,\n    156,\n    47,\n    203,\n    26,\n    244,\n    243,\n    191,\n    187,\n    234,\n    136,\n    211,\n    159,\n    13,\n    115,\n    76,\n    55,\n    82,\n    183,\n    3,\n    117,\n    222,\n    37,\n    86,\n    16,\n    179,\n    207,\n    49,\n    237,\n    179,\n    48,\n    1,\n    106,\n    178,\n    219,\n    175,\n    199,\n    166,\n    48,\n    238,\n    55,\n    204,\n    36,\n    31,\n    240,\n    32,\n    63,\n    15,\n    83,\n    93,\n    161,\n    116,\n    147,\n    48,\n    113] == [179,\n  19,\n  48,\n  202,\n  219,\n  236,\n  232,\n  135,\n  111,\n  155,\n  110,\n  18,\n  24,\n  232,\n  95,\n  158,\n  26,\n  110,\n  170,\n  154,\n  109,\n  42,\n  178,\n  168,\n  156,\n  240,\n  248,\n  238,\n  168,\n  196,\n  190,\n  203,\n  69,\n  144,\n  51,\n  57,\n  29,\n  29,\n  150,\n  26,\n  150,\n  30,\n  235,\n  249,\n  190,\n  163,\n  251,\n  48,\n  27,\n  111,\n  114,\n  114,\n  118,\n  40,\n  152,\n  157,\n  180,\n  57,\n  27,\n  94,\n  107,\n  42,\n  236,\n  35])\n```"}]}
