{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/008_KS.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the AES-128 key schedule module that uses Nk = 4, Nb = 4, Nr = 10 and the types State = [4][Nb * 8], RoundKey = State, and KS = (RoundKey, [Nr - 1]RoundKey, RoundKey), and implement a function that takes a 128-bit key and returns the corresponding KS value of all round keys."},{"role":"assistant","content":"```cryptol\ntype Nk = 4\ntype Nb = 4\ntype Nr = 6 + Nk\ntype State = [4][Nb * 8]\ntype RoundKey = State\ntype KS = (RoundKey, [Nr - 1]RoundKey, RoundKey)\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/019_roundConstants.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias GF28, the functions gf28Mult : [8] -> [8] -> [8] and gf28Pow : [8] -> [8] -> [8] using polynomial multiplication modulo x^^8 + x^^4 + x^^3 + x + 1, and the sequence roundConstants : [16][8] where roundConstants = take`{16} ([0] # [gf28Pow 2 (k - 1) | k <- [1 ...]])."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Pow : GF28 -> [8] -> GF28\ngf28Pow n k =\n  if k == 0\n  then 1\n  else (if (k && 1) == 1 then gf28Mult n w else w\n        where\n          v = gf28Pow n (k >> 1)\n          w = gf28Mult v v)\nroundConstants =\n  take`{16} ([0] # [gf28Pow 2 (k - 1) | k <- [1 ...]])\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/030_mE.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the AES-128 Rijndael finite-field multiplication by 0x0e over GF(2^8) (with modulus x^8 + x^4 + x^3 + x + 1) and the corresponding 256-entry lookup table `mETable`, and provide the function `mE : [8] -> [8]` that indexes into this table."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\nmETable = [gf28Mult 0x0e i | i <- [0 .. 255]]\nmE i = mETable @ i\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/031_mB.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the finite field type GF28 over the AES polynomial x^8 + x^4 + x^3 + x + 1, implement the multiplication function gf28Mult : [8] -> [8] -> [8], and define the constant mBTable and lookup function mB : [8] -> [8] that returns the precomputed table entry for multiplication by 0x0b in GF(2^8)."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\nmBTable = [gf28Mult 0x0b i | i <- [0 .. 255]]\nmB i = mBTable @ i\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/034_tables.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the AES-GCM-SIV AES-128 finite-field multiplication in GF(2^8) by the polynomial x^8 + x^4 + x^3 + x + 1, generates the precomputed multiplication tables for constants 0x0e, 0x0b, 0x0d, and 0x09 over all 8-bit values, and exposes the lookup functions mE, mB, mD, m9 and the 4\u00d74 table matrix `tables` as the primary external-facing definitions."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\nmETable = [gf28Mult 0x0e i | i <- [0 .. 255]]\nmBTable = [gf28Mult 0x0b i | i <- [0 .. 255]]\nmDTable = [gf28Mult 0x0d i | i <- [0 .. 255]]\nm9Table = [gf28Mult 0x09 i | i <- [0 .. 255]]\nmE i = mETable @ i\nmB i = mBTable @ i\nmD i = mDTable @ i\nm9 i = m9Table @ i\ntables =\n  [[mE, mB, mD, m9],\n  [m9, mE, mB, mD],\n  [mD, m9, mE, mB],\n  [mB, mD, m9, mE]]\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/035_invMixColumns.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the AES-128 inverse MixColumns transformation over GF(2^8) using precomputed multiplication tables (for 0x0e, 0x0b, 0x0d, 0x09), including the types GF28, State, the helper functions gf28Mult, toBytes, fromBytes, and a function invMixColumns : State -> State matching the standard AES inverse MixColumns step."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ntype Nb = 4\ntype State = [4][Nb * 8]\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\ntoBytes : [32] -> [4]GF28\ntoBytes x = split`{4} x\nfromBytes : [4]GF28 -> [32]\nfromBytes xs = join xs\nmETable = [gf28Mult 0x0e i | i <- [0 .. 255]]\nmBTable = [gf28Mult 0x0b i | i <- [0 .. 255]]\nmDTable = [gf28Mult 0x0d i | i <- [0 .. 255]]\nm9Table = [gf28Mult 0x09 i | i <- [0 .. 255]]\nmE i = mETable @ i\nmB i = mBTable @ i\nmD i = mDTable @ i\nm9 i = m9Table @ i\ntables =\n  [[mE, mB, mD, m9],\n  [m9, mE, mB, mD],\n  [mD, m9, mE, mB],\n  [mB, mD, m9, mE]]\ninvMixColumns : State -> State\ninvMixColumns state =\n  [fromBytes ce | ce <- transpose\n                 (mmult [toBytes se | se <- state])]\n  where\n    dollar f x = f x\n    dot f fs = foldr1 (^) (zipWith dollar f fs)\n    mmult n = [[(dot r) ne | ne <- n] | r <- tables]\nfoldr : {a, b, n} (fin n) => (a -> b -> b) -> b -> [n]a -> b\nfoldr f acc xs =\n  ys ! 0\n  where\n    ys = [acc] # [f x a | a <- ys | x <- reverse xs]\nfoldr1 : {a, b} (fin b) => (a -> a -> a) -> [1 + b]a -> a\nfoldr1 f xs = foldr f (xs @ 0) (tail xs)\nzipWith : {a, b, c, n} (a -> b -> c) -> [n]a -> [n]b -> [n]c\nzipWith f xs ys = [f x y | x <- xs | y <- ys]\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/041_doRounds.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function `doRounds` and supporting types and functions (`Nb`, `State`, `RoundKey`, `addRoundKey`) as given, where `doRounds` iteratively applies a round function `rnd` over an initial key, a sequence of round keys, and a final key, and verify with a `property` that for any choice of `rnd`, initial key, round keys, final key, and input state, `doRounds` produces the same final state as computing the initial AddRoundKey followed by the same sequence of `rnd` applications unrolled explicitly."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype State = [4][Nb * 8]\ntype RoundKey = State\naddRoundKey : RoundKey -> State -> State\naddRoundKey k s = k ^ s\ndoRounds : {a, b}\n  (fin b) =>\n    (Bit -> State -> a -> State) ->\n    (RoundKey, [b]a, a) -> State -> State\ndoRounds rnd (ikey, rkeys, fkey) sIn =\n  rnd True (rs ! 0) fkey\n  where\n    s0 = addRoundKey ikey sIn\n    rs = [s0] # [rnd False s k | s <- rs | k <- rkeys]\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/049_aesRound.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property that proves the aesRound function specified here (including GF28 arithmetic, S-box, T-tables t0\u2013t3, and addRoundKey) is extensionally equivalent to the standard AES-128 round transformation (including correct handling of the final-round flag) on 128-bit states and round keys."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ntype Nb = 4\ntype State = [4][Nb * 8]\ntype RoundKey = State\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\ntoBytes : [32] -> [4]GF28\ntoBytes x = split`{4} x\nfromBytes : [4]GF28 -> [32]\nfromBytes xs = join xs\nrotR : [4]GF28 -> [2] -> [4]GF28\nrotR xs n = xs >>> n\nsbox =\n  [0x63,\n  0x7c,\n  0x77,\n  0x7b,\n  0xf2,\n  0x6b,\n  0x6f,\n  0xc5,\n  0x30,\n  0x01,\n  0x67,\n  0x2b,\n  0xfe,\n  0xd7,\n  0xab,\n  0x76,\n  0xca,\n  0x82,\n  0xc9,\n  0x7d,\n  0xfa,\n  0x59,\n  0x47,\n  0xf0,\n  0xad,\n  0xd4,\n  0xa2,\n  0xaf,\n  0x9c,\n  0xa4,\n  0x72,\n  0xc0,\n  0xb7,\n  0xfd,\n  0x93,\n  0x26,\n  0x36,\n  0x3f,\n  0xf7,\n  0xcc,\n  0x34,\n  0xa5,\n  0xe5,\n  0xf1,\n  0x71,\n  0xd8,\n  0x31,\n  0x15,\n  0x04,\n  0xc7,\n  0x23,\n  0xc3,\n  0x18,\n  0x96,\n  0x05,\n  0x9a,\n  0x07,\n  0x12,\n  0x80,\n  0xe2,\n  0xeb,\n  0x27,\n  0xb2,\n  0x75,\n  0x09,\n  0x83,\n  0x2c,\n  0x1a,\n  0x1b,\n  0x6e,\n  0x5a,\n  0xa0,\n  0x52,\n  0x3b,\n  0xd6,\n  0xb3,\n  0x29,\n  0xe3,\n  0x2f,\n  0x84,\n  0x53,\n  0xd1,\n  0x00,\n  0xed,\n  0x20,\n  0xfc,\n  0xb1,\n  0x5b,\n  0x6a,\n  0xcb,\n  0xbe,\n  0x39,\n  0x4a,\n  0x4c,\n  0x58,\n  0xcf,\n  0xd0,\n  0xef,\n  0xaa,\n  0xfb,\n  0x43,\n  0x4d,\n  0x33,\n  0x85,\n  0x45,\n  0xf9,\n  0x02,\n  0x7f,\n  0x50,\n  0x3c,\n  0x9f,\n  0xa8,\n  0x51,\n  0xa3,\n  0x40,\n  0x8f,\n  0x92,\n  0x9d,\n  0x38,\n  0xf5,\n  0xbc,\n  0xb6,\n  0xda,\n  0x21,\n  0x10,\n  0xff,\n  0xf3,\n  0xd2,\n  0xcd,\n  0x0c,\n  0x13,\n  0xec,\n  0x5f,\n  0x97,\n  0x44,\n  0x17,\n  0xc4,\n  0xa7,\n  0x7e,\n  0x3d,\n  0x64,\n  0x5d,\n  0x19,\n  0x73,\n  0x60,\n  0x81,\n  0x4f,\n  0xdc,\n  0x22,\n  0x2a,\n  0x90,\n  0x88,\n  0x46,\n  0xee,\n  0xb8,\n  0x14,\n  0xde,\n  0x5e,\n  0x0b,\n  0xdb,\n  0xe0,\n  0x32,\n  0x3a,\n  0x0a,\n  0x49,\n  0x06,\n  0x24,\n  0x5c,\n  0xc2,\n  0xd3,\n  0xac,\n  0x62,\n  0x91,\n  0x95,\n  0xe4,\n  0x79,\n  0xe7,\n  0xc8,\n  0x37,\n  0x6d,\n  0x8d,\n  0xd5,\n  0x4e,\n  0xa9,\n  0x6c,\n  0x56,\n  0xf4,\n  0xea,\n  0x65,\n  0x7a,\n  0xae,\n  0x08,\n  0xba,\n  0x78,\n  0x25,\n  0x2e,\n  0x1c,\n  0xa6,\n  0xb4,\n  0xc6,\n  0xe8,\n  0xdd,\n  0x74,\n  0x1f,\n  0x4b,\n  0xbd,\n  0x8b,\n  0x8a,\n  0x70,\n  0x3e,\n  0xb5,\n  0x66,\n  0x48,\n  0x03,\n  0xf6,\n  0x0e,\n  0x61,\n  0x35,\n  0x57,\n  0xb9,\n  0x86,\n  0xc1,\n  0x1d,\n  0x9e,\n  0xe1,\n  0xf8,\n  0x98,\n  0x11,\n  0x69,\n  0xd9,\n  0x8e,\n  0x94,\n  0x9b,\n  0x1e,\n  0x87,\n  0xe9,\n  0xce,\n  0x55,\n  0x28,\n  0xdf,\n  0x8c,\n  0xa1,\n  0x89,\n  0x0d,\n  0xbf,\n  0xe6,\n  0x42,\n  0x68,\n  0x41,\n  0x99,\n  0x2d,\n  0x0f,\n  0xb0,\n  0x54,\n  0xbb,\n  0x16]\naddRoundKey : RoundKey -> State -> State\naddRoundKey k s = k ^ s\nt0Func : GF28 -> [4]GF28\nt0Func a = [gf28Mult s 2, s, s, gf28Mult s 3] where s = sbox @ a\nt0 = [fromBytes (t0Func a) | a <- [0 .. 255]]\nt1 = [fromBytes (rotR (t0Func a) 1) | a <- [0 .. 255]]\nt2 = [fromBytes (rotR (t0Func a) 2) | a <- [0 .. 255]]\nt3 = [fromBytes (rotR (t0Func a) 3) | a <- [0 .. 255]]\naesRound : Bit -> State -> RoundKey -> State\naesRound isFinal s key =\n  addRoundKey d key\n  where\n    d = [f isFinal i | i <- [0 .. 3]]\n    a = [toBytes se | se <- s]\n    f b j =\n      if b\n      then fromBytes\n        [sbox @ (a @ ((j + 0) % 4) @ 0),\n        sbox @ (a @ ((j + 1) % 4) @ 1),\n        sbox @ (a @ ((j + 2) % 4) @ 2),\n        sbox @ (a @ ((j + 3) % 4) @ 3)]\n      else e0 ^ e1 ^ e2 ^ e3\n      where\n        e0 = t0 @ (a @ ((j + 0) % 4) @ 0)\n        e1 = t1 @ (a @ ((j + 1) % 4) @ 1)\n        e2 = t2 @ (a @ ((j + 2) % 4) @ 2)\n        e3 = t3 @ (a @ ((j + 3) % 4) @ 3)\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/061_t128EncTest.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property t128EncTest : property that checks your AES-128 T-Box based aesEncrypt function encrypts the 128-bit plaintext [0x00112233, 0x44556677, 0x8899aabb, 0xccddeeff] with the 128-bit key [0x00010203, 0x04050607, 0x08090a0b, 0x0c0d0e0f] to the 128-bit ciphertext [0x69c4e0d8, 0x6a7b0430, 0xd8cdb780, 0x70b4c55a]."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ntype Nk = 4\ntype Nb = 4\ntype Nr = 6 + Nk\ntype State = [4][Nb * 8]\ntype Key = [Nk][Nb * 8]\ntype RoundKey = State\ntype KS = (RoundKey, [Nr - 1]RoundKey, RoundKey)\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Pow : GF28 -> [8] -> GF28\ngf28Pow n k =\n  if k == 0\n  then 1\n  else (if (k && 1) == 1 then gf28Mult n w else w\n        where\n          v = gf28Pow n (k >> 1)\n          w = gf28Mult v v)\ntoBytes : [32] -> [4]GF28\ntoBytes x = split`{4} x\nfromBytes : [4]GF28 -> [32]\nfromBytes xs = join xs\nrotR : [4]GF28 -> [2] -> [4]GF28\nrotR xs n = xs >>> n\nroundConstants =\n  take`{16} ([0] # [gf28Pow 2 (k - 1) | k <- [1 ...]])\nsbox =\n  [0x63,\n  0x7c,\n  0x77,\n  0x7b,\n  0xf2,\n  0x6b,\n  0x6f,\n  0xc5,\n  0x30,\n  0x01,\n  0x67,\n  0x2b,\n  0xfe,\n  0xd7,\n  0xab,\n  0x76,\n  0xca,\n  0x82,\n  0xc9,\n  0x7d,\n  0xfa,\n  0x59,\n  0x47,\n  0xf0,\n  0xad,\n  0xd4,\n  0xa2,\n  0xaf,\n  0x9c,\n  0xa4,\n  0x72,\n  0xc0,\n  0xb7,\n  0xfd,\n  0x93,\n  0x26,\n  0x36,\n  0x3f,\n  0xf7,\n  0xcc,\n  0x34,\n  0xa5,\n  0xe5,\n  0xf1,\n  0x71,\n  0xd8,\n  0x31,\n  0x15,\n  0x04,\n  0xc7,\n  0x23,\n  0xc3,\n  0x18,\n  0x96,\n  0x05,\n  0x9a,\n  0x07,\n  0x12,\n  0x80,\n  0xe2,\n  0xeb,\n  0x27,\n  0xb2,\n  0x75,\n  0x09,\n  0x83,\n  0x2c,\n  0x1a,\n  0x1b,\n  0x6e,\n  0x5a,\n  0xa0,\n  0x52,\n  0x3b,\n  0xd6,\n  0xb3,\n  0x29,\n  0xe3,\n  0x2f,\n  0x84,\n  0x53,\n  0xd1,\n  0x00,\n  0xed,\n  0x20,\n  0xfc,\n  0xb1,\n  0x5b,\n  0x6a,\n  0xcb,\n  0xbe,\n  0x39,\n  0x4a,\n  0x4c,\n  0x58,\n  0xcf,\n  0xd0,\n  0xef,\n  0xaa,\n  0xfb,\n  0x43,\n  0x4d,\n  0x33,\n  0x85,\n  0x45,\n  0xf9,\n  0x02,\n  0x7f,\n  0x50,\n  0x3c,\n  0x9f,\n  0xa8,\n  0x51,\n  0xa3,\n  0x40,\n  0x8f,\n  0x92,\n  0x9d,\n  0x38,\n  0xf5,\n  0xbc,\n  0xb6,\n  0xda,\n  0x21,\n  0x10,\n  0xff,\n  0xf3,\n  0xd2,\n  0xcd,\n  0x0c,\n  0x13,\n  0xec,\n  0x5f,\n  0x97,\n  0x44,\n  0x17,\n  0xc4,\n  0xa7,\n  0x7e,\n  0x3d,\n  0x64,\n  0x5d,\n  0x19,\n  0x73,\n  0x60,\n  0x81,\n  0x4f,\n  0xdc,\n  0x22,\n  0x2a,\n  0x90,\n  0x88,\n  0x46,\n  0xee,\n  0xb8,\n  0x14,\n  0xde,\n  0x5e,\n  0x0b,\n  0xdb,\n  0xe0,\n  0x32,\n  0x3a,\n  0x0a,\n  0x49,\n  0x06,\n  0x24,\n  0x5c,\n  0xc2,\n  0xd3,\n  0xac,\n  0x62,\n  0x91,\n  0x95,\n  0xe4,\n  0x79,\n  0xe7,\n  0xc8,\n  0x37,\n  0x6d,\n  0x8d,\n  0xd5,\n  0x4e,\n  0xa9,\n  0x6c,\n  0x56,\n  0xf4,\n  0xea,\n  0x65,\n  0x7a,\n  0xae,\n  0x08,\n  0xba,\n  0x78,\n  0x25,\n  0x2e,\n  0x1c,\n  0xa6,\n  0xb4,\n  0xc6,\n  0xe8,\n  0xdd,\n  0x74,\n  0x1f,\n  0x4b,\n  0xbd,\n  0x8b,\n  0x8a,\n  0x70,\n  0x3e,\n  0xb5,\n  0x66,\n  0x48,\n  0x03,\n  0xf6,\n  0x0e,\n  0x61,\n  0x35,\n  0x57,\n  0xb9,\n  0x86,\n  0xc1,\n  0x1d,\n  0x9e,\n  0xe1,\n  0xf8,\n  0x98,\n  0x11,\n  0x69,\n  0xd9,\n  0x8e,\n  0x94,\n  0x9b,\n  0x1e,\n  0x87,\n  0xe9,\n  0xce,\n  0x55,\n  0x28,\n  0xdf,\n  0x8c,\n  0xa1,\n  0x89,\n  0x0d,\n  0xbf,\n  0xe6,\n  0x42,\n  0x68,\n  0x41,\n  0x99,\n  0x2d,\n  0x0f,\n  0xb0,\n  0x54,\n  0xbb,\n  0x16]\naddRoundKey : RoundKey -> State -> State\naddRoundKey k s = k ^ s\nkeyExpansion : Key -> [inf]RoundKey\nkeyExpansion key =\n  chop4 keys\n  where\n    keys =\n      key # [nextWord i prev old | i <- [`Nk ...]\n                                 | prev <- drop`{Nk - 1} keys\n                                 | old <- keys]\n    chop4 : {a} [inf]a -> [inf][4]a\n    chop4 xs = split xs\n    subWordRcon : [Nb * 8] -> GF28 -> [Nb * 8]\n    subWordRcon w rc =\n      fromBytes [a ^ rc, b, c, d]\n      where\n        [a, b, c, d] = [sbox @ i | i <- toBytes w]\n    nextWord : [8] -> [Nb * 8] -> [Nb * 8] -> [Nb * 8]\n    nextWord i prev old =\n      old ^ (if (i % `Nk) == 0\n      then subWordRcon (join (split`{4} prev <<< 1))\n        (roundConstants @ (i \/ `Nk))\n      else if (i % `Nk) == 4 \/\\ `Nk > 6\n      then subWordRcon prev 0\n      else prev)\naesEncryptKeySchedule : Key -> KS\naesEncryptKeySchedule key =\n  (rKeys @ 0, m, rKeys @ `Nr)\n  where\n    rKeys = keyExpansion key\n    m = take`{Nr - 1} (tail rKeys)\ndoRounds : {a, b}\n  (fin b) =>\n    (Bit -> State -> a -> State) ->\n    (RoundKey, [b]a, a) -> State -> State\ndoRounds rnd (ikey, rkeys, fkey) sIn =\n  rnd True (rs ! 0) fkey\n  where\n    s0 = addRoundKey ikey sIn\n    rs = [s0] # [rnd False s k | s <- rs | k <- rkeys]\nt0Func : GF28 -> [4]GF28\nt0Func a = [gf28Mult s 2, s, s, gf28Mult s 3] where s = sbox @ a\nt0 = [fromBytes (t0Func a) | a <- [0 .. 255]]\nt1 = [fromBytes (rotR (t0Func a) 1) | a <- [0 .. 255]]\nt2 = [fromBytes (rotR (t0Func a) 2) | a <- [0 .. 255]]\nt3 = [fromBytes (rotR (t0Func a) 3) | a <- [0 .. 255]]\naesRound : Bit -> State -> RoundKey -> State\naesRound isFinal s key =\n  addRoundKey d key\n  where\n    d = [f isFinal i | i <- [0 .. 3]]\n    a = [toBytes se | se <- s]\n    f b j =\n      if b\n      then fromBytes\n        [sbox @ (a @ ((j + 0) % 4) @ 0),\n        sbox @ (a @ ((j + 1) % 4) @ 1),\n        sbox @ (a @ ((j + 2) % 4) @ 2),\n        sbox @ (a @ ((j + 3) % 4) @ 3)]\n      else e0 ^ e1 ^ e2 ^ e3\n      where\n        e0 = t0 @ (a @ ((j + 0) % 4) @ 0)\n        e1 = t1 @ (a @ ((j + 1) % 4) @ 1)\n        e2 = t2 @ (a @ ((j + 2) % 4) @ 2)\n        e3 = t3 @ (a @ ((j + 3) % 4) @ 3)\naesEncrypt pt key =\n  doRounds aesRound (aesEncryptKeySchedule key) pt\n\/* pragma t128EncTest : property *\/\nt128EncTest =\n  aesEncrypt pt k == [0x69c4e0d8,\n  0x6a7b0430,\n  0xd8cdb780,\n  0x70b4c55a]\n  where\n    pt = [0x00112233, 0x44556677, 0x8899aabb, 0xccddeeff]\n    k = [0x00010203, 0x04050607, 0x08090a0b, 0x0c0d0e0f]\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/063_AESTests.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that implements AES-128 encryption and decryption using T-boxes (with GF(2^8) arithmetic, S-box\/InvS-box tables, key expansion, round functions, and key schedules) and define properties t128EncTest, t128DecTest, and AESTests that check the standard AES-128 NIST test vector for both encryption and decryption."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ntype Nk = 4\ntype Nb = 4\ntype Nr = 6 + Nk\ntype State = [4][Nb * 8]\ntype Key = [Nk][Nb * 8]\ntype RoundKey = State\ntype KS = (RoundKey, [Nr - 1]RoundKey, RoundKey)\ngf28Mult : GF28 -> GF28 -> GF28\ngf28Mult x y = pmod (pmult x y) <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Pow : GF28 -> [8] -> GF28\ngf28Pow n k =\n  if k == 0\n  then 1\n  else (if (k && 1) == 1 then gf28Mult n w else w\n        where\n          v = gf28Pow n (k >> 1)\n          w = gf28Mult v v)\ntoBytes : [32] -> [4]GF28\ntoBytes x = split`{4} x\nfromBytes : [4]GF28 -> [32]\nfromBytes xs = join xs\nrotR : [4]GF28 -> [2] -> [4]GF28\nrotR xs n = xs >>> n\nroundConstants =\n  take`{16} ([0] # [gf28Pow 2 (k - 1) | k <- [1 ...]])\nsbox =\n  [0x63,\n  0x7c,\n  0x77,\n  0x7b,\n  0xf2,\n  0x6b,\n  0x6f,\n  0xc5,\n  0x30,\n  0x01,\n  0x67,\n  0x2b,\n  0xfe,\n  0xd7,\n  0xab,\n  0x76,\n  0xca,\n  0x82,\n  0xc9,\n  0x7d,\n  0xfa,\n  0x59,\n  0x47,\n  0xf0,\n  0xad,\n  0xd4,\n  0xa2,\n  0xaf,\n  0x9c,\n  0xa4,\n  0x72,\n  0xc0,\n  0xb7,\n  0xfd,\n  0x93,\n  0x26,\n  0x36,\n  0x3f,\n  0xf7,\n  0xcc,\n  0x34,\n  0xa5,\n  0xe5,\n  0xf1,\n  0x71,\n  0xd8,\n  0x31,\n  0x15,\n  0x04,\n  0xc7,\n  0x23,\n  0xc3,\n  0x18,\n  0x96,\n  0x05,\n  0x9a,\n  0x07,\n  0x12,\n  0x80,\n  0xe2,\n  0xeb,\n  0x27,\n  0xb2,\n  0x75,\n  0x09,\n  0x83,\n  0x2c,\n  0x1a,\n  0x1b,\n  0x6e,\n  0x5a,\n  0xa0,\n  0x52,\n  0x3b,\n  0xd6,\n  0xb3,\n  0x29,\n  0xe3,\n  0x2f,\n  0x84,\n  0x53,\n  0xd1,\n  0x00,\n  0xed,\n  0x20,\n  0xfc,\n  0xb1,\n  0x5b,\n  0x6a,\n  0xcb,\n  0xbe,\n  0x39,\n  0x4a,\n  0x4c,\n  0x58,\n  0xcf,\n  0xd0,\n  0xef,\n  0xaa,\n  0xfb,\n  0x43,\n  0x4d,\n  0x33,\n  0x85,\n  0x45,\n  0xf9,\n  0x02,\n  0x7f,\n  0x50,\n  0x3c,\n  0x9f,\n  0xa8,\n  0x51,\n  0xa3,\n  0x40,\n  0x8f,\n  0x92,\n  0x9d,\n  0x38,\n  0xf5,\n  0xbc,\n  0xb6,\n  0xda,\n  0x21,\n  0x10,\n  0xff,\n  0xf3,\n  0xd2,\n  0xcd,\n  0x0c,\n  0x13,\n  0xec,\n  0x5f,\n  0x97,\n  0x44,\n  0x17,\n  0xc4,\n  0xa7,\n  0x7e,\n  0x3d,\n  0x64,\n  0x5d,\n  0x19,\n  0x73,\n  0x60,\n  0x81,\n  0x4f,\n  0xdc,\n  0x22,\n  0x2a,\n  0x90,\n  0x88,\n  0x46,\n  0xee,\n  0xb8,\n  0x14,\n  0xde,\n  0x5e,\n  0x0b,\n  0xdb,\n  0xe0,\n  0x32,\n  0x3a,\n  0x0a,\n  0x49,\n  0x06,\n  0x24,\n  0x5c,\n  0xc2,\n  0xd3,\n  0xac,\n  0x62,\n  0x91,\n  0x95,\n  0xe4,\n  0x79,\n  0xe7,\n  0xc8,\n  0x37,\n  0x6d,\n  0x8d,\n  0xd5,\n  0x4e,\n  0xa9,\n  0x6c,\n  0x56,\n  0xf4,\n  0xea,\n  0x65,\n  0x7a,\n  0xae,\n  0x08,\n  0xba,\n  0x78,\n  0x25,\n  0x2e,\n  0x1c,\n  0xa6,\n  0xb4,\n  0xc6,\n  0xe8,\n  0xdd,\n  0x74,\n  0x1f,\n  0x4b,\n  0xbd,\n  0x8b,\n  0x8a,\n  0x70,\n  0x3e,\n  0xb5,\n  0x66,\n  0x48,\n  0x03,\n  0xf6,\n  0x0e,\n  0x61,\n  0x35,\n  0x57,\n  0xb9,\n  0x86,\n  0xc1,\n  0x1d,\n  0x9e,\n  0xe1,\n  0xf8,\n  0x98,\n  0x11,\n  0x69,\n  0xd9,\n  0x8e,\n  0x94,\n  0x9b,\n  0x1e,\n  0x87,\n  0xe9,\n  0xce,\n  0x55,\n  0x28,\n  0xdf,\n  0x8c,\n  0xa1,\n  0x89,\n  0x0d,\n  0xbf,\n  0xe6,\n  0x42,\n  0x68,\n  0x41,\n  0x99,\n  0x2d,\n  0x0f,\n  0xb0,\n  0x54,\n  0xbb,\n  0x16]\nunsbox =\n  [unsboxf i sboxit 0 0 | i <- [0 .. 255]]\n  where\n    sboxit = [(j, i) | i <- [0 .. 255] | j <- sbox]\n    unsboxf n t i d =\n      if i >= (length t)\n      then d\n      else (if (k == n) then v else unsboxf n t (i + 1) d\n            where\n              (k, v) = t @ i)\naddRoundKey : RoundKey -> State -> State\naddRoundKey k s = k ^ s\nkeyExpansion : Key -> [inf]RoundKey\nkeyExpansion key =\n  chop4 keys\n  where\n    keys =\n      key # [nextWord i prev old | i <- [`Nk ...]\n                                 | prev <- drop`{Nk - 1} keys\n                                 | old <- keys]\n    chop4 : {a} [inf]a -> [inf][4]a\n    chop4 xs = split xs\n    subWordRcon : [Nb * 8] -> GF28 -> [Nb * 8]\n    subWordRcon w rc =\n      fromBytes [a ^ rc, b, c, d]\n      where\n        [a, b, c, d] = [sbox @ i | i <- toBytes w]\n    nextWord : [8] -> [Nb * 8] -> [Nb * 8] -> [Nb * 8]\n    nextWord i prev old =\n      old ^ (if (i % `Nk) == 0\n      then subWordRcon (join (split`{4} prev <<< 1))\n        (roundConstants @ (i \/ `Nk))\n      else if (i % `Nk) == 4 \/\\ `Nk > 6\n      then subWordRcon prev 0\n      else prev)\nmETable = [gf28Mult 0x0e i | i <- [0 .. 255]]\nmBTable = [gf28Mult 0x0b i | i <- [0 .. 255]]\nmDTable = [gf28Mult 0x0d i | i <- [0 .. 255]]\nm9Table = [gf28Mult 0x09 i | i <- [0 .. 255]]\nmE i = mETable @ i\nmB i = mBTable @ i\nmD i = mDTable @ i\nm9 i = m9Table @ i\ntables =\n  [[mE, mB, mD, m9],\n  [m9, mE, mB, mD],\n  [mD, m9, mE, mB],\n  [mB, mD, m9, mE]]\ninvMixColumns : State -> State\ninvMixColumns state =\n  [fromBytes ce | ce <- transpose\n                 (mmult [toBytes se | se <- state])]\n  where\n    dollar f x = f x\n    dot f fs = foldr1 (^) (zipWith dollar f fs)\n    mmult n = [[(dot r) ne | ne <- n] | r <- tables]\naesEncryptKeySchedule : Key -> KS\naesEncryptKeySchedule key =\n  (rKeys @ 0, m, rKeys @ `Nr)\n  where\n    rKeys = keyExpansion key\n    m = take`{Nr - 1} (tail rKeys)\naesDecryptKeySchedule : Key -> KS\naesDecryptKeySchedule key =\n  (rKeys @ `Nr, m, rKeys @ 0)\n  where\n    rKeys = keyExpansion key\n    m = [invMixColumns k | k <- reverse (take`{Nr - 1} (tail rKeys))]\ndoRounds : {a, b}\n  (fin b) =>\n    (Bit -> State -> a -> State) ->\n    (RoundKey, [b]a, a) -> State -> State\ndoRounds rnd (ikey, rkeys, fkey) sIn =\n  rnd True (rs ! 0) fkey\n  where\n    s0 = addRoundKey ikey sIn\n    rs = [s0] # [rnd False s k | s <- rs | k <- rkeys]\nt0Func : GF28 -> [4]GF28\nt0Func a = [gf28Mult s 2, s, s, gf28Mult s 3] where s = sbox @ a\nt0 = [fromBytes (t0Func a) | a <- [0 .. 255]]\nt1 = [fromBytes (rotR (t0Func a) 1) | a <- [0 .. 255]]\nt2 = [fromBytes (rotR (t0Func a) 2) | a <- [0 .. 255]]\nt3 = [fromBytes (rotR (t0Func a) 3) | a <- [0 .. 255]]\naesRound : Bit -> State -> RoundKey -> State\naesRound isFinal s key =\n  addRoundKey d key\n  where\n    d = [f isFinal i | i <- [0 .. 3]]\n    a = [toBytes se | se <- s]\n    f b j =\n      if b\n      then fromBytes\n        [sbox @ (a @ ((j + 0) % 4) @ 0),\n        sbox @ (a @ ((j + 1) % 4) @ 1),\n        sbox @ (a @ ((j + 2) % 4) @ 2),\n        sbox @ (a @ ((j + 3) % 4) @ 3)]\n      else e0 ^ e1 ^ e2 ^ e3\n      where\n        e0 = t0 @ (a @ ((j + 0) % 4) @ 0)\n        e1 = t1 @ (a @ ((j + 1) % 4) @ 1)\n        e2 = t2 @ (a @ ((j + 2) % 4) @ 2)\n        e3 = t3 @ (a @ ((j + 3) % 4) @ 3)\nu0Func : GF28 -> [4]GF28\nu0Func a =\n  [gf28Mult s 0x0e,\n  gf28Mult s 0x09,\n  gf28Mult s 0x0d,\n  gf28Mult s 0x0b]\n  where\n    s = unsbox @ a\nu0 = [fromBytes (u0Func a) | a <- [0 .. 255]]\nu1 = [fromBytes (rotR (u0Func a) 1) | a <- [0 .. 255]]\nu2 = [fromBytes (rotR (u0Func a) 2) | a <- [0 .. 255]]\nu3 = [fromBytes (rotR (u0Func a) 3) | a <- [0 .. 255]]\naesInvRound : Bit -> State -> RoundKey -> State\naesInvRound isFinal s key =\n  addRoundKey d key\n  where\n    d = [f isFinal i | i <- [0 .. 3]]\n    a = [toBytes se | se <- s]\n    f b j =\n      if b\n      then fromBytes\n        [unsbox @ (a @ ((j + 0) % 4) @ 0),\n        unsbox @ (a @ ((j + 3) % 4) @ 1),\n        unsbox @ (a @ ((j + 2) % 4) @ 2),\n        unsbox @ (a @ ((j + 1) % 4) @ 3)]\n      else e0 ^ e1 ^ e2 ^ e3\n      where\n        e0 = u0 @ (a @ ((j + 0) % 4) @ 0)\n        e1 = u1 @ (a @ ((j + 3) % 4) @ 1)\n        e2 = u2 @ (a @ ((j + 2) % 4) @ 2)\n        e3 = u3 @ (a @ ((j + 1) % 4) @ 3)\naesEncrypt pt key =\n  doRounds aesRound (aesEncryptKeySchedule key) pt\naesDecrypt ct key =\n  doRounds aesInvRound (aesDecryptKeySchedule key) ct\n\/* pragma t128EncTest : property *\/\nt128EncTest =\n  aesEncrypt pt k == [0x69c4e0d8,\n  0x6a7b0430,\n  0xd8cdb780,\n  0x70b4c55a]\n  where\n    pt = [0x00112233, 0x44556677, 0x8899aabb, 0xccddeeff]\n    k = [0x00010203, 0x04050607, 0x08090a0b, 0x0c0d0e0f]\n\/* pragma t128DecTest : property *\/\nt128DecTest =\n  aesDecrypt ct k == [0x00112233,\n  0x44556677,\n  0x8899aabb,\n  0xccddeeff]\n  where\n    ct = [0x69c4e0d8, 0x6a7b0430, 0xd8cdb780, 0x70b4c55a]\n    k = [0x00010203, 0x04050607, 0x08090a0b, 0x0c0d0e0f]\n\/* pragma AESTests : property *\/\nAESTests = t128EncTest && t128DecTest\nfoldr : {a, b, n} (fin n) => (a -> b -> b) -> b -> [n]a -> b\nfoldr f acc xs =\n  ys ! 0\n  where\n    ys = [acc] # [f x a | a <- ys | x <- reverse xs]\nfoldr1 : {a, b} (fin b) => (a -> a -> a) -> [1 + b]a -> a\nfoldr1 f xs = foldr f (xs @ 0) (tail xs)\nzipWith : {a, b, c, n} (a -> b -> c) -> [n]a -> [n]b -> [n]c\nzipWith f xs ys = [f x y | x <- xs | y <- ys]\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/067_foldr.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the higher-order function `foldr : {a, b, n} (fin n) => (a -> b -> b) -> b -> [n]a -> b` in Cryptol using a self-referential sequence comprehension over the reversed input sequence, matching the behavior of the given definition."},{"role":"assistant","content":"```cryptol\nfoldr : {a, b, n} (fin n) => (a -> b -> b) -> b -> [n]a -> b\nfoldr f acc xs =\n  ys ! 0\n  where\n    ys = [acc] # [f x a | a <- ys | x <- reverse xs]\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/069_foldr1.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the functions `foldr` and `foldr1` in Cryptol with the given polymorphic types and list-based implementations, ensuring `foldr1` is expressed in terms of `foldr` using the head element as the initial accumulator and the tail as the remaining list."},{"role":"assistant","content":"```cryptol\nfoldr : {a, b, n} (fin n) => (a -> b -> b) -> b -> [n]a -> b\nfoldr f acc xs =\n  ys ! 0\n  where\n    ys = [acc] # [f x a | a <- ys | x <- reverse xs]\nfoldr1 : {a, b} (fin b) => (a -> a -> a) -> [1 + b]a -> a\nfoldr1 f xs = foldr f (xs @ 0) (tail xs)\n```"}]}
{"filename":"AES-GCM-SIV-proof\/proof\/asm\/deps\/saw-script\/examples\/openssl_aes\/AES128TBox\/071_zipWith.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the polymorphic function `zipWith : {a, b, c, n} (a -> b -> c) -> [n]a -> [n]b -> [n]c` that applies a binary function element-wise to two equally sized sequences using list comprehension, exactly matching this type and behavior."},{"role":"assistant","content":"```cryptol\nzipWith : {a, b, c, n} (a -> b -> c) -> [n]a -> [n]b -> [n]c\nzipWith f xs ys = [f x y | x <- xs | y <- ys]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/015_pad.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `pad : {r, m} (fin r, fin m, r >= 1) => [m] -> [(m + 2) \/^ r][r]` so that for any input bitvector `M` it produces the Keccak 0x01-0x80 style padding by computing `split (M # [True] # zero # [True])`, where `zero` is the appropriately sized block of `False` bits."},{"role":"assistant","content":"```cryptol\npad : {r, m} (fin r, fin m, r >= 1) => [m] -> [(m + 2) \/^ r][r]\npad M = split (M # [True] # zero # [True])\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/019_Round.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that specifies one full Keccak round function Round : {w} (fin w) => [5][5][w] -> [5][5][w] -> [5][5][w] together with its component transformations \u03b8, \u03c1, \u03c0, \u03c7, and \u03b9 and the helper function xor, matching the Keccak permutation step semantics for an arbitrary lane width w."},{"role":"assistant","content":"```cryptol\nRound : {w} (fin w) => [5][5][w] -> [5][5][w] -> [5][5][w]\nRound RC A = \u03b9 RC (\u03c7 (\u03c0 (\u03c1 (\u03b8 A))))\n\u03b8 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03b8 A =\n  A'\n  where\n    C = [xor a | a <- A]\n    D =\n      [C @ x ^ (C @ y <<< 1) | x : [8] <- [4, 0, 1, 2, 3]\n                             | y : [8] <- [1, 2, 3, 4, 0]]\n    A' = [[a ^ (D @ x) | a <- A @ x] | x : [8] <- [0 .. 4]]\n\u03c1 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03c1 A =\n  groupBy`{5} [a <<< r | a <- join A | r : [8] <- R]\n  where\n    R =\n      [0,\n      36,\n      3,\n      41,\n      18,\n      1,\n      44,\n      10,\n      45,\n      2,\n      62,\n      6,\n      43,\n      15,\n      61,\n      28,\n      55,\n      25,\n      21,\n      56,\n      27,\n      20,\n      39,\n      8,\n      14]\n\u03c0 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03c0 A =\n  groupBy`{5}\n    [A @ ((x + 3 * y) % 5) @ x | x : [8] <- [0 .. 4],\n                              y : [8] <- [0 .. 4]]\n\u03c7 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03c7 A =\n  groupBy`{5}\n    [(A @ x @ y) ^ (~A @ ((x + 1) % 5) @ y && A @ ((x + 2) % 5) @ y) | x : [8] <- [0 .. 4],\n                                                                    y : [8] <- [0 .. 4]]\n\u03b9 : {w} (fin w) => [5][5][w] -> [5][5][w] -> [5][5][w]\n\u03b9 RC A = A ^ RC\nxor : {a, b} (fin a) => [a][b] -> [b]\nxor xs =\n  xors ! 0\n  where\n    xors = [zero] # [x ^ z | x <- xs | z <- xors]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/021_\u03b8.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the Keccak-f \u03b8 step mapping over a 5\u00d75 array of w-bit lanes, including the helper function xor : {a, b} (fin a) => [a][b] -> [b] that XOR-reduces an array of lanes, matching the behavior of the provided \u03b8 definition."},{"role":"assistant","content":"```cryptol\n\u03b8 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03b8 A =\n  A'\n  where\n    C = [xor a | a <- A]\n    D =\n      [C @ x ^ (C @ y <<< 1) | x : [8] <- [4, 0, 1, 2, 3]\n                             | y : [8] <- [1, 2, 3, 4, 0]]\n    A' = [[a ^ (D @ x) | a <- A @ x] | x : [8] <- [0 .. 4]]\nxor : {a, b} (fin a) => [a][b] -> [b]\nxor xs =\n  xors ! 0\n  where\n    xors = [zero] # [x ^ z | x <- xs | z <- xors]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/023_\u03c1.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the Keccak \u03c1 step mapping as a function `\u03c1 : {w} (fin w) => [5][5][w] -> [5][5][w]` that cyclically left-rotates each 64-bit lane of the 5\u00d75 state by its specified offset using the constant table of 25 rotation amounts."},{"role":"assistant","content":"```cryptol\n\u03c1 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03c1 A =\n  groupBy`{5} [a <<< r | a <- join A | r : [8] <- R]\n  where\n    R =\n      [0,\n      36,\n      3,\n      41,\n      18,\n      1,\n      44,\n      10,\n      45,\n      2,\n      62,\n      6,\n      43,\n      15,\n      61,\n      28,\n      55,\n      25,\n      21,\n      56,\n      27,\n      20,\n      39,\n      8,\n      14]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/025_\u03c0.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Keccak permutation step function `\u03c0 : {w} (fin w) => [5][5][w] -> [5][5][w]` that permutes the 5\u00d75 state array using the index mapping A[(x + 3 * y) % 5][x] for x,y in [0..4]."},{"role":"assistant","content":"```cryptol\n\u03c0 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03c0 A =\n  groupBy`{5}\n    [A @ ((x + 3 * y) % 5) @ x | x : [8] <- [0 .. 4],\n                              y : [8] <- [0 .. 4]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/027_\u03c7.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Keccak \u03c7 (chi) step mapping function \u03c7 : {w} (fin w) => [5][5][w] -> [5][5][w] that takes a 5\u00d75 state of w-bit lanes and returns the transformed state using the non-linear \u03c7 operation as given by the round function of Keccak\/SHA-3."},{"role":"assistant","content":"```cryptol\n\u03c7 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03c7 A =\n  groupBy`{5}\n    [(A @ x @ y) ^ (~A @ ((x + 1) % 5) @ y && A @ ((x + 2) % 5) @ y) | x : [8] <- [0 .. 4],\n                                                                    y : [8] <- [0 .. 4]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/029_\u03b9.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function \u03b9 : {w} (fin w) => [5][5][w] -> [5][5][w] -> [5][5][w] that applies the Keccak iota step by XORing the 5\u00d75 state array A with the round-constant array RC, matching \u03b9 RC A = A ^ RC."},{"role":"assistant","content":"```cryptol\n\u03b9 : {w} (fin w) => [5][5][w] -> [5][5][w] -> [5][5][w]\n\u03b9 RC A = A ^ RC\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/031_RCs.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the round-constant array `RCs : {w, n} (fin w, fin n, 24 >= n, n == 12 + 2 * (lg2 w)) => [n][5][5][w]` for the Keccak permutation, derived from the 24 64-bit constants `RCs64 : [24][64]` given in the excerpt, and ensure it matches the Keccak specification for all allowed `w` and `n`."},{"role":"assistant","content":"```cryptol\nRCs : {w, n}\n  (fin w, fin n, 24 >= n, n == 12 + 2 * (lg2 w)) =>\n    [n][5][5][w]\nRCs = take`{n} [[[take`{w} RC] # zero] # zero | RC <- RCs64]\nRCs64 : [24][64]\nRCs64 =\n  join\n    (transpose\n      [[0x0000000000000001, 0x000000008000808b],\n      [0x0000000000008082, 0x800000000000008b],\n      [0x800000000000808a, 0x8000000000008089],\n      [0x8000000080008000, 0x8000000000008003],\n      [0x000000000000808b, 0x8000000000008002],\n      [0x0000000080000001, 0x8000000000000080],\n      [0x8000000080008081, 0x000000000000800a],\n      [0x8000000000008009, 0x800000008000000a],\n      [0x000000000000008a, 0x8000000080008081],\n      [0x0000000000000088, 0x8000000000008080],\n      [0x0000000080008009, 0x0000000080000001],\n      [0x000000008000000a, 0x8000000080008008]])\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/035_unflatten.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `unflatten : {r, w} (fin w, 25 * w >= r) => [r] -> [5][5][w]` that takes a bitvector of length `r`, right-pads it with zeros to length `25*w`, splits it into 25 chunks of width `w`, arranges them into a 5\u00d75 matrix with proper ordering using `reverse`, `groupBy`, and `transpose`, matching the behavior of the given specification."},{"role":"assistant","content":"```cryptol\nunflatten : {r, w} (fin w, 25 * w >= r) => [r] -> [5][5][w]\nunflatten p =\n  transpose\n    (groupBy`{5} (reverse (groupBy`{w} (reverse (p # zero)))))\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/037_flatten.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `flatten : {w} (fin w) => [5][5][w] -> [5 * 5 * w]` that converts a 5\u00d75 matrix of `w`-bit words into a flat sequence of `5 * 5 * w` bits using `transpose`, `join`, and `reverse` in the composition `flatten A = reverse (join (reverse (join (transpose A))))`."},{"role":"assistant","content":"```cryptol\nflatten : {w} (fin w) => [5][5][w] -> [5 * 5 * w]\nflatten A = reverse (join (reverse (join (transpose A))))\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/039_xor.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `xor : {a, b} (fin a) => [a][b] -> [b]` in Cryptol so that, given a sequence of `a` vectors of width `b`, it returns the running cumulative XORs using the recursive list-comprehension construction shown, starting from the all-zero value."},{"role":"assistant","content":"```cryptol\nxor : {a, b} (fin a) => [a][b] -> [b]\nxor xs =\n  xors ! 0\n  where\n    xors = [zero] # [x ^ z | x <- xs | z <- xors]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/041_RC_correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the constant `RCs64 : [24][64]` for the Keccak-\u0192[1600] round constants and a property `RC_correct : [8] -> [8] -> Bit` that asserts for all `i < 24` and `j < 7` that `RCs64 @ i ! (2 ^^ j - 1)` equals `lfsr @ (j + 7 * i)`, where `lfsr : [inf]` is generated from an 8-bit LFSR with feedback polynomial x^^8 + x^^6 + x^^5 + x^^4 + 1."},{"role":"assistant","content":"```cryptol\nRCs64 : [24][64]\nRCs64 =\n  join\n    (transpose\n      [[0x0000000000000001, 0x000000008000808b],\n      [0x0000000000008082, 0x800000000000008b],\n      [0x800000000000808a, 0x8000000000008089],\n      [0x8000000080008000, 0x8000000000008003],\n      [0x000000000000808b, 0x8000000000008002],\n      [0x0000000080000001, 0x8000000000000080],\n      [0x8000000080008081, 0x000000000000800a],\n      [0x8000000000008009, 0x800000008000000a],\n      [0x000000000000008a, 0x8000000080008081],\n      [0x0000000000000088, 0x8000000000008080],\n      [0x0000000080008009, 0x0000000080000001],\n      [0x000000008000000a, 0x8000000080008008]])\n\/* pragma RC_correct : property *\/\nRC_correct i j =\n  (i : [8]) < 24 ==> (j : [8]) < 7 ==> RCs64 @ i ! (2 ^^ j - 1) == lfsr @ (j + 7 * i)\nlfsr : [inf]\nlfsr =\n  [p ! 0 | p <- ps]\n  where\n    ps = [0x01] # [pmod (pmult p 0b10) m | p <- ps]\n    m = <| x^^8 + x^^6 + x^^5 + x^^4 + 1 |>\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/042_lfsr.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module that defines the infinite LFSR stream `lfsr : [inf]` generated by repeatedly multiplying by 0b10 modulo the polynomial m = x^^8 + x^^6 + x^^5 + x^^4 + 1 over GF(2), starting from the initial value 0x01, and ensures the sequence elements match this recurrence."},{"role":"assistant","content":"```cryptol\nlfsr : [inf]\nlfsr =\n  [p ! 0 | p <- ps]\n  where\n    ps = [0x01] # [pmod (pmult p 0b10) m | p <- ps]\n    m = <| x^^8 + x^^6 + x^^5 + x^^4 + 1 |>\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/044_unflatten_correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `unflatten_correct` that, for all indices `x`, `y`, `z` and bit vector `p`, proves that accessing `p` at linearized index `((5 * y + x) * 64 + z)` equals accessing the corresponding bit `z` of the element at coordinates `[x][y]` in `unflatten` applied to `p` with type parameters `{1600, 64}`."},{"role":"assistant","content":"```cryptol\nunflatten : {r, w} (fin w, 25 * w >= r) => [r] -> [5][5][w]\nunflatten p =\n  transpose\n    (groupBy`{5} (reverse (groupBy`{w} (reverse (p # zero)))))\n\/* pragma unflatten_correct : property *\/\nunflatten_correct x y z p =\n  x < 5 ==> y < 5 ==> z < (64 : [12]) ==> p @ ((5 * y + x) * 64 + z) == unflatten`{1600,\n    64} p @ x @ y ! z\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/045_flatten_correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property flatten_correct that proves flatten and unflatten are inverses for the Keccak state representation, i.e., for s : [5][5][64], unflatten`{1600,64} (flatten`{64} s) == s, using the given definitions of flatten : {w} (fin w) => [5][5][w] -> [5*5*w] and unflatten : {r,w} (fin w, 25*w >= r) => [r] -> [5][5][w]."},{"role":"assistant","content":"```cryptol\nunflatten : {r, w} (fin w, 25 * w >= r) => [r] -> [5][5][w]\nunflatten p =\n  transpose\n    (groupBy`{5} (reverse (groupBy`{w} (reverse (p # zero)))))\nflatten : {w} (fin w) => [5][5][w] -> [5 * 5 * w]\nflatten A = reverse (join (reverse (join (transpose A))))\n\/* pragma flatten_correct : property *\/\nflatten_correct s = unflatten`{1600, 64} (flatten`{64} s) == s\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/McEliece_KEM\/high-level\/keccak\/061_w1.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the SHA3-224 hash function using the given Keccak sponge construction (with r = 1152, c = 448, padding, absorb, squeeze, and Keccak_f with rounds and round constants), and define a property w1 that asserts hashing the fixed 1600-bit message msg1600 appended with the 5-bit suffix 0b11000 yields the expected 224-bit digest 0x22d2f7bb0b173fd8c19686f9173166e3ee62738047d7eadd69efb228 when converted to bytes via toBytes and join."},{"role":"assistant","content":"```cryptol\nSHA_3_224 M = take`{224} (Keccak`{r = 1152, c = 448} (M # 0b01))\nKeccak : {r, c, m}\n  (fin r, fin c, fin m, r >= 1, (r + c) % 25 == 0,\n   64 >= (r + c) \/ 25) =>\n    [m] -> [inf]\nKeccak M =\n  squeeze`{r = r} (absorb`{w = (r + c) \/ 25} Ps)\n  where\n    Ps = pad`{r = r} M\nsqueeze : {r, w}\n  (fin r, fin w, 64 >= w, r >= 0, 25 * w >= r) =>\n    [5][5][w] -> [inf]\nsqueeze A = take`{r} (flatten A) # squeeze`{r = r} (Keccak_f A)\nabsorb : {r, w, n}\n  (fin r, fin w, fin n, 64 >= w, 25 * w >= r) =>\n    [n][r] -> [5][5][w]\nabsorb Ps =\n  as ! 0\n  where\n    as =\n      [zero] # [Keccak_f`{w = w} (s ^ (unflatten p)) | s <- as\n                                                     | p <- Ps]\npad : {r, m} (fin r, fin m, r >= 1) => [m] -> [(m + 2) \/^ r][r]\npad M = split (M # [True] # zero # [True])\nKeccak_f : {w} (fin w, 64 >= w) => [5][5][w] -> [5][5][w]\nKeccak_f A0 =\n  rounds ! 0\n  where\n    rounds = [A0] # [Round RC A | RC <- RCs`{w = w} | A <- rounds]\nRound : {w} (fin w) => [5][5][w] -> [5][5][w] -> [5][5][w]\nRound RC A = \u03b9 RC (\u03c7 (\u03c0 (\u03c1 (\u03b8 A))))\n\u03b8 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03b8 A =\n  A'\n  where\n    C = [xor a | a <- A]\n    D =\n      [C @ x ^ (C @ y <<< 1) | x : [8] <- [4, 0, 1, 2, 3]\n                             | y : [8] <- [1, 2, 3, 4, 0]]\n    A' = [[a ^ (D @ x) | a <- A @ x] | x : [8] <- [0 .. 4]]\n\u03c1 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03c1 A =\n  groupBy`{5} [a <<< r | a <- join A | r : [8] <- R]\n  where\n    R =\n      [0,\n      36,\n      3,\n      41,\n      18,\n      1,\n      44,\n      10,\n      45,\n      2,\n      62,\n      6,\n      43,\n      15,\n      61,\n      28,\n      55,\n      25,\n      21,\n      56,\n      27,\n      20,\n      39,\n      8,\n      14]\n\u03c0 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03c0 A =\n  groupBy`{5}\n    [A @ ((x + 3 * y) % 5) @ x | x : [8] <- [0 .. 4],\n                              y : [8] <- [0 .. 4]]\n\u03c7 : {w} (fin w) => [5][5][w] -> [5][5][w]\n\u03c7 A =\n  groupBy`{5}\n    [(A @ x @ y) ^ (~A @ ((x + 1) % 5) @ y && A @ ((x + 2) % 5) @ y) | x : [8] <- [0 .. 4],\n                                                                    y : [8] <- [0 .. 4]]\n\u03b9 : {w} (fin w) => [5][5][w] -> [5][5][w] -> [5][5][w]\n\u03b9 RC A = A ^ RC\nRCs : {w, n}\n  (fin w, fin n, 24 >= n, n == 12 + 2 * (lg2 w)) =>\n    [n][5][5][w]\nRCs = take`{n} [[[take`{w} RC] # zero] # zero | RC <- RCs64]\nRCs64 : [24][64]\nRCs64 =\n  join\n    (transpose\n      [[0x0000000000000001, 0x000000008000808b],\n      [0x0000000000008082, 0x800000000000008b],\n      [0x800000000000808a, 0x8000000000008089],\n      [0x8000000080008000, 0x8000000000008003],\n      [0x000000000000808b, 0x8000000000008002],\n      [0x0000000080000001, 0x8000000000000080],\n      [0x8000000080008081, 0x000000000000800a],\n      [0x8000000000008009, 0x800000008000000a],\n      [0x000000000000008a, 0x8000000080008081],\n      [0x0000000000000088, 0x8000000000008080],\n      [0x0000000080008009, 0x0000000080000001],\n      [0x000000008000000a, 0x8000000080008008]])\nunflatten : {r, w} (fin w, 25 * w >= r) => [r] -> [5][5][w]\nunflatten p =\n  transpose\n    (groupBy`{5} (reverse (groupBy`{w} (reverse (p # zero)))))\nflatten : {w} (fin w) => [5][5][w] -> [5 * 5 * w]\nflatten A = reverse (join (reverse (join (transpose A))))\nxor : {a, b} (fin a) => [a][b] -> [b]\nxor xs =\n  xors ! 0\n  where\n    xors = [zero] # [x ^ z | x <- xs | z <- xors]\ntoBytes : {n} (fin n) => [8 * n] -> [n][8]\ntoBytes s = reverse (split (reverse s))\nmsg1600 : [1600]\nmsg1600 = join [0b11000101 | _ <- zero : [200]]\n\/* pragma w1 : property *\/\nw1 =\n  join\n    (toBytes\n      (SHA_3_224\n        (msg1600 # 0b11000))) == 0x22d2f7bb0b173fd8c19686f9173166e3ee62738047d7eadd69efb228\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/008_expandKey.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that specifies the DES key schedule, including the constants KP and CP, the helper functions zeroBasify and sums, and the functions expand and expandKey : [64] -> [16][48] that generate the 16 48-bit round subkeys from a 64-bit DES key using the standard DES permutations and left-rotation schedule."},{"role":"assistant","content":"```cryptol\nexpandKey : [64] -> [16][48]\nexpandKey key = expand (split (key @@ KPz))\nexpand : [2][28] -> [16][48]\nexpand [kl, kr] =\n  [((kl <<< i) # (kr <<< i)) @@ CPz | i <- sums\n                                     [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1]]\nsums : [16][8] -> [16][8]\nsums xs = ys where ys = [x + y | x <- xs | y <- [0] # ys]\nzeroBasify XP = [i - 1 | i <- XP]\nKPz = zeroBasify KP\nCPz = zeroBasify CP\nKP : [56][6]\nKP =\n  [57,\n  49,\n  41,\n  33,\n  25,\n  17,\n  9,\n  1,\n  58,\n  50,\n  42,\n  34,\n  26,\n  18,\n  10,\n  2,\n  59,\n  51,\n  43,\n  35,\n  27,\n  19,\n  11,\n  3,\n  60,\n  52,\n  44,\n  36,\n  63,\n  55,\n  47,\n  39,\n  31,\n  23,\n  15,\n  7,\n  62,\n  54,\n  46,\n  38,\n  30,\n  22,\n  14,\n  6,\n  61,\n  53,\n  45,\n  37,\n  29,\n  21,\n  13,\n  5,\n  28,\n  20,\n  12,\n  4]\nCP : [48][6]\nCP =\n  [14,\n  17,\n  11,\n  24,\n  1,\n  5,\n  3,\n  28,\n  15,\n  6,\n  21,\n  10,\n  23,\n  19,\n  12,\n  4,\n  26,\n  8,\n  16,\n  7,\n  27,\n  20,\n  13,\n  2,\n  41,\n  52,\n  31,\n  37,\n  47,\n  55,\n  30,\n  40,\n  51,\n  45,\n  33,\n  48,\n  44,\n  49,\n  39,\n  56,\n  34,\n  53,\n  46,\n  42,\n  50,\n  36,\n  29,\n  32]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/010_expand.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the DES key schedule expansion function `expand : [2][28] -> [16][48]` using the given permutation table `CP`, helper functions `sums` and `zeroBasify`, and constant `CPz`, and include a property that verifies `expand` produces the standard 16 48-bit round keys for known DES test keys."},{"role":"assistant","content":"```cryptol\nexpand : [2][28] -> [16][48]\nexpand [kl, kr] =\n  [((kl <<< i) # (kr <<< i)) @@ CPz | i <- sums\n                                     [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1]]\nsums : [16][8] -> [16][8]\nsums xs = ys where ys = [x + y | x <- xs | y <- [0] # ys]\nzeroBasify XP = [i - 1 | i <- XP]\nCPz = zeroBasify CP\nCP : [48][6]\nCP =\n  [14,\n  17,\n  11,\n  24,\n  1,\n  5,\n  3,\n  28,\n  15,\n  6,\n  21,\n  10,\n  23,\n  19,\n  12,\n  4,\n  26,\n  8,\n  16,\n  7,\n  27,\n  20,\n  13,\n  2,\n  41,\n  52,\n  31,\n  37,\n  47,\n  55,\n  30,\n  40,\n  51,\n  45,\n  33,\n  48,\n  44,\n  49,\n  39,\n  56,\n  34,\n  53,\n  46,\n  42,\n  50,\n  36,\n  29,\n  32]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/015_KPz.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the constant `KPz : [56][6]` for the DES key permutation table in zero-based indexing by applying the function `zeroBasify XP = [i - 1 | i <- XP]` to the one-based permutation constant `KP : [56][6]` given by the 56-entry list of indices for DES key permutation, and ensure the resulting `KPz` matches the standard DES PC-1 permutation in zero-based form."},{"role":"assistant","content":"```cryptol\nzeroBasify XP = [i - 1 | i <- XP]\nKPz = zeroBasify KP\nKP : [56][6]\nKP =\n  [57,\n  49,\n  41,\n  33,\n  25,\n  17,\n  9,\n  1,\n  58,\n  50,\n  42,\n  34,\n  26,\n  18,\n  10,\n  2,\n  59,\n  51,\n  43,\n  35,\n  27,\n  19,\n  11,\n  3,\n  60,\n  52,\n  44,\n  36,\n  63,\n  55,\n  47,\n  39,\n  31,\n  23,\n  15,\n  7,\n  62,\n  54,\n  46,\n  38,\n  30,\n  22,\n  14,\n  6,\n  61,\n  53,\n  45,\n  37,\n  29,\n  21,\n  13,\n  5,\n  28,\n  20,\n  12,\n  4]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/016_CPz.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the constant `CPz : [48][6]` as the zero-based DES key compression permutation table derived from the given one-based table `CP`, using a helper function `zeroBasify` that subtracts 1 from each entry of `CP`."},{"role":"assistant","content":"```cryptol\nzeroBasify XP = [i - 1 | i <- XP]\nCPz = zeroBasify CP\nCP : [48][6]\nCP =\n  [14,\n  17,\n  11,\n  24,\n  1,\n  5,\n  3,\n  28,\n  15,\n  6,\n  21,\n  10,\n  23,\n  19,\n  12,\n  4,\n  26,\n  8,\n  16,\n  7,\n  27,\n  20,\n  13,\n  2,\n  41,\n  52,\n  31,\n  37,\n  47,\n  55,\n  30,\n  40,\n  51,\n  45,\n  33,\n  48,\n  44,\n  49,\n  39,\n  56,\n  34,\n  53,\n  46,\n  42,\n  50,\n  36,\n  29,\n  32]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/017_PPz.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the DES P-permutation table constant `PP` as a 32-element sequence of 6-bit indices and its zero-based variant `PPz = zeroBasify PP`, matching the standard DES P-box permutation used in the DES Feistel function."},{"role":"assistant","content":"```cryptol\nzeroBasify XP = [i - 1 | i <- XP]\nPPz = zeroBasify PP\nPP : [32][6]\nPP =\n  [16,\n  7,\n  20,\n  21,\n  29,\n  12,\n  28,\n  17,\n  1,\n  15,\n  23,\n  26,\n  5,\n  18,\n  31,\n  10,\n  2,\n  8,\n  24,\n  14,\n  32,\n  27,\n  3,\n  9,\n  19,\n  13,\n  30,\n  6,\n  22,\n  11,\n  4,\n  25]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/018_EPz.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the constant `EP : [48][6]` for the DES expansion permutation table as given, the helper function `zeroBasify : [n][6] -> [n][6]` that converts 1-based indices to 0-based by subtracting 1, and the derived 0-based table `EPz = zeroBasify EP`."},{"role":"assistant","content":"```cryptol\nzeroBasify XP = [i - 1 | i <- XP]\nEPz = zeroBasify EP\nEP : [48][6]\nEP =\n  [32,\n  1,\n  2,\n  3,\n  4,\n  5,\n  4,\n  5,\n  6,\n  7,\n  8,\n  9,\n  8,\n  9,\n  10,\n  11,\n  12,\n  13,\n  12,\n  13,\n  14,\n  15,\n  16,\n  17,\n  16,\n  17,\n  18,\n  19,\n  20,\n  21,\n  20,\n  21,\n  22,\n  23,\n  24,\n  25,\n  24,\n  25,\n  26,\n  27,\n  28,\n  29,\n  28,\n  29,\n  30,\n  31,\n  32,\n  1]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/019_IPz.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the DES initial permutation table IP as a constant of type [64][7], define IPz as the corresponding zero-based permutation using a helper function zeroBasify : [64][7] -> [64][7] that subtracts 1 from each entry, and (optionally) add a property that checks IPz correctly represents the zero-based indices of IP."},{"role":"assistant","content":"```cryptol\nzeroBasify XP = [i - 1 | i <- XP]\nIPz = zeroBasify IP\nIP : [64][7]\nIP =\n  [58,\n  50,\n  42,\n  34,\n  26,\n  18,\n  10,\n  2,\n  60,\n  52,\n  44,\n  36,\n  28,\n  20,\n  12,\n  4,\n  62,\n  54,\n  46,\n  38,\n  30,\n  22,\n  14,\n  6,\n  64,\n  56,\n  48,\n  40,\n  32,\n  24,\n  16,\n  8,\n  57,\n  49,\n  41,\n  33,\n  25,\n  17,\n  9,\n  1,\n  59,\n  51,\n  43,\n  35,\n  27,\n  19,\n  11,\n  3,\n  61,\n  53,\n  45,\n  37,\n  29,\n  21,\n  13,\n  5,\n  63,\n  55,\n  47,\n  39,\n  31,\n  23,\n  15,\n  7]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/020_FPz.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for the DES final permutation (FP) that defines the 64-entry table FP : [64][7], a helper function zeroBasify that converts the 1-based FP indices to 0-based indices, and the derived constant FPz = zeroBasify FP."},{"role":"assistant","content":"```cryptol\nzeroBasify XP = [i - 1 | i <- XP]\nFPz = zeroBasify FP\nFP : [64][7]\nFP =\n  [40,\n  8,\n  48,\n  16,\n  56,\n  24,\n  64,\n  32,\n  39,\n  7,\n  47,\n  15,\n  55,\n  23,\n  63,\n  31,\n  38,\n  6,\n  46,\n  14,\n  54,\n  22,\n  62,\n  30,\n  37,\n  5,\n  45,\n  13,\n  53,\n  21,\n  61,\n  29,\n  36,\n  4,\n  44,\n  12,\n  52,\n  20,\n  60,\n  28,\n  35,\n  3,\n  43,\n  11,\n  51,\n  19,\n  59,\n  27,\n  34,\n  2,\n  42,\n  10,\n  50,\n  18,\n  58,\n  26,\n  33,\n  1,\n  41,\n  9,\n  49,\n  17,\n  57,\n  25]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/038_sbox1.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the constant `sbox1 : [4][16][4]` for the DES S-box 1 lookup table exactly as specified, and add a property that checks `sbox1` equals the given 4\u00d716 matrix of 4-bit values used by the DES algorithm."},{"role":"assistant","content":"```cryptol\nsbox1 : [4][16][4]\nsbox1 =\n  [[14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],\n  [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],\n  [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],\n  [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/040_sbox2.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the constant sbox2 : [4][16][4] as the DES S-box 2 substitution table with the exact entries given, suitable for use in a DES block cipher specification and its verification properties."},{"role":"assistant","content":"```cryptol\nsbox2 : [4][16][4]\nsbox2 =\n  [[15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],\n  [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],\n  [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],\n  [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/042_sbox3.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the constant `sbox3 : [4][16][4]` for the DES block cipher\u2019s third S-box with the exact table values given, so it can be used by other DES specification modules."},{"role":"assistant","content":"```cryptol\nsbox3 : [4][16][4]\nsbox3 =\n  [[10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8],\n  [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1],\n  [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7],\n  [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/044_sbox4.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the constant sbox4 : [4][16][4] with the DES S-box 4 lookup table values exactly as specified, suitable for use in a DES block cipher specification."},{"role":"assistant","content":"```cryptol\nsbox4 : [4][16][4]\nsbox4 =\n  [[7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15],\n  [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9],\n  [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4],\n  [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/046_sbox5.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the DES S-box 5 constant `sbox5 : [4][16][4]` with the exact 4\u00d716 table of 4-bit values used in the DES block cipher specification, and include a property that checks `sbox5` matches this standard DES S-box 5 table."},{"role":"assistant","content":"```cryptol\nsbox5 : [4][16][4]\nsbox5 =\n  [[2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9],\n  [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6],\n  [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14],\n  [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/048_sbox6.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the DES S-box 6 constant `sbox6 : [4][16][4]` with the given 4\u00d716 table of 4-bit values exactly as specified here."},{"role":"assistant","content":"```cryptol\nsbox6 : [4][16][4]\nsbox6 =\n  [[12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],\n  [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],\n  [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],\n  [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/050_sbox7.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the DES S-box 7 constant `sbox7 : [4][16][4]` exactly as specified by the standard DES S-box 7 table so it can be used by other DES components."},{"role":"assistant","content":"```cryptol\nsbox7 : [4][16][4]\nsbox7 =\n  [[4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1],\n  [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6],\n  [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2],\n  [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/052_sbox8.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the constant `sbox8 : [4][16][4]` for the DES block cipher S-box 8 with the standard 4\u00d716 table of 4-bit outputs, and include a property that `sbox8` matches the FIPS-46 DES S-box 8 specification for all valid row and column indices."},{"role":"assistant","content":"```cryptol\nsbox8 : [4][16][4]\nsbox8 =\n  [[13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7],\n  [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2],\n  [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8],\n  [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/DES\/058_testsPass.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the DES block cipher as a value `DES : Cipher 64 64` (with `encrypt`\/`decrypt` wired through the DES round function, key schedule, permutations, and S-boxes as in the NIST standard) and a property `testsPass` that checks `DES.encrypt` on given test message\/key pairs matches the expected ciphertexts."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Cipher\n\n\nDES : Cipher 64 64\nDES =\n  {encrypt = \\key pt -> des (expandKey key) pt,\n  decrypt = \\key ct -> des (reverse (expandKey key)) ct}\ndes keys pt =\n  (swap (split lst)) @@ FPz\n  where\n    pt' = pt @@ IPz\n    iv = [round (k, split lr) | k <- keys | lr <- [pt'] # iv]\n    lst = iv @ (length keys - 1)\nround : ([48], [2][32]) -> [64]\nround (k, [l, r]) = r # (l ^ f (r, k))\nf (r, k) = (SBox (k ^ (r @@ EPz))) @@ PPz\nswap [a, b] = b # a\nexpandKey : [64] -> [16][48]\nexpandKey key = expand (split (key @@ KPz))\nexpand : [2][28] -> [16][48]\nexpand [kl, kr] =\n  [((kl <<< i) # (kr <<< i)) @@ CPz | i <- sums\n                                     [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1]]\nsums : [16][8] -> [16][8]\nsums xs = ys where ys = [x + y | x <- xs | y <- [0] # ys]\nzeroBasify XP = [i - 1 | i <- XP]\nKPz = zeroBasify KP\nCPz = zeroBasify CP\nPPz = zeroBasify PP\nEPz = zeroBasify EP\nIPz = zeroBasify IP\nFPz = zeroBasify FP\nKP : [56][6]\nKP =\n  [57,\n  49,\n  41,\n  33,\n  25,\n  17,\n  9,\n  1,\n  58,\n  50,\n  42,\n  34,\n  26,\n  18,\n  10,\n  2,\n  59,\n  51,\n  43,\n  35,\n  27,\n  19,\n  11,\n  3,\n  60,\n  52,\n  44,\n  36,\n  63,\n  55,\n  47,\n  39,\n  31,\n  23,\n  15,\n  7,\n  62,\n  54,\n  46,\n  38,\n  30,\n  22,\n  14,\n  6,\n  61,\n  53,\n  45,\n  37,\n  29,\n  21,\n  13,\n  5,\n  28,\n  20,\n  12,\n  4]\nCP : [48][6]\nCP =\n  [14,\n  17,\n  11,\n  24,\n  1,\n  5,\n  3,\n  28,\n  15,\n  6,\n  21,\n  10,\n  23,\n  19,\n  12,\n  4,\n  26,\n  8,\n  16,\n  7,\n  27,\n  20,\n  13,\n  2,\n  41,\n  52,\n  31,\n  37,\n  47,\n  55,\n  30,\n  40,\n  51,\n  45,\n  33,\n  48,\n  44,\n  49,\n  39,\n  56,\n  34,\n  53,\n  46,\n  42,\n  50,\n  36,\n  29,\n  32]\nPP : [32][6]\nPP =\n  [16,\n  7,\n  20,\n  21,\n  29,\n  12,\n  28,\n  17,\n  1,\n  15,\n  23,\n  26,\n  5,\n  18,\n  31,\n  10,\n  2,\n  8,\n  24,\n  14,\n  32,\n  27,\n  3,\n  9,\n  19,\n  13,\n  30,\n  6,\n  22,\n  11,\n  4,\n  25]\nEP : [48][6]\nEP =\n  [32,\n  1,\n  2,\n  3,\n  4,\n  5,\n  4,\n  5,\n  6,\n  7,\n  8,\n  9,\n  8,\n  9,\n  10,\n  11,\n  12,\n  13,\n  12,\n  13,\n  14,\n  15,\n  16,\n  17,\n  16,\n  17,\n  18,\n  19,\n  20,\n  21,\n  20,\n  21,\n  22,\n  23,\n  24,\n  25,\n  24,\n  25,\n  26,\n  27,\n  28,\n  29,\n  28,\n  29,\n  30,\n  31,\n  32,\n  1]\nIP : [64][7]\nIP =\n  [58,\n  50,\n  42,\n  34,\n  26,\n  18,\n  10,\n  2,\n  60,\n  52,\n  44,\n  36,\n  28,\n  20,\n  12,\n  4,\n  62,\n  54,\n  46,\n  38,\n  30,\n  22,\n  14,\n  6,\n  64,\n  56,\n  48,\n  40,\n  32,\n  24,\n  16,\n  8,\n  57,\n  49,\n  41,\n  33,\n  25,\n  17,\n  9,\n  1,\n  59,\n  51,\n  43,\n  35,\n  27,\n  19,\n  11,\n  3,\n  61,\n  53,\n  45,\n  37,\n  29,\n  21,\n  13,\n  5,\n  63,\n  55,\n  47,\n  39,\n  31,\n  23,\n  15,\n  7]\nFP : [64][7]\nFP =\n  [40,\n  8,\n  48,\n  16,\n  56,\n  24,\n  64,\n  32,\n  39,\n  7,\n  47,\n  15,\n  55,\n  23,\n  63,\n  31,\n  38,\n  6,\n  46,\n  14,\n  54,\n  22,\n  62,\n  30,\n  37,\n  5,\n  45,\n  13,\n  53,\n  21,\n  61,\n  29,\n  36,\n  4,\n  44,\n  12,\n  52,\n  20,\n  60,\n  28,\n  35,\n  3,\n  43,\n  11,\n  51,\n  19,\n  59,\n  27,\n  34,\n  2,\n  42,\n  10,\n  50,\n  18,\n  58,\n  26,\n  33,\n  1,\n  41,\n  9,\n  49,\n  17,\n  57,\n  25]\nSBox : [48] -> [32]\nSBox x = join [sbox (n, b) | n <- [1 .. 8] | b <- split x]\nsbox : ([4], [6]) -> [4]\nsbox (n, x) =\n  (s @ [b1, b6] @ [b2, b3, b4, b5])\n  where\n    s = sboxes @ (n - 1)\n    b1 = x @ 0\n    b2 = x @ 1\n    b3 = x @ 2\n    b4 = x @ 3\n    b5 = x @ 4\n    b6 = x @ 5\nsboxes = [sbox1, sbox2, sbox3, sbox4, sbox5, sbox6, sbox7, sbox8]\nsbox1 : [4][16][4]\nsbox1 =\n  [[14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],\n  [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],\n  [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],\n  [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13]]\nsbox2 : [4][16][4]\nsbox2 =\n  [[15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],\n  [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],\n  [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],\n  [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9]]\nsbox3 : [4][16][4]\nsbox3 =\n  [[10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8],\n  [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1],\n  [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7],\n  [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12]]\nsbox4 : [4][16][4]\nsbox4 =\n  [[7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15],\n  [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9],\n  [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4],\n  [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14]]\nsbox5 : [4][16][4]\nsbox5 =\n  [[2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9],\n  [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6],\n  [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14],\n  [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3]]\nsbox6 : [4][16][4]\nsbox6 =\n  [[12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],\n  [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],\n  [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],\n  [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13]]\nsbox7 : [4][16][4]\nsbox7 =\n  [[4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1],\n  [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6],\n  [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2],\n  [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12]]\nsbox8 : [4][16][4]\nsbox8 =\n  [[13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7],\n  [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2],\n  [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8],\n  [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11]]\ntestmsgs =\n  [0x1122334455667788,\n  0x99aabbccddeeff00,\n  0x41ad068548809d02,\n  0xb10f843097a0f932]\ntestkeys =\n  [0x752878397493cb70,\n  0x752878397493cb70,\n  0x0001020304050607,\n  0x2bd6459f82c5b300]\ntestct =\n  [0xb5219ee81aa7499d,\n  0x2196687e13973856,\n  0x0011223344556677,\n  0xea024714ad5c4d84]\n\/* pragma testsPass : property *\/\ntestsPass =\n  and\n    [DES.encrypt key msg == ct | key <- testkeys\n                               | msg <- testmsgs\n                               | ct <- testct]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/ZUC\/003_add.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for a ZUC stream cipher helper function `add : {a} (fin a) => [a][31] -> [31]` that takes a sequence of 31-bit words and returns their sum modulo 2^31 (with proper carry handling), matching the described behavior and types exactly."},{"role":"assistant","content":"```cryptol\nadd : {a} (fin a) => [a][31] -> [31]\nadd xs =\n  sums ! 0\n  where\n    sums = [0] # [plus (s, x) | s <- sums | x <- xs]\n    plus : ([31], [31]) -> [31]\n    plus (a, b) =\n      if sab @ 0 then sab' + 1 else sab'\n      where\n        sab : [32]\n        sab = ((zero : [1]) # a) + ((zero : [1]) # b)\n        sab' : [31]\n        sab' = drop sab\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/ZUC\/006_LFSRWithInitializationMode.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the ZUC stream cipher LFSR type and the LFSRWithInitializationMode : ([31], [16][31]) -> [16][31] function, including the 31-bit add operation and version1_5 behavior exactly as in the ZUC-1.5 initialization mode, so it can be used for formal verification of the cipher\u2019s initialization step."},{"role":"assistant","content":"```cryptol\nversion1_5 : Bit\nversion1_5 = True\nadd : {a} (fin a) => [a][31] -> [31]\nadd xs =\n  sums ! 0\n  where\n    sums = [0] # [plus (s, x) | s <- sums | x <- xs]\n    plus : ([31], [31]) -> [31]\n    plus (a, b) =\n      if sab @ 0 then sab' + 1 else sab'\n      where\n        sab : [32]\n        sab = ((zero : [1]) # a) + ((zero : [1]) # b)\n        sab' : [31]\n        sab' = drop sab\ntype LFSR = [16][31]\nLFSRWithInitializationMode : ([31], LFSR) -> LFSR\nLFSRWithInitializationMode (u, ss) =\n  ss @@ [1 .. 15] # [s16]\n  where\n    v =\n      add\n        [s <<< c | s <- ss @@ [15, 13, 10, 4, 0, 0]\n                 | c <- [15, 17, 21, 20, 8, 0]]\n    vu = if version1_5 then add [v, u] else v ^ u\n    s16 = if vu == 0 then `2147483647 else vu\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/ZUC\/010_BitReorganization.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function `BitReorganization : [16][31] -> [4][32]` for the ZUC stream cipher that, given an LFSR state `ss`, extracts `s0, s2, s5, s7, s9, s11, s14, s15` and concatenates their high and low 16-bit parts exactly as specified, maintaining the same types and bit indices as in the original file."},{"role":"assistant","content":"```cryptol\ntype LFSR = [16][31]\nBitReorganization : LFSR -> [4][32]\nBitReorganization ss =\n  [hi s15 # lo s14, lo s11 # hi s9, lo s7 # hi s5, lo s2 # hi s0]\n  where\n    lo : [31] -> [16]\n    hi : [31] -> [16]\n    lo x = x @@ [15 .. 30]\n    hi x = x @@ [0 .. 15]\n    [s0, s2, s5, s7, s9, s11, s14, s15] =\n      ss @@ [0, 2, 5, 7, 9, 11, 14, 15]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/ZUC\/012_F.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module for the ZUC stream cipher that includes the F function with type F : ([3][32], [2][32]) -> ([32], [2][32]), its nonlinear layer S using S0\/S1 S-box tables, and linear transformations L1 and L2, suitable for use as the ZUC finite state machine (FSM) output and register update step."},{"role":"assistant","content":"```cryptol\nF : ([3][32], [2][32]) -> ([32], [2][32])\nF ([X0, X1, X2], [R1, R2]) =\n  (W, [R1', R2'])\n  where\n    W = (X0 ^ R1) + R2\n    W1 = R1 + X1\n    W2 = R2 ^ X2\n    [W1H, W1L] = split W1\n    [W2H, W2L] = split W2\n    R1' = S (L1 (W1L # W2H))\n    R2' = S (L2 (W2L # W1H))\nS : [32] -> [32]\nS X =\n  Y0 # Y1 # Y2 # Y3\n  where\n    [X0, X1, X2, X3] = split X\n    [Y0, Y1, Y2, Y3] = [S0 X0, S1 X1, S2 X2, S3 X3]\nS0 : [8] -> [8]\nS1 : [8] -> [8]\nS2 : [8] -> [8]\nS3 : [8] -> [8]\nS0 x = S0Table @ x\nS1 x = S1Table @ x\nS2 = S0\nS3 = S1\nS0Table : [256][8]\nS0Table =\n  [0x3e,\n  0x72,\n  0x5b,\n  0x47,\n  0xca,\n  0xe0,\n  0x00,\n  0x33,\n  0x04,\n  0xd1,\n  0x54,\n  0x98,\n  0x09,\n  0xb9,\n  0x6d,\n  0xcb,\n  0x7b,\n  0x1b,\n  0xf9,\n  0x32,\n  0xaf,\n  0x9d,\n  0x6a,\n  0xa5,\n  0xb8,\n  0x2d,\n  0xfc,\n  0x1d,\n  0x08,\n  0x53,\n  0x03,\n  0x90,\n  0x4d,\n  0x4e,\n  0x84,\n  0x99,\n  0xe4,\n  0xce,\n  0xd9,\n  0x91,\n  0xdd,\n  0xb6,\n  0x85,\n  0x48,\n  0x8b,\n  0x29,\n  0x6e,\n  0xac,\n  0xcd,\n  0xc1,\n  0xf8,\n  0x1e,\n  0x73,\n  0x43,\n  0x69,\n  0xc6,\n  0xb5,\n  0xbd,\n  0xfd,\n  0x39,\n  0x63,\n  0x20,\n  0xd4,\n  0x38,\n  0x76,\n  0x7d,\n  0xb2,\n  0xa7,\n  0xcf,\n  0xed,\n  0x57,\n  0xc5,\n  0xf3,\n  0x2c,\n  0xbb,\n  0x14,\n  0x21,\n  0x06,\n  0x55,\n  0x9b,\n  0xe3,\n  0xef,\n  0x5e,\n  0x31,\n  0x4f,\n  0x7f,\n  0x5a,\n  0xa4,\n  0x0d,\n  0x82,\n  0x51,\n  0x49,\n  0x5f,\n  0xba,\n  0x58,\n  0x1c,\n  0x4a,\n  0x16,\n  0xd5,\n  0x17,\n  0xa8,\n  0x92,\n  0x24,\n  0x1f,\n  0x8c,\n  0xff,\n  0xd8,\n  0xae,\n  0x2e,\n  0x01,\n  0xd3,\n  0xad,\n  0x3b,\n  0x4b,\n  0xda,\n  0x46,\n  0xeb,\n  0xc9,\n  0xde,\n  0x9a,\n  0x8f,\n  0x87,\n  0xd7,\n  0x3a,\n  0x80,\n  0x6f,\n  0x2f,\n  0xc8,\n  0xb1,\n  0xb4,\n  0x37,\n  0xf7,\n  0x0a,\n  0x22,\n  0x13,\n  0x28,\n  0x7c,\n  0xcc,\n  0x3c,\n  0x89,\n  0xc7,\n  0xc3,\n  0x96,\n  0x56,\n  0x07,\n  0xbf,\n  0x7e,\n  0xf0,\n  0x0b,\n  0x2b,\n  0x97,\n  0x52,\n  0x35,\n  0x41,\n  0x79,\n  0x61,\n  0xa6,\n  0x4c,\n  0x10,\n  0xfe,\n  0xbc,\n  0x26,\n  0x95,\n  0x88,\n  0x8a,\n  0xb0,\n  0xa3,\n  0xfb,\n  0xc0,\n  0x18,\n  0x94,\n  0xf2,\n  0xe1,\n  0xe5,\n  0xe9,\n  0x5d,\n  0xd0,\n  0xdc,\n  0x11,\n  0x66,\n  0x64,\n  0x5c,\n  0xec,\n  0x59,\n  0x42,\n  0x75,\n  0x12,\n  0xf5,\n  0x74,\n  0x9c,\n  0xaa,\n  0x23,\n  0x0e,\n  0x86,\n  0xab,\n  0xbe,\n  0x2a,\n  0x02,\n  0xe7,\n  0x67,\n  0xe6,\n  0x44,\n  0xa2,\n  0x6c,\n  0xc2,\n  0x93,\n  0x9f,\n  0xf1,\n  0xf6,\n  0xfa,\n  0x36,\n  0xd2,\n  0x50,\n  0x68,\n  0x9e,\n  0x62,\n  0x71,\n  0x15,\n  0x3d,\n  0xd6,\n  0x40,\n  0xc4,\n  0xe2,\n  0x0f,\n  0x8e,\n  0x83,\n  0x77,\n  0x6b,\n  0x25,\n  0x05,\n  0x3f,\n  0x0c,\n  0x30,\n  0xea,\n  0x70,\n  0xb7,\n  0xa1,\n  0xe8,\n  0xa9,\n  0x65,\n  0x8d,\n  0x27,\n  0x1a,\n  0xdb,\n  0x81,\n  0xb3,\n  0xa0,\n  0xf4,\n  0x45,\n  0x7a,\n  0x19,\n  0xdf,\n  0xee,\n  0x78,\n  0x34,\n  0x60]\nS1Table : [256][8]\nS1Table =\n  [0x55,\n  0xc2,\n  0x63,\n  0x71,\n  0x3b,\n  0xc8,\n  0x47,\n  0x86,\n  0x9f,\n  0x3c,\n  0xda,\n  0x5b,\n  0x29,\n  0xaa,\n  0xfd,\n  0x77,\n  0x8c,\n  0xc5,\n  0x94,\n  0x0c,\n  0xa6,\n  0x1a,\n  0x13,\n  0x00,\n  0xe3,\n  0xa8,\n  0x16,\n  0x72,\n  0x40,\n  0xf9,\n  0xf8,\n  0x42,\n  0x44,\n  0x26,\n  0x68,\n  0x96,\n  0x81,\n  0xd9,\n  0x45,\n  0x3e,\n  0x10,\n  0x76,\n  0xc6,\n  0xa7,\n  0x8b,\n  0x39,\n  0x43,\n  0xe1,\n  0x3a,\n  0xb5,\n  0x56,\n  0x2a,\n  0xc0,\n  0x6d,\n  0xb3,\n  0x05,\n  0x22,\n  0x66,\n  0xbf,\n  0xdc,\n  0x0b,\n  0xfa,\n  0x62,\n  0x48,\n  0xdd,\n  0x20,\n  0x11,\n  0x06,\n  0x36,\n  0xc9,\n  0xc1,\n  0xcf,\n  0xf6,\n  0x27,\n  0x52,\n  0xbb,\n  0x69,\n  0xf5,\n  0xd4,\n  0x87,\n  0x7f,\n  0x84,\n  0x4c,\n  0xd2,\n  0x9c,\n  0x57,\n  0xa4,\n  0xbc,\n  0x4f,\n  0x9a,\n  0xdf,\n  0xfe,\n  0xd6,\n  0x8d,\n  0x7a,\n  0xeb,\n  0x2b,\n  0x53,\n  0xd8,\n  0x5c,\n  0xa1,\n  0x14,\n  0x17,\n  0xfb,\n  0x23,\n  0xd5,\n  0x7d,\n  0x30,\n  0x67,\n  0x73,\n  0x08,\n  0x09,\n  0xee,\n  0xb7,\n  0x70,\n  0x3f,\n  0x61,\n  0xb2,\n  0x19,\n  0x8e,\n  0x4e,\n  0xe5,\n  0x4b,\n  0x93,\n  0x8f,\n  0x5d,\n  0xdb,\n  0xa9,\n  0xad,\n  0xf1,\n  0xae,\n  0x2e,\n  0xcb,\n  0x0d,\n  0xfc,\n  0xf4,\n  0x2d,\n  0x46,\n  0x6e,\n  0x1d,\n  0x97,\n  0xe8,\n  0xd1,\n  0xe9,\n  0x4d,\n  0x37,\n  0xa5,\n  0x75,\n  0x5e,\n  0x83,\n  0x9e,\n  0xab,\n  0x82,\n  0x9d,\n  0xb9,\n  0x1c,\n  0xe0,\n  0xcd,\n  0x49,\n  0x89,\n  0x01,\n  0xb6,\n  0xbd,\n  0x58,\n  0x24,\n  0xa2,\n  0x5f,\n  0x38,\n  0x78,\n  0x99,\n  0x15,\n  0x90,\n  0x50,\n  0xb8,\n  0x95,\n  0xe4,\n  0xd0,\n  0x91,\n  0xc7,\n  0xce,\n  0xed,\n  0x0f,\n  0xb4,\n  0x6f,\n  0xa0,\n  0xcc,\n  0xf0,\n  0x02,\n  0x4a,\n  0x79,\n  0xc3,\n  0xde,\n  0xa3,\n  0xef,\n  0xea,\n  0x51,\n  0xe6,\n  0x6b,\n  0x18,\n  0xec,\n  0x1b,\n  0x2c,\n  0x80,\n  0xf7,\n  0x74,\n  0xe7,\n  0xff,\n  0x21,\n  0x5a,\n  0x6a,\n  0x54,\n  0x1e,\n  0x41,\n  0x31,\n  0x92,\n  0x35,\n  0xc4,\n  0x33,\n  0x07,\n  0x0a,\n  0xba,\n  0x7e,\n  0x0e,\n  0x34,\n  0x88,\n  0xb1,\n  0x98,\n  0x7c,\n  0xf3,\n  0x3d,\n  0x60,\n  0x6c,\n  0x7b,\n  0xca,\n  0xd3,\n  0x1f,\n  0x32,\n  0x65,\n  0x04,\n  0x28,\n  0x64,\n  0xbe,\n  0x85,\n  0x9b,\n  0x2f,\n  0x59,\n  0x8a,\n  0xd7,\n  0xb0,\n  0x25,\n  0xac,\n  0xaf,\n  0x12,\n  0x03,\n  0xe2,\n  0xf2]\nL1 : [32] -> [32]\nL1 X = X ^ X <<< 2 ^ X <<< 10 ^ X <<< 18 ^ X <<< 24\nL2 : [32] -> [32]\nL2 X = X ^ X <<< 8 ^ X <<< 14 ^ X <<< 22 ^ X <<< 30\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/ZUC\/019_S2.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the ZUC stream cipher S-box S0 as a Cryptol function `S0 : [8] -> [8]` implemented by a 256-entry lookup table `S0Table : [256][8]`, define `S2 : [8] -> [8]` as an alias of `S0`, and ensure the table contents exactly match the ZUC S0 S-box from the ZUC specification."},{"role":"assistant","content":"```cryptol\nS0 : [8] -> [8]\nS2 : [8] -> [8]\nS0 x = S0Table @ x\nS2 = S0\nS0Table : [256][8]\nS0Table =\n  [0x3e,\n  0x72,\n  0x5b,\n  0x47,\n  0xca,\n  0xe0,\n  0x00,\n  0x33,\n  0x04,\n  0xd1,\n  0x54,\n  0x98,\n  0x09,\n  0xb9,\n  0x6d,\n  0xcb,\n  0x7b,\n  0x1b,\n  0xf9,\n  0x32,\n  0xaf,\n  0x9d,\n  0x6a,\n  0xa5,\n  0xb8,\n  0x2d,\n  0xfc,\n  0x1d,\n  0x08,\n  0x53,\n  0x03,\n  0x90,\n  0x4d,\n  0x4e,\n  0x84,\n  0x99,\n  0xe4,\n  0xce,\n  0xd9,\n  0x91,\n  0xdd,\n  0xb6,\n  0x85,\n  0x48,\n  0x8b,\n  0x29,\n  0x6e,\n  0xac,\n  0xcd,\n  0xc1,\n  0xf8,\n  0x1e,\n  0x73,\n  0x43,\n  0x69,\n  0xc6,\n  0xb5,\n  0xbd,\n  0xfd,\n  0x39,\n  0x63,\n  0x20,\n  0xd4,\n  0x38,\n  0x76,\n  0x7d,\n  0xb2,\n  0xa7,\n  0xcf,\n  0xed,\n  0x57,\n  0xc5,\n  0xf3,\n  0x2c,\n  0xbb,\n  0x14,\n  0x21,\n  0x06,\n  0x55,\n  0x9b,\n  0xe3,\n  0xef,\n  0x5e,\n  0x31,\n  0x4f,\n  0x7f,\n  0x5a,\n  0xa4,\n  0x0d,\n  0x82,\n  0x51,\n  0x49,\n  0x5f,\n  0xba,\n  0x58,\n  0x1c,\n  0x4a,\n  0x16,\n  0xd5,\n  0x17,\n  0xa8,\n  0x92,\n  0x24,\n  0x1f,\n  0x8c,\n  0xff,\n  0xd8,\n  0xae,\n  0x2e,\n  0x01,\n  0xd3,\n  0xad,\n  0x3b,\n  0x4b,\n  0xda,\n  0x46,\n  0xeb,\n  0xc9,\n  0xde,\n  0x9a,\n  0x8f,\n  0x87,\n  0xd7,\n  0x3a,\n  0x80,\n  0x6f,\n  0x2f,\n  0xc8,\n  0xb1,\n  0xb4,\n  0x37,\n  0xf7,\n  0x0a,\n  0x22,\n  0x13,\n  0x28,\n  0x7c,\n  0xcc,\n  0x3c,\n  0x89,\n  0xc7,\n  0xc3,\n  0x96,\n  0x56,\n  0x07,\n  0xbf,\n  0x7e,\n  0xf0,\n  0x0b,\n  0x2b,\n  0x97,\n  0x52,\n  0x35,\n  0x41,\n  0x79,\n  0x61,\n  0xa6,\n  0x4c,\n  0x10,\n  0xfe,\n  0xbc,\n  0x26,\n  0x95,\n  0x88,\n  0x8a,\n  0xb0,\n  0xa3,\n  0xfb,\n  0xc0,\n  0x18,\n  0x94,\n  0xf2,\n  0xe1,\n  0xe5,\n  0xe9,\n  0x5d,\n  0xd0,\n  0xdc,\n  0x11,\n  0x66,\n  0x64,\n  0x5c,\n  0xec,\n  0x59,\n  0x42,\n  0x75,\n  0x12,\n  0xf5,\n  0x74,\n  0x9c,\n  0xaa,\n  0x23,\n  0x0e,\n  0x86,\n  0xab,\n  0xbe,\n  0x2a,\n  0x02,\n  0xe7,\n  0x67,\n  0xe6,\n  0x44,\n  0xa2,\n  0x6c,\n  0xc2,\n  0x93,\n  0x9f,\n  0xf1,\n  0xf6,\n  0xfa,\n  0x36,\n  0xd2,\n  0x50,\n  0x68,\n  0x9e,\n  0x62,\n  0x71,\n  0x15,\n  0x3d,\n  0xd6,\n  0x40,\n  0xc4,\n  0xe2,\n  0x0f,\n  0x8e,\n  0x83,\n  0x77,\n  0x6b,\n  0x25,\n  0x05,\n  0x3f,\n  0x0c,\n  0x30,\n  0xea,\n  0x70,\n  0xb7,\n  0xa1,\n  0xe8,\n  0xa9,\n  0x65,\n  0x8d,\n  0x27,\n  0x1a,\n  0xdb,\n  0x81,\n  0xb3,\n  0xa0,\n  0xf4,\n  0x45,\n  0x7a,\n  0x19,\n  0xdf,\n  0xee,\n  0x78,\n  0x34,\n  0x60]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/ZUC\/020_S3.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module for the ZUC stream cipher S-box S3 stage that includes the constant lookup table `S1Table : [256][8]` as given, and the functions `S1 : [8] -> [8]` and `S3 : [8] -> [8]` where `S1 x = S1Table @ x` and `S3 = S1`."},{"role":"assistant","content":"```cryptol\nS1 : [8] -> [8]\nS3 : [8] -> [8]\nS1 x = S1Table @ x\nS3 = S1\nS1Table : [256][8]\nS1Table =\n  [0x55,\n  0xc2,\n  0x63,\n  0x71,\n  0x3b,\n  0xc8,\n  0x47,\n  0x86,\n  0x9f,\n  0x3c,\n  0xda,\n  0x5b,\n  0x29,\n  0xaa,\n  0xfd,\n  0x77,\n  0x8c,\n  0xc5,\n  0x94,\n  0x0c,\n  0xa6,\n  0x1a,\n  0x13,\n  0x00,\n  0xe3,\n  0xa8,\n  0x16,\n  0x72,\n  0x40,\n  0xf9,\n  0xf8,\n  0x42,\n  0x44,\n  0x26,\n  0x68,\n  0x96,\n  0x81,\n  0xd9,\n  0x45,\n  0x3e,\n  0x10,\n  0x76,\n  0xc6,\n  0xa7,\n  0x8b,\n  0x39,\n  0x43,\n  0xe1,\n  0x3a,\n  0xb5,\n  0x56,\n  0x2a,\n  0xc0,\n  0x6d,\n  0xb3,\n  0x05,\n  0x22,\n  0x66,\n  0xbf,\n  0xdc,\n  0x0b,\n  0xfa,\n  0x62,\n  0x48,\n  0xdd,\n  0x20,\n  0x11,\n  0x06,\n  0x36,\n  0xc9,\n  0xc1,\n  0xcf,\n  0xf6,\n  0x27,\n  0x52,\n  0xbb,\n  0x69,\n  0xf5,\n  0xd4,\n  0x87,\n  0x7f,\n  0x84,\n  0x4c,\n  0xd2,\n  0x9c,\n  0x57,\n  0xa4,\n  0xbc,\n  0x4f,\n  0x9a,\n  0xdf,\n  0xfe,\n  0xd6,\n  0x8d,\n  0x7a,\n  0xeb,\n  0x2b,\n  0x53,\n  0xd8,\n  0x5c,\n  0xa1,\n  0x14,\n  0x17,\n  0xfb,\n  0x23,\n  0xd5,\n  0x7d,\n  0x30,\n  0x67,\n  0x73,\n  0x08,\n  0x09,\n  0xee,\n  0xb7,\n  0x70,\n  0x3f,\n  0x61,\n  0xb2,\n  0x19,\n  0x8e,\n  0x4e,\n  0xe5,\n  0x4b,\n  0x93,\n  0x8f,\n  0x5d,\n  0xdb,\n  0xa9,\n  0xad,\n  0xf1,\n  0xae,\n  0x2e,\n  0xcb,\n  0x0d,\n  0xfc,\n  0xf4,\n  0x2d,\n  0x46,\n  0x6e,\n  0x1d,\n  0x97,\n  0xe8,\n  0xd1,\n  0xe9,\n  0x4d,\n  0x37,\n  0xa5,\n  0x75,\n  0x5e,\n  0x83,\n  0x9e,\n  0xab,\n  0x82,\n  0x9d,\n  0xb9,\n  0x1c,\n  0xe0,\n  0xcd,\n  0x49,\n  0x89,\n  0x01,\n  0xb6,\n  0xbd,\n  0x58,\n  0x24,\n  0xa2,\n  0x5f,\n  0x38,\n  0x78,\n  0x99,\n  0x15,\n  0x90,\n  0x50,\n  0xb8,\n  0x95,\n  0xe4,\n  0xd0,\n  0x91,\n  0xc7,\n  0xce,\n  0xed,\n  0x0f,\n  0xb4,\n  0x6f,\n  0xa0,\n  0xcc,\n  0xf0,\n  0x02,\n  0x4a,\n  0x79,\n  0xc3,\n  0xde,\n  0xa3,\n  0xef,\n  0xea,\n  0x51,\n  0xe6,\n  0x6b,\n  0x18,\n  0xec,\n  0x1b,\n  0x2c,\n  0x80,\n  0xf7,\n  0x74,\n  0xe7,\n  0xff,\n  0x21,\n  0x5a,\n  0x6a,\n  0x54,\n  0x1e,\n  0x41,\n  0x31,\n  0x92,\n  0x35,\n  0xc4,\n  0x33,\n  0x07,\n  0x0a,\n  0xba,\n  0x7e,\n  0x0e,\n  0x34,\n  0x88,\n  0xb1,\n  0x98,\n  0x7c,\n  0xf3,\n  0x3d,\n  0x60,\n  0x6c,\n  0x7b,\n  0xca,\n  0xd3,\n  0x1f,\n  0x32,\n  0x65,\n  0x04,\n  0x28,\n  0x64,\n  0xbe,\n  0x85,\n  0x9b,\n  0x2f,\n  0x59,\n  0x8a,\n  0xd7,\n  0xb0,\n  0x25,\n  0xac,\n  0xaf,\n  0x12,\n  0x03,\n  0xe2,\n  0xf2]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/ZUC\/033_LoadKey.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for the ZUC stream cipher key-loading step by defining the type alias `LFSR = [16][31]` and the function `LoadKey : ([128], [128]) -> LFSR` that takes a 128-bit key and 128-bit IV, splits them into 16 bytes each, concatenates them with the fixed 15-bit constants vector `ds` element-wise to form the 16 31-bit LFSR states, and ensures these constants match the ZUC standard."},{"role":"assistant","content":"```cryptol\ntype LFSR = [16][31]\nLoadKey : ([128], [128]) -> LFSR\nLoadKey (key, iv) =\n  [k # d # i | k <- ks\n             | i <- is\n             | d <- ds]\n  where\n    ks : [16][8]\n    ks = split key\n    is : [16][8]\n    is = split iv\n    ds : [16][15]\n    ds =\n      [0b100010011010111,\n      0b010011010111100,\n      0b110001001101011,\n      0b001001101011110,\n      0b101011110001001,\n      0b011010111100010,\n      0b111000100110101,\n      0b000100110101111,\n      0b100110101111000,\n      0b010111100010011,\n      0b110101111000100,\n      0b001101011110001,\n      0b101111000100110,\n      0b011110001001101,\n      0b111100010011010,\n      0b100011110101100]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/ZUC\/044_ZUC_TestVectors.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `ZUC_TestVectors` that checks the ZUC-128-EEA3 stream cipher specification (including LFSR initialization, bit reorganization, nonlinear function F, S-boxes, and key\/IV loading) by asserting that the `ZUC : [128] -> [128] -> [inf][32]` keystream outputs match the four given 32-bit test vector sequences for specified key\/IV pairs and positions."},{"role":"assistant","content":"```cryptol\nversion1_5 : Bit\nversion1_5 = True\nadd : {a} (fin a) => [a][31] -> [31]\nadd xs =\n  sums ! 0\n  where\n    sums = [0] # [plus (s, x) | s <- sums | x <- xs]\n    plus : ([31], [31]) -> [31]\n    plus (a, b) =\n      if sab @ 0 then sab' + 1 else sab'\n      where\n        sab : [32]\n        sab = ((zero : [1]) # a) + ((zero : [1]) # b)\n        sab' : [31]\n        sab' = drop sab\ntype LFSR = [16][31]\nLFSRWithInitializationMode : ([31], LFSR) -> LFSR\nLFSRWithInitializationMode (u, ss) =\n  ss @@ [1 .. 15] # [s16]\n  where\n    v =\n      add\n        [s <<< c | s <- ss @@ [15, 13, 10, 4, 0, 0]\n                 | c <- [15, 17, 21, 20, 8, 0]]\n    vu = if version1_5 then add [v, u] else v ^ u\n    s16 = if vu == 0 then `2147483647 else vu\nLFSRWithWorkMode : LFSR -> LFSR\nLFSRWithWorkMode ss =\n  ss @@ [1 .. 15] # [s16]\n  where\n    v =\n      add\n        [s <<< c | s <- ss @@ [15, 13, 10, 4, 0, 0]\n                 | c <- [15, 17, 21, 20, 8, 0]]\n    s16 = if v == 0 then `2147483647 else v\nBitReorganization : LFSR -> [4][32]\nBitReorganization ss =\n  [hi s15 # lo s14, lo s11 # hi s9, lo s7 # hi s5, lo s2 # hi s0]\n  where\n    lo : [31] -> [16]\n    hi : [31] -> [16]\n    lo x = x @@ [15 .. 30]\n    hi x = x @@ [0 .. 15]\n    [s0, s2, s5, s7, s9, s11, s14, s15] =\n      ss @@ [0, 2, 5, 7, 9, 11, 14, 15]\nF : ([3][32], [2][32]) -> ([32], [2][32])\nF ([X0, X1, X2], [R1, R2]) =\n  (W, [R1', R2'])\n  where\n    W = (X0 ^ R1) + R2\n    W1 = R1 + X1\n    W2 = R2 ^ X2\n    [W1H, W1L] = split W1\n    [W2H, W2L] = split W2\n    R1' = S (L1 (W1L # W2H))\n    R2' = S (L2 (W2L # W1H))\nS : [32] -> [32]\nS X =\n  Y0 # Y1 # Y2 # Y3\n  where\n    [X0, X1, X2, X3] = split X\n    [Y0, Y1, Y2, Y3] = [S0 X0, S1 X1, S2 X2, S3 X3]\nS0 : [8] -> [8]\nS1 : [8] -> [8]\nS2 : [8] -> [8]\nS3 : [8] -> [8]\nS0 x = S0Table @ x\nS1 x = S1Table @ x\nS2 = S0\nS3 = S1\nS0Table : [256][8]\nS0Table =\n  [0x3e,\n  0x72,\n  0x5b,\n  0x47,\n  0xca,\n  0xe0,\n  0x00,\n  0x33,\n  0x04,\n  0xd1,\n  0x54,\n  0x98,\n  0x09,\n  0xb9,\n  0x6d,\n  0xcb,\n  0x7b,\n  0x1b,\n  0xf9,\n  0x32,\n  0xaf,\n  0x9d,\n  0x6a,\n  0xa5,\n  0xb8,\n  0x2d,\n  0xfc,\n  0x1d,\n  0x08,\n  0x53,\n  0x03,\n  0x90,\n  0x4d,\n  0x4e,\n  0x84,\n  0x99,\n  0xe4,\n  0xce,\n  0xd9,\n  0x91,\n  0xdd,\n  0xb6,\n  0x85,\n  0x48,\n  0x8b,\n  0x29,\n  0x6e,\n  0xac,\n  0xcd,\n  0xc1,\n  0xf8,\n  0x1e,\n  0x73,\n  0x43,\n  0x69,\n  0xc6,\n  0xb5,\n  0xbd,\n  0xfd,\n  0x39,\n  0x63,\n  0x20,\n  0xd4,\n  0x38,\n  0x76,\n  0x7d,\n  0xb2,\n  0xa7,\n  0xcf,\n  0xed,\n  0x57,\n  0xc5,\n  0xf3,\n  0x2c,\n  0xbb,\n  0x14,\n  0x21,\n  0x06,\n  0x55,\n  0x9b,\n  0xe3,\n  0xef,\n  0x5e,\n  0x31,\n  0x4f,\n  0x7f,\n  0x5a,\n  0xa4,\n  0x0d,\n  0x82,\n  0x51,\n  0x49,\n  0x5f,\n  0xba,\n  0x58,\n  0x1c,\n  0x4a,\n  0x16,\n  0xd5,\n  0x17,\n  0xa8,\n  0x92,\n  0x24,\n  0x1f,\n  0x8c,\n  0xff,\n  0xd8,\n  0xae,\n  0x2e,\n  0x01,\n  0xd3,\n  0xad,\n  0x3b,\n  0x4b,\n  0xda,\n  0x46,\n  0xeb,\n  0xc9,\n  0xde,\n  0x9a,\n  0x8f,\n  0x87,\n  0xd7,\n  0x3a,\n  0x80,\n  0x6f,\n  0x2f,\n  0xc8,\n  0xb1,\n  0xb4,\n  0x37,\n  0xf7,\n  0x0a,\n  0x22,\n  0x13,\n  0x28,\n  0x7c,\n  0xcc,\n  0x3c,\n  0x89,\n  0xc7,\n  0xc3,\n  0x96,\n  0x56,\n  0x07,\n  0xbf,\n  0x7e,\n  0xf0,\n  0x0b,\n  0x2b,\n  0x97,\n  0x52,\n  0x35,\n  0x41,\n  0x79,\n  0x61,\n  0xa6,\n  0x4c,\n  0x10,\n  0xfe,\n  0xbc,\n  0x26,\n  0x95,\n  0x88,\n  0x8a,\n  0xb0,\n  0xa3,\n  0xfb,\n  0xc0,\n  0x18,\n  0x94,\n  0xf2,\n  0xe1,\n  0xe5,\n  0xe9,\n  0x5d,\n  0xd0,\n  0xdc,\n  0x11,\n  0x66,\n  0x64,\n  0x5c,\n  0xec,\n  0x59,\n  0x42,\n  0x75,\n  0x12,\n  0xf5,\n  0x74,\n  0x9c,\n  0xaa,\n  0x23,\n  0x0e,\n  0x86,\n  0xab,\n  0xbe,\n  0x2a,\n  0x02,\n  0xe7,\n  0x67,\n  0xe6,\n  0x44,\n  0xa2,\n  0x6c,\n  0xc2,\n  0x93,\n  0x9f,\n  0xf1,\n  0xf6,\n  0xfa,\n  0x36,\n  0xd2,\n  0x50,\n  0x68,\n  0x9e,\n  0x62,\n  0x71,\n  0x15,\n  0x3d,\n  0xd6,\n  0x40,\n  0xc4,\n  0xe2,\n  0x0f,\n  0x8e,\n  0x83,\n  0x77,\n  0x6b,\n  0x25,\n  0x05,\n  0x3f,\n  0x0c,\n  0x30,\n  0xea,\n  0x70,\n  0xb7,\n  0xa1,\n  0xe8,\n  0xa9,\n  0x65,\n  0x8d,\n  0x27,\n  0x1a,\n  0xdb,\n  0x81,\n  0xb3,\n  0xa0,\n  0xf4,\n  0x45,\n  0x7a,\n  0x19,\n  0xdf,\n  0xee,\n  0x78,\n  0x34,\n  0x60]\nS1Table : [256][8]\nS1Table =\n  [0x55,\n  0xc2,\n  0x63,\n  0x71,\n  0x3b,\n  0xc8,\n  0x47,\n  0x86,\n  0x9f,\n  0x3c,\n  0xda,\n  0x5b,\n  0x29,\n  0xaa,\n  0xfd,\n  0x77,\n  0x8c,\n  0xc5,\n  0x94,\n  0x0c,\n  0xa6,\n  0x1a,\n  0x13,\n  0x00,\n  0xe3,\n  0xa8,\n  0x16,\n  0x72,\n  0x40,\n  0xf9,\n  0xf8,\n  0x42,\n  0x44,\n  0x26,\n  0x68,\n  0x96,\n  0x81,\n  0xd9,\n  0x45,\n  0x3e,\n  0x10,\n  0x76,\n  0xc6,\n  0xa7,\n  0x8b,\n  0x39,\n  0x43,\n  0xe1,\n  0x3a,\n  0xb5,\n  0x56,\n  0x2a,\n  0xc0,\n  0x6d,\n  0xb3,\n  0x05,\n  0x22,\n  0x66,\n  0xbf,\n  0xdc,\n  0x0b,\n  0xfa,\n  0x62,\n  0x48,\n  0xdd,\n  0x20,\n  0x11,\n  0x06,\n  0x36,\n  0xc9,\n  0xc1,\n  0xcf,\n  0xf6,\n  0x27,\n  0x52,\n  0xbb,\n  0x69,\n  0xf5,\n  0xd4,\n  0x87,\n  0x7f,\n  0x84,\n  0x4c,\n  0xd2,\n  0x9c,\n  0x57,\n  0xa4,\n  0xbc,\n  0x4f,\n  0x9a,\n  0xdf,\n  0xfe,\n  0xd6,\n  0x8d,\n  0x7a,\n  0xeb,\n  0x2b,\n  0x53,\n  0xd8,\n  0x5c,\n  0xa1,\n  0x14,\n  0x17,\n  0xfb,\n  0x23,\n  0xd5,\n  0x7d,\n  0x30,\n  0x67,\n  0x73,\n  0x08,\n  0x09,\n  0xee,\n  0xb7,\n  0x70,\n  0x3f,\n  0x61,\n  0xb2,\n  0x19,\n  0x8e,\n  0x4e,\n  0xe5,\n  0x4b,\n  0x93,\n  0x8f,\n  0x5d,\n  0xdb,\n  0xa9,\n  0xad,\n  0xf1,\n  0xae,\n  0x2e,\n  0xcb,\n  0x0d,\n  0xfc,\n  0xf4,\n  0x2d,\n  0x46,\n  0x6e,\n  0x1d,\n  0x97,\n  0xe8,\n  0xd1,\n  0xe9,\n  0x4d,\n  0x37,\n  0xa5,\n  0x75,\n  0x5e,\n  0x83,\n  0x9e,\n  0xab,\n  0x82,\n  0x9d,\n  0xb9,\n  0x1c,\n  0xe0,\n  0xcd,\n  0x49,\n  0x89,\n  0x01,\n  0xb6,\n  0xbd,\n  0x58,\n  0x24,\n  0xa2,\n  0x5f,\n  0x38,\n  0x78,\n  0x99,\n  0x15,\n  0x90,\n  0x50,\n  0xb8,\n  0x95,\n  0xe4,\n  0xd0,\n  0x91,\n  0xc7,\n  0xce,\n  0xed,\n  0x0f,\n  0xb4,\n  0x6f,\n  0xa0,\n  0xcc,\n  0xf0,\n  0x02,\n  0x4a,\n  0x79,\n  0xc3,\n  0xde,\n  0xa3,\n  0xef,\n  0xea,\n  0x51,\n  0xe6,\n  0x6b,\n  0x18,\n  0xec,\n  0x1b,\n  0x2c,\n  0x80,\n  0xf7,\n  0x74,\n  0xe7,\n  0xff,\n  0x21,\n  0x5a,\n  0x6a,\n  0x54,\n  0x1e,\n  0x41,\n  0x31,\n  0x92,\n  0x35,\n  0xc4,\n  0x33,\n  0x07,\n  0x0a,\n  0xba,\n  0x7e,\n  0x0e,\n  0x34,\n  0x88,\n  0xb1,\n  0x98,\n  0x7c,\n  0xf3,\n  0x3d,\n  0x60,\n  0x6c,\n  0x7b,\n  0xca,\n  0xd3,\n  0x1f,\n  0x32,\n  0x65,\n  0x04,\n  0x28,\n  0x64,\n  0xbe,\n  0x85,\n  0x9b,\n  0x2f,\n  0x59,\n  0x8a,\n  0xd7,\n  0xb0,\n  0x25,\n  0xac,\n  0xaf,\n  0x12,\n  0x03,\n  0xe2,\n  0xf2]\nL1 : [32] -> [32]\nL1 X = X ^ X <<< 2 ^ X <<< 10 ^ X <<< 18 ^ X <<< 24\nL2 : [32] -> [32]\nL2 X = X ^ X <<< 8 ^ X <<< 14 ^ X <<< 22 ^ X <<< 30\nLoadKey : ([128], [128]) -> LFSR\nLoadKey (key, iv) =\n  [k # d # i | k <- ks\n             | i <- is\n             | d <- ds]\n  where\n    ks : [16][8]\n    ks = split key\n    is : [16][8]\n    is = split iv\n    ds : [16][15]\n    ds =\n      [0b100010011010111,\n      0b010011010111100,\n      0b110001001101011,\n      0b001001101011110,\n      0b101011110001001,\n      0b011010111100010,\n      0b111000100110101,\n      0b000100110101111,\n      0b100110101111000,\n      0b010111100010011,\n      0b110101111000100,\n      0b001101011110001,\n      0b101111000100110,\n      0b011110001001101,\n      0b111100010011010,\n      0b100011110101100]\ntype ZUC = (LFSR, [32], [32])\nInitializeZUC : ([128], [128]) -> [inf]ZUC\nInitializeZUC (key, iv) =\n  outs\n  where\n    initLFSR = LoadKey (key, iv)\n    outs = [(initLFSR, 0, 0)] # [step out | out <- outs]\n    step (lfsr, R1, R2) =\n      (LFSRWithInitializationMode (drop (w >> 1), lfsr), R1', R2')\n      where\n        [X0, X1, X2, X3] = BitReorganization lfsr\n        (w', [R1', R2']) = F ([X0, X1, X2], [R1, R2])\n        w = if version1_5 then w' else w' ^ X3\nWorkingStage : ZUC -> ZUC\nWorkingStage (lfsr, R1, R2) =\n  (lfsr', R1', R2')\n  where\n    [X0, X1, X2, _] = BitReorganization lfsr\n    (_, [R1', R2']) = F ([X0, X1, X2], [R1, R2])\n    lfsr' = LFSRWithWorkMode lfsr\nProductionStage : ZUC -> ([32], ZUC)\nProductionStage (lfsr, R1, R2) =\n  (w ^ X3, (lfsr', R1', R2'))\n  where\n    [X0, X1, X2, X3] = BitReorganization lfsr\n    (w, [R1', R2']) = F ([X0, X1, X2], [R1, R2])\n    lfsr' = LFSRWithWorkMode lfsr\nZUC : [128] -> [128] -> [inf][32]\nZUC key iv =\n  tail [w | (w, _) <- zucs]\n  where\n    initZuc = WorkingStage (InitializeZUC (key, iv) @ 32)\n    zucs =\n      [(zero, initZuc)] # [ProductionStage zuc | (_, zuc) <- zucs]\n\/* pragma ZUC_TestVectors : property *\/\nZUC_TestVectors =\n  t1 \/\\ t2 \/\\ t3 \/\\ t4\n  where\n    t1 = take (ZUC zero zero) == [0x27bede74, 0x018082da]\n    t2 = take (ZUC (~zero) (~zero)) == [0x0657cfa0, 0x7096398b]\n    t3 =\n      take\n        (ZUC\n          (join\n            [0x3d,\n            0x4c,\n            0x4b,\n            0xe9,\n            0x6a,\n            0x82,\n            0xfd,\n            0xae,\n            0xb5,\n            0x8f,\n            0x64,\n            0x1d,\n            0xb1,\n            0x7b,\n            0x45,\n            0x5b])\n          (join\n            [0x84,\n            0x31,\n            0x9a,\n            0xa8,\n            0xde,\n            0x69,\n            0x15,\n            0xca,\n            0x1f,\n            0x6b,\n            0xda,\n            0x6b,\n            0xfb,\n            0xd8,\n            0xc7,\n            0x66])) == [0x14f1c272, 0x3279c419]\n    t4 =\n      take ks # [ks @ 1999] == [0xed4400e7, 0x0633e5c5, 0x7a574cdb]\n      where\n        ks =\n          ZUC\n            (join\n              [0x4d,\n              0x32,\n              0x0b,\n              0xfa,\n              0xd4,\n              0xc2,\n              0x85,\n              0xbf,\n              0xd6,\n              0xb8,\n              0xbd,\n              0x00,\n              0xf3,\n              0x9d,\n              0x8b,\n              0x41])\n            (join\n              [0x52,\n              0x95,\n              0x9d,\n              0xab,\n              0xa0,\n              0xbf,\n              0x17,\n              0x6e,\n              0xce,\n              0x2d,\n              0xc3,\n              0x15,\n              0x04,\n              0x9e,\n              0xb5,\n              0x74])\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/ZUC\/045_LoadKey_TestVectors.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property `LoadKey_TestVectors` that checks the ZUC stream cipher `LoadKey : ([128], [128]) -> [16][31]` key\/IV loading function against the four given known-answer test vectors for keys, IVs, and expected initial LFSR states, and ensures the property holds for all provided vectors."},{"role":"assistant","content":"```cryptol\ntype LFSR = [16][31]\nLoadKey : ([128], [128]) -> LFSR\nLoadKey (key, iv) =\n  [k # d # i | k <- ks\n             | i <- is\n             | d <- ds]\n  where\n    ks : [16][8]\n    ks = split key\n    is : [16][8]\n    is = split iv\n    ds : [16][15]\n    ds =\n      [0b100010011010111,\n      0b010011010111100,\n      0b110001001101011,\n      0b001001101011110,\n      0b101011110001001,\n      0b011010111100010,\n      0b111000100110101,\n      0b000100110101111,\n      0b100110101111000,\n      0b010111100010011,\n      0b110101111000100,\n      0b001101011110001,\n      0b101111000100110,\n      0b011110001001101,\n      0b111100010011010,\n      0b100011110101100]\n\/* pragma LoadKey_TestVectors : property *\/\nLoadKey_TestVectors =\n  [LoadKey (k, iv) == lfsr0 | k <- ks\n                            | iv <- ivs\n                            | lfsr0 <- lfsr0s] == ~0\n  where\n    ks =\n      [0,\n      ~0,\n      0x3d4c4be96a82fdaeb58f641db17b455b,\n      0x4d320bfad4c285bfd6b8bd00f39d8b41]\n    ivs =\n      [0,\n      ~0,\n      0x84319aa8de6915ca1f6bda6bfbd8c766,\n      0x52959daba0bf176ece2dc315049eb574]\n    lfsr0s =\n      [[`4511488,\n      `2538496,\n      `6449920,\n      `1269248,\n      `5736704,\n      `3531264,\n      `7419136,\n      `634624,\n      `5076992,\n      `3085056,\n      `7062528,\n      `1765632,\n      `6170112,\n      `3951872,\n      `7903744,\n      `4697088],\n      [`2143606783,\n      `2141633791,\n      `2145545215,\n      `2140364543,\n      `2144831999,\n      `2142626559,\n      `2146514431,\n      `2139729919,\n      `2144172287,\n      `2142180351,\n      `2146157823,\n      `2140860927,\n      `2145265407,\n      `2143047167,\n      `2146999039,\n      `2143792383],\n      [`516216708,\n      `640072753,\n      `635595674,\n      `1955815080,\n      `894929374,\n      `1094050409,\n      `2129736981,\n      `1460252618,\n      `1523415071,\n      `1202656107,\n      `845923546,\n      `245035371,\n      `1490953979,\n      `1035750872,\n      `586717895,\n      `768060518],\n      [`650434386,\n      `421969045,\n      `98724765,\n      `2098421419,\n      `1784121760,\n      `1630921407,\n      `1123104023,\n      `1602858862,\n      `1800239310,\n      `1546588973,\n      `1592509635,\n      `1765653,\n      `2044601860,\n      `1320963486,\n      `1173920437,\n      `549956724]]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/008_cdround.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that specifies the ChaCha20 cipher\u2019s column-diagonal (cdround) operation over a 16-word 32-bit state, including the qround function on four 32-bit words and the Round type [16][32], suitable for use in further ChaCha20 verification properties."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/010_core.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of the ChaCha20 core permutation, including the types Round = [16][32] and Block = [64][8], and the functions qround : [4][32] -> [4][32], cdround : Round -> Round, iterate : {a} (a -> a) -> a -> [inf]a, blocked : Round -> Block, and core : Round -> Block that applies 10 cdround iterations, adds the result to the input state, and outputs the state as bytes."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/012_kexp.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for the ChaCha20 key expansion function `kexp : [32][8] -> [32] -> [12][8] -> [16][32]` that builds the initial 4x4 state matrix from a 256-bit key, 32-bit counter, and 96-bit nonce using the standard ChaCha20 constants and byte-to-word packing as in RFC 8439, including the helper `rjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b` and `map` used for grouping and joining bytes into 32-bit words."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/014_iround.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type alias Round = [16][32], the function iterate : {a} (a -> a) -> a -> [inf]a as an infinite stream iterator, and the function iround : [64] -> Round -> Round that returns the n-th iterated state of a ChaCha20 round where each iteration increments word x12 by 1, matching the behavior described here."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\niround : [64] -> Round -> Round\niround n r =\n  (iterate once r) @ n\n  where\n    once\n      [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n       x15] =\n      [x0,\n      x1,\n      x2,\n      x3,\n      x4,\n      x5,\n      x6,\n      x7,\n      x8,\n      x9,\n      x10,\n      x11,\n      x12 + 1,\n      x13,\n      x14,\n      x15]\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/020_rfctest03.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property rfctest03 that verifies the given ChaCha20 stream cipher implementation (using qround, cdround, core, kexp, iround, stream, and encrypt over types Round, Block, Key, Nonce, and Counter) correctly encrypts the specified msg with the given key and counter to produce the expected out test vector."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\niround : [64] -> Round -> Round\niround n r =\n  (iterate once r) @ n\n  where\n    once\n      [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n       x15] =\n      [x0,\n      x1,\n      x2,\n      x3,\n      x4,\n      x5,\n      x6,\n      x7,\n      x8,\n      x9,\n      x10,\n      x11,\n      x12 + 1,\n      x13,\n      x14,\n      x15]\nstream : {n} (fin n) => Key -> Counter -> Nonce -> [n][8]\nstream k c n =\n  take`{n} (join rounds)\n  where\n    key = kexp k c n\n    rounds = [core (iround i key) | i <- [0, 1 ...]]\nencrypt : {n}\n  (fin n) =>\n    Key -> Counter -> Nonce -> [n][8] -> [n][8]\nencrypt k c n m = m ^ (stream k c n)\nrfctest03 =\n  encrypt key 42 (zero # [2]) msg == out\n  where\n    key =\n      [0x1c,\n      0x92,\n      0x40,\n      0xa5,\n      0xeb,\n      0x55,\n      0xd3,\n      0x8a,\n      0xf3,\n      0x33,\n      0x88,\n      0x86,\n      0x04,\n      0xf6,\n      0xb5,\n      0xf0,\n      0x47,\n      0x39,\n      0x17,\n      0xc1,\n      0x40,\n      0x2b,\n      0x80,\n      0x09,\n      0x9d,\n      0xca,\n      0x5c,\n      0xbc,\n      0x20,\n      0x70,\n      0x75,\n      0xc0]\n    out =\n      [0x27,\n      0x54,\n      0x77,\n      0x61,\n      0x73,\n      0x20,\n      0x62,\n      0x72,\n      0x69,\n      0x6c,\n      0x6c,\n      0x69,\n      0x67,\n      0x2c,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x73,\n      0x6c,\n      0x69,\n      0x74,\n      0x68,\n      0x79,\n      0x20,\n      0x74,\n      0x6f,\n      0x76,\n      0x65,\n      0x73,\n      0x0a,\n      0x44,\n      0x69,\n      0x64,\n      0x20,\n      0x67,\n      0x79,\n      0x72,\n      0x65,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x67,\n      0x69,\n      0x6d,\n      0x62,\n      0x6c,\n      0x65,\n      0x20,\n      0x69,\n      0x6e,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x77,\n      0x61,\n      0x62,\n      0x65,\n      0x3a,\n      0x0a,\n      0x41,\n      0x6c,\n      0x6c,\n      0x20,\n      0x6d,\n      0x69,\n      0x6d,\n      0x73,\n      0x79,\n      0x20,\n      0x77,\n      0x65,\n      0x72,\n      0x65,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x62,\n      0x6f,\n      0x72,\n      0x6f,\n      0x67,\n      0x6f,\n      0x76,\n      0x65,\n      0x73,\n      0x2c,\n      0x0a,\n      0x41,\n      0x6e,\n      0x64,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x6d,\n      0x6f,\n      0x6d,\n      0x65,\n      0x20,\n      0x72,\n      0x61,\n      0x74,\n      0x68,\n      0x73,\n      0x20,\n      0x6f,\n      0x75,\n      0x74,\n      0x67,\n      0x72,\n      0x61,\n      0x62,\n      0x65,\n      0x2e]\n    msg =\n      [0x62,\n      0xe6,\n      0x34,\n      0x7f,\n      0x95,\n      0xed,\n      0x87,\n      0xa4,\n      0x5f,\n      0xfa,\n      0xe7,\n      0x42,\n      0x6f,\n      0x27,\n      0xa1,\n      0xdf,\n      0x5f,\n      0xb6,\n      0x91,\n      0x10,\n      0x04,\n      0x4c,\n      0x0d,\n      0x73,\n      0x11,\n      0x8e,\n      0xff,\n      0xa9,\n      0x5b,\n      0x01,\n      0xe5,\n      0xcf,\n      0x16,\n      0x6d,\n      0x3d,\n      0xf2,\n      0xd7,\n      0x21,\n      0xca,\n      0xf9,\n      0xb2,\n      0x1e,\n      0x5f,\n      0xb1,\n      0x4c,\n      0x61,\n      0x68,\n      0x71,\n      0xfd,\n      0x84,\n      0xc5,\n      0x4f,\n      0x9d,\n      0x65,\n      0xb2,\n      0x83,\n      0x19,\n      0x6c,\n      0x7f,\n      0xe4,\n      0xf6,\n      0x05,\n      0x53,\n      0xeb,\n      0xf3,\n      0x9c,\n      0x64,\n      0x02,\n      0xc4,\n      0x22,\n      0x34,\n      0xe3,\n      0x2a,\n      0x35,\n      0x6b,\n      0x3e,\n      0x76,\n      0x43,\n      0x12,\n      0xa6,\n      0x1a,\n      0x55,\n      0x32,\n      0x05,\n      0x57,\n      0x16,\n      0xea,\n      0xd6,\n      0x96,\n      0x25,\n      0x68,\n      0xf8,\n      0x7d,\n      0x3f,\n      0x3f,\n      0x77,\n      0x04,\n      0xc6,\n      0xa8,\n      0xd1,\n      0xbc,\n      0xd1,\n      0xbf,\n      0x4d,\n      0x50,\n      0xd6,\n      0x15,\n      0x4b,\n      0x6d,\n      0xa7,\n      0x31,\n      0xb1,\n      0x87,\n      0xb5,\n      0x8d,\n      0xfd,\n      0x72,\n      0x8a,\n      0xfa,\n      0x36,\n      0x75,\n      0x7a,\n      0x79,\n      0x7a,\n      0xc1,\n      0x88,\n      0xd1]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/021_rfctest02.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of the ChaCha20 stream cipher with types Round = [16][32], Block = [64][8], Key = [32][8], Nonce = [12][8], Counter = [32], functions qround, cdround, kexp, iround, core, stream, encrypt, and a property rfctest02 that checks encrypt (zero # [1]) 1 (zero # [2]) msg equals the given RFC test vector out for the provided msg bytes."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\niround : [64] -> Round -> Round\niround n r =\n  (iterate once r) @ n\n  where\n    once\n      [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n       x15] =\n      [x0,\n      x1,\n      x2,\n      x3,\n      x4,\n      x5,\n      x6,\n      x7,\n      x8,\n      x9,\n      x10,\n      x11,\n      x12 + 1,\n      x13,\n      x14,\n      x15]\nstream : {n} (fin n) => Key -> Counter -> Nonce -> [n][8]\nstream k c n =\n  take`{n} (join rounds)\n  where\n    key = kexp k c n\n    rounds = [core (iround i key) | i <- [0, 1 ...]]\nencrypt : {n}\n  (fin n) =>\n    Key -> Counter -> Nonce -> [n][8] -> [n][8]\nencrypt k c n m = m ^ (stream k c n)\nrfctest02 =\n  encrypt (zero # [1]) 1 (zero # [2]) msg == out\n  where\n    out =\n      [0xa3,\n      0xfb,\n      0xf0,\n      0x7d,\n      0xf3,\n      0xfa,\n      0x2f,\n      0xde,\n      0x4f,\n      0x37,\n      0x6c,\n      0xa2,\n      0x3e,\n      0x82,\n      0x73,\n      0x70,\n      0x41,\n      0x60,\n      0x5d,\n      0x9f,\n      0x4f,\n      0x4f,\n      0x57,\n      0xbd,\n      0x8c,\n      0xff,\n      0x2c,\n      0x1d,\n      0x4b,\n      0x79,\n      0x55,\n      0xec,\n      0x2a,\n      0x97,\n      0x94,\n      0x8b,\n      0xd3,\n      0x72,\n      0x29,\n      0x15,\n      0xc8,\n      0xf3,\n      0xd3,\n      0x37,\n      0xf7,\n      0xd3,\n      0x70,\n      0x05,\n      0x0e,\n      0x9e,\n      0x96,\n      0xd6,\n      0x47,\n      0xb7,\n      0xc3,\n      0x9f,\n      0x56,\n      0xe0,\n      0x31,\n      0xca,\n      0x5e,\n      0xb6,\n      0x25,\n      0x0d,\n      0x40,\n      0x42,\n      0xe0,\n      0x27,\n      0x85,\n      0xec,\n      0xec,\n      0xfa,\n      0x4b,\n      0x4b,\n      0xb5,\n      0xe8,\n      0xea,\n      0xd0,\n      0x44,\n      0x0e,\n      0x20,\n      0xb6,\n      0xe8,\n      0xdb,\n      0x09,\n      0xd8,\n      0x81,\n      0xa7,\n      0xc6,\n      0x13,\n      0x2f,\n      0x42,\n      0x0e,\n      0x52,\n      0x79,\n      0x50,\n      0x42,\n      0xbd,\n      0xfa,\n      0x77,\n      0x73,\n      0xd8,\n      0xa9,\n      0x05,\n      0x14,\n      0x47,\n      0xb3,\n      0x29,\n      0x1c,\n      0xe1,\n      0x41,\n      0x1c,\n      0x68,\n      0x04,\n      0x65,\n      0x55,\n      0x2a,\n      0xa6,\n      0xc4,\n      0x05,\n      0xb7,\n      0x76,\n      0x4d,\n      0x5e,\n      0x87,\n      0xbe,\n      0xa8,\n      0x5a,\n      0xd0,\n      0x0f,\n      0x84,\n      0x49,\n      0xed,\n      0x8f,\n      0x72,\n      0xd0,\n      0xd6,\n      0x62,\n      0xab,\n      0x05,\n      0x26,\n      0x91,\n      0xca,\n      0x66,\n      0x42,\n      0x4b,\n      0xc8,\n      0x6d,\n      0x2d,\n      0xf8,\n      0x0e,\n      0xa4,\n      0x1f,\n      0x43,\n      0xab,\n      0xf9,\n      0x37,\n      0xd3,\n      0x25,\n      0x9d,\n      0xc4,\n      0xb2,\n      0xd0,\n      0xdf,\n      0xb4,\n      0x8a,\n      0x6c,\n      0x91,\n      0x39,\n      0xdd,\n      0xd7,\n      0xf7,\n      0x69,\n      0x66,\n      0xe9,\n      0x28,\n      0xe6,\n      0x35,\n      0x55,\n      0x3b,\n      0xa7,\n      0x6c,\n      0x5c,\n      0x87,\n      0x9d,\n      0x7b,\n      0x35,\n      0xd4,\n      0x9e,\n      0xb2,\n      0xe6,\n      0x2b,\n      0x08,\n      0x71,\n      0xcd,\n      0xac,\n      0x63,\n      0x89,\n      0x39,\n      0xe2,\n      0x5e,\n      0x8a,\n      0x1e,\n      0x0e,\n      0xf9,\n      0xd5,\n      0x28,\n      0x0f,\n      0xa8,\n      0xca,\n      0x32,\n      0x8b,\n      0x35,\n      0x1c,\n      0x3c,\n      0x76,\n      0x59,\n      0x89,\n      0xcb,\n      0xcf,\n      0x3d,\n      0xaa,\n      0x8b,\n      0x6c,\n      0xcc,\n      0x3a,\n      0xaf,\n      0x9f,\n      0x39,\n      0x79,\n      0xc9,\n      0x2b,\n      0x37,\n      0x20,\n      0xfc,\n      0x88,\n      0xdc,\n      0x95,\n      0xed,\n      0x84,\n      0xa1,\n      0xbe,\n      0x05,\n      0x9c,\n      0x64,\n      0x99,\n      0xb9,\n      0xfd,\n      0xa2,\n      0x36,\n      0xe7,\n      0xe8,\n      0x18,\n      0xb0,\n      0x4b,\n      0x0b,\n      0xc3,\n      0x9c,\n      0x1e,\n      0x87,\n      0x6b,\n      0x19,\n      0x3b,\n      0xfe,\n      0x55,\n      0x69,\n      0x75,\n      0x3f,\n      0x88,\n      0x12,\n      0x8c,\n      0xc0,\n      0x8a,\n      0xaa,\n      0x9b,\n      0x63,\n      0xd1,\n      0xa1,\n      0x6f,\n      0x80,\n      0xef,\n      0x25,\n      0x54,\n      0xd7,\n      0x18,\n      0x9c,\n      0x41,\n      0x1f,\n      0x58,\n      0x69,\n      0xca,\n      0x52,\n      0xc5,\n      0xb8,\n      0x3f,\n      0xa3,\n      0x6f,\n      0xf2,\n      0x16,\n      0xb9,\n      0xc1,\n      0xd3,\n      0x00,\n      0x62,\n      0xbe,\n      0xbc,\n      0xfd,\n      0x2d,\n      0xc5,\n      0xbc,\n      0xe0,\n      0x91,\n      0x19,\n      0x34,\n      0xfd,\n      0xa7,\n      0x9a,\n      0x86,\n      0xf6,\n      0xe6,\n      0x98,\n      0xce,\n      0xd7,\n      0x59,\n      0xc3,\n      0xff,\n      0x9b,\n      0x64,\n      0x77,\n      0x33,\n      0x8f,\n      0x3d,\n      0xa4,\n      0xf9,\n      0xcd,\n      0x85,\n      0x14,\n      0xea,\n      0x99,\n      0x82,\n      0xcc,\n      0xaf,\n      0xb3,\n      0x41,\n      0xb2,\n      0x38,\n      0x4d,\n      0xd9,\n      0x02,\n      0xf3,\n      0xd1,\n      0xab,\n      0x7a,\n      0xc6,\n      0x1d,\n      0xd2,\n      0x9c,\n      0x6f,\n      0x21,\n      0xba,\n      0x5b,\n      0x86,\n      0x2f,\n      0x37,\n      0x30,\n      0xe3,\n      0x7c,\n      0xfd,\n      0xc4,\n      0xfd,\n      0x80,\n      0x6c,\n      0x22,\n      0xf2,\n      0x21]\n    msg =\n      [0x41,\n      0x6e,\n      0x79,\n      0x20,\n      0x73,\n      0x75,\n      0x62,\n      0x6d,\n      0x69,\n      0x73,\n      0x73,\n      0x69,\n      0x6f,\n      0x6e,\n      0x20,\n      0x74,\n      0x6f,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x69,\n      0x6e,\n      0x74,\n      0x65,\n      0x6e,\n      0x64,\n      0x65,\n      0x64,\n      0x20,\n      0x62,\n      0x79,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x43,\n      0x6f,\n      0x6e,\n      0x74,\n      0x72,\n      0x69,\n      0x62,\n      0x75,\n      0x74,\n      0x6f,\n      0x72,\n      0x20,\n      0x66,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x75,\n      0x62,\n      0x6c,\n      0x69,\n      0x63,\n      0x61,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x61,\n      0x6c,\n      0x6c,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x61,\n      0x72,\n      0x74,\n      0x20,\n      0x6f,\n      0x66,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x49,\n      0x6e,\n      0x74,\n      0x65,\n      0x72,\n      0x6e,\n      0x65,\n      0x74,\n      0x2d,\n      0x44,\n      0x72,\n      0x61,\n      0x66,\n      0x74,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x52,\n      0x46,\n      0x43,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x61,\n      0x6e,\n      0x79,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x20,\n      0x6d,\n      0x61,\n      0x64,\n      0x65,\n      0x20,\n      0x77,\n      0x69,\n      0x74,\n      0x68,\n      0x69,\n      0x6e,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x63,\n      0x6f,\n      0x6e,\n      0x74,\n      0x65,\n      0x78,\n      0x74,\n      0x20,\n      0x6f,\n      0x66,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x61,\n      0x63,\n      0x74,\n      0x69,\n      0x76,\n      0x69,\n      0x74,\n      0x79,\n      0x20,\n      0x69,\n      0x73,\n      0x20,\n      0x63,\n      0x6f,\n      0x6e,\n      0x73,\n      0x69,\n      0x64,\n      0x65,\n      0x72,\n      0x65,\n      0x64,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x22,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x43,\n      0x6f,\n      0x6e,\n      0x74,\n      0x72,\n      0x69,\n      0x62,\n      0x75,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x22,\n      0x2e,\n      0x20,\n      0x53,\n      0x75,\n      0x63,\n      0x68,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x73,\n      0x20,\n      0x69,\n      0x6e,\n      0x63,\n      0x6c,\n      0x75,\n      0x64,\n      0x65,\n      0x20,\n      0x6f,\n      0x72,\n      0x61,\n      0x6c,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x73,\n      0x20,\n      0x69,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x73,\n      0x65,\n      0x73,\n      0x73,\n      0x69,\n      0x6f,\n      0x6e,\n      0x73,\n      0x2c,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x77,\n      0x65,\n      0x6c,\n      0x6c,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x77,\n      0x72,\n      0x69,\n      0x74,\n      0x74,\n      0x65,\n      0x6e,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x65,\n      0x6c,\n      0x65,\n      0x63,\n      0x74,\n      0x72,\n      0x6f,\n      0x6e,\n      0x69,\n      0x63,\n      0x20,\n      0x63,\n      0x6f,\n      0x6d,\n      0x6d,\n      0x75,\n      0x6e,\n      0x69,\n      0x63,\n      0x61,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x73,\n      0x20,\n      0x6d,\n      0x61,\n      0x64,\n      0x65,\n      0x20,\n      0x61,\n      0x74,\n      0x20,\n      0x61,\n      0x6e,\n      0x79,\n      0x20,\n      0x74,\n      0x69,\n      0x6d,\n      0x65,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x6c,\n      0x61,\n      0x63,\n      0x65,\n      0x2c,\n      0x20,\n      0x77,\n      0x68,\n      0x69,\n      0x63,\n      0x68,\n      0x20,\n      0x61,\n      0x72,\n      0x65,\n      0x20,\n      0x61,\n      0x64,\n      0x64,\n      0x72,\n      0x65,\n      0x73,\n      0x73,\n      0x65,\n      0x64,\n      0x20,\n      0x74,\n      0x6f]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/022_rfctest01.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module implementing the ChaCha20 stream cipher with types Round, Block, Key, Nonce, and Counter, functions qround, cdround, kexp, iround, core, stream, and encrypt as in the excerpt, and a property rfctest01 that checks the encrypt function with all-zero key, counter, nonce, and plaintext yields the standard ChaCha20 RFC test vector keystream bytes given."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\niround : [64] -> Round -> Round\niround n r =\n  (iterate once r) @ n\n  where\n    once\n      [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n       x15] =\n      [x0,\n      x1,\n      x2,\n      x3,\n      x4,\n      x5,\n      x6,\n      x7,\n      x8,\n      x9,\n      x10,\n      x11,\n      x12 + 1,\n      x13,\n      x14,\n      x15]\nstream : {n} (fin n) => Key -> Counter -> Nonce -> [n][8]\nstream k c n =\n  take`{n} (join rounds)\n  where\n    key = kexp k c n\n    rounds = [core (iround i key) | i <- [0, 1 ...]]\nencrypt : {n}\n  (fin n) =>\n    Key -> Counter -> Nonce -> [n][8] -> [n][8]\nencrypt k c n m = m ^ (stream k c n)\nrfctest01 =\n  encrypt zero zero zero zero == [0x76,\n  0xb8,\n  0xe0,\n  0xad,\n  0xa0,\n  0xf1,\n  0x3d,\n  0x90,\n  0x40,\n  0x5d,\n  0x6a,\n  0xe5,\n  0x53,\n  0x86,\n  0xbd,\n  0x28,\n  0xbd,\n  0xd2,\n  0x19,\n  0xb8,\n  0xa0,\n  0x8d,\n  0xed,\n  0x1a,\n  0xa8,\n  0x36,\n  0xef,\n  0xcc,\n  0x8b,\n  0x77,\n  0x0d,\n  0xc7,\n  0xda,\n  0x41,\n  0x59,\n  0x7c,\n  0x51,\n  0x57,\n  0x48,\n  0x8d,\n  0x77,\n  0x24,\n  0xe0,\n  0x3f,\n  0xb8,\n  0xd8,\n  0x4a,\n  0x37,\n  0x6a,\n  0x43,\n  0xb8,\n  0xf4,\n  0x15,\n  0x18,\n  0xa1,\n  0x1c,\n  0xc3,\n  0x87,\n  0xb6,\n  0x69,\n  0xb2,\n  0xee,\n  0x65,\n  0x86]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/023_core02.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property core02 that specifies the ChaCha20 core function and key expansion (qround, cdround, core, kexp) correctly produce the known RFC 8439 test vector output block for the given 256-bit key, 32-bit counter value 1, and 96-bit nonce."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\ncore02 =\n  core (kexp k 1 n) == out\n  where\n    n =\n      [0x00,\n      0x00,\n      0x00,\n      0x09,\n      0x00,\n      0x00,\n      0x00,\n      0x4a,\n      0x00,\n      0x00,\n      0x00,\n      0x00]\n    k =\n      [0x00,\n      0x01,\n      0x02,\n      0x03,\n      0x04,\n      0x05,\n      0x06,\n      0x07,\n      0x08,\n      0x09,\n      0x0a,\n      0x0b,\n      0x0c,\n      0x0d,\n      0x0e,\n      0x0f,\n      0x10,\n      0x11,\n      0x12,\n      0x13,\n      0x14,\n      0x15,\n      0x16,\n      0x17,\n      0x18,\n      0x19,\n      0x1a,\n      0x1b,\n      0x1c,\n      0x1d,\n      0x1e,\n      0x1f]\n    out =\n      [0x10,\n      0xf1,\n      0xe7,\n      0xe4,\n      0xd1,\n      0x3b,\n      0x59,\n      0x15,\n      0x50,\n      0x0f,\n      0xdd,\n      0x1f,\n      0xa3,\n      0x20,\n      0x71,\n      0xc4,\n      0xc7,\n      0xd1,\n      0xf4,\n      0xc7,\n      0x33,\n      0xc0,\n      0x68,\n      0x03,\n      0x04,\n      0x22,\n      0xaa,\n      0x9a,\n      0xc3,\n      0xd4,\n      0x6c,\n      0x4e,\n      0xd2,\n      0x82,\n      0x64,\n      0x46,\n      0x07,\n      0x9f,\n      0xaa,\n      0x09,\n      0x14,\n      0xc2,\n      0xd7,\n      0x05,\n      0xd9,\n      0x8b,\n      0x02,\n      0xa2,\n      0xb5,\n      0x12,\n      0x9c,\n      0xd1,\n      0xde,\n      0x16,\n      0x4e,\n      0xb9,\n      0xcb,\n      0xd0,\n      0x83,\n      0xe8,\n      0xa2,\n      0x50,\n      0x3c,\n      0x4e]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/024_core01.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of the ChaCha20 key expansion function `kexp : [32][8] -> [32] -> [12][8] -> [16][32]` and a property `core01` that checks it produces the specified 16-word initial state for the given test key, counter = 1, and nonce from the ChaCha20 test vector."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\ncore01 =\n  kexp k 1 n == out\n  where\n    n =\n      [0x00,\n      0x00,\n      0x00,\n      0x09,\n      0x00,\n      0x00,\n      0x00,\n      0x4a,\n      0x00,\n      0x00,\n      0x00,\n      0x00]\n    k =\n      [0x00,\n      0x01,\n      0x02,\n      0x03,\n      0x04,\n      0x05,\n      0x06,\n      0x07,\n      0x08,\n      0x09,\n      0x0a,\n      0x0b,\n      0x0c,\n      0x0d,\n      0x0e,\n      0x0f,\n      0x10,\n      0x11,\n      0x12,\n      0x13,\n      0x14,\n      0x15,\n      0x16,\n      0x17,\n      0x18,\n      0x19,\n      0x1a,\n      0x1b,\n      0x1c,\n      0x1d,\n      0x1e,\n      0x1f]\n    out =\n      [0x61707865,\n      0x3320646e,\n      0x79622d32,\n      0x6b206574,\n      0x03020100,\n      0x07060504,\n      0x0b0a0908,\n      0x0f0e0d0c,\n      0x13121110,\n      0x17161514,\n      0x1b1a1918,\n      0x1f1e1d1c,\n      0x00000001,\n      0x09000000,\n      0x4a000000,\n      0x00000000]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/025_qround01.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function qround : [4][32] -> [4][32] implementing the ChaCha20 quarter-round operation as specified, and a property qround01 that asserts qround [0x11111111, 0x01020304, 0x9b8d6f43, 0x01234567] == [0xea2a92f4, 0xcb1cf8ce, 0x4581472e, 0x5881c4bb]."},{"role":"assistant","content":"```cryptol\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\nqround01 =\n  qround in == out\n  where\n    in = [0x11111111, 0x01020304, 0x9b8d6f43, 0x01234567]\n    out = [0xea2a92f4, 0xcb1cf8ce, 0x4581472e, 0x5881c4bb]\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/026_allTestsPass.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of the ChaCha20 stream cipher (types Round, Block, Key, Nonce, Counter; functions qround, cdround, kexp, core, iround, stream, encrypt) and the boolean property allTestsPass that is true exactly when the RFC 7539 test vectors qround01, core01, core02, rfctest01, rfctest02, and rfctest03 all hold."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\ntype Key = [32][8]\ntype Nonce = [12][8]\ntype Counter = [32]\nqround : [4][32] -> [4][32]\nqround [a0, b0, c0, d0] =\n  [a2, b4, c2, d4]\n  where\n    a1 = a0 + b0\n    d1 = d0 ^ a1\n    d2 = d1 <<< 16\n    c1 = c0 + d2\n    b1 = b0 ^ c1\n    b2 = b1 <<< 12\n    a2 = a1 + b2\n    d3 = d2 ^ a2\n    d4 = d3 <<< 8\n    c2 = c1 + d4\n    b3 = b2 ^ c2\n    b4 = b3 <<< 7\ncdround : Round -> Round\ncdround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [y0, y4, y8, y12] = qround [x0, x4, x8, x12]\n    [y1, y5, y9, y13] = qround [x1, x5, x9, x13]\n    [y2, y6, y10, y14] = qround [x2, x6, x10, x14]\n    [y3, y7, y11, y15] = qround [x3, x7, x11, x15]\n    [z0, z5, z10, z15] = qround [y0, y5, y10, y15]\n    [z1, z6, z11, z12] = qround [y1, y6, y11, y12]\n    [z2, z7, z8, z13] = qround [y2, y7, y8, y13]\n    [z3, z4, z9, z14] = qround [y3, y4, y9, y14]\ncore : Round -> Block\ncore x =\n  block\n  where\n    rounds = iterate cdround x\n    result = rounds @ 10\n    block = blocked (x + result)\nkexp : Key -> Counter -> Nonce -> Round\nkexp k c n =\n  [c0,\n  c1,\n  c2,\n  c3,\n  c4,\n  c5,\n  c6,\n  c7,\n  c8,\n  c9,\n  c10,\n  c11,\n  c12,\n  c13,\n  c14,\n  c15]\n  where\n    [c0, c1, c2, c3] =\n      [0x61707865, 0x3320646e, 0x79622d32, 0x6b206574]\n    [c4, c5, c6, c7] =\n      map rjoin (groupBy`{4} kslice1 : [4][4][8]) : [4][32]\n    [c8, c9, c10, c11] =\n      map rjoin (groupBy`{4} kslice2 : [4][4][8]) : [4][32]\n    kslice1 = k @@ ([0 .. 15] : [16][32])\n    kslice2 = k @@ ([16 .. 31] : [16][32])\n    [c12] = [c]\n    [c13, c14, c15] = map rjoin (groupBy`{4} n)\niround : [64] -> Round -> Round\niround n r =\n  (iterate once r) @ n\n  where\n    once\n      [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n       x15] =\n      [x0,\n      x1,\n      x2,\n      x3,\n      x4,\n      x5,\n      x6,\n      x7,\n      x8,\n      x9,\n      x10,\n      x11,\n      x12 + 1,\n      x13,\n      x14,\n      x15]\nstream : {n} (fin n) => Key -> Counter -> Nonce -> [n][8]\nstream k c n =\n  take`{n} (join rounds)\n  where\n    key = kexp k c n\n    rounds = [core (iround i key) | i <- [0, 1 ...]]\nencrypt : {n}\n  (fin n) =>\n    Key -> Counter -> Nonce -> [n][8] -> [n][8]\nencrypt k c n m = m ^ (stream k c n)\nrfctest03 =\n  encrypt key 42 (zero # [2]) msg == out\n  where\n    key =\n      [0x1c,\n      0x92,\n      0x40,\n      0xa5,\n      0xeb,\n      0x55,\n      0xd3,\n      0x8a,\n      0xf3,\n      0x33,\n      0x88,\n      0x86,\n      0x04,\n      0xf6,\n      0xb5,\n      0xf0,\n      0x47,\n      0x39,\n      0x17,\n      0xc1,\n      0x40,\n      0x2b,\n      0x80,\n      0x09,\n      0x9d,\n      0xca,\n      0x5c,\n      0xbc,\n      0x20,\n      0x70,\n      0x75,\n      0xc0]\n    out =\n      [0x27,\n      0x54,\n      0x77,\n      0x61,\n      0x73,\n      0x20,\n      0x62,\n      0x72,\n      0x69,\n      0x6c,\n      0x6c,\n      0x69,\n      0x67,\n      0x2c,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x73,\n      0x6c,\n      0x69,\n      0x74,\n      0x68,\n      0x79,\n      0x20,\n      0x74,\n      0x6f,\n      0x76,\n      0x65,\n      0x73,\n      0x0a,\n      0x44,\n      0x69,\n      0x64,\n      0x20,\n      0x67,\n      0x79,\n      0x72,\n      0x65,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x67,\n      0x69,\n      0x6d,\n      0x62,\n      0x6c,\n      0x65,\n      0x20,\n      0x69,\n      0x6e,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x77,\n      0x61,\n      0x62,\n      0x65,\n      0x3a,\n      0x0a,\n      0x41,\n      0x6c,\n      0x6c,\n      0x20,\n      0x6d,\n      0x69,\n      0x6d,\n      0x73,\n      0x79,\n      0x20,\n      0x77,\n      0x65,\n      0x72,\n      0x65,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x62,\n      0x6f,\n      0x72,\n      0x6f,\n      0x67,\n      0x6f,\n      0x76,\n      0x65,\n      0x73,\n      0x2c,\n      0x0a,\n      0x41,\n      0x6e,\n      0x64,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x6d,\n      0x6f,\n      0x6d,\n      0x65,\n      0x20,\n      0x72,\n      0x61,\n      0x74,\n      0x68,\n      0x73,\n      0x20,\n      0x6f,\n      0x75,\n      0x74,\n      0x67,\n      0x72,\n      0x61,\n      0x62,\n      0x65,\n      0x2e]\n    msg =\n      [0x62,\n      0xe6,\n      0x34,\n      0x7f,\n      0x95,\n      0xed,\n      0x87,\n      0xa4,\n      0x5f,\n      0xfa,\n      0xe7,\n      0x42,\n      0x6f,\n      0x27,\n      0xa1,\n      0xdf,\n      0x5f,\n      0xb6,\n      0x91,\n      0x10,\n      0x04,\n      0x4c,\n      0x0d,\n      0x73,\n      0x11,\n      0x8e,\n      0xff,\n      0xa9,\n      0x5b,\n      0x01,\n      0xe5,\n      0xcf,\n      0x16,\n      0x6d,\n      0x3d,\n      0xf2,\n      0xd7,\n      0x21,\n      0xca,\n      0xf9,\n      0xb2,\n      0x1e,\n      0x5f,\n      0xb1,\n      0x4c,\n      0x61,\n      0x68,\n      0x71,\n      0xfd,\n      0x84,\n      0xc5,\n      0x4f,\n      0x9d,\n      0x65,\n      0xb2,\n      0x83,\n      0x19,\n      0x6c,\n      0x7f,\n      0xe4,\n      0xf6,\n      0x05,\n      0x53,\n      0xeb,\n      0xf3,\n      0x9c,\n      0x64,\n      0x02,\n      0xc4,\n      0x22,\n      0x34,\n      0xe3,\n      0x2a,\n      0x35,\n      0x6b,\n      0x3e,\n      0x76,\n      0x43,\n      0x12,\n      0xa6,\n      0x1a,\n      0x55,\n      0x32,\n      0x05,\n      0x57,\n      0x16,\n      0xea,\n      0xd6,\n      0x96,\n      0x25,\n      0x68,\n      0xf8,\n      0x7d,\n      0x3f,\n      0x3f,\n      0x77,\n      0x04,\n      0xc6,\n      0xa8,\n      0xd1,\n      0xbc,\n      0xd1,\n      0xbf,\n      0x4d,\n      0x50,\n      0xd6,\n      0x15,\n      0x4b,\n      0x6d,\n      0xa7,\n      0x31,\n      0xb1,\n      0x87,\n      0xb5,\n      0x8d,\n      0xfd,\n      0x72,\n      0x8a,\n      0xfa,\n      0x36,\n      0x75,\n      0x7a,\n      0x79,\n      0x7a,\n      0xc1,\n      0x88,\n      0xd1]\nrfctest02 =\n  encrypt (zero # [1]) 1 (zero # [2]) msg == out\n  where\n    out =\n      [0xa3,\n      0xfb,\n      0xf0,\n      0x7d,\n      0xf3,\n      0xfa,\n      0x2f,\n      0xde,\n      0x4f,\n      0x37,\n      0x6c,\n      0xa2,\n      0x3e,\n      0x82,\n      0x73,\n      0x70,\n      0x41,\n      0x60,\n      0x5d,\n      0x9f,\n      0x4f,\n      0x4f,\n      0x57,\n      0xbd,\n      0x8c,\n      0xff,\n      0x2c,\n      0x1d,\n      0x4b,\n      0x79,\n      0x55,\n      0xec,\n      0x2a,\n      0x97,\n      0x94,\n      0x8b,\n      0xd3,\n      0x72,\n      0x29,\n      0x15,\n      0xc8,\n      0xf3,\n      0xd3,\n      0x37,\n      0xf7,\n      0xd3,\n      0x70,\n      0x05,\n      0x0e,\n      0x9e,\n      0x96,\n      0xd6,\n      0x47,\n      0xb7,\n      0xc3,\n      0x9f,\n      0x56,\n      0xe0,\n      0x31,\n      0xca,\n      0x5e,\n      0xb6,\n      0x25,\n      0x0d,\n      0x40,\n      0x42,\n      0xe0,\n      0x27,\n      0x85,\n      0xec,\n      0xec,\n      0xfa,\n      0x4b,\n      0x4b,\n      0xb5,\n      0xe8,\n      0xea,\n      0xd0,\n      0x44,\n      0x0e,\n      0x20,\n      0xb6,\n      0xe8,\n      0xdb,\n      0x09,\n      0xd8,\n      0x81,\n      0xa7,\n      0xc6,\n      0x13,\n      0x2f,\n      0x42,\n      0x0e,\n      0x52,\n      0x79,\n      0x50,\n      0x42,\n      0xbd,\n      0xfa,\n      0x77,\n      0x73,\n      0xd8,\n      0xa9,\n      0x05,\n      0x14,\n      0x47,\n      0xb3,\n      0x29,\n      0x1c,\n      0xe1,\n      0x41,\n      0x1c,\n      0x68,\n      0x04,\n      0x65,\n      0x55,\n      0x2a,\n      0xa6,\n      0xc4,\n      0x05,\n      0xb7,\n      0x76,\n      0x4d,\n      0x5e,\n      0x87,\n      0xbe,\n      0xa8,\n      0x5a,\n      0xd0,\n      0x0f,\n      0x84,\n      0x49,\n      0xed,\n      0x8f,\n      0x72,\n      0xd0,\n      0xd6,\n      0x62,\n      0xab,\n      0x05,\n      0x26,\n      0x91,\n      0xca,\n      0x66,\n      0x42,\n      0x4b,\n      0xc8,\n      0x6d,\n      0x2d,\n      0xf8,\n      0x0e,\n      0xa4,\n      0x1f,\n      0x43,\n      0xab,\n      0xf9,\n      0x37,\n      0xd3,\n      0x25,\n      0x9d,\n      0xc4,\n      0xb2,\n      0xd0,\n      0xdf,\n      0xb4,\n      0x8a,\n      0x6c,\n      0x91,\n      0x39,\n      0xdd,\n      0xd7,\n      0xf7,\n      0x69,\n      0x66,\n      0xe9,\n      0x28,\n      0xe6,\n      0x35,\n      0x55,\n      0x3b,\n      0xa7,\n      0x6c,\n      0x5c,\n      0x87,\n      0x9d,\n      0x7b,\n      0x35,\n      0xd4,\n      0x9e,\n      0xb2,\n      0xe6,\n      0x2b,\n      0x08,\n      0x71,\n      0xcd,\n      0xac,\n      0x63,\n      0x89,\n      0x39,\n      0xe2,\n      0x5e,\n      0x8a,\n      0x1e,\n      0x0e,\n      0xf9,\n      0xd5,\n      0x28,\n      0x0f,\n      0xa8,\n      0xca,\n      0x32,\n      0x8b,\n      0x35,\n      0x1c,\n      0x3c,\n      0x76,\n      0x59,\n      0x89,\n      0xcb,\n      0xcf,\n      0x3d,\n      0xaa,\n      0x8b,\n      0x6c,\n      0xcc,\n      0x3a,\n      0xaf,\n      0x9f,\n      0x39,\n      0x79,\n      0xc9,\n      0x2b,\n      0x37,\n      0x20,\n      0xfc,\n      0x88,\n      0xdc,\n      0x95,\n      0xed,\n      0x84,\n      0xa1,\n      0xbe,\n      0x05,\n      0x9c,\n      0x64,\n      0x99,\n      0xb9,\n      0xfd,\n      0xa2,\n      0x36,\n      0xe7,\n      0xe8,\n      0x18,\n      0xb0,\n      0x4b,\n      0x0b,\n      0xc3,\n      0x9c,\n      0x1e,\n      0x87,\n      0x6b,\n      0x19,\n      0x3b,\n      0xfe,\n      0x55,\n      0x69,\n      0x75,\n      0x3f,\n      0x88,\n      0x12,\n      0x8c,\n      0xc0,\n      0x8a,\n      0xaa,\n      0x9b,\n      0x63,\n      0xd1,\n      0xa1,\n      0x6f,\n      0x80,\n      0xef,\n      0x25,\n      0x54,\n      0xd7,\n      0x18,\n      0x9c,\n      0x41,\n      0x1f,\n      0x58,\n      0x69,\n      0xca,\n      0x52,\n      0xc5,\n      0xb8,\n      0x3f,\n      0xa3,\n      0x6f,\n      0xf2,\n      0x16,\n      0xb9,\n      0xc1,\n      0xd3,\n      0x00,\n      0x62,\n      0xbe,\n      0xbc,\n      0xfd,\n      0x2d,\n      0xc5,\n      0xbc,\n      0xe0,\n      0x91,\n      0x19,\n      0x34,\n      0xfd,\n      0xa7,\n      0x9a,\n      0x86,\n      0xf6,\n      0xe6,\n      0x98,\n      0xce,\n      0xd7,\n      0x59,\n      0xc3,\n      0xff,\n      0x9b,\n      0x64,\n      0x77,\n      0x33,\n      0x8f,\n      0x3d,\n      0xa4,\n      0xf9,\n      0xcd,\n      0x85,\n      0x14,\n      0xea,\n      0x99,\n      0x82,\n      0xcc,\n      0xaf,\n      0xb3,\n      0x41,\n      0xb2,\n      0x38,\n      0x4d,\n      0xd9,\n      0x02,\n      0xf3,\n      0xd1,\n      0xab,\n      0x7a,\n      0xc6,\n      0x1d,\n      0xd2,\n      0x9c,\n      0x6f,\n      0x21,\n      0xba,\n      0x5b,\n      0x86,\n      0x2f,\n      0x37,\n      0x30,\n      0xe3,\n      0x7c,\n      0xfd,\n      0xc4,\n      0xfd,\n      0x80,\n      0x6c,\n      0x22,\n      0xf2,\n      0x21]\n    msg =\n      [0x41,\n      0x6e,\n      0x79,\n      0x20,\n      0x73,\n      0x75,\n      0x62,\n      0x6d,\n      0x69,\n      0x73,\n      0x73,\n      0x69,\n      0x6f,\n      0x6e,\n      0x20,\n      0x74,\n      0x6f,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x69,\n      0x6e,\n      0x74,\n      0x65,\n      0x6e,\n      0x64,\n      0x65,\n      0x64,\n      0x20,\n      0x62,\n      0x79,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x43,\n      0x6f,\n      0x6e,\n      0x74,\n      0x72,\n      0x69,\n      0x62,\n      0x75,\n      0x74,\n      0x6f,\n      0x72,\n      0x20,\n      0x66,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x75,\n      0x62,\n      0x6c,\n      0x69,\n      0x63,\n      0x61,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x61,\n      0x6c,\n      0x6c,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x61,\n      0x72,\n      0x74,\n      0x20,\n      0x6f,\n      0x66,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x49,\n      0x6e,\n      0x74,\n      0x65,\n      0x72,\n      0x6e,\n      0x65,\n      0x74,\n      0x2d,\n      0x44,\n      0x72,\n      0x61,\n      0x66,\n      0x74,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x52,\n      0x46,\n      0x43,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x61,\n      0x6e,\n      0x79,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x20,\n      0x6d,\n      0x61,\n      0x64,\n      0x65,\n      0x20,\n      0x77,\n      0x69,\n      0x74,\n      0x68,\n      0x69,\n      0x6e,\n      0x20,\n      0x74,\n      0x68,\n      0x65,\n      0x20,\n      0x63,\n      0x6f,\n      0x6e,\n      0x74,\n      0x65,\n      0x78,\n      0x74,\n      0x20,\n      0x6f,\n      0x66,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x61,\n      0x63,\n      0x74,\n      0x69,\n      0x76,\n      0x69,\n      0x74,\n      0x79,\n      0x20,\n      0x69,\n      0x73,\n      0x20,\n      0x63,\n      0x6f,\n      0x6e,\n      0x73,\n      0x69,\n      0x64,\n      0x65,\n      0x72,\n      0x65,\n      0x64,\n      0x20,\n      0x61,\n      0x6e,\n      0x20,\n      0x22,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x43,\n      0x6f,\n      0x6e,\n      0x74,\n      0x72,\n      0x69,\n      0x62,\n      0x75,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x22,\n      0x2e,\n      0x20,\n      0x53,\n      0x75,\n      0x63,\n      0x68,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x73,\n      0x20,\n      0x69,\n      0x6e,\n      0x63,\n      0x6c,\n      0x75,\n      0x64,\n      0x65,\n      0x20,\n      0x6f,\n      0x72,\n      0x61,\n      0x6c,\n      0x20,\n      0x73,\n      0x74,\n      0x61,\n      0x74,\n      0x65,\n      0x6d,\n      0x65,\n      0x6e,\n      0x74,\n      0x73,\n      0x20,\n      0x69,\n      0x6e,\n      0x20,\n      0x49,\n      0x45,\n      0x54,\n      0x46,\n      0x20,\n      0x73,\n      0x65,\n      0x73,\n      0x73,\n      0x69,\n      0x6f,\n      0x6e,\n      0x73,\n      0x2c,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x77,\n      0x65,\n      0x6c,\n      0x6c,\n      0x20,\n      0x61,\n      0x73,\n      0x20,\n      0x77,\n      0x72,\n      0x69,\n      0x74,\n      0x74,\n      0x65,\n      0x6e,\n      0x20,\n      0x61,\n      0x6e,\n      0x64,\n      0x20,\n      0x65,\n      0x6c,\n      0x65,\n      0x63,\n      0x74,\n      0x72,\n      0x6f,\n      0x6e,\n      0x69,\n      0x63,\n      0x20,\n      0x63,\n      0x6f,\n      0x6d,\n      0x6d,\n      0x75,\n      0x6e,\n      0x69,\n      0x63,\n      0x61,\n      0x74,\n      0x69,\n      0x6f,\n      0x6e,\n      0x73,\n      0x20,\n      0x6d,\n      0x61,\n      0x64,\n      0x65,\n      0x20,\n      0x61,\n      0x74,\n      0x20,\n      0x61,\n      0x6e,\n      0x79,\n      0x20,\n      0x74,\n      0x69,\n      0x6d,\n      0x65,\n      0x20,\n      0x6f,\n      0x72,\n      0x20,\n      0x70,\n      0x6c,\n      0x61,\n      0x63,\n      0x65,\n      0x2c,\n      0x20,\n      0x77,\n      0x68,\n      0x69,\n      0x63,\n      0x68,\n      0x20,\n      0x61,\n      0x72,\n      0x65,\n      0x20,\n      0x61,\n      0x64,\n      0x64,\n      0x72,\n      0x65,\n      0x73,\n      0x73,\n      0x65,\n      0x64,\n      0x20,\n      0x74,\n      0x6f]\nrfctest01 =\n  encrypt zero zero zero zero == [0x76,\n  0xb8,\n  0xe0,\n  0xad,\n  0xa0,\n  0xf1,\n  0x3d,\n  0x90,\n  0x40,\n  0x5d,\n  0x6a,\n  0xe5,\n  0x53,\n  0x86,\n  0xbd,\n  0x28,\n  0xbd,\n  0xd2,\n  0x19,\n  0xb8,\n  0xa0,\n  0x8d,\n  0xed,\n  0x1a,\n  0xa8,\n  0x36,\n  0xef,\n  0xcc,\n  0x8b,\n  0x77,\n  0x0d,\n  0xc7,\n  0xda,\n  0x41,\n  0x59,\n  0x7c,\n  0x51,\n  0x57,\n  0x48,\n  0x8d,\n  0x77,\n  0x24,\n  0xe0,\n  0x3f,\n  0xb8,\n  0xd8,\n  0x4a,\n  0x37,\n  0x6a,\n  0x43,\n  0xb8,\n  0xf4,\n  0x15,\n  0x18,\n  0xa1,\n  0x1c,\n  0xc3,\n  0x87,\n  0xb6,\n  0x69,\n  0xb2,\n  0xee,\n  0x65,\n  0x86]\ncore02 =\n  core (kexp k 1 n) == out\n  where\n    n =\n      [0x00,\n      0x00,\n      0x00,\n      0x09,\n      0x00,\n      0x00,\n      0x00,\n      0x4a,\n      0x00,\n      0x00,\n      0x00,\n      0x00]\n    k =\n      [0x00,\n      0x01,\n      0x02,\n      0x03,\n      0x04,\n      0x05,\n      0x06,\n      0x07,\n      0x08,\n      0x09,\n      0x0a,\n      0x0b,\n      0x0c,\n      0x0d,\n      0x0e,\n      0x0f,\n      0x10,\n      0x11,\n      0x12,\n      0x13,\n      0x14,\n      0x15,\n      0x16,\n      0x17,\n      0x18,\n      0x19,\n      0x1a,\n      0x1b,\n      0x1c,\n      0x1d,\n      0x1e,\n      0x1f]\n    out =\n      [0x10,\n      0xf1,\n      0xe7,\n      0xe4,\n      0xd1,\n      0x3b,\n      0x59,\n      0x15,\n      0x50,\n      0x0f,\n      0xdd,\n      0x1f,\n      0xa3,\n      0x20,\n      0x71,\n      0xc4,\n      0xc7,\n      0xd1,\n      0xf4,\n      0xc7,\n      0x33,\n      0xc0,\n      0x68,\n      0x03,\n      0x04,\n      0x22,\n      0xaa,\n      0x9a,\n      0xc3,\n      0xd4,\n      0x6c,\n      0x4e,\n      0xd2,\n      0x82,\n      0x64,\n      0x46,\n      0x07,\n      0x9f,\n      0xaa,\n      0x09,\n      0x14,\n      0xc2,\n      0xd7,\n      0x05,\n      0xd9,\n      0x8b,\n      0x02,\n      0xa2,\n      0xb5,\n      0x12,\n      0x9c,\n      0xd1,\n      0xde,\n      0x16,\n      0x4e,\n      0xb9,\n      0xcb,\n      0xd0,\n      0x83,\n      0xe8,\n      0xa2,\n      0x50,\n      0x3c,\n      0x4e]\ncore01 =\n  kexp k 1 n == out\n  where\n    n =\n      [0x00,\n      0x00,\n      0x00,\n      0x09,\n      0x00,\n      0x00,\n      0x00,\n      0x4a,\n      0x00,\n      0x00,\n      0x00,\n      0x00]\n    k =\n      [0x00,\n      0x01,\n      0x02,\n      0x03,\n      0x04,\n      0x05,\n      0x06,\n      0x07,\n      0x08,\n      0x09,\n      0x0a,\n      0x0b,\n      0x0c,\n      0x0d,\n      0x0e,\n      0x0f,\n      0x10,\n      0x11,\n      0x12,\n      0x13,\n      0x14,\n      0x15,\n      0x16,\n      0x17,\n      0x18,\n      0x19,\n      0x1a,\n      0x1b,\n      0x1c,\n      0x1d,\n      0x1e,\n      0x1f]\n    out =\n      [0x61707865,\n      0x3320646e,\n      0x79622d32,\n      0x6b206574,\n      0x03020100,\n      0x07060504,\n      0x0b0a0908,\n      0x0f0e0d0c,\n      0x13121110,\n      0x17161514,\n      0x1b1a1918,\n      0x1f1e1d1c,\n      0x00000001,\n      0x09000000,\n      0x4a000000,\n      0x00000000]\nqround01 =\n  qround in == out\n  where\n    in = [0x11111111, 0x01020304, 0x9b8d6f43, 0x01234567]\n    out = [0xea2a92f4, 0xcb1cf8ce, 0x4581472e, 0x5881c4bb]\n\/* pragma allTestsPass : property *\/\nallTestsPass =\n  and [qround01, core01, core02, rfctest01, rfctest02, rfctest03]\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/027_rjoin.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `rjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b` that flattens an outer sequence of inner sequences of bits after first reversing the outer sequence (i.e., `rjoin x = join (reverse x)`)."},{"role":"assistant","content":"```cryptol\nrjoin x = join (reverse x)\nrjoin : {a, b, c} (fin a, fin c) => [c][a]b -> [a * c]b\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/029_iterate.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the polymorphic function `iterate : {a} (a -> a) -> a -> [inf]a` that, given a state transition function `f` and an initial value `x`, returns the infinite stream `[x, f x, f (f x), ...]` using a self-referential list definition as in the provided pattern."},{"role":"assistant","content":"```cryptol\niterate f x =\n  [x] # [f v | v <- iterate f x]\n  where\n    xs = [x] # [f v | v <- xs]\niterate : {a} (a -> a) -> a -> [inf]a\n```"}]}
{"filename":"aws-lc-verification\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Stream\/chacha20\/033_blocked.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the types Round = [16][32] and Block = [64][8] and implement the function blocked : Round -> Block that maps each 32-bit word of the 16-word round state to four bytes (using reverse (groupBy`{8})) and concatenates all resulting bytes into a 64-byte block, matching the behavior of the provided specification."},{"role":"assistant","content":"```cryptol\ntype Round = [16][32]\ntype Block = [64][8]\nmap f xs = [f x | x <- xs]\nmap : {a, b, c} (a -> b) -> [c]a -> [c]b\nblocked x =\n  join (map toBytes x)\n  where\n    toBytes : [32] -> [4][8]\n    toBytes v = reverse (groupBy`{8} v)\nblocked : Round -> Block\n```"}]}
{"filename":"cryptol\/examples\/MiniLock\/prim\/Blake2s\/010_SIGMA_TABLE.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the constant SIGMA_TABLE : [10][16][4] for the BLAKE2s permutation schedule exactly as given here, and add a property sigmaTableLengthOK that proves each of the 10 rows is a permutation of the 16 distinct 4-bit indices [0..15]."},{"role":"assistant","content":"```cryptol\nSIGMA_TABLE : [10][16][4]\nSIGMA_TABLE =\n  [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15],\n  [14, 10, 4, 8, 9, 15, 13, 6, 1, 12, 0, 2, 11, 7, 5, 3],\n  [11, 8, 12, 0, 5, 2, 15, 13, 10, 14, 3, 6, 7, 1, 9, 4],\n  [7, 9, 3, 1, 13, 12, 11, 14, 2, 6, 5, 10, 4, 0, 15, 8],\n  [9, 0, 5, 7, 2, 4, 10, 15, 14, 1, 11, 12, 6, 8, 3, 13],\n  [2, 12, 6, 10, 0, 11, 8, 3, 4, 13, 7, 5, 15, 14, 1, 9],\n  [12, 5, 1, 15, 14, 13, 4, 10, 0, 7, 6, 3, 9, 2, 8, 11],\n  [13, 11, 7, 14, 12, 1, 3, 9, 5, 0, 15, 4, 8, 6, 2, 10],\n  [6, 15, 14, 9, 11, 3, 0, 8, 12, 2, 13, 7, 1, 4, 10, 5],\n  [10, 2, 8, 4, 7, 6, 1, 5, 15, 11, 9, 14, 3, 12, 13, 0]]\n```"}]}
{"filename":"cryptol\/examples\/MiniLock\/prim\/Blake2s\/025_blake2s.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module that implements the Blake2s hash function over byte sequences using the given Block, State, LocalState, BCounter, Context types, IV, SIGMA_TABLE, rotation constants, mixing function G\/G', compression function F, block processing (blake2Update, blake2sFinish, mkBlock), and exposes the top-level function `blake2s : {ll, nn} (fin ll, 32 >= nn, 64 >= width ll) => [ll][8] -> [nn * 8]` with correct padding and counter handling."},{"role":"assistant","content":"```cryptol\ntype Block = [16][32]\ntype State = [8][32]\ntype LocalState = [16][32]\ntype BCounter = [64]\ntype Context = {state : State, counter : BCounter}\nIV : [8][32]\nIV =\n  [0x6a09e667,\n  0xbb67ae85,\n  0x3c6ef372,\n  0xa54ff53a,\n  0x510e527f,\n  0x9b05688c,\n  0x1f83d9ab,\n  0x5be0cd19]\nSIGMA_TABLE : [10][16][4]\nSIGMA_TABLE =\n  [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15],\n  [14, 10, 4, 8, 9, 15, 13, 6, 1, 12, 0, 2, 11, 7, 5, 3],\n  [11, 8, 12, 0, 5, 2, 15, 13, 10, 14, 3, 6, 7, 1, 9, 4],\n  [7, 9, 3, 1, 13, 12, 11, 14, 2, 6, 5, 10, 4, 0, 15, 8],\n  [9, 0, 5, 7, 2, 4, 10, 15, 14, 1, 11, 12, 6, 8, 3, 13],\n  [2, 12, 6, 10, 0, 11, 8, 3, 4, 13, 7, 5, 15, 14, 1, 9],\n  [12, 5, 1, 15, 14, 13, 4, 10, 0, 7, 6, 3, 9, 2, 8, 11],\n  [13, 11, 7, 14, 12, 1, 3, 9, 5, 0, 15, 4, 8, 6, 2, 10],\n  [6, 15, 14, 9, 11, 3, 0, 8, 12, 2, 13, 7, 1, 4, 10, 5],\n  [10, 2, 8, 4, 7, 6, 1, 5, 15, 11, 9, 14, 3, 12, 13, 0]]\nR1, R2, R3, R4 : [6]\nR1 = 16\nR2 = 12\nR3 = 8\nR4 = 7\nG : [4] -> [4] -> LocalState -> [4][6] -> Block -> [16][32]\nG r i vec abcd ms =\n  foldl updateVector vec (zip abcd new)\n  where\n    new = G' r i (vec @@ abcd) ms\nG' : [4] -> [4] -> [4][32] -> Block -> [4][32]\nG' r i vals ms =\n  [a2, b2, c2, d2]\n  where\n    x = ms @ (SIGMA_TABLE @ r @ (2 * i))\n    y = ms @ (SIGMA_TABLE @ r @ (2 * i + 1))\n    [a, b, c, d] = vals\n    a1 = a + b + x\n    d1 = (d ^ a1) >>> R1\n    c1 = c + d1\n    b1 = (b ^ c1) >>> R2\n    a2 = a1 + b1 + y\n    d2 = (d1 ^ a2) >>> R3\n    c2 = c1 + d2\n    b2 = (b1 ^ c2) >>> R4\nF : State -> Block -> BCounter -> Bit -> State\nF h ms t f =\n  h ^ (take (vs ! 0)) ^ (drop (vs ! 0))\n  where\n    v = h # IV ^ (zero # [t0, t1, f0, zero])\n    [t1, t0] = split t : [2][32]\n    f0 = [f | _ <- [0 .. 31] : [_][6]]\n    vs = [v] # [round i ms v' | v' <- vs | i <- [0 .. 9]]\nround : [4] -> Block -> LocalState -> LocalState\nround r ms v =\n  vs ! 0\n  where\n    vs =\n      [v] # [G r i v' ix ms | v' <- vs\n                            | i <- [0 .. 7]\n                            | ix <- [[0, 4, 8, 12],\n                           [1, 5, 9, 13],\n                           [2, 6, 10, 14],\n                           [3, 7, 11, 15],\n                           [0, 5, 10, 15],\n                           [1, 6, 11, 12],\n                           [2, 7, 8, 13],\n                           [3, 4, 9, 14]]]\nblake2s : {ll, nn}\n  (fin ll, 32 >= nn, 64 >= width ll) =>\n    [ll][8] -> [nn * 8]\nblake2s m = blake2s'`{ll = ll, nn = nn} m\nblake2s' : {ll, dd, nn}\n  (fin ll, 32 >= nn, dd == (max 1 ((ll + 63) \/ 64)) - 1,\n   64 >= width ll) =>\n    [ll][8] -> [nn * 8]\nblake2s' m =\n  take`{nn * 8}\n    (blake2sFinish ({state = (hs ! 0).state, counter = `ll})\n      lastBlock)\n  where\n    fullBlocks : [dd]Block\n    fullBlocks =\n      [mkBlock b | b <- split\n                  (join (take`{front = 64 * dd, back = ll - 64 * dd} m))]\n    partialBlock = drop`{front = 64 * dd, back = ll - 64 * dd} m\n    lastBlock : Block\n    lastBlock =\n      if (`ll == (zero : [64]))\n      then zero\n      else mkBlock\n        ((split (join (partialBlock # (zero : [inf][8])))) @ 0)\n    h : Context\n    h =\n      {state = [IV @ 0 ^ `16842752 ^ `nn] # drop`{1} IV, counter = 0}\n    hs : [dd + 1]Context\n    hs = [h] # [blake2Update h' dX | h' <- hs | dX <- fullBlocks]\nblake2Update : Context -> Block -> Context\nblake2Update ctx d =\n  {state = newState, counter = newCount}\n  where\n    newState = F ctx.state d newCount False\n    newCount = ctx.counter + (64 : [64])\nblake2sFinish : Context -> Block -> [256]\nblake2sFinish ctx b =\n  join [reverseBytes w | w <- F ctx.state b ctx.counter True]\nmkBlock x = reverse (split (reverseBytes x))\nreverseBytes x = join (reverse (bytes x))\nbytes x = split x : [_][8]\nupdateVector : {a, b, c}\n  (c >= width (a - 1), a >= 1, fin a, fin c) =>\n    [a]b -> ([c], b) -> [a]b\nupdateVector orig idxNew =\n  vs\n  where\n    idx = idxNew.0\n    new = idxNew.1\n    vs = [if i == idx then new else orig @ i | i <- [0 .. a - 1]]\n```"}]}
{"filename":"cryptol\/examples\/MiniLock\/prim\/Blake2s\/031_postprocess.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type synonyms `Block = [16][32]` and `BCounter = [64]` and implement the function `postprocess : {ll} (64 >= ll, 64 >= width ll) => BCounter -> [ll][8] -> Block` so that it returns all-zero when the counter `c` is zero and `ll` is zero, and otherwise returns `split (join m # zero)` cast to `Block`."},{"role":"assistant","content":"```cryptol\ntype Block = [16][32]\ntype BCounter = [64]\npostprocess : {ll}\n  (64 >= ll, 64 >= width ll) =>\n    BCounter -> [ll][8] -> Block\npostprocess c m =\n  if c == 0 \/\\ `ll == (zero : [64])\n  then zero\n  else split (join m # zero)\n```"}]}
{"filename":"cryptol\/examples\/MiniLock\/prim\/Blake2s\/033_blake2sFinish.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that implements the finalization step of the BLAKE2s hash (including the IV, SIGMA_TABLE, rotation constants, G, round, F, and blake2sFinish functions and the Context type) and exposes blake2sFinish : {n} Context -> Block -> [256] as the main external interface, along with any necessary helper functions like reverseBytes and updateVector."},{"role":"assistant","content":"```cryptol\ntype Block = [16][32]\ntype State = [8][32]\ntype LocalState = [16][32]\ntype BCounter = [64]\ntype Context = {state : State, counter : BCounter}\nIV : [8][32]\nIV =\n  [0x6a09e667,\n  0xbb67ae85,\n  0x3c6ef372,\n  0xa54ff53a,\n  0x510e527f,\n  0x9b05688c,\n  0x1f83d9ab,\n  0x5be0cd19]\nSIGMA_TABLE : [10][16][4]\nSIGMA_TABLE =\n  [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15],\n  [14, 10, 4, 8, 9, 15, 13, 6, 1, 12, 0, 2, 11, 7, 5, 3],\n  [11, 8, 12, 0, 5, 2, 15, 13, 10, 14, 3, 6, 7, 1, 9, 4],\n  [7, 9, 3, 1, 13, 12, 11, 14, 2, 6, 5, 10, 4, 0, 15, 8],\n  [9, 0, 5, 7, 2, 4, 10, 15, 14, 1, 11, 12, 6, 8, 3, 13],\n  [2, 12, 6, 10, 0, 11, 8, 3, 4, 13, 7, 5, 15, 14, 1, 9],\n  [12, 5, 1, 15, 14, 13, 4, 10, 0, 7, 6, 3, 9, 2, 8, 11],\n  [13, 11, 7, 14, 12, 1, 3, 9, 5, 0, 15, 4, 8, 6, 2, 10],\n  [6, 15, 14, 9, 11, 3, 0, 8, 12, 2, 13, 7, 1, 4, 10, 5],\n  [10, 2, 8, 4, 7, 6, 1, 5, 15, 11, 9, 14, 3, 12, 13, 0]]\nR1, R2, R3, R4 : [6]\nR1 = 16\nR2 = 12\nR3 = 8\nR4 = 7\nG : [4] -> [4] -> LocalState -> [4][6] -> Block -> [16][32]\nG r i vec abcd ms =\n  foldl updateVector vec (zip abcd new)\n  where\n    new = G' r i (vec @@ abcd) ms\nG' : [4] -> [4] -> [4][32] -> Block -> [4][32]\nG' r i vals ms =\n  [a2, b2, c2, d2]\n  where\n    x = ms @ (SIGMA_TABLE @ r @ (2 * i))\n    y = ms @ (SIGMA_TABLE @ r @ (2 * i + 1))\n    [a, b, c, d] = vals\n    a1 = a + b + x\n    d1 = (d ^ a1) >>> R1\n    c1 = c + d1\n    b1 = (b ^ c1) >>> R2\n    a2 = a1 + b1 + y\n    d2 = (d1 ^ a2) >>> R3\n    c2 = c1 + d2\n    b2 = (b1 ^ c2) >>> R4\nF : State -> Block -> BCounter -> Bit -> State\nF h ms t f =\n  h ^ (take (vs ! 0)) ^ (drop (vs ! 0))\n  where\n    v = h # IV ^ (zero # [t0, t1, f0, zero])\n    [t1, t0] = split t : [2][32]\n    f0 = [f | _ <- [0 .. 31] : [_][6]]\n    vs = [v] # [round i ms v' | v' <- vs | i <- [0 .. 9]]\nround : [4] -> Block -> LocalState -> LocalState\nround r ms v =\n  vs ! 0\n  where\n    vs =\n      [v] # [G r i v' ix ms | v' <- vs\n                            | i <- [0 .. 7]\n                            | ix <- [[0, 4, 8, 12],\n                           [1, 5, 9, 13],\n                           [2, 6, 10, 14],\n                           [3, 7, 11, 15],\n                           [0, 5, 10, 15],\n                           [1, 6, 11, 12],\n                           [2, 7, 8, 13],\n                           [3, 4, 9, 14]]]\nblake2sFinish : Context -> Block -> [256]\nblake2sFinish ctx b =\n  join [reverseBytes w | w <- F ctx.state b ctx.counter True]\nreverseBytes x = join (reverse (bytes x))\nbytes x = split x : [_][8]\nupdateVector : {a, b, c}\n  (c >= width (a - 1), a >= 1, fin a, fin c) =>\n    [a]b -> ([c], b) -> [a]b\nupdateVector orig idxNew =\n  vs\n  where\n    idx = idxNew.0\n    new = idxNew.1\n    vs = [if i == idx then new else orig @ i | i <- [0 .. a - 1]]\n```"}]}
{"filename":"cryptol\/examples\/MiniLock\/prim\/Blake2s\/038_updateVector.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `updateVector : {a, b, c} (c >= width (a - 1), a >= 1, fin a, fin c) => [a]b -> ([c], b) -> [a]b` that returns a vector where the element at position `idxNew.0` is replaced with `idxNew.1`, and specify a property that for all valid inputs it is equal to `take a (orig) @ [idxNew.0 := idxNew.1]` (i.e., only that index is updated and all other elements remain unchanged)."},{"role":"assistant","content":"```cryptol\nupdateVector : {a, b, c}\n  (c >= width (a - 1), a >= 1, fin a, fin c) =>\n    [a]b -> ([c], b) -> [a]b\nupdateVector orig idxNew =\n  vs\n  where\n    idx = idxNew.0\n    new = idxNew.1\n    vs = [if i == idx then new else orig @ i | i <- [0 .. a - 1]]\n```"}]}
{"filename":"cryptol\/examples\/contrib\/MISTY1\/007_S7.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the constant S7 : [128][7] as the 128-entry 7-bit S-box table used in the MISTY1 block cipher, using exactly the values given in the MISTY1 specification for S-box S7."},{"role":"assistant","content":"```cryptol\nS7 : [_][7]\nS7 =\n  [27,\n  50,\n  51,\n  90,\n  59,\n  16,\n  23,\n  84,\n  91,\n  26,\n  114,\n  115,\n  107,\n  44,\n  102,\n  73,\n  31,\n  36,\n  19,\n  108,\n  55,\n  46,\n  63,\n  74,\n  93,\n  15,\n  64,\n  86,\n  37,\n  81,\n  28,\n  4,\n  11,\n  70,\n  32,\n  13,\n  123,\n  53,\n  68,\n  66,\n  43,\n  30,\n  65,\n  20,\n  75,\n  121,\n  21,\n  111,\n  14,\n  85,\n  9,\n  54,\n  116,\n  12,\n  103,\n  83,\n  40,\n  10,\n  126,\n  56,\n  2,\n  7,\n  96,\n  41,\n  25,\n  18,\n  101,\n  47,\n  48,\n  57,\n  8,\n  104,\n  95,\n  120,\n  42,\n  76,\n  100,\n  69,\n  117,\n  61,\n  89,\n  72,\n  3,\n  87,\n  124,\n  79,\n  98,\n  60,\n  29,\n  33,\n  94,\n  39,\n  106,\n  112,\n  77,\n  58,\n  1,\n  109,\n  110,\n  99,\n  24,\n  119,\n  35,\n  5,\n  38,\n  118,\n  0,\n  49,\n  45,\n  122,\n  127,\n  97,\n  80,\n  34,\n  17,\n  6,\n  71,\n  22,\n  82,\n  78,\n  113,\n  62,\n  105,\n  67,\n  52,\n  92,\n  88,\n  125]\n```"}]}
{"filename":"cryptol\/examples\/contrib\/MISTY1\/011_FL.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of the MISTY1 FL round function, including the function `FL : [32] -> [8] -> [32][16] -> [32]` and the helper `isEven : {a} (fin a) => [a] -> Bool`, matching the given behavior of splitting the 32-bit input into two 16-bit halves, conditionally updating them based on the parity of the 8-bit index and round subkeys from `EK`, and recombining them."},{"role":"assistant","content":"```cryptol\nFL : [32] -> [8] -> [32][16] -> [32]\nFL FL_IN k EK =\n  if isEven k\n  then d0_even # d1_even\n       where\n         d1_even = d1 ^ (d0 && (EK @ (k \/ 2)))\n         d0_even = d0 ^ (d1_even || (EK @ ((k \/ 2 + 6) % 8 + 8)))\n  else d0_odd # d1_odd\n  where\n    d1_odd = d1 ^ (d0 && (EK @ (((k - 1) \/ 2 + 2) % 8 + 8)))\n    d0_odd = d0 ^ (d1_odd || (EK @ (((k - 1) \/ 2 + 4) % 8)))\n  where\n    d0 : [16]\n    d0 = take FL_IN\n    d1 : [16]\n    d1 = drop FL_IN\nisEven : {a} (fin a) => [a] -> Bool\nisEven n = ~(n ! 0)\n```"}]}
{"filename":"cryptol\/examples\/contrib\/MISTY1\/013_FLINV.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the MISTY1 FL inverse round function `FLINV : [32] -> [8] -> [32][16] -> [32]` exactly as given, including the even\/odd branch logic, the use of the subkey array `EK`, the splitting and recombining of the 32-bit input into two 16-bit halves, and the helper function `isEven : {a} (fin a) => [a] -> Bool` used to select the branch."},{"role":"assistant","content":"```cryptol\nFLINV : [32] -> [8] -> [32][16] -> [32]\nFLINV FL_IN k EK =\n  if isEven k\n  then d0_even # d1_even\n       where\n         d0_even = d0 ^ (d1 || (EK @ ((k \/ 2 + 6) % 8 + 8)))\n         d1_even = d1 ^ (d0_even && (EK @ (k \/ 2)))\n  else d0_odd # d1_odd\n  where\n    d0_odd = d0 ^ (d1 || (EK @ (((k - 1) \/ 2 + 4) % 8)))\n    d1_odd = d1 ^ (d0_odd && (EK @ (((k - 1) \/ 2 + 2) % 8 + 8)))\n  where\n    d0 : [16]\n    d0 = take FL_IN\n    d1 : [16]\n    d1 = drop FL_IN\nisEven : {a} (fin a) => [a] -> Bool\nisEven n = ~(n ! 0)\n```"}]}
{"filename":"cryptol\/examples\/contrib\/MISTY1\/024_misty1Correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the functions, types, S-box constants, key schedule, encryption and decryption for the 64-bit MISTY1 block cipher in Cryptol, and include a property misty1Correct pt key that proves misty1Decrypt (misty1Encrypt pt EK) EK == pt for all 64-bit plaintexts pt and 128-bit keys key, where EK = keySchedule key."},{"role":"assistant","content":"```cryptol\nkeySchedule : [16][8] -> [32][16]\nkeySchedule K =\n  EK_1 # EK_2 # EK_3 # EK_4\n  where\n    EK_1 = split (join K)\n    EK_2 =\n      [FI ek_1 ek_1_shifted | ek_1 <- EK_1\n                            | ek_1_shifted <- EK_1 <<< 1]\n    EK_3 = [extend (drop`{7} ek_2) | ek_2 <- EK_2]\n    EK_4 = [extend (take`{7} ek_2) | ek_2 <- EK_2]\nFO : [32] -> [8] -> [32][16] -> [32]\nFO FO_IN k EK =\n  (FO_OUT ! 0).1 # (FO_OUT ! 0).0\n  where\n    FO_OUT =\n      [(take FO_IN, drop FO_IN)] # [f t0 t1 | f <- funcs\n                                            | (t0, t1) <- FO_OUT]\n    funcs : [_]([16] -> [16] -> ([16], [16]))\n    funcs =\n      [\\t0 t1 -> (t0 ^ (EK @ k), t1),\n      \\t0 t1 -> (FI t0 (EK @ ((k + 5) % 8 + 8)), t1),\n      \\t0 t1 -> (t0 ^ t1, t1),\n      \\t0 t1 -> (t0, t1 ^ (EK @ ((k + 2) % 8))),\n      \\t0 t1 -> (t0, FI t1 (EK @ ((k + 1) % 8 + 8))),\n      \\t0 t1 -> (t0, t1 ^ t0),\n      \\t0 t1 -> (t0 ^ EK @ ((k + 7) % 8), t1),\n      \\t0 t1 -> (FI t0 (EK @ ((k + 3) % 8 + 8)), t1),\n      \\t0 t1 -> (t0 ^ t1, t1),\n      \\t0 t1 -> (t0, t1 ^ EK @ ((k + 4) % 8))]\nFI : [16] -> [16] -> [16]\nFI FI_IN FI_KEY =\n  (FI_OUT ! 0).1 # (FI_OUT ! 0).0\n  where\n    FI_OUT =\n      [(take FI_IN, drop FI_IN)] # [f d9 d7 | f <- funcs\n                                            | (d9, d7) <- FI_OUT]\n    funcs : [_]([9] -> [7] -> ([9], [7]))\n    funcs =\n      [\\d9 d7 -> ((S9 @ d9) ^ (extend d7), d7),\n      \\d9 d7 -> (d9, drop (extend (S7 @ d7) ^ d9)),\n      \\d9 d7 -> (d9, d7 ^ drop (FI_KEY >> 9)),\n      \\d9 d7 -> (d9 ^ drop FI_KEY, d7),\n      \\d9 d7 -> ((S9 @ d9) ^ (extend d7), d7)]\nS7 : [_][7]\nS7 =\n  [27,\n  50,\n  51,\n  90,\n  59,\n  16,\n  23,\n  84,\n  91,\n  26,\n  114,\n  115,\n  107,\n  44,\n  102,\n  73,\n  31,\n  36,\n  19,\n  108,\n  55,\n  46,\n  63,\n  74,\n  93,\n  15,\n  64,\n  86,\n  37,\n  81,\n  28,\n  4,\n  11,\n  70,\n  32,\n  13,\n  123,\n  53,\n  68,\n  66,\n  43,\n  30,\n  65,\n  20,\n  75,\n  121,\n  21,\n  111,\n  14,\n  85,\n  9,\n  54,\n  116,\n  12,\n  103,\n  83,\n  40,\n  10,\n  126,\n  56,\n  2,\n  7,\n  96,\n  41,\n  25,\n  18,\n  101,\n  47,\n  48,\n  57,\n  8,\n  104,\n  95,\n  120,\n  42,\n  76,\n  100,\n  69,\n  117,\n  61,\n  89,\n  72,\n  3,\n  87,\n  124,\n  79,\n  98,\n  60,\n  29,\n  33,\n  94,\n  39,\n  106,\n  112,\n  77,\n  58,\n  1,\n  109,\n  110,\n  99,\n  24,\n  119,\n  35,\n  5,\n  38,\n  118,\n  0,\n  49,\n  45,\n  122,\n  127,\n  97,\n  80,\n  34,\n  17,\n  6,\n  71,\n  22,\n  82,\n  78,\n  113,\n  62,\n  105,\n  67,\n  52,\n  92,\n  88,\n  125]\nS9 : [_][9]\nS9 =\n  [451,\n  203,\n  339,\n  415,\n  483,\n  233,\n  251,\n  53,\n  385,\n  185,\n  279,\n  491,\n  307,\n  9,\n  45,\n  211,\n  199,\n  330,\n  55,\n  126,\n  235,\n  356,\n  403,\n  472,\n  163,\n  286,\n  85,\n  44,\n  29,\n  418,\n  355,\n  280,\n  331,\n  338,\n  466,\n  15,\n  43,\n  48,\n  314,\n  229,\n  273,\n  312,\n  398,\n  99,\n  227,\n  200,\n  500,\n  27,\n  1,\n  157,\n  248,\n  416,\n  365,\n  499,\n  28,\n  326,\n  125,\n  209,\n  130,\n  490,\n  387,\n  301,\n  244,\n  414,\n  467,\n  221,\n  482,\n  296,\n  480,\n  236,\n  89,\n  145,\n  17,\n  303,\n  38,\n  220,\n  176,\n  396,\n  271,\n  503,\n  231,\n  364,\n  182,\n  249,\n  216,\n  337,\n  257,\n  332,\n  259,\n  184,\n  340,\n  299,\n  430,\n  23,\n  113,\n  12,\n  71,\n  88,\n  127,\n  420,\n  308,\n  297,\n  132,\n  349,\n  413,\n  434,\n  419,\n  72,\n  124,\n  81,\n  458,\n  35,\n  317,\n  423,\n  357,\n  59,\n  66,\n  218,\n  402,\n  206,\n  193,\n  107,\n  159,\n  497,\n  300,\n  388,\n  250,\n  406,\n  481,\n  361,\n  381,\n  49,\n  384,\n  266,\n  148,\n  474,\n  390,\n  318,\n  284,\n  96,\n  373,\n  463,\n  103,\n  281,\n  101,\n  104,\n  153,\n  336,\n  8,\n  7,\n  380,\n  183,\n  36,\n  25,\n  222,\n  295,\n  219,\n  228,\n  425,\n  82,\n  265,\n  144,\n  412,\n  449,\n  40,\n  435,\n  309,\n  362,\n  374,\n  223,\n  485,\n  392,\n  197,\n  366,\n  478,\n  433,\n  195,\n  479,\n  54,\n  238,\n  494,\n  240,\n  147,\n  73,\n  154,\n  438,\n  105,\n  129,\n  293,\n  11,\n  94,\n  180,\n  329,\n  455,\n  372,\n  62,\n  315,\n  439,\n  142,\n  454,\n  174,\n  16,\n  149,\n  495,\n  78,\n  242,\n  509,\n  133,\n  253,\n  246,\n  160,\n  367,\n  131,\n  138,\n  342,\n  155,\n  316,\n  263,\n  359,\n  152,\n  464,\n  489,\n  3,\n  510,\n  189,\n  290,\n  137,\n  210,\n  399,\n  18,\n  51,\n  106,\n  322,\n  237,\n  368,\n  283,\n  226,\n  335,\n  344,\n  305,\n  327,\n  93,\n  275,\n  461,\n  121,\n  353,\n  421,\n  377,\n  158,\n  436,\n  204,\n  34,\n  306,\n  26,\n  232,\n  4,\n  391,\n  493,\n  407,\n  57,\n  447,\n  471,\n  39,\n  395,\n  198,\n  156,\n  208,\n  334,\n  108,\n  52,\n  498,\n  110,\n  202,\n  37,\n  186,\n  401,\n  254,\n  19,\n  262,\n  47,\n  429,\n  370,\n  475,\n  192,\n  267,\n  470,\n  245,\n  492,\n  269,\n  118,\n  276,\n  427,\n  117,\n  268,\n  484,\n  345,\n  84,\n  287,\n  75,\n  196,\n  446,\n  247,\n  41,\n  164,\n  14,\n  496,\n  119,\n  77,\n  378,\n  134,\n  139,\n  179,\n  369,\n  191,\n  270,\n  260,\n  151,\n  347,\n  352,\n  360,\n  215,\n  187,\n  102,\n  462,\n  252,\n  146,\n  453,\n  111,\n  22,\n  74,\n  161,\n  313,\n  175,\n  241,\n  400,\n  10,\n  426,\n  323,\n  379,\n  86,\n  397,\n  358,\n  212,\n  507,\n  333,\n  404,\n  410,\n  135,\n  504,\n  291,\n  167,\n  440,\n  321,\n  60,\n  505,\n  320,\n  42,\n  341,\n  282,\n  417,\n  408,\n  213,\n  294,\n  431,\n  97,\n  302,\n  343,\n  476,\n  114,\n  394,\n  170,\n  150,\n  277,\n  239,\n  69,\n  123,\n  141,\n  325,\n  83,\n  95,\n  376,\n  178,\n  46,\n  32,\n  469,\n  63,\n  457,\n  487,\n  428,\n  68,\n  56,\n  20,\n  177,\n  363,\n  171,\n  181,\n  90,\n  386,\n  456,\n  468,\n  24,\n  375,\n  100,\n  207,\n  109,\n  256,\n  409,\n  304,\n  346,\n  5,\n  288,\n  443,\n  445,\n  224,\n  79,\n  214,\n  319,\n  452,\n  298,\n  21,\n  6,\n  255,\n  411,\n  166,\n  67,\n  136,\n  80,\n  351,\n  488,\n  289,\n  115,\n  382,\n  188,\n  194,\n  201,\n  371,\n  393,\n  501,\n  116,\n  460,\n  486,\n  424,\n  405,\n  31,\n  65,\n  13,\n  442,\n  50,\n  61,\n  465,\n  128,\n  168,\n  87,\n  441,\n  354,\n  328,\n  217,\n  261,\n  98,\n  122,\n  33,\n  511,\n  274,\n  264,\n  448,\n  169,\n  285,\n  432,\n  422,\n  205,\n  243,\n  92,\n  258,\n  91,\n  473,\n  324,\n  502,\n  173,\n  165,\n  58,\n  459,\n  310,\n  383,\n  70,\n  225,\n  30,\n  477,\n  230,\n  311,\n  506,\n  389,\n  140,\n  143,\n  64,\n  437,\n  190,\n  120,\n  0,\n  172,\n  272,\n  350,\n  292,\n  2,\n  444,\n  162,\n  234,\n  112,\n  508,\n  278,\n  348,\n  76,\n  450]\nFL : [32] -> [8] -> [32][16] -> [32]\nFL FL_IN k EK =\n  if isEven k\n  then d0_even # d1_even\n       where\n         d1_even = d1 ^ (d0 && (EK @ (k \/ 2)))\n         d0_even = d0 ^ (d1_even || (EK @ ((k \/ 2 + 6) % 8 + 8)))\n  else d0_odd # d1_odd\n  where\n    d1_odd = d1 ^ (d0 && (EK @ (((k - 1) \/ 2 + 2) % 8 + 8)))\n    d0_odd = d0 ^ (d1_odd || (EK @ (((k - 1) \/ 2 + 4) % 8)))\n  where\n    d0 : [16]\n    d0 = take FL_IN\n    d1 : [16]\n    d1 = drop FL_IN\nFLINV : [32] -> [8] -> [32][16] -> [32]\nFLINV FL_IN k EK =\n  if isEven k\n  then d0_even # d1_even\n       where\n         d0_even = d0 ^ (d1 || (EK @ ((k \/ 2 + 6) % 8 + 8)))\n         d1_even = d1 ^ (d0_even && (EK @ (k \/ 2)))\n  else d0_odd # d1_odd\n  where\n    d0_odd = d0 ^ (d1 || (EK @ (((k - 1) \/ 2 + 4) % 8)))\n    d1_odd = d1 ^ (d0_odd && (EK @ (((k - 1) \/ 2 + 2) % 8 + 8)))\n  where\n    d0 : [16]\n    d0 = take FL_IN\n    d1 : [16]\n    d1 = drop FL_IN\nmisty1Encrypt : [64] -> [32][16] -> [64]\nmisty1Encrypt P EK =\n  (C ! 0).1 # (C ! 0).0\n  where\n    C = [(take P, drop P)] # [f D0 D1 | f <- funcs | (D0, D1) <- C]\n    funcs : [_]([32] -> [32] -> ([32], [32]))\n    funcs =\n      [\\D0 D1 -> (FL D0 0 EK, D1),\n      \\D0 D1 -> (D0, FL D1 1 EK),\n      \\D0 D1 -> (D0, D1 ^ (FO D0 0 EK)),\n      \\D0 D1 -> (D0 ^ (FO D1 1 EK), D1),\n      \\D0 D1 -> (FL D0 2 EK, D1),\n      \\D0 D1 -> (D0, FL D1 3 EK),\n      \\D0 D1 -> (D0, D1 ^ (FO D0 2 EK)),\n      \\D0 D1 -> (D0 ^ (FO D1 3 EK), D1),\n      \\D0 D1 -> (FL D0 4 EK, D1),\n      \\D0 D1 -> (D0, FL D1 5 EK),\n      \\D0 D1 -> (D0, D1 ^ (FO D0 4 EK)),\n      \\D0 D1 -> (D0 ^ (FO D1 5 EK), D1),\n      \\D0 D1 -> (FL D0 6 EK, D1),\n      \\D0 D1 -> (D0, FL D1 7 EK),\n      \\D0 D1 -> (D0, D1 ^ (FO D0 6 EK)),\n      \\D0 D1 -> (D0 ^ (FO D1 7 EK), D1),\n      \\D0 D1 -> (FL D0 8 EK, D1),\n      \\D0 D1 -> (D0, FL D1 9 EK)]\nmisty1Decrypt : [64] -> [32][16] -> [64]\nmisty1Decrypt C EK =\n  (P ! 0).0 # (P ! 0).1\n  where\n    P = [(drop C, take C)] # [f D0 D1 | f <- funcs | (D0, D1) <- P]\n    funcs : [_]([32] -> [32] -> ([32], [32]))\n    funcs =\n      [\\D0 D1 -> (FLINV D0 8 EK, D1),\n      \\D0 D1 -> (D0, FLINV D1 9 EK),\n      \\D0 D1 -> (D0 ^ (FO D1 7 EK), D1),\n      \\D0 D1 -> (D0, D1 ^ (FO D0 6 EK)),\n      \\D0 D1 -> (FLINV D0 6 EK, D1),\n      \\D0 D1 -> (D0, FLINV D1 7 EK),\n      \\D0 D1 -> (D0 ^ (FO D1 5 EK), D1),\n      \\D0 D1 -> (D0, D1 ^ (FO D0 4 EK)),\n      \\D0 D1 -> (FLINV D0 4 EK, D1),\n      \\D0 D1 -> (D0, FLINV D1 5 EK),\n      \\D0 D1 -> (D0 ^ (FO D1 3 EK), D1),\n      \\D0 D1 -> (D0, D1 ^ (FO D0 2 EK)),\n      \\D0 D1 -> (FLINV D0 2 EK, D1),\n      \\D0 D1 -> (D0, FLINV D1 3 EK),\n      \\D0 D1 -> (D0 ^ (FO D1 1 EK), D1),\n      \\D0 D1 -> (D0, D1 ^ (FO D0 0 EK)),\n      \\D0 D1 -> (FLINV D0 0 EK, D1),\n      \\D0 D1 -> (D0, FLINV D1 1 EK)]\nextend : {total, n}\n  (fin total, fin n, total >= n) =>\n    [n] -> [total]\nextend n = zero # n\nisEven : {a} (fin a) => [a] -> Bool\nisEven n = ~(n ! 0)\n\/* pragma misty1Correct : property *\/\nmisty1Correct pt key =\n  misty1Decrypt (misty1Encrypt pt EK) EK == pt\n  where\n    EK = keySchedule key\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/004_mct_ecb_decrypt_128.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type AESTestVector 128 and the function mct_ecb_decrypt_128 : [128] -> [128] -> [100](AESTestVector 128) implementing the AES-128 Monte Carlo Test for ECB decryption using aesDecryptBlock and aes128DecryptSchedule from SuiteB, including generation of 100 test vectors from an initial key and ciphertext as described."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_128 : [128] -> [128] -> [100](AESTestVector 128)\nmct_ecb_decrypt_128 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][128]\n    keys =\n      [initialKey] # [k ^ (xs ! 0) | xs <- take`{99}\n                                    (groupBy`{1000} pts)\n                                   | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES128)\n    schedules = map aes128DecryptSchedule keys\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/006_aes128_MCT_vectors_encrypt_correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `aes128_MCT_vectors_encrypt_correct` that proves the AES-128 Monte Carlo Test (MCT) ECB encryption reference vectors `aes128_MCT_encrypt_test_vectors : [100](AESTestVector 128)` are exactly those produced by `mct_ecb_encrypt_128 : [128] -> [128] -> [100](AESTestVector 128)` when called with the given initial key and plaintext."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_encrypt_128 : [128] -> [128] -> [100](AESTestVector 128)\nmct_ecb_encrypt_128 initialKey initialPt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       plaintext = pts @ (i * 1000),\n       ciphertext = cts @ (i * 1000 + 999)})\n    pts : [100 * 1000][128]\n    pts = [initialPt] # take cts\n    cts : [100 * 1000][128]\n    cts =\n      generate (\\i ->\n       aesEncryptBlock (schedules @ (i \/ 1000)) (pts @ i))\n    keys : [100][128]\n    keys =\n      [initialKey] # [k ^ (xs ! 0) | xs <- take`{99}\n                                    (groupBy`{1000} cts)\n                                   | k <- keys]\n    schedules : [100](AESEncryptKeySchedule AES128)\n    schedules = map aes128EncryptSchedule keys\n\/* pragma aes128_MCT_vectors_encrypt_correct : property *\/\naes128_MCT_vectors_encrypt_correct =\n  aes128_MCT_encrypt_test_vectors == mct_ecb_encrypt_128\n    0x139a35422f1d61de3c91787fe0507afd\n    0xb9145a768b7dc489a096b546f43b231f\naes128_MCT_encrypt_test_vectors : [100](AESTestVector 128)\naes128_MCT_encrypt_test_vectors =\n  [{key = 0x139a35422f1d61de3c91787fe0507afd,\n  plaintext = 0xb9145a768b7dc489a096b546f43b231f,\n  ciphertext = 0xd7c3ffac9031238650901e157364c386},\n  {key = 0xc459caeebf2c42586c01666a9334b97b,\n  plaintext = 0xd7c3ffac9031238650901e157364c386,\n  ciphertext = 0xbc3637da2daf8fcf7c68bb28c143a0a4},\n  {key = 0x786ffd349283cd971069dd42527719df,\n  plaintext = 0xbc3637da2daf8fcf7c68bb28c143a0a4,\n  ciphertext = 0x9c88a8db798f48df1ac4936afa959eac},\n  {key = 0xe4e755efeb0c85480aad4e28a8e28773,\n  plaintext = 0x9c88a8db798f48df1ac4936afa959eac,\n  ciphertext = 0xb87aaa1c76a775d94c2ddf82abe5c66e},\n  {key = 0x5c9dfff39dabf091468091aa0307411d,\n  plaintext = 0xb87aaa1c76a775d94c2ddf82abe5c66e,\n  ciphertext = 0x79ee212734f14d1bf5a59d46e8c2fa34},\n  {key = 0x2573ded4a95abd8ab3250cecebc5bb29,\n  plaintext = 0x79ee212734f14d1bf5a59d46e8c2fa34,\n  ciphertext = 0x09df49135aeb8e373a19fa457ab280a0},\n  {key = 0x2cac97c7f3b133bd893cf6a991773b89,\n  plaintext = 0x09df49135aeb8e373a19fa457ab280a0,\n  ciphertext = 0xc52263efa6379209d17e87ac250615cb},\n  {key = 0xe98ef4285586a1b458427105b4712e42,\n  plaintext = 0xc52263efa6379209d17e87ac250615cb,\n  ciphertext = 0x336bed017e10a247ee92989862431163},\n  {key = 0xdae519292b9603f3b6d0e99dd6323f21,\n  plaintext = 0x336bed017e10a247ee92989862431163,\n  ciphertext = 0xb13310581ffe5b10aaefdeb8992aec18},\n  {key = 0x6bd60971346858e31c3f37254f18d339,\n  plaintext = 0xb13310581ffe5b10aaefdeb8992aec18,\n  ciphertext = 0xb0eaede3f3eebfef88822a6ede1950b1},\n  {key = 0xdb3ce492c786e70c94bd1d4b91018388,\n  plaintext = 0xb0eaede3f3eebfef88822a6ede1950b1,\n  ciphertext = 0x37891fc253b00de13155d5517e1b7890},\n  {key = 0xecb5fb509436eaeda5e8c81aef1afb18,\n  plaintext = 0x37891fc253b00de13155d5517e1b7890,\n  ciphertext = 0x8f574c85fa44af2d43c95ee5f627fc9d},\n  {key = 0x63e2b7d56e7245c0e62196ff193d0785,\n  plaintext = 0x8f574c85fa44af2d43c95ee5f627fc9d,\n  ciphertext = 0x6c0af6709225f328a0225b2280efa3e3},\n  {key = 0x0fe841a5fc57b6e84603cddd99d2a466,\n  plaintext = 0x6c0af6709225f328a0225b2280efa3e3,\n  ciphertext = 0xe2dc36073fe192e712373a8702e8adce},\n  {key = 0xed3477a2c3b6240f5434f75a9b3a09a8,\n  plaintext = 0xe2dc36073fe192e712373a8702e8adce,\n  ciphertext = 0x1e91d1e1f82f1d320186210a792f7ba1},\n  {key = 0xf3a5a6433b99393d55b2d650e2157209,\n  plaintext = 0x1e91d1e1f82f1d320186210a792f7ba1,\n  ciphertext = 0x228eac74166da261d7fa83f43d9ddd2f},\n  {key = 0xd12b0a372df49b5c824855a4df88af26,\n  plaintext = 0x228eac74166da261d7fa83f43d9ddd2f,\n  ciphertext = 0x25d0de6a894361a1b83d5fa2fd607f26},\n  {key = 0xf4fbd45da4b7fafd3a750a0622e8d000,\n  plaintext = 0x25d0de6a894361a1b83d5fa2fd607f26,\n  ciphertext = 0x36095dc3e659ec50ca7f6f8207d20031},\n  {key = 0xc2f2899e42ee16adf00a6584253ad031,\n  plaintext = 0x36095dc3e659ec50ca7f6f8207d20031,\n  ciphertext = 0x8dbfe965078468875d86145164c4ab4f},\n  {key = 0x4f4d60fb456a7e2aad8c71d541fe7b7e,\n  plaintext = 0x8dbfe965078468875d86145164c4ab4f,\n  ciphertext = 0x4032bb8137d4b9eb93644359a995bb4e},\n  {key = 0x0f7fdb7a72bec7c13ee8328ce86bc030,\n  plaintext = 0x4032bb8137d4b9eb93644359a995bb4e,\n  ciphertext = 0x85308aa92c625a25bd5f4a40375c6baa},\n  {key = 0x8a4f51d35edc9de483b778ccdf37ab9a,\n  plaintext = 0x85308aa92c625a25bd5f4a40375c6baa,\n  ciphertext = 0x73283fc59e04e80a867e478d97a3f388},\n  {key = 0xf9676e16c0d875ee05c93f4148945812,\n  plaintext = 0x73283fc59e04e80a867e478d97a3f388,\n  ciphertext = 0x418c1fe377e4ef9832f20286b167f916},\n  {key = 0xb8eb71f5b73c9a76373b3dc7f9f3a104,\n  plaintext = 0x418c1fe377e4ef9832f20286b167f916,\n  ciphertext = 0x60ad1341525e67cffdd68ff671253c77},\n  {key = 0xd84662b4e562fdb9caedb23188d69d73,\n  plaintext = 0x60ad1341525e67cffdd68ff671253c77,\n  ciphertext = 0x4edf6e01a76de6153d17713a49d5b028},\n  {key = 0x96990cb5420f1bacf7fac30bc1032d5b,\n  plaintext = 0x4edf6e01a76de6153d17713a49d5b028,\n  ciphertext = 0x2c85ebf9e3d80596f78712df56ac77cd},\n  {key = 0xba1ce74ca1d71e3a007dd1d497af5a96,\n  plaintext = 0x2c85ebf9e3d80596f78712df56ac77cd,\n  ciphertext = 0x8fc8ef9ab7462712977e87c741795ece},\n  {key = 0x35d408d61691392897035613d6d60458,\n  plaintext = 0x8fc8ef9ab7462712977e87c741795ece,\n  ciphertext = 0x37e9ac800cfb19133b4e9b0c418ca098},\n  {key = 0x023da4561a6a203bac4dcd1f975aa4c0,\n  plaintext = 0x37e9ac800cfb19133b4e9b0c418ca098,\n  ciphertext = 0xcb7cd7619caa605e45f95f5b31a85495},\n  {key = 0xc941733786c04065e9b49244a6f2f055,\n  plaintext = 0xcb7cd7619caa605e45f95f5b31a85495,\n  ciphertext = 0x6e265e5fd030847b8841bf6652996392},\n  {key = 0xa7672d6856f0c41e61f52d22f46b93c7,\n  plaintext = 0x6e265e5fd030847b8841bf6652996392,\n  ciphertext = 0x5c9a7d2ce1c86f0b3425b3b6aae108e0},\n  {key = 0xfbfd5044b738ab1555d09e945e8a9b27,\n  plaintext = 0x5c9a7d2ce1c86f0b3425b3b6aae108e0,\n  ciphertext = 0xc911dee5ff318a7e799f92daadcb3d9a},\n  {key = 0x32ec8ea14809216b2c4f0c4ef341a6bd,\n  plaintext = 0xc911dee5ff318a7e799f92daadcb3d9a,\n  ciphertext = 0x7a3afdf10410f1c47c7d928d4a8d432a},\n  {key = 0x48d673504c19d0af50329ec3b9cce597,\n  plaintext = 0x7a3afdf10410f1c47c7d928d4a8d432a,\n  ciphertext = 0xc681b7b6d3ec9dc91012e3b7427c67ad},\n  {key = 0x8e57c4e69ff54d6640207d74fbb0823a,\n  plaintext = 0xc681b7b6d3ec9dc91012e3b7427c67ad,\n  ciphertext = 0xcd3f84bbe958536d502065eb37ae10b4},\n  {key = 0x4368405d76ad1e0b1000189fcc1e928e,\n  plaintext = 0xcd3f84bbe958536d502065eb37ae10b4,\n  ciphertext = 0x879db797e686b9116c25c07f4ae67593},\n  {key = 0xc4f5f7ca902ba71a7c25d8e086f8e71d,\n  plaintext = 0x879db797e686b9116c25c07f4ae67593,\n  ciphertext = 0x5959ebd7a1167713429eda69538c536b},\n  {key = 0x9dac1c1d313dd0093ebb0289d574b476,\n  plaintext = 0x5959ebd7a1167713429eda69538c536b,\n  ciphertext = 0xf57101d7fa19f97a31d60b276312717c},\n  {key = 0x68dd1dcacb2429730f6d09aeb666c50a,\n  plaintext = 0xf57101d7fa19f97a31d60b276312717c,\n  ciphertext = 0x6dfbbc2b147568c55adbfdc3c706edb0},\n  {key = 0x0526a1e1df5141b655b6f46d716028ba,\n  plaintext = 0x6dfbbc2b147568c55adbfdc3c706edb0,\n  ciphertext = 0x9c4ea9002306d75e7b0f03e2a72b7a1d},\n  {key = 0x996808e1fc5796e82eb9f78fd64b52a7,\n  plaintext = 0x9c4ea9002306d75e7b0f03e2a72b7a1d,\n  ciphertext = 0xcb9975336cc05f0114f26bde4cc84f8d},\n  {key = 0x52f17dd29097c9e93a4b9c519a831d2a,\n  plaintext = 0xcb9975336cc05f0114f26bde4cc84f8d,\n  ciphertext = 0x902c4250cff110d792938e8dcd534cf0},\n  {key = 0xc2dd3f825f66d93ea8d812dc57d051da,\n  plaintext = 0x902c4250cff110d792938e8dcd534cf0,\n  ciphertext = 0x140242f195ef2ef7f6ee23574c071311},\n  {key = 0xd6df7d73ca89f7c95e36318b1bd742cb,\n  plaintext = 0x140242f195ef2ef7f6ee23574c071311,\n  ciphertext = 0x3c6d4ffafde866f1e994480c47d20a04},\n  {key = 0xeab2328937619138b7a279875c0548cf,\n  plaintext = 0x3c6d4ffafde866f1e994480c47d20a04,\n  ciphertext = 0x1ca04a21addc38ef8bfc8989d3d6b33b},\n  {key = 0xf61278a89abda9d73c5ef00e8fd3fbf4,\n  plaintext = 0x1ca04a21addc38ef8bfc8989d3d6b33b,\n  ciphertext = 0xbb8875ee3c3c8c0987b1c20f999028e9},\n  {key = 0x4d9a0d46a68125debbef32011643d31d,\n  plaintext = 0xbb8875ee3c3c8c0987b1c20f999028e9,\n  ciphertext = 0x9d33724d80a76f2033a37a851403ef28},\n  {key = 0xd0a97f0b26264afe884c488402403c35,\n  plaintext = 0x9d33724d80a76f2033a37a851403ef28,\n  ciphertext = 0x4c92fe152d16da8ea59b9f29c75f20ff},\n  {key = 0x9c3b811e0b3090702dd7d7adc51f1cca,\n  plaintext = 0x4c92fe152d16da8ea59b9f29c75f20ff,\n  ciphertext = 0x659c76f73032b0192b281034b6a99a3f},\n  {key = 0xf9a7f7e93b02206906ffc79973b686f5,\n  plaintext = 0x659c76f73032b0192b281034b6a99a3f,\n  ciphertext = 0x5d296637697ccad84fc77936a31c2655},\n  {key = 0xa48e91de527eeab14938beafd0aaa0a0,\n  plaintext = 0x5d296637697ccad84fc77936a31c2655,\n  ciphertext = 0xa72a596a030d5541bc4d0fc739491d5b},\n  {key = 0x03a4c8b45173bff0f575b168e9e3bdfb,\n  plaintext = 0xa72a596a030d5541bc4d0fc739491d5b,\n  ciphertext = 0x5f5ec53c91225717fcba470688dfa364},\n  {key = 0x5cfa0d88c051e8e709cff66e613c1e9f,\n  plaintext = 0x5f5ec53c91225717fcba470688dfa364,\n  ciphertext = 0x5719cb14eba820c0d51109a0c7a4154f},\n  {key = 0x0be3c69c2bf9c827dcdeffcea6980bd0,\n  plaintext = 0x5719cb14eba820c0d51109a0c7a4154f,\n  ciphertext = 0x3abd186712a9def73b6312b5300f02af},\n  {key = 0x315edefb395016d0e7bded7b9697097f,\n  plaintext = 0x3abd186712a9def73b6312b5300f02af,\n  ciphertext = 0xb1e90c8c0d4c9651a6de7f52a63ac456},\n  {key = 0x80b7d277341c80814163922930adcd29,\n  plaintext = 0xb1e90c8c0d4c9651a6de7f52a63ac456,\n  ciphertext = 0x5d26e33aae1441554034c77bde451679},\n  {key = 0xdd91314d9a08c1d401575552eee8db50,\n  plaintext = 0x5d26e33aae1441554034c77bde451679,\n  ciphertext = 0x93e44cdce14803544a53bc5b520c156f},\n  {key = 0x4e757d917b40c2804b04e909bce4ce3f,\n  plaintext = 0x93e44cdce14803544a53bc5b520c156f,\n  ciphertext = 0x8ee3b6fd953b441043f69f3747e4cf63},\n  {key = 0xc096cb6cee7b869008f2763efb00015c,\n  plaintext = 0x8ee3b6fd953b441043f69f3747e4cf63,\n  ciphertext = 0xcb2f545970200630e5145f817a013807},\n  {key = 0x0bb99f359e5b80a0ede629bf8101395b,\n  plaintext = 0xcb2f545970200630e5145f817a013807,\n  ciphertext = 0x50047276451ce19cb14d8d2ef0b3851b},\n  {key = 0x5bbded43db47613c5caba49171b2bc40,\n  plaintext = 0x50047276451ce19cb14d8d2ef0b3851b,\n  ciphertext = 0xd243791dde33c2a4333ef4dcbcadbd3a},\n  {key = 0x89fe945e0574a3986f95504dcd1f017a,\n  plaintext = 0xd243791dde33c2a4333ef4dcbcadbd3a,\n  ciphertext = 0x343181860092a5e33c2e1c441a9f6804},\n  {key = 0xbdcf15d805e6067b53bb4c09d780697e,\n  plaintext = 0x343181860092a5e33c2e1c441a9f6804,\n  ciphertext = 0x4e7cdd553d732909e25a13a521e04078},\n  {key = 0xf3b3c88d38952f72b1e15facf6602906,\n  plaintext = 0x4e7cdd553d732909e25a13a521e04078,\n  ciphertext = 0x9c16f3fda49bb6a2b6d76a6696bd768f},\n  {key = 0x6fa53b709c0e99d0073635ca60dd5f89,\n  plaintext = 0x9c16f3fda49bb6a2b6d76a6696bd768f,\n  ciphertext = 0x9eb63f9099123591a4ca7aa0fff55a49},\n  {key = 0xf11304e0051cac41a3fc4f6a9f2805c0,\n  plaintext = 0x9eb63f9099123591a4ca7aa0fff55a49,\n  ciphertext = 0xaa6a9e40aad692550b7c87b92b205af0},\n  {key = 0x5b799aa0afca3e14a880c8d3b4085f30,\n  plaintext = 0xaa6a9e40aad692550b7c87b92b205af0,\n  ciphertext = 0xae92c267f38b9b4623df36523bb739b6},\n  {key = 0xf5eb58c75c41a5528b5ffe818fbf6686,\n  plaintext = 0xae92c267f38b9b4623df36523bb739b6,\n  ciphertext = 0x39c0de843767dfa2d563c0632405d595},\n  {key = 0xcc2b86436b267af05e3c3ee2abbab313,\n  plaintext = 0x39c0de843767dfa2d563c0632405d595,\n  ciphertext = 0x80a9445be75373b07476608feb1f1c7b},\n  {key = 0x4c82c2188c7509402a4a5e6d40a5af68,\n  plaintext = 0x80a9445be75373b07476608feb1f1c7b,\n  ciphertext = 0x5306f5a77e42d9f4cee8f134ba1448c6},\n  {key = 0x1f8437bff237d0b4e4a2af59fab1e7ae,\n  plaintext = 0x5306f5a77e42d9f4cee8f134ba1448c6,\n  ciphertext = 0x8db0c3fba7dc797cd175d97503759260},\n  {key = 0x9234f44455eba9c835d7762cf9c475ce,\n  plaintext = 0x8db0c3fba7dc797cd175d97503759260,\n  ciphertext = 0x04fcb0c77ae0c98d2afb178ab2c2b02d},\n  {key = 0x96c844832f0b60451f2c61a64b06c5e3,\n  plaintext = 0x04fcb0c77ae0c98d2afb178ab2c2b02d,\n  ciphertext = 0x1a156581b3557078971cc6877a3d9339},\n  {key = 0x8cdd21029c5e103d8830a721313b56da,\n  plaintext = 0x1a156581b3557078971cc6877a3d9339,\n  ciphertext = 0xe47087289290fa2b6734eeaab2fc815d},\n  {key = 0x68ada62a0eceea16ef04498b83c7d787,\n  plaintext = 0xe47087289290fa2b6734eeaab2fc815d,\n  ciphertext = 0x00ce641525020d35244e2227287b2a20},\n  {key = 0x6863c23f2bcce723cb4a6bacabbcfda7,\n  plaintext = 0x00ce641525020d35244e2227287b2a20,\n  ciphertext = 0xecf623cef1e420d0994070c078592c97},\n  {key = 0x8495e1f1da28c7f3520a1b6cd3e5d130,\n  plaintext = 0xecf623cef1e420d0994070c078592c97,\n  ciphertext = 0x256c8f28df4a286fb05514fcfa8cbcaf},\n  {key = 0xa1f96ed90562ef9ce25f0f9029696d9f,\n  plaintext = 0x256c8f28df4a286fb05514fcfa8cbcaf,\n  ciphertext = 0xfd4aed4b5a2b8edefe3cc2aef6ecd298},\n  {key = 0x5cb383925f4961421c63cd3edf85bf07,\n  plaintext = 0xfd4aed4b5a2b8edefe3cc2aef6ecd298,\n  ciphertext = 0xdfe0e571f77f0b46c52f003e774918ac},\n  {key = 0x835366e3a8366a04d94ccd00a8cca7ab,\n  plaintext = 0xdfe0e571f77f0b46c52f003e774918ac,\n  ciphertext = 0xe421fbeb4c23745b97578162f89e68fc},\n  {key = 0x67729d08e4151e5f4e1b4c625052cf57,\n  plaintext = 0xe421fbeb4c23745b97578162f89e68fc,\n  ciphertext = 0xc38c0bbde031d1a79438f79ff7cc68a5},\n  {key = 0xa4fe96b50424cff8da23bbfda79ea7f2,\n  plaintext = 0xc38c0bbde031d1a79438f79ff7cc68a5,\n  ciphertext = 0x86113133968aa3052709875bf033d804},\n  {key = 0x22efa78692ae6cfdfd2a3ca657ad7ff6,\n  plaintext = 0x86113133968aa3052709875bf033d804,\n  ciphertext = 0xfd706bef1bf30c8d1e95543b75629e02},\n  {key = 0xdf9fcc69895d6070e3bf689d22cfe1f4,\n  plaintext = 0xfd706bef1bf30c8d1e95543b75629e02,\n  ciphertext = 0x9a5bbb6125152f1352b10e1c1a172aa6},\n  {key = 0x45c47708ac484f63b10e668138d8cb52,\n  plaintext = 0x9a5bbb6125152f1352b10e1c1a172aa6,\n  ciphertext = 0x3ee69736488c51fa72784aa263618f45},\n  {key = 0x7b22e03ee4c41e99c3762c235bb94417,\n  plaintext = 0x3ee69736488c51fa72784aa263618f45,\n  ciphertext = 0xfc66daa246ebcc320c7c89b599014633},\n  {key = 0x87443a9ca22fd2abcf0aa596c2b80224,\n  plaintext = 0xfc66daa246ebcc320c7c89b599014633,\n  ciphertext = 0x35645885ed205d67e5caeff26646c38c},\n  {key = 0xb22062194f0f8fcc2ac04a64a4fec1a8,\n  plaintext = 0x35645885ed205d67e5caeff26646c38c,\n  ciphertext = 0xdaeaa866aa4eacdb752caccb2c0ae6c1},\n  {key = 0x68caca7fe54123175fece6af88f42769,\n  plaintext = 0xdaeaa866aa4eacdb752caccb2c0ae6c1,\n  ciphertext = 0x29e88b1ae615fcd06b09e767459d6089},\n  {key = 0x412241650354dfc734e501c8cd6947e0,\n  plaintext = 0x29e88b1ae615fcd06b09e767459d6089,\n  ciphertext = 0x63470bff052e7f5c7a735cc2e6eb61ac},\n  {key = 0x22654a9a067aa09b4e965d0a2b82264c,\n  plaintext = 0x63470bff052e7f5c7a735cc2e6eb61ac,\n  ciphertext = 0xf4fa6a3549cd2b33af9cac134d7b1402},\n  {key = 0xd69f20af4fb78ba8e10af11966f9324e,\n  plaintext = 0xf4fa6a3549cd2b33af9cac134d7b1402,\n  ciphertext = 0x5b22a82ccbae9b9c75f797e74e6da53d},\n  {key = 0x8dbd88838419103494fd66fe28949773,\n  plaintext = 0x5b22a82ccbae9b9c75f797e74e6da53d,\n  ciphertext = 0x87b51692f8f28743bd8dc843276f351a},\n  {key = 0x0a089e117ceb97772970aebd0ffba269,\n  plaintext = 0x87b51692f8f28743bd8dc843276f351a,\n  ciphertext = 0x150fb2180704a7623a1fab8bf17fba18},\n  {key = 0x1f072c097bef3015136f0536fe841871,\n  plaintext = 0x150fb2180704a7623a1fab8bf17fba18,\n  ciphertext = 0x8088874e7f3f09a98fd3f0a59f2a0b4b},\n  {key = 0x9f8fab4704d039bc9cbcf59361ae133a,\n  plaintext = 0x8088874e7f3f09a98fd3f0a59f2a0b4b,\n  ciphertext = 0x08e02c091057d81c05d917ea5c07cdd0},\n  {key = 0x976f874e1487e1a09965e2793da9deea,\n  plaintext = 0x08e02c091057d81c05d917ea5c07cdd0,\n  ciphertext = 0xb9636b3e2752694c3685872fd0a9a0ea},\n  {key = 0x2e0cec7033d588ecafe06556ed007e00,\n  plaintext = 0xb9636b3e2752694c3685872fd0a9a0ea,\n  ciphertext = 0x2610dae2b64d74a8cbb4f43fa2d0a603},\n  {key = 0x081c36928598fc44645491694fd0d803,\n  plaintext = 0x2610dae2b64d74a8cbb4f43fa2d0a603,\n  ciphertext = 0x9cc994eda697fb5545eaa502b2a30fd3},\n  {key = 0x94d5a27f230f071121be346bfd73d7d0,\n  plaintext = 0x9cc994eda697fb5545eaa502b2a30fd3,\n  ciphertext = 0xfb2649694783b551eacd9d5db6126d47}]\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/007_aes128_MCT_vectors_decrypt_correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property aes128_MCT_vectors_decrypt_correct that verifies the function mct_ecb_decrypt_128 : [128] -> [128] -> [100](AESTestVector 128), using SuiteB.aesDecryptBlock and AES128 key schedules, produces exactly the given 100 AES-128 ECB Monte Carlo decryption test vectors when started from the specified initial key and ciphertext."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_128 : [128] -> [128] -> [100](AESTestVector 128)\nmct_ecb_decrypt_128 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][128]\n    keys =\n      [initialKey] # [k ^ (xs ! 0) | xs <- take`{99}\n                                    (groupBy`{1000} pts)\n                                   | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES128)\n    schedules = map aes128DecryptSchedule keys\n\/* pragma aes128_MCT_vectors_decrypt_correct : property *\/\naes128_MCT_vectors_decrypt_correct =\n  aes128_MCT_decrypt_test_vectors == mct_ecb_decrypt_128\n    0x0c60e7bf20ada9baa9e1ddf0d1540726\n    0xb08a29b11a500ea3aca42c36675b9785\naes128_MCT_decrypt_test_vectors : [100](AESTestVector 128)\naes128_MCT_decrypt_test_vectors =\n  [{key = 0x0c60e7bf20ada9baa9e1ddf0d1540726,\n  ciphertext = 0xb08a29b11a500ea3aca42c36675b9785,\n  plaintext = 0xb613b87085fed1bb87f07a574e6d2879},\n  {key = 0xba735fcfa55378012e11a7a79f392f5f,\n  ciphertext = 0xb613b87085fed1bb87f07a574e6d2879,\n  plaintext = 0x5541d7bf6d25c55c0c2296acba756e9e},\n  {key = 0xef328870c876bd5d2233310b254c41c1,\n  ciphertext = 0x5541d7bf6d25c55c0c2296acba756e9e,\n  plaintext = 0x4c138198d55d0d87d43cdb92fb0b5fc0},\n  {key = 0xa32109e81d2bb0daf60fea99de471e01,\n  ciphertext = 0x4c138198d55d0d87d43cdb92fb0b5fc0,\n  plaintext = 0x257c07bdcba57aff1643de90b63c0a88},\n  {key = 0x865d0e55d68eca25e04c3409687b1489,\n  ciphertext = 0x257c07bdcba57aff1643de90b63c0a88,\n  plaintext = 0x8039be4e65d218d3e640f88309d01c6f},\n  {key = 0x0664b01bb35cd2f6060ccc8a61ab08e6,\n  ciphertext = 0x8039be4e65d218d3e640f88309d01c6f,\n  plaintext = 0x0115dcd390855bf5ce32e946a6d5ad38},\n  {key = 0x07716cc823d98903c83e25ccc77ea5de,\n  ciphertext = 0x0115dcd390855bf5ce32e946a6d5ad38,\n  plaintext = 0x71741ccb723348c7f3f9e4a397977bdb},\n  {key = 0x7605700351eac1c43bc7c16f50e9de05,\n  ciphertext = 0x71741ccb723348c7f3f9e4a397977bdb,\n  plaintext = 0x668c9f3dc9e154bd16d61364a99f635d},\n  {key = 0x1089ef3e980b95792d11d20bf976bd58,\n  ciphertext = 0x668c9f3dc9e154bd16d61364a99f635d,\n  plaintext = 0x124b19b2501a540066ddf7943417cba3},\n  {key = 0x02c2f68cc811c1794bcc259fcd6176fb,\n  ciphertext = 0x124b19b2501a540066ddf7943417cba3,\n  plaintext = 0x23e7c95f7ed9017af339c234b7a8fcc4},\n  {key = 0x21253fd3b6c8c003b8f5e7ab7ac98a3f,\n  ciphertext = 0x23e7c95f7ed9017af339c234b7a8fcc4,\n  plaintext = 0x7b0e1e1afe46c1e50785efb939f8ade3},\n  {key = 0x5a2b21c9488e01e6bf700812433127dc,\n  ciphertext = 0x7b0e1e1afe46c1e50785efb939f8ade3,\n  plaintext = 0xc166aeebf5182c96d1f3c92cece9d714},\n  {key = 0x9b4d8f22bd962d706e83c13eafd8f0c8,\n  ciphertext = 0xc166aeebf5182c96d1f3c92cece9d714,\n  plaintext = 0x71968762dc1b41bebd9ee8b2396b87be},\n  {key = 0xeadb0840618d6cced31d298c96b37776,\n  ciphertext = 0x71968762dc1b41bebd9ee8b2396b87be,\n  plaintext = 0x77b0aa88222a785282352bb861ea0cd2},\n  {key = 0x9d6ba2c843a7149c51280234f7597ba4,\n  ciphertext = 0x77b0aa88222a785282352bb861ea0cd2,\n  plaintext = 0xe65c461cba6957fe5b5ee5014c899e65},\n  {key = 0x7b37e4d4f9ce43620a76e735bbd0e5c1,\n  ciphertext = 0xe65c461cba6957fe5b5ee5014c899e65,\n  plaintext = 0xa799870cee001551f3494bdf3c27bd94},\n  {key = 0xdcae63d817ce5633f93facea87f75855,\n  ciphertext = 0xa799870cee001551f3494bdf3c27bd94,\n  plaintext = 0xf54697576153f97d9fb1a4d164a8538e},\n  {key = 0x29e8f48f769daf4e668e083be35f0bdb,\n  ciphertext = 0xf54697576153f97d9fb1a4d164a8538e,\n  plaintext = 0xf3f1f964b98b3498898c3032e44a308c},\n  {key = 0xda190debcf169bd6ef02380907153b57,\n  ciphertext = 0xf3f1f964b98b3498898c3032e44a308c,\n  plaintext = 0x40ccc3a26141900280a3a7b62d4ed8b6},\n  {key = 0x9ad5ce49ae570bd46fa19fbf2a5be3e1,\n  ciphertext = 0x40ccc3a26141900280a3a7b62d4ed8b6,\n  plaintext = 0x7fcf64bd75808be6199f3fac0881d4d4},\n  {key = 0xe51aaaf4dbd78032763ea01322da3735,\n  ciphertext = 0x7fcf64bd75808be6199f3fac0881d4d4,\n  plaintext = 0x11ca970c169315ff0b54ecdb00ba4547},\n  {key = 0xf4d03df8cd4495cd7d6a4cc822607272,\n  ciphertext = 0x11ca970c169315ff0b54ecdb00ba4547,\n  plaintext = 0xbc02615754b58eb975c26190a3583d28},\n  {key = 0x48d25caf99f11b7408a82d5881384f5a,\n  ciphertext = 0xbc02615754b58eb975c26190a3583d28,\n  plaintext = 0x5b12925c7f72aaafbae6834a6e9d5af9},\n  {key = 0x13c0cef3e683b1dbb24eae12efa515a3,\n  ciphertext = 0x5b12925c7f72aaafbae6834a6e9d5af9,\n  plaintext = 0x7950ffe2537235bfaa38101c2a9e6d42},\n  {key = 0x6a903111b5f184641876be0ec53b78e1,\n  ciphertext = 0x7950ffe2537235bfaa38101c2a9e6d42,\n  plaintext = 0xcdf5c997d8ddcc1de7cc47ecc47d0819},\n  {key = 0xa765f8866d2c4879ffbaf9e2014670f8,\n  ciphertext = 0xcdf5c997d8ddcc1de7cc47ecc47d0819,\n  plaintext = 0x8f4d77bccc4858016b28c2e8f84dd9a3},\n  {key = 0x28288f3aa164107894923b0af90ba95b,\n  ciphertext = 0x8f4d77bccc4858016b28c2e8f84dd9a3,\n  plaintext = 0x561d95847869cccc81df7df65d70808d},\n  {key = 0x7e351abed90ddcb4154d46fca47b29d6,\n  ciphertext = 0x561d95847869cccc81df7df65d70808d,\n  plaintext = 0x17b9e6f86ec1cff22cc6f8e14072bb0f},\n  {key = 0x698cfc46b7cc1346398bbe1de40992d9,\n  ciphertext = 0x17b9e6f86ec1cff22cc6f8e14072bb0f,\n  plaintext = 0x8f959f24fae93418c2262ec73c6c8e1d},\n  {key = 0xe61963624d25275efbad90dad8651cc4,\n  ciphertext = 0x8f959f24fae93418c2262ec73c6c8e1d,\n  plaintext = 0x2876f3a90b7a60168869d9de1e455836},\n  {key = 0xce6f90cb465f474873c44904c62044f2,\n  ciphertext = 0x2876f3a90b7a60168869d9de1e455836,\n  plaintext = 0x5c609c0acdf2e389f19b3e0657706c9c},\n  {key = 0x920f0cc18bada4c1825f77029150286e,\n  ciphertext = 0x5c609c0acdf2e389f19b3e0657706c9c,\n  plaintext = 0x88f537f67481490d20b713ff48b079e5},\n  {key = 0x1afa3b37ff2cedcca2e864fdd9e0518b,\n  ciphertext = 0x88f537f67481490d20b713ff48b079e5,\n  plaintext = 0x0b1878fc9406b6c5f2c0085e8c9e0dd9},\n  {key = 0x11e243cb6b2a5b0950286ca3557e5c52,\n  ciphertext = 0x0b1878fc9406b6c5f2c0085e8c9e0dd9,\n  plaintext = 0x594b9df3bad040afa14e63298945068d},\n  {key = 0x48a9de38d1fa1ba6f1660f8adc3b5adf,\n  ciphertext = 0x594b9df3bad040afa14e63298945068d,\n  plaintext = 0xfcf5ffafacc372e641b1520fe76d16c7},\n  {key = 0xb45c21977d396940b0d75d853b564c18,\n  ciphertext = 0xfcf5ffafacc372e641b1520fe76d16c7,\n  plaintext = 0x67319b7ab394937244b93977ba06c1ee},\n  {key = 0xd36dbaedceadfa32f46e64f281508df6,\n  ciphertext = 0x67319b7ab394937244b93977ba06c1ee,\n  plaintext = 0xd956a31188a667eea44c93582d6aed6f},\n  {key = 0x0a3b19fc460b9ddc5022f7aaac3a6099,\n  ciphertext = 0xd956a31188a667eea44c93582d6aed6f,\n  plaintext = 0x04f18289308787f3d936dd2a45c49e22},\n  {key = 0x0eca9b75768c1a2f89142a80e9fefebb,\n  ciphertext = 0x04f18289308787f3d936dd2a45c49e22,\n  plaintext = 0xc925df60f455b0e27852efcf9fddc3d0},\n  {key = 0xc7ef441582d9aacdf146c54f76233d6b,\n  ciphertext = 0xc925df60f455b0e27852efcf9fddc3d0,\n  plaintext = 0x14c3bcf83483de973d975dbf249c505e},\n  {key = 0xd32cf8edb65a745accd198f052bf6d35,\n  ciphertext = 0x14c3bcf83483de973d975dbf249c505e,\n  plaintext = 0xa5f3f4afd0d01b9f4999d27e6386e925},\n  {key = 0x76df0c42668a6fc585484a8e31398410,\n  ciphertext = 0xa5f3f4afd0d01b9f4999d27e6386e925,\n  plaintext = 0xd94451374478c1bdb4b94eb6908a205e},\n  {key = 0xaf9b5d7522f2ae7831f10438a1b3a44e,\n  ciphertext = 0xd94451374478c1bdb4b94eb6908a205e,\n  plaintext = 0x9f3c6ed40a32c89d4ee8d4b87c8298c7},\n  {key = 0x30a733a128c066e57f19d080dd313c89,\n  ciphertext = 0x9f3c6ed40a32c89d4ee8d4b87c8298c7,\n  plaintext = 0x54aa57cf75650cf6b7ccbd7202469bf7},\n  {key = 0x640d646e5da56a13c8d56df2df77a77e,\n  ciphertext = 0x54aa57cf75650cf6b7ccbd7202469bf7,\n  plaintext = 0x11bc0be20465848934c0fd7d7ced8bd1},\n  {key = 0x75b16f8c59c0ee9afc15908fa39a2caf,\n  ciphertext = 0x11bc0be20465848934c0fd7d7ced8bd1,\n  plaintext = 0x69d48f1ca39977f1c05f8cabd5f7e4ac},\n  {key = 0x1c65e090fa59996b3c4a1c24766dc803,\n  ciphertext = 0x69d48f1ca39977f1c05f8cabd5f7e4ac,\n  plaintext = 0x2e447e6121162382c182b3efb27b2d5a},\n  {key = 0x32219ef1db4fbae9fdc8afcbc416e559,\n  ciphertext = 0x2e447e6121162382c182b3efb27b2d5a,\n  plaintext = 0x3d99d0dff0891c38bec01551b4040e55},\n  {key = 0x0fb84e2e2bc6a6d14308ba9a7012eb0c,\n  ciphertext = 0x3d99d0dff0891c38bec01551b4040e55,\n  plaintext = 0x92294ba363ed5b750c066cb6708620ee},\n  {key = 0x9d91058d482bfda44f0ed62c0094cbe2,\n  ciphertext = 0x92294ba363ed5b750c066cb6708620ee,\n  plaintext = 0xcb674decffaae472d3d0710935b02aae},\n  {key = 0x56f64861b78119d69cdea7253524e14c,\n  ciphertext = 0xcb674decffaae472d3d0710935b02aae,\n  plaintext = 0x47cd6a4b2f9b3d610d2bd3fe39feec91},\n  {key = 0x113b222a981a24b791f574db0cda0ddd,\n  ciphertext = 0x47cd6a4b2f9b3d610d2bd3fe39feec91,\n  plaintext = 0x65b0b926a5b5b67f6895af42441f106b},\n  {key = 0x748b9b0c3daf92c8f960db9948c51db6,\n  ciphertext = 0x65b0b926a5b5b67f6895af42441f106b,\n  plaintext = 0x3642fd59024efb3dc4e5bb268dd9de04},\n  {key = 0x42c966553fe169f53d8560bfc51cc3b2,\n  ciphertext = 0x3642fd59024efb3dc4e5bb268dd9de04,\n  plaintext = 0x4e5d32a0e40dd9b830af0c2904518906},\n  {key = 0x0c9454f5dbecb04d0d2a6c96c14d4ab4,\n  ciphertext = 0x4e5d32a0e40dd9b830af0c2904518906,\n  plaintext = 0x40a7ff6a6d0ea135245d5b24a0004466},\n  {key = 0x4c33ab9fb6e21178297737b2614d0ed2,\n  ciphertext = 0x40a7ff6a6d0ea135245d5b24a0004466,\n  plaintext = 0xb18e6d37f5292acd1eaeee742930952a},\n  {key = 0xfdbdc6a843cb3bb537d9d9c6487d9bf8,\n  ciphertext = 0xb18e6d37f5292acd1eaeee742930952a,\n  plaintext = 0x42df9c23bfbc90b787c5cb0dc08e80dc},\n  {key = 0xbf625a8bfc77ab02b01c12cb88f31b24,\n  ciphertext = 0x42df9c23bfbc90b787c5cb0dc08e80dc,\n  plaintext = 0x589af99abbba45318106d2c1ca7b82b0},\n  {key = 0xe7f8a31147cdee33311ac00a42889994,\n  ciphertext = 0x589af99abbba45318106d2c1ca7b82b0,\n  plaintext = 0x96f54a5bacec995c0263226cd443f2c6},\n  {key = 0x710de94aeb21776f3379e26696cb6b52,\n  ciphertext = 0x96f54a5bacec995c0263226cd443f2c6,\n  plaintext = 0x84e07ce717c747cb924e42cdf6ec6524},\n  {key = 0xf5ed95adfce630a4a137a0ab60270e76,\n  ciphertext = 0x84e07ce717c747cb924e42cdf6ec6524,\n  plaintext = 0x5140a66d02867ddfa8bb014f75d53b83},\n  {key = 0xa4ad33c0fe604d7b098ca1e415f235f5,\n  ciphertext = 0x5140a66d02867ddfa8bb014f75d53b83,\n  plaintext = 0xa1570dc8605d7d68f0a2416aa2c3536a},\n  {key = 0x05fa3e089e3d3013f92ee08eb731669f,\n  ciphertext = 0xa1570dc8605d7d68f0a2416aa2c3536a,\n  plaintext = 0x96ab8bd9091a703a6e6d1a2190f0b5c9},\n  {key = 0x9351b5d1972740299743faaf27c1d356,\n  ciphertext = 0x96ab8bd9091a703a6e6d1a2190f0b5c9,\n  plaintext = 0x8418c2cec9d7cc3825152790f120488f},\n  {key = 0x1749771f5ef08c11b256dd3fd6e19bd9,\n  ciphertext = 0x8418c2cec9d7cc3825152790f120488f,\n  plaintext = 0x7973673755c8201ec52bdec30a86191f},\n  {key = 0x6e3a10280b38ac0f777d03fcdc6782c6,\n  ciphertext = 0x7973673755c8201ec52bdec30a86191f,\n  plaintext = 0x2a92ba991755f3c6ad1ef58681ac3a12},\n  {key = 0x44a8aab11c6d5fc9da63f67a5dcbb8d4,\n  ciphertext = 0x2a92ba991755f3c6ad1ef58681ac3a12,\n  plaintext = 0xe3daa0cfe79594311762ca0d39985da2},\n  {key = 0xa7720a7efbf8cbf8cd013c776453e576,\n  ciphertext = 0xe3daa0cfe79594311762ca0d39985da2,\n  plaintext = 0x5c2ea8b0b4bd7b50b48abd7df8e716f2},\n  {key = 0xfb5ca2ce4f45b0a8798b810a9cb4f384,\n  ciphertext = 0x5c2ea8b0b4bd7b50b48abd7df8e716f2,\n  plaintext = 0xf15e39a11ed397378b6de3d62bde10c2},\n  {key = 0x0a029b6f5196279ff2e662dcb76ae346,\n  ciphertext = 0xf15e39a11ed397378b6de3d62bde10c2,\n  plaintext = 0xd16879ee2fe2c07703e7eba3e093e911},\n  {key = 0xdb6ae2817e74e7e8f101897f57f90a57,\n  ciphertext = 0xd16879ee2fe2c07703e7eba3e093e911,\n  plaintext = 0x57aac9d12da681f1ef4fc3d07269e159},\n  {key = 0x8cc02b5053d266191e4e4aaf2590eb0e,\n  ciphertext = 0x57aac9d12da681f1ef4fc3d07269e159,\n  plaintext = 0xf6472d8a7d288db2262d826ff2f806ee},\n  {key = 0x7a8706da2efaebab3863c8c0d768ede0,\n  ciphertext = 0xf6472d8a7d288db2262d826ff2f806ee,\n  plaintext = 0xd3ec20ae3257192d51f2ce4e73f87e53},\n  {key = 0xa96b26741cadf2866991068ea49093b3,\n  ciphertext = 0xd3ec20ae3257192d51f2ce4e73f87e53,\n  plaintext = 0xd99891b245282641fb9e91681fce7ee1},\n  {key = 0x70f3b7c65985d4c7920f97e6bb5eed52,\n  ciphertext = 0xd99891b245282641fb9e91681fce7ee1,\n  plaintext = 0x8f2fa0031baacb388ed7da3e7fd62828},\n  {key = 0xffdc17c5422f1fff1cd84dd8c488c57a,\n  ciphertext = 0x8f2fa0031baacb388ed7da3e7fd62828,\n  plaintext = 0x80bed13ad5aebb0783629b03af2f6897},\n  {key = 0x7f62c6ff9781a4f89fbad6db6ba7aded,\n  ciphertext = 0x80bed13ad5aebb0783629b03af2f6897,\n  plaintext = 0xfac43dfa16d393580f130b8a955339a6},\n  {key = 0x85a6fb05815237a090a9dd51fef4944b,\n  ciphertext = 0xfac43dfa16d393580f130b8a955339a6,\n  plaintext = 0x60aa3f3683346b09466f1c4c11b376f5},\n  {key = 0xe50cc43302665ca9d6c6c11def47e2be,\n  ciphertext = 0x60aa3f3683346b09466f1c4c11b376f5,\n  plaintext = 0xe93ac158da113797bce2472240c4d7bb},\n  {key = 0x0c36056bd8776b3e6a24863faf833505,\n  ciphertext = 0xe93ac158da113797bce2472240c4d7bb,\n  plaintext = 0xe96e8432e2eea1de7e0cceadfe5e1623},\n  {key = 0xe55881593a99cae01428489251dd2326,\n  ciphertext = 0xe96e8432e2eea1de7e0cceadfe5e1623,\n  plaintext = 0xd99630cb34f06a3a02e9803a029980a2},\n  {key = 0x3cceb1920e69a0da16c1c8a85344a384,\n  ciphertext = 0xd99630cb34f06a3a02e9803a029980a2,\n  plaintext = 0xe5a14b334430768edf5dd7863ee30678},\n  {key = 0xd96ffaa14a59d654c99c1f2e6da7a5fc,\n  ciphertext = 0xe5a14b334430768edf5dd7863ee30678,\n  plaintext = 0x49dab0bc5fb8c387ea9c557d3a35e659},\n  {key = 0x90b54a1d15e115d323004a53579243a5,\n  ciphertext = 0x49dab0bc5fb8c387ea9c557d3a35e659,\n  plaintext = 0x6867e956763a7377a15a4248ab91c829},\n  {key = 0xf8d2a34b63db66a4825a081bfc038b8c,\n  ciphertext = 0x6867e956763a7377a15a4248ab91c829,\n  plaintext = 0x4f536383ba4e258dd3ab764027a66e39},\n  {key = 0xb781c0c8d995432951f17e5bdba5e5b5,\n  ciphertext = 0x4f536383ba4e258dd3ab764027a66e39,\n  plaintext = 0xe9b6abc089286834eb9421e71fe98517},\n  {key = 0x5e376b0850bd2b1dba655fbcc44c60a2,\n  ciphertext = 0xe9b6abc089286834eb9421e71fe98517,\n  plaintext = 0x256121dead70e6675ad631dd0527fb1a},\n  {key = 0x7b564ad6fdcdcd7ae0b36e61c16b9bb8,\n  ciphertext = 0x256121dead70e6675ad631dd0527fb1a,\n  plaintext = 0x6bdbcc94ec6497445e4024acb601741b},\n  {key = 0x108d864211a95a3ebef34acd776aefa3,\n  ciphertext = 0x6bdbcc94ec6497445e4024acb601741b,\n  plaintext = 0x44e86f9d48c6699554a3538eb6f55479},\n  {key = 0x5465e9df596f33abea501943c19fbbda,\n  ciphertext = 0x44e86f9d48c6699554a3538eb6f55479,\n  plaintext = 0xc7c622fee00a180f3131a57a82acf7a9},\n  {key = 0x93a3cb21b9652ba4db61bc3943334c73,\n  ciphertext = 0xc7c622fee00a180f3131a57a82acf7a9,\n  plaintext = 0xe096b0406e6e8abb6ced353f1be40693},\n  {key = 0x73357b61d70ba11fb78c890658d74ae0,\n  ciphertext = 0xe096b0406e6e8abb6ced353f1be40693,\n  plaintext = 0x73326251dbd89c23b37caee2ee6d2d9e},\n  {key = 0x000719300cd33d3c04f027e4b6ba677e,\n  ciphertext = 0x73326251dbd89c23b37caee2ee6d2d9e,\n  plaintext = 0x7b2c687d460054af03709645056407c6},\n  {key = 0x7b2b714d4ad369930780b1a1b3de60b8,\n  ciphertext = 0x7b2c687d460054af03709645056407c6,\n  plaintext = 0x8bb9f381438145a96714e238a8864e0b},\n  {key = 0xf09282cc09522c3a609453991b582eb3,\n  ciphertext = 0x8bb9f381438145a96714e238a8864e0b,\n  plaintext = 0xd59509d08bcfc30e20344b1c4c53f726},\n  {key = 0x25078b1c829def3440a01885570bd995,\n  ciphertext = 0xd59509d08bcfc30e20344b1c4c53f726,\n  plaintext = 0x02e6077d01a352637899d6ce626782ac},\n  {key = 0x27e18c61833ebd573839ce4b356c5b39,\n  ciphertext = 0x02e6077d01a352637899d6ce626782ac,\n  plaintext = 0xed01d9601145c11662986b0827e403ec},\n  {key = 0xcae05501927b7c415aa1a543128858d5,\n  ciphertext = 0xed01d9601145c11662986b0827e403ec,\n  plaintext = 0x7d5b1ca06884b5a55e9035fe7d77d4a7},\n  {key = 0xb7bb49a1faffc9e4043190bd6fff8c72,\n  ciphertext = 0x7d5b1ca06884b5a55e9035fe7d77d4a7,\n  plaintext = 0x1a23d371b97e1056e8bc9545c56cab9e},\n  {key = 0xad989ad04381d9b2ec8d05f8aa9327ec,\n  ciphertext = 0x1a23d371b97e1056e8bc9545c56cab9e,\n  plaintext = 0xd1d2bfdc58ffcad2341b095bce55221e}]\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/012_mct_ecb_encrypt_192.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the function `mct_ecb_encrypt_192 : [192] -> [128] -> [100](AESTestVector 192)` implementing the AES-192 Monte Carlo Test (MCT) for ECB encryption, including the iterative generation of 100 test vectors with evolving keys, plaintexts, ciphertexts, and corresponding AES-192 encryption key schedules using `aesEncryptBlock` and `aes192EncryptSchedule` from `SuiteB`."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_encrypt_192 : [192] -> [128] -> [100](AESTestVector 192)\nmct_ecb_encrypt_192 initialKey initialPt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       plaintext = pts @ (i * 1000),\n       ciphertext = cts @ (i * 1000 + 999)})\n    pts : [100 * 1000][128]\n    pts = [initialPt] # take cts\n    cts : [100 * 1000][128]\n    cts =\n      generate (\\i ->\n       aesEncryptBlock (schedules @ (i \/ 1000)) (pts @ i))\n    keys : [100][192]\n    keys =\n      [initialKey] # [k ^ ((drop`{64}\n        (xs ! 1)) # xs ! 0) | xs <- take`{99} (groupBy`{1000} cts)\n                            | k <- keys]\n    schedules : [100](AESEncryptKeySchedule AES192)\n    schedules = map aes192EncryptSchedule keys\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/014_mct_ecb_decrypt_192.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the function `mct_ecb_decrypt_192 : [192] -> [128] -> [100](AESTestVector 192)` and any required types and helpers so that it models the AES-192 Monte Carlo Test for ECB decryption, producing 100 test vectors of key, plaintext, and ciphertext derived from iterative AES-192 decryption and key schedule updates."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_192 : [192] -> [128] -> [100](AESTestVector 192)\nmct_ecb_decrypt_192 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][192]\n    keys =\n      [initialKey] # [k ^ ((drop`{64}\n        (xs ! 1)) # xs ! 0) | xs <- take`{99} (groupBy`{1000} pts)\n                            | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES192)\n    schedules = map aes192DecryptSchedule keys\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/016_mct_ecb_encrypt_256.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `mct_ecb_encrypt_256 : [256] -> [128] -> [100](AESTestVector 256)` and any required supporting types and functions so that it computes the 100-vector AES-256 Monte Carlo ECB encryption test sequence given an initial 256-bit key and 128-bit plaintext, using iterative key updates, block encryptions, and key schedules as in NIST AES Monte Carlo Test specifications."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_encrypt_256 : [256] -> [128] -> [100](AESTestVector 256)\nmct_ecb_encrypt_256 initialKey initialPt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       plaintext = pts @ (i * 1000),\n       ciphertext = cts @ (i * 1000 + 999)})\n    pts : [100 * 1000][128]\n    pts = [initialPt] # take cts\n    cts : [100 * 1000][128]\n    cts =\n      generate (\\i ->\n       aesEncryptBlock (schedules @ (i \/ 1000)) (pts @ i))\n    keys : [100][256]\n    keys =\n      [initialKey] # [k ^ (xs ! 1 # xs ! 0) | xs <- take`{99}\n                                             (groupBy`{1000} cts)\n                                            | k <- keys]\n    schedules : [100](AESEncryptKeySchedule AES256)\n    schedules = map aes256EncryptSchedule keys\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/018_mct_ecb_decrypt_256.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the function `mct_ecb_decrypt_256 : [256] -> [128] -> [100](AESTestVector 256)` implementing the AES-256 Monte Carlo Test for ECB decryption, using `aesDecryptBlock`, `aes256DecryptSchedule`, and `AESDecryptKeySchedule AES256` to iteratively derive 1000-block plaintext\/ciphertext chains and updated keys, and returning 100 test vectors of key\/plaintext\/ciphertext triples as specified."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_256 : [256] -> [128] -> [100](AESTestVector 256)\nmct_ecb_decrypt_256 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][256]\n    keys =\n      [initialKey] # [k ^ (xs ! 1 # xs ! 0) | xs <- take`{99}\n                                             (groupBy`{1000} pts)\n                                            | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES256)\n    schedules = map aes256DecryptSchedule keys\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/020_aes192_MCT_vectors_encrypt_correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `aes192_MCT_vectors_encrypt_correct` that checks, for all 192-bit initial keys and 128-bit initial plaintexts, that the Monte Carlo AES-192 ECB encryption generator `mct_ecb_encrypt_192 : [192] -> [128] -> [100](AESTestVector 192)` produces exactly the 100 known-good NIST AES-192 MCT ECB encryption test vectors `aes192_MCT_encrypt_test_vectors` given the specific initial key 0xb9a63e09e1dfc42e93a90d9bad739e5967aef672eedd5da9 and plaintext 0x85a1f7a58167b389cddc8a9ff175ee26."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_encrypt_192 : [192] -> [128] -> [100](AESTestVector 192)\nmct_ecb_encrypt_192 initialKey initialPt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       plaintext = pts @ (i * 1000),\n       ciphertext = cts @ (i * 1000 + 999)})\n    pts : [100 * 1000][128]\n    pts = [initialPt] # take cts\n    cts : [100 * 1000][128]\n    cts =\n      generate (\\i ->\n       aesEncryptBlock (schedules @ (i \/ 1000)) (pts @ i))\n    keys : [100][192]\n    keys =\n      [initialKey] # [k ^ ((drop`{64}\n        (xs ! 1)) # xs ! 0) | xs <- take`{99} (groupBy`{1000} cts)\n                            | k <- keys]\n    schedules : [100](AESEncryptKeySchedule AES192)\n    schedules = map aes192EncryptSchedule keys\n\/* pragma aes192_MCT_vectors_encrypt_correct : property *\/\naes192_MCT_vectors_encrypt_correct =\n  aes192_MCT_encrypt_test_vectors == mct_ecb_encrypt_192\n    0xb9a63e09e1dfc42e93a90d9bad739e5967aef672eedd5da9\n    0x85a1f7a58167b389cddc8a9ff175ee26\naes192_MCT_encrypt_test_vectors : [100](AESTestVector 192)\naes192_MCT_encrypt_test_vectors =\n  [{key = 0xb9a63e09e1dfc42e93a90d9bad739e5967aef672eedd5da9,\n  plaintext = 0x85a1f7a58167b389cddc8a9ff175ee26,\n  ciphertext = 0xee83d85279e022d2048031abeefbc4a4},\n  {key = 0x3aaa458160ee54c97d2ad5c9d493bc8b632ec7d90026990d,\n  plaintext = 0xee83d85279e022d2048031abeefbc4a4,\n  ciphertext = 0xa8f99517b4bd14a16c26bae901417498},\n  {key = 0x1d17d1bcc74a8584d5d340de602ea82a0f087d300167ed95,\n  plaintext = 0xa8f99517b4bd14a16c26bae901417498,\n  ciphertext = 0x80286e71937334fd6e90c706abbaf0ff},\n  {key = 0xc0025cd0eb1f23c055fb2eaff35d9cd76198ba36aadd1d6a,\n  plaintext = 0x80286e71937334fd6e90c706abbaf0ff,\n  ciphertext = 0xc8b8c153bcb231e9424d65f37bff75b8},\n  {key = 0xafb45c1097553d589d43effc4fefad3e23d5dfc5d12268d2,\n  plaintext = 0xc8b8c153bcb231e9424d65f37bff75b8,\n  ciphertext = 0x8108fbfde1cff0d94b88b1073114c657},\n  {key = 0x8b81e2418f676a5b1c4b1401ae205de7685d6ec2e036ae85,\n  plaintext = 0x8108fbfde1cff0d94b88b1073114c657,\n  ciphertext = 0x79af44f2490efc90d217af55dd10fd2e},\n  {key = 0x43463bbf9528c3bc65e450f3e72ea177ba4ac1973d2653ab,\n  plaintext = 0x79af44f2490efc90d217af55dd10fd2e,\n  ciphertext = 0xd0c2da3860c367e1fd68cf04bb6b41cd},\n  {key = 0x0e3efca8ca3fd45bb5268acb87edc69647220e93864d1266,\n  plaintext = 0xd0c2da3860c367e1fd68cf04bb6b41cd,\n  ciphertext = 0xe5d39a5d7ca8c4f4aafd3d851c40c016},\n  {key = 0x2908445968d0a18f50f51096fb450262eddf33169a0dd270,\n  plaintext = 0xe5d39a5d7ca8c4f4aafd3d851c40c016,\n  ciphertext = 0x98657051b23c69741b2ab506f818fd3f},\n  {key = 0x00feb8bffd6b4bcbc89060c749796b16f6f5861062152f4f,\n  plaintext = 0x98657051b23c69741b2ab506f818fd3f,\n  ciphertext = 0xc9b6e95fb54b540adc1faa8cece00286},\n  {key = 0xbe96e16fffe0a2db01268998fc323f1c2aea2c9c8ef52dc9,\n  plaintext = 0xc9b6e95fb54b540adc1faa8cece00286,\n  ciphertext = 0x5cf9f61a3dd3a2f76d571384c831ae88},\n  {key = 0x41baf817490bf49c5ddf7f82c1e19deb47bd3f1846c48341,\n  plaintext = 0x5cf9f61a3dd3a2f76d571384c831ae88,\n  ciphertext = 0xdc6e6c13679958963b8648457eb8a415},\n  {key = 0xa4afa1ac957b31fe81b11391a678c57d7c3b775d387c2754,\n  plaintext = 0xdc6e6c13679958963b8648457eb8a415,\n  ciphertext = 0x033f2b7189ec7f2ef0c496a83f5c5051},\n  {key = 0x6a5b44860a26a4ff828e38e02f94ba538cffe1f507207705,\n  plaintext = 0x033f2b7189ec7f2ef0c496a83f5c5051,\n  ciphertext = 0x032727204d9b169679eff2ffe5f71efb},\n  {key = 0xc80d5ebc48693fdc81a91fc0620facc5f510130ae2d769fe,\n  plaintext = 0x032727204d9b169679eff2ffe5f71efb,\n  ciphertext = 0xd19884aaae710c5861fff7251ea143c8},\n  {key = 0xb9d36290d5324a8350319b6acc7ea09d94efe42ffc762a36,\n  plaintext = 0xd19884aaae710c5861fff7251ea143c8,\n  ciphertext = 0x3097d32245163fcf4c578e5a7dd2349a},\n  {key = 0x3d00403bc3a0ff5b60a6484889689f52d8b86a7581a41eac,\n  plaintext = 0x3097d32245163fcf4c578e5a7dd2349a,\n  ciphertext = 0x39b6615b1e047b9469b3cfd7251987c9},\n  {key = 0xbb85f657f0d5241659102913976ce4c6b10ba5a2a4bd9965,\n  plaintext = 0x39b6615b1e047b9469b3cfd7251987c9,\n  ciphertext = 0x868194c44a68d8b48e0ed4dbacded128},\n  {key = 0x7db3635bf7d52f66df91bdd7dd043c723f0571790863484d,\n  plaintext = 0x868194c44a68d8b48e0ed4dbacded128,\n  ciphertext = 0xd324fd7db1cfaa86511280dafa5340e6},\n  {key = 0x1449e32d51b3680f0cb540aa6ccb96f46e17f1a3f23008ab,\n  plaintext = 0xd324fd7db1cfaa86511280dafa5340e6,\n  ciphertext = 0x409aa25dcb51d8831a2f5627746c2bc9},\n  {key = 0x63d4b33e24bf3f7c4c2fe2f7a79a4e777438a784865c2362,\n  plaintext = 0x409aa25dcb51d8831a2f5627746c2bc9,\n  ciphertext = 0xbfa0348398b9bc4e07eb1739c589b225},\n  {key = 0x03f21169aad21af3f38fd6743f23f23973d3b0bd43d59147,\n  plaintext = 0xbfa0348398b9bc4e07eb1739c589b225,\n  ciphertext = 0x13582b4881e6b7f6398f41b57d617201},\n  {key = 0x541879f8770ad35de0d7fd3cbec545cf4a5cf1083eb4e346,\n  plaintext = 0x13582b4881e6b7f6398f41b57d617201,\n  ciphertext = 0xd9d58082c3a976852a350ba551862362},\n  {key = 0xd0c6100d7f8fdd8739027dbe7d6c334a6069faad6f32c024,\n  plaintext = 0xd9d58082c3a976852a350ba551862362,\n  ciphertext = 0x3cafa17506a92359c23600404ad61513},\n  {key = 0x05345651ac0d23b305addccb7bc51013a25ffaed25e4d537,\n  plaintext = 0x3cafa17506a92359c23600404ad61513,\n  ciphertext = 0xa4a3041803fe9bf7d355b34d21293ecf},\n  {key = 0x4ce9e1102ccba488a10ed8d3783b8be4710a49a004cdebf8,\n  plaintext = 0xa4a3041803fe9bf7d355b34d21293ecf,\n  ciphertext = 0xcfa674aba22c17036da437832c635b30},\n  {key = 0x08fed0e9350ac7386ea8ac78da179ce71cae7e2328aeb0c8,\n  plaintext = 0xcfa674aba22c17036da437832c635b30,\n  ciphertext = 0xf4de164a6ca93e96dfc91426d636e481},\n  {key = 0xcc5643ba704f961c9a76ba32b6bea271c3676a05fe985449,\n  plaintext = 0xf4de164a6ca93e96dfc91426d636e481,\n  ciphertext = 0x1deb553ac91ec346201154dbbdac9b14},\n  {key = 0xd413a379439b2caf879def087fa06137e3763ede4334cf5d,\n  plaintext = 0x1deb553ac91ec346201154dbbdac9b14,\n  ciphertext = 0x52372415208849a222acf6f27e145f75},\n  {key = 0x575a3e57736fe96dd5aacb1d5f282895c1dac82c3d209028,\n  plaintext = 0x52372415208849a222acf6f27e145f75,\n  ciphertext = 0x710f708e402325c6763ca461f6f855e0},\n  {key = 0x7d593f399f198b9da4a5bb931f0b0d53b7e66c4dcbd8c5c8,\n  plaintext = 0x710f708e402325c6763ca461f6f855e0,\n  ciphertext = 0x8fae56699e3af53b86d484be2463b602},\n  {key = 0x401e3d459d7254a82b0bedfa8131f8683132e8f3efbb73ca,\n  plaintext = 0x8fae56699e3af53b86d484be2463b602,\n  ciphertext = 0xaa44678efb43326727d5204edc942fe2},\n  {key = 0x996d36de694dc3cb814f8a747a72ca0f16e7c8bd332f5c28,\n  plaintext = 0xaa44678efb43326727d5204edc942fe2,\n  ciphertext = 0xfb04caba312e387528a355d39db15db6},\n  {key = 0xbba2ddbf7cc063957a4b40ce4b5cf27a3e449d6eae9e019e,\n  plaintext = 0xfb04caba312e387528a355d39db15db6,\n  ciphertext = 0x5d8156335210cc39885ab652d8ccfd33},\n  {key = 0x5fdbf5f7b3b389c727ca16fd194c3e43b61e2b3c7652fcad,\n  plaintext = 0x5d8156335210cc39885ab652d8ccfd33,\n  ciphertext = 0x8b8d3455188ad9615a2c3a34c4bfb8df},\n  {key = 0xfa876ec64e22b16bac4722a801c6e722ec321108b2ed4472,\n  plaintext = 0x8b8d3455188ad9615a2c3a34c4bfb8df,\n  ciphertext = 0x1c5bab7b91032ffac3a8e4d41a3a5338},\n  {key = 0xceeda64221ae37d3b01c89d390c5c8d82f9af5dca8d7174a,\n  plaintext = 0x1c5bab7b91032ffac3a8e4d41a3a5338,\n  ciphertext = 0xad98def9c24e9d0de0e6a9541c86c34c},\n  {key = 0xb2b6b9074795f6501d84572a528b55d5cf7c5c88b451d406,\n  plaintext = 0xad98def9c24e9d0de0e6a9541c86c34c,\n  ciphertext = 0xee54a410d2e410e721bf9b12f9a8bb04},\n  {key = 0x42e6927395e5d3dbf3d0f33a806f4532eec3c79a4df96f02,\n  plaintext = 0xee54a410d2e410e721bf9b12f9a8bb04,\n  ciphertext = 0x7b894a4e5514249029af1118576093cc},\n  {key = 0x07373c871002daaf8859b974d57b61a2c76cd6821a99fcce,\n  plaintext = 0x7b894a4e5514249029af1118576093cc,\n  ciphertext = 0xf555d93e38137c9b931b4583de367ff2},\n  {key = 0x8eebc322f66630687d0c604aed681d3954779301c4af833c,\n  plaintext = 0xf555d93e38137c9b931b4583de367ff2,\n  ciphertext = 0xf5adbb37c99646913d1670ccd8203c04},\n  {key = 0x56d70f07f90e11ab88a1db7d24fe5ba86961e3cd1c8fbf38,\n  plaintext = 0xf5adbb37c99646913d1670ccd8203c04,\n  ciphertext = 0x122f214900ffcfd59652c1af64b10c71},\n  {key = 0xcf4ec9b7f52cd2d99a8efa342401947dff332262783eb349,\n  plaintext = 0x122f214900ffcfd59652c1af64b10c71,\n  ciphertext = 0xbe1b5d5ac7b61b73c479d7b1fc65ea35},\n  {key = 0x8ca5b0fe1053b3982495a76ee3b78f0e3b4af5d3845b597c,\n  plaintext = 0xbe1b5d5ac7b61b73c479d7b1fc65ea35,\n  ciphertext = 0xf9868b44c1ce21b040b8fff3716b011a},\n  {key = 0x34f2ce0dbb3fa2d2dd132c2a2279aebe7bf20a20f5305866,\n  plaintext = 0xf9868b44c1ce21b040b8fff3716b011a,\n  ciphertext = 0x9cac4efb170dc8ded3fc6a309fd7aca7},\n  {key = 0x603bbb7bf54b365d41bf62d135746660a80e60106ae7f4c1,\n  plaintext = 0x9cac4efb170dc8ded3fc6a309fd7aca7,\n  ciphertext = 0xe52a42e78048c6dda63f98fc6c5f47f9},\n  {key = 0xa146ac000cb1f14ba4952036b53ca0bd0e31f8ec06b8b338,\n  plaintext = 0xe52a42e78048c6dda63f98fc6c5f47f9,\n  ciphertext = 0x826af473c60d61bd746a8d8bda3b410c},\n  {key = 0x979e0246f75d08e226ffd4457331c1007a5b7567dc83f234,\n  plaintext = 0x826af473c60d61bd746a8d8bda3b410c,\n  ciphertext = 0x9fa4ebdccace9033a56e3a5aace74dba},\n  {key = 0x3c34cf05821c9d17b95b3f99b9ff5133df354f3d7064bf8e,\n  plaintext = 0x9fa4ebdccace9033a56e3a5aace74dba,\n  ciphertext = 0xe0ac5dee9d6247d50b379589c2415444},\n  {key = 0x3e42ac26f6c0977a59f76277249d16e6d402dab4b225ebca,\n  plaintext = 0xe0ac5dee9d6247d50b379589c2415444,\n  ciphertext = 0x462562da72ea6b5c371530c716879dcd},\n  {key = 0xed7edff15890f7841fd200ad56777dbae317ea73a4a27607,\n  plaintext = 0x462562da72ea6b5c371530c716879dcd,\n  ciphertext = 0x78a040009e18ef207253ef992e7e2c91},\n  {key = 0x4140882041912162677240adc86f929a914405ea8adc5a96,\n  plaintext = 0x78a040009e18ef207253ef992e7e2c91,\n  ciphertext = 0xf8c7a79f10c92ec49e1ec59b08498d64},\n  {key = 0x2cbc00f60f66695a9fb5e732d8a6bc5e0f5ac0718295d7f2,\n  plaintext = 0xf8c7a79f10c92ec49e1ec59b08498d64,\n  ciphertext = 0x2f9a5f2cfd515a6878ecd923c36b1b4e},\n  {key = 0xce9854aa7b6e184ab02fb81e25f7e63677b6195241feccbc,\n  plaintext = 0x2f9a5f2cfd515a6878ecd923c36b1b4e,\n  ciphertext = 0xf7d3b3758ecf5359ab523beaa17a0306},\n  {key = 0x93163ae28f22570b47fc0b6bab38b56fdce422b8e084cfba,\n  plaintext = 0xf7d3b3758ecf5359ab523beaa17a0306,\n  ciphertext = 0x6c9dd076750bd1d2c0b8f203ca14ee1e},\n  {key = 0xca2a7882db1cb3b52b61db1dde3364bd1c5cd0bb2a9021a4,\n  plaintext = 0x6c9dd076750bd1d2c0b8f203ca14ee1e,\n  ciphertext = 0x289cf1ab3b9eac26cdd02df244412d4e},\n  {key = 0x90dc3a02ba5b5f2b03fd2ab6e5adc89bd18cfd496ed10cea,\n  plaintext = 0x289cf1ab3b9eac26cdd02df244412d4e,\n  ciphertext = 0x8ee4ca3c6c9cc5f27ddb79ae7cfcc47e},\n  {key = 0x11b26d4f3eb77d218d19e08a89310d69ac5784e7122dc894,\n  plaintext = 0x8ee4ca3c6c9cc5f27ddb79ae7cfcc47e,\n  ciphertext = 0x6cbf94fcdcadfd9a39d4c4f702d7b101},\n  {key = 0x7159cd8684c28039e1a67476559cf0f39583401010fa7995,\n  plaintext = 0x6cbf94fcdcadfd9a39d4c4f702d7b101,\n  ciphertext = 0x5047270db233f75e84c734b5cb56f765},\n  {key = 0x76bbdc75f530ec0ab1e1537be7af07ad114474a5dbac8ef0,\n  plaintext = 0x5047270db233f75e84c734b5cb56f765,\n  ciphertext = 0xb82602cd22e7821be62e5ff67cb193c6},\n  {key = 0x306a4720867eca7009c751b6c54885b6f76a2b53a71d1d36,\n  plaintext = 0xb82602cd22e7821be62e5ff67cb193c6,\n  ciphertext = 0x5a241fbcb4a0f769c37408abe658da25},\n  {key = 0x306323bbf53bd84f53e34e0a71e872df341e23f84145c713,\n  plaintext = 0x5a241fbcb4a0f769c37408abe658da25,\n  ciphertext = 0x9a63d956a9c719465e30cdc160991042},\n  {key = 0x897b6f11ecb97862c980975cd82f6b996a2eee3921dcd751,\n  plaintext = 0x9a63d956a9c719465e30cdc160991042,\n  ciphertext = 0x2a733f407d8080470c5f22a6cf8358cd},\n  {key = 0x14fa0e9978672ad5e3f3a81ca5afebde6671cc9fee5f8f9c,\n  plaintext = 0x2a733f407d8080470c5f22a6cf8358cd,\n  ciphertext = 0x24db9f77f61060accf6d41e7639c1ec6},\n  {key = 0xc1125a27a85e3826c728376b53bf8b72a91c8d788dc3915a,\n  plaintext = 0x24db9f77f61060accf6d41e7639c1ec6,\n  ciphertext = 0xa89eccce6ee8c9d4d34cf5ba8b29cba7},\n  {key = 0x1ce385ac9c70d4e26fb6fba53d5742a67a5078c206ea5afd,\n  plaintext = 0xa89eccce6ee8c9d4d34cf5ba8b29cba7,\n  ciphertext = 0xe4ef08e86141940ef87d6b385d19108c},\n  {key = 0x9a3967a8ff01d35f8b59f34d5c16d6a8822d13fa5bf34a71,\n  plaintext = 0xe4ef08e86141940ef87d6b385d19108c,\n  ciphertext = 0x1039c441007d6805551a87e820c63dca},\n  {key = 0x7d0af1cd0d641f209b60370c5c6bbeadd73794127b3577bb,\n  plaintext = 0x1039c441007d6805551a87e820c63dca,\n  ciphertext = 0x2584b55b214a94ee9894b104178a6dd5},\n  {key = 0x3f78d295449908e6bee482577d212a434fa325166cbf1a6e,\n  plaintext = 0x2584b55b214a94ee9894b104178a6dd5,\n  ciphertext = 0x9d32bd6357551091ca659f7bd4509fc2},\n  {key = 0x9cd28f265a13556123d63f342a743ad285c6ba6db8ef85ac,\n  plaintext = 0x9d32bd6357551091ca659f7bd4509fc2,\n  ciphertext = 0x9ac46eb8e253bb37304394ff0042d306},\n  {key = 0x34caf580014164d4b912518cc82781e5b5852e92b8ad56aa,\n  plaintext = 0x9ac46eb8e253bb37304394ff0042d306,\n  ciphertext = 0x3b899f1f2d93e3890418763fdd35943a},\n  {key = 0x7c19a50fa9360041829bce93e5b4626cb19d58ad6598c290,\n  plaintext = 0x3b899f1f2d93e3890418763fdd35943a,\n  ciphertext = 0xea89d4537784f253eae2d6cebdd63a4c},\n  {key = 0x2109b2880479bb4f68121ac09230903f5b7f8e63d84ef8dc,\n  plaintext = 0xea89d4537784f253eae2d6cebdd63a4c,\n  ciphertext = 0x80711a42f6687a62590a8a0d165b2fb8},\n  {key = 0x83fe682b1fcdb57be86300826458ea5d0275046ece15d764,\n  plaintext = 0x80711a42f6687a62590a8a0d165b2fb8,\n  ciphertext = 0xb2174ffab755e3e0c666cecb075256ec},\n  {key = 0x63434f6c69c041735a744f78d30d09bdc413caa5c9478188,\n  plaintext = 0xb2174ffab755e3e0c666cecb075256ec,\n  ciphertext = 0x57120386bd566d31807a6fe7b0e78041},\n  {key = 0xdfa4b3f99eda96420d664cfe6e5b648c4469a54279a001c9,\n  plaintext = 0x57120386bd566d31807a6fe7b0e78041,\n  ciphertext = 0x3b128fcdb7bb4252b5e5e00df5629508},\n  {key = 0x24fa37bb6d70bd943674c333d9e026def18c454f8cc294c1,\n  plaintext = 0x3b128fcdb7bb4252b5e5e00df5629508,\n  ciphertext = 0x4826cf69d83c7f475230679b61ca8e0a},\n  {key = 0x246a7408f739d1d37e520c5a01dc5999a3bc22d4ed081acb,\n  plaintext = 0x4826cf69d83c7f475230679b61ca8e0a,\n  ciphertext = 0x25a23c7fb798a50f5929e90e743da11c},\n  {key = 0x9f1827be83518dbc5bf03025b644fc96fa95cbda9935bbd7,\n  plaintext = 0x25a23c7fb798a50f5929e90e743da11c,\n  ciphertext = 0x7639e9f902d65feb6bc5cbc44b5e12ed},\n  {key = 0xfda6b0d164b7fd982dc9d9dcb492a37d9150001ed26ba93a,\n  plaintext = 0x7639e9f902d65feb6bc5cbc44b5e12ed,\n  ciphertext = 0x85a71ee457e94fc85cb9ac461fff1c4f},\n  {key = 0x0755b86a470bb93aa86ec738e37becb5cde9ac58cd94b575,\n  plaintext = 0x85a71ee457e94fc85cb9ac461fff1c4f,\n  ciphertext = 0xc9ef84a268877ecef88bb554ea63c336},\n  {key = 0x8f13f2d9085091816181439a8bfc927b3562190c27f77643,\n  plaintext = 0xc9ef84a268877ecef88bb554ea63c336,\n  ciphertext = 0x260dd6bf1366c029b5fd64e72853d2d7},\n  {key = 0xfdd71c524c374345478c9525989a5252809f7deb0fa4a494,\n  plaintext = 0x260dd6bf1366c029b5fd64e72853d2d7,\n  ciphertext = 0x39cc3e224738efaaf45fab525fc13127},\n  {key = 0x8bd43e3f448778ea7e40ab07dfa2bdf874c0d6b9506595b3,\n  plaintext = 0x39cc3e224738efaaf45fab525fc13127,\n  ciphertext = 0x4d5ac8506c0a13b1c2092731c6fe5fbc},\n  {key = 0x69b7449dc811b19c331a6357b3a8ae49b6c9f188969bca0f,\n  plaintext = 0x4d5ac8506c0a13b1c2092731c6fe5fbc,\n  ciphertext = 0xede69bd80f879d57640c77bc1312f064},\n  {key = 0x40e1692d44e3b441defcf88fbc2f331ed2c5863485893a6b,\n  plaintext = 0xede69bd80f879d57640c77bc1312f064,\n  ciphertext = 0x31dc854d8552e6684904bc6502682434},\n  {key = 0xc1de7d9285751138ef207dc2397dd5769bc13a5187e11e5f,\n  plaintext = 0x31dc854d8552e6684904bc6502682434,\n  ciphertext = 0xc7bdc57aaa445e489655154b25d3906d},\n  {key = 0xd8689fdcc9b77227289db8b893398b3e0d942f1aa2328e32,\n  plaintext = 0xc7bdc57aaa445e489655154b25d3906d,\n  ciphertext = 0xc4b498470a24113b6b182674c0366131},\n  {key = 0x8293a998633a405dec2920ff991d9a05668c096e6204ef03,\n  plaintext = 0xc4b498470a24113b6b182674c0366131,\n  ciphertext = 0x7575104da6d5b4e0fb21d682f93d0d24},\n  {key = 0xe71e9c0918c908ae995c30b23fc82ee59daddfec9b39e227,\n  plaintext = 0x7575104da6d5b4e0fb21d682f93d0d24,\n  ciphertext = 0xc5acdc318353c4ef3f6f45bf4a84c659},\n  {key = 0xa5f19f392eb2afd15cf0ec83bc9bea0aa2c29a53d1bd247e,\n  plaintext = 0xc5acdc318353c4ef3f6f45bf4a84c659,\n  ciphertext = 0xaf6a60f60fc085656e305a4c050cc9c3},\n  {key = 0x180b05bff13a1ad3f39a8c75b35b6f6fccf2c01fd4b1edbd,\n  plaintext = 0xaf6a60f60fc085656e305a4c050cc9c3,\n  ciphertext = 0x9d5f30e488c3243ad20767b39ec9ee4e},\n  {key = 0x1fb7ff20cab8a5186ec5bc913b984b551ef5a7ac4a7803f3,\n  plaintext = 0x9d5f30e488c3243ad20767b39ec9ee4e,\n  ciphertext = 0x5c3a1d144e5efe7cede88e21dcbc2777},\n  {key = 0x3e999761c9d15f3932ffa18575c6b529f31d298d96c42484,\n  plaintext = 0x5c3a1d144e5efe7cede88e21dcbc2777,\n  ciphertext = 0x4f163c25a6d545ccffc54511b2a5605d},\n  {key = 0x8bc1e531e9d3f84f7de99da0d313f0e50cd86c9c246144d9,\n  plaintext = 0x4f163c25a6d545ccffc54511b2a5605d,\n  ciphertext = 0x3eed65dab0bd7ae8c8b115fa185e310a},\n  {key = 0x4efaae2e7ecadcd24304f87a63ae8a0dc46979663c3f75d3,\n  plaintext = 0x3eed65dab0bd7ae8c8b115fa185e310a,\n  ciphertext = 0xfefce0da5af3885d022636f19adab9b8},\n  {key = 0x44e1224d08476e9cbdf818a0395d0250c64f4f97a6e5cc6b,\n  plaintext = 0xfefce0da5af3885d022636f19adab9b8,\n  ciphertext = 0x3a0c3d806aff32fde868343b0b58c77a},\n  {key = 0xef93ffb9eb0b9f1787f4252053a230ad2e277bacadbd0b11,\n  plaintext = 0x3a0c3d806aff32fde868343b0b58c77a,\n  ciphertext = 0x6610ee19970ee606083968e523af2370},\n  {key = 0xfc7c2c3d27519036e1e4cb39c4acd6ab261e13498e122861,\n  plaintext = 0x6610ee19970ee606083968e523af2370,\n  ciphertext = 0x2f714ddbd4adf8327dc93c723aebfffa},\n  {key = 0xf2f8a8247724e289ce9586e210012e995bd72f3bb4f9d79b,\n  plaintext = 0x2f714ddbd4adf8327dc93c723aebfffa,\n  ciphertext = 0x5d1196da8f184975e240949a25104554}]\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/021_aes192_MCT_vectors_decrypt_correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `aes192_MCT_vectors_decrypt_correct` asserting that the AES-192 ECB Monte Carlo decryption test generator `mct_ecb_decrypt_192` produces exactly the 100 known-answer test vectors in `aes192_MCT_decrypt_test_vectors` when initialized with key `0x4b97585701c03fbebdfa8555024f589f1482c58a00fdd9fd` and ciphertext `0xd0bd0e02ded155e4516be83f42d347a4`."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_192 : [192] -> [128] -> [100](AESTestVector 192)\nmct_ecb_decrypt_192 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][192]\n    keys =\n      [initialKey] # [k ^ ((drop`{64}\n        (xs ! 1)) # xs ! 0) | xs <- take`{99} (groupBy`{1000} pts)\n                            | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES192)\n    schedules = map aes192DecryptSchedule keys\n\/* pragma aes192_MCT_vectors_decrypt_correct : property *\/\naes192_MCT_vectors_decrypt_correct =\n  aes192_MCT_decrypt_test_vectors == mct_ecb_decrypt_192\n    0x4b97585701c03fbebdfa8555024f589f1482c58a00fdd9fd\n    0xd0bd0e02ded155e4516be83f42d347a4\naes192_MCT_decrypt_test_vectors : [100](AESTestVector 192)\naes192_MCT_decrypt_test_vectors =\n  [{key = 0x4b97585701c03fbebdfa8555024f589f1482c58a00fdd9fd,\n  ciphertext = 0xd0bd0e02ded155e4516be83f42d347a4,\n  plaintext = 0xc7b6581ccc88f7fc26d15d2731e7251b},\n  {key = 0x3c98c80336e0f13f7a4cdd49cec7af63325398ad311afce6,\n  ciphertext = 0xc7b6581ccc88f7fc26d15d2731e7251b,\n  plaintext = 0x01aa957b12c596511484ed7705766c67},\n  {key = 0x825349971b370dc47be64832dc02393226d775da346c9081,\n  ciphertext = 0x01aa957b12c596511484ed7705766c67,\n  plaintext = 0xf98c15d93f5daef6047c2760c5df5540},\n  {key = 0xebb9611cf25685c3826a5debe35f97c422ab52baf1b3c5c1,\n  ciphertext = 0xf98c15d93f5daef6047c2760c5df5540,\n  plaintext = 0x5c86395c6b3ed7d30d5e3ce3331fb3ed},\n  {key = 0xd8d6d591e30f4e77deec64b7886140172ff56e59c2ac762c,\n  ciphertext = 0x5c86395c6b3ed7d30d5e3ce3331fb3ed,\n  plaintext = 0x8e8cb768b31e65d054e9db8d19862084},\n  {key = 0x775a6f9a0e4733e45060d3df3b7f25c77b1cb5d4db2a56a8,\n  ciphertext = 0x8e8cb768b31e65d054e9db8d19862084,\n  plaintext = 0x96cab38070ea8e37c3d437a091e9e74c},\n  {key = 0x511e536ea113429bc6aa605f4b95abf0b8c882744ac3b1e4,\n  ciphertext = 0x96cab38070ea8e37c3d437a091e9e74c,\n  plaintext = 0xf8356cfe486b2375c2e2e4138b285ce7},\n  {key = 0xc3f94c74f86b59723e9f0ca103fe88857a2a6667c1ebed03,\n  ciphertext = 0xf8356cfe486b2375c2e2e4138b285ce7,\n  plaintext = 0x6a15770b29960c063395a70dc3cf7575},\n  {key = 0xa220f197ee7db5a2548a7baa2a68848349bfc16a02249876,\n  ciphertext = 0x6a15770b29960c063395a70dc3cf7575,\n  plaintext = 0xd16463745da38ef8997e20e102fb8573},\n  {key = 0x187bc771e567fb1285ee18de77cb0a7bd0c1e18b00df1d05,\n  ciphertext = 0xd16463745da38ef8997e20e102fb8573,\n  plaintext = 0x98ea16875a9e3006de150e93be9585b8},\n  {key = 0x432ab1057033bb041d040e592d553a7d0ed4ef18be4a98bd,\n  ciphertext = 0x98ea16875a9e3006de150e93be9585b8,\n  plaintext = 0x9d4c05cb0c5cb543515cfd05a4b90004},\n  {key = 0x64a7f543e2e2a60780480b9221098f3e5f88121d1af398b9,\n  ciphertext = 0x9d4c05cb0c5cb543515cfd05a4b90004,\n  plaintext = 0x93c4638f0f76b0a42481c030314ca594},\n  {key = 0x755c48e6e44a956f138c681d2e7f3f9a7b09d22d2bbf3d2d,\n  ciphertext = 0x93c4638f0f76b0a42481c030314ca594,\n  plaintext = 0x8ad1d144144c8530218c0edf3119aa82},\n  {key = 0x4ff1466b9e9939af995db9593a33baaa5a85dcf21aa697af,\n  ciphertext = 0x8ad1d144144c8530218c0edf3119aa82,\n  plaintext = 0xa46e11cca3b2f98e9f7360d33d236189},\n  {key = 0xb2e265f13266035a3d33a89599814324c5f6bc212785f626,\n  ciphertext = 0xa46e11cca3b2f98e9f7360d33d236189,\n  plaintext = 0x9ece35fb84957574fd353cfac1608943},\n  {key = 0x102d9afa0e70b1daa3fd9d6e1d14365038c380dbe6e57f65,\n  ciphertext = 0x9ece35fb84957574fd353cfac1608943,\n  plaintext = 0x225ce2f6987392afd1921c5eecd6ba17},\n  {key = 0xc772081227697cc081a17f988567a4ffe9519c850a33c572,\n  ciphertext = 0x225ce2f6987392afd1921c5eecd6ba17,\n  plaintext = 0x85fd494bfd5127cff96088e0b130ef04},\n  {key = 0xc306028aea2e8f1c045c36d37836833010311465bb032a76,\n  ciphertext = 0x85fd494bfd5127cff96088e0b130ef04,\n  plaintext = 0x1e693009be7a868db9e6a495c2e238f3},\n  {key = 0x7a646ea7ab6a11101a3506dac64c05bda9d7b0f079e11285,\n  ciphertext = 0x1e693009be7a868db9e6a495c2e238f3,\n  plaintext = 0x49f55237f9a66050b7e04e66a0b4bf24},\n  {key = 0xddbe30e84a14077953c054ed3fea65ed1e37fe96d955ada1,\n  ciphertext = 0x49f55237f9a66050b7e04e66a0b4bf24,\n  plaintext = 0xb966ec6748bd876046be2be11abff82a},\n  {key = 0x55e1472be2e1739aeaa6b88a7757e28d5889d577c3ea558b,\n  ciphertext = 0xb966ec6748bd876046be2be11abff82a,\n  plaintext = 0x0f6a78ac23e6ea2d9f4232e8568cea97},\n  {key = 0x38750e9c7a729e09e5ccc02654b108a0c7cbe79f9566bf1c,\n  ciphertext = 0x0f6a78ac23e6ea2d9f4232e8568cea97,\n  plaintext = 0xc80bfbe58fb9b00cd4858fd769e3cd1d},\n  {key = 0xe45ace33a0f7494c2dc73bc3db08b8ac134e6848fc857201,\n  ciphertext = 0xc80bfbe58fb9b00cd4858fd769e3cd1d,\n  plaintext = 0x918e28b7a7ad8a370d2f260f9f7a5fec},\n  {key = 0xd2a3b2ca9419501abc4913747ca5329b1e614e4763ff2ded,\n  ciphertext = 0x918e28b7a7ad8a370d2f260f9f7a5fec,\n  plaintext = 0x59d1732fc2452e53eeda0790b80a244a},\n  {key = 0x9dae1b9eaa53bdfce598605bbee01cc8f0bb49d7dbf509a7,\n  ciphertext = 0x59d1732fc2452e53eeda0790b80a244a,\n  plaintext = 0xe74d820249410cd1a39287dc536ed5fc},\n  {key = 0xe74268a3d42edb8702d5e259f7a110195329ce0b889bdc5b,\n  ciphertext = 0xe74d820249410cd1a39287dc536ed5fc,\n  plaintext = 0x27ca67828485be98a6cd22d724af53b9},\n  {key = 0x0d793e8f7e0ea82d251f85db7324ae81f5e4ecdcac348fe2,\n  ciphertext = 0x27ca67828485be98a6cd22d724af53b9,\n  plaintext = 0x4927ab19552102414e39126b8a91c675},\n  {key = 0xc99788fd8dc7a7246c382ec22605acc0bbddfeb726a54997,\n  ciphertext = 0x4927ab19552102414e39126b8a91c675,\n  plaintext = 0x99ea6ccf100d06243b45998d68c9b6bc},\n  {key = 0x733425872bb717edf5d2420d3608aae48098673a4e6cff2b,\n  ciphertext = 0x99ea6ccf100d06243b45998d68c9b6bc,\n  plaintext = 0xf029e59925e67de178b5cb9fd187f2c6},\n  {key = 0xfc02106517299a1e05fba79413eed705f82daca59feb0ded,\n  ciphertext = 0xf029e59925e67de178b5cb9fd187f2c6,\n  plaintext = 0x5f9da95aa424d5a65f1ff3d99769522d},\n  {key = 0x9b0efe0e5f4f4e395a660eceb7ca02a3a7325f7c08825fc0,\n  ciphertext = 0x5f9da95aa424d5a65f1ff3d99769522d,\n  plaintext = 0xa20f232bb355370df27f55bb53469b40},\n  {key = 0x502b270205133d51f8692de5049f35ae554d0ac75bc4c480,\n  ciphertext = 0xa20f232bb355370df27f55bb53469b40,\n  plaintext = 0x32e5d13e44b2e67952d8ef98af19a4d3},\n  {key = 0xd1cac8a82a2e3ab3ca8cfcdb402dd3d70795e55ff4dd6053,\n  ciphertext = 0x32e5d13e44b2e67952d8ef98af19a4d3,\n  plaintext = 0x688ab3ed2b373467bc547be2bf519846},\n  {key = 0x7e4af6629efd55dfa2064f366b1ae7b0bbc19ebd4b8cf815,\n  ciphertext = 0x688ab3ed2b373467bc547be2bf519846,\n  plaintext = 0x1a88d45de26cab118e86fe7089d818d0},\n  {key = 0x216cd4ed3d38e68cb88e9b6b89764ca1354760cdc254e0c5,\n  ciphertext = 0x1a88d45de26cab118e86fe7089d818d0,\n  plaintext = 0x8d154a7ebc0e6fd2d6d7686d9b9492ad},\n  {key = 0xedf6f3e4f323dc91359bd11535782373e39008a059c07268,\n  ciphertext = 0x8d154a7ebc0e6fd2d6d7686d9b9492ad,\n  plaintext = 0xbe46ead5f431ee2c6d1795f852558ed7},\n  {key = 0x94afb2de656daf688bdd3bc0c149cd5f8e879d580b95fcbf,\n  ciphertext = 0xbe46ead5f431ee2c6d1795f852558ed7,\n  plaintext = 0x9f1ecd9839abd6abbecba89a71405c76},\n  {key = 0x70bea40807c903c714c3f658f8e21bf4304c35c27ad5a0c9,\n  ciphertext = 0x9f1ecd9839abd6abbecba89a71405c76,\n  plaintext = 0xf5f335142d71d35a4723bbece7a39c43},\n  {key = 0xb32369cb5a1611d7e130c34cd593c8ae776f8e2e9d763c8a,\n  ciphertext = 0xf5f335142d71d35a4723bbece7a39c43,\n  plaintext = 0x55ace2aa461af10d10436e529a2d8d85},\n  {key = 0xf6412cbd1f98e445b49c21e6938939a3672ce07c075bb10f,\n  ciphertext = 0x55ace2aa461af10d10436e529a2d8d85,\n  plaintext = 0xf6670a6576aa2d20b63482aab26f7c82},\n  {key = 0xea7cf55a9e0fcb0d42fb2b83e5231483d11862d6b534cd8d,\n  ciphertext = 0xf6670a6576aa2d20b63482aab26f7c82,\n  plaintext = 0x93e81b9866979a0adc573d380065f18e},\n  {key = 0x1a5d1de4468ed5e5d113301b83b48e890d4f5feeb5513c03,\n  ciphertext = 0x93e81b9866979a0adc573d380065f18e,\n  plaintext = 0x324024007edad9a3e4b435b212bfec88},\n  {key = 0x8ed3c18837593af6e353141bfd6e572ae9fb6a5ca7eed08b,\n  ciphertext = 0x324024007edad9a3e4b435b212bfec88,\n  plaintext = 0x5eb5e71f06992c1998ae0cf03dbc9dce},\n  {key = 0xe5d6d1566d3c9a17bde6f304fbf77b33715566ac9a524d45,\n  ciphertext = 0x5eb5e71f06992c1998ae0cf03dbc9dce,\n  plaintext = 0xa83fe8f226ad5ee5b358fac03a092882},\n  {key = 0xd5ec4f5df302bfa515d91bf6dd5a25d6c20d9c6ca05b65c7,\n  ciphertext = 0xa83fe8f226ad5ee5b358fac03a092882,\n  plaintext = 0x72360b4fcd1293a36ed0bb44213da8b9},\n  {key = 0x50257306e757d76567ef10b91048b675acdd27288166cd7e,\n  ciphertext = 0x72360b4fcd1293a36ed0bb44213da8b9,\n  plaintext = 0x982119600a3e73dff33583558134bcf0},\n  {key = 0x64b394f798415fbcffce09d91a76c5aa5fe8a47d0052718e,\n  ciphertext = 0x982119600a3e73dff33583558134bcf0,\n  plaintext = 0x0c33669b84d714959785b37d586bb355},\n  {key = 0xcbaf8d92f18efe87f3fd6f429ea1d13fc86d17005839c2db,\n  ciphertext = 0x0c33669b84d714959785b37d586bb355,\n  plaintext = 0x9fc2fd51bbefd70fe7ce0c13af3d2ace},\n  {key = 0x80bb745fb5b9cb616c3f9213254e06302fa31b13f704e815,\n  ciphertext = 0x9fc2fd51bbefd70fe7ce0c13af3d2ace,\n  plaintext = 0xaf4a4566e556a7f2dd3477a53c094498},\n  {key = 0xb5d94340d5852f04c375d775c018a1c2f2976cb6cb0dac8d,\n  ciphertext = 0xaf4a4566e556a7f2dd3477a53c094498,\n  plaintext = 0x8107ca3fc833fee74501f2a42f088401},\n  {key = 0x23341a3b649010c942721d4a082b5f25b7969e12e405288c,\n  ciphertext = 0x8107ca3fc833fee74501f2a42f088401,\n  plaintext = 0x714341183a67b95abcf9bc992d1aa290},\n  {key = 0x955075d16664498333315c52324ce67f0b6f228bc91f8a1c,\n  ciphertext = 0x714341183a67b95abcf9bc992d1aa290,\n  plaintext = 0x564289f3ac30d6e27dde4308ee5637ab},\n  {key = 0x9e5493cf59a7d0e76573d5a19e7c309d76b161832749bdb7,\n  ciphertext = 0x564289f3ac30d6e27dde4308ee5637ab,\n  plaintext = 0x805424be37b7f0b5498ab5bf8904f468},\n  {key = 0x0e8dd0538bcfa448e527f11fa9cbc0283f3bd43cae4d49df,\n  ciphertext = 0x805424be37b7f0b5498ab5bf8904f468,\n  plaintext = 0x793554c1cc565f00f9f2122bd06672aa},\n  {key = 0xf253723471590c249c12a5de659d9f28c6c9c6177e2b3b75,\n  ciphertext = 0x793554c1cc565f00f9f2122bd06672aa,\n  plaintext = 0xb89feee17d71a452b46e4683cfddc0ba},\n  {key = 0x14781c9f73227825248d4b3f18ec3b7a72a78094b1f6fbcf,\n  ciphertext = 0xb89feee17d71a452b46e4683cfddc0ba,\n  plaintext = 0x737c418d35812556f6d26ebf91028ad7},\n  {key = 0xc4706d6414a3594657f10ab22d6d1e2c8475ee2b20f47118,\n  ciphertext = 0x737c418d35812556f6d26ebf91028ad7,\n  plaintext = 0xc2e352ec712b84fa74f98254740d0847},\n  {key = 0x74fabaf96545e7199512585e5c469ad6f08c6c7f54f9795f,\n  ciphertext = 0xc2e352ec712b84fa74f98254740d0847,\n  plaintext = 0xe09f8d7cc0e4d7f4efb65e10529592e5},\n  {key = 0xdbfa75aad7f1ad19758dd5229ca24d221f3a326f066cebba,\n  ciphertext = 0xe09f8d7cc0e4d7f4efb65e10529592e5,\n  plaintext = 0x8a8911579e11d858bd4e336b8125fa6f},\n  {key = 0xad8ea306bb3eb77bff04c47502b3957aa2740104874911d5,\n  ciphertext = 0x8a8911579e11d858bd4e336b8125fa6f,\n  plaintext = 0x3b1f396eae6ae53926e9607fb4b6e1d6},\n  {key = 0x2b204520b1389d5bc41bfd1bacd97043849d617b33fff003,\n  ciphertext = 0x3b1f396eae6ae53926e9607fb4b6e1d6,\n  plaintext = 0x6d06fe256d84ab0112119425d70d5aa6},\n  {key = 0x86d761e020a46b76a91d033ec15ddb42968cf55ee4f2aaa5,\n  ciphertext = 0x6d06fe256d84ab0112119425d70d5aa6,\n  plaintext = 0x537dd3000fdff67107362da65c95f101},\n  {key = 0xbee0861f51136bd0fa60d03ece822d3391bad8f8b8675ba4,\n  ciphertext = 0x537dd3000fdff67107362da65c95f101,\n  plaintext = 0x2843b7b7107b1390be393137e3e266c9},\n  {key = 0x8706a8a8fab02e3dd2236789def93ea32f83e9cf5b853d6d,\n  ciphertext = 0x2843b7b7107b1390be393137e3e266c9,\n  plaintext = 0xd5fae73a8940ec3c1bebe8a5e4fa0423},\n  {key = 0x43ab0c1509505c7407d980b357b9d29f3468016abf7f394e,\n  ciphertext = 0xd5fae73a8940ec3c1bebe8a5e4fa0423,\n  plaintext = 0x63a9a8c99a6a8984dc6975772dd0beac},\n  {key = 0xfb0dbb8cab3b89b16470287acdd35b1be801741d92af87e2,\n  ciphertext = 0x63a9a8c99a6a8984dc6975772dd0beac,\n  plaintext = 0x4c7b28c69c39c7eea1359ba2c167266a},\n  {key = 0x1abc6031a84a5908280b00bc51ea9cf54934efbf53c8a188,\n  ciphertext = 0x4c7b28c69c39c7eea1359ba2c167266a,\n  plaintext = 0x076024c11bf696874d791813887685e7},\n  {key = 0x746718f146cad3d92f6b247d4a1c0a72044df7acdbbe246f,\n  ciphertext = 0x076024c11bf696874d791813887685e7,\n  plaintext = 0xb413f148dc94e0525ad4800fb53dfc64},\n  {key = 0x65a422dccc0f07779b78d5359688ea205e9977a36e83d80b,\n  ciphertext = 0xb413f148dc94e0525ad4800fb53dfc64,\n  plaintext = 0xbd94776297b168e862d3afd0669a2668},\n  {key = 0x6d9fc6a3839c401426eca257013982c83c4ad8730819fe63,\n  ciphertext = 0xbd94776297b168e862d3afd0669a2668,\n  plaintext = 0xa383eb812e9d2ad7d04ef05beebc663c},\n  {key = 0x31e8ba40171be0cc856f49d62fa4a81fec042828e6a5985f,\n  ciphertext = 0xa383eb812e9d2ad7d04ef05beebc663c,\n  plaintext = 0x125833c5a964733d24ca84ae573e537e},\n  {key = 0xa1bd656677244e3597377a1386c0db22c8ceac86b19bcb21,\n  ciphertext = 0x125833c5a964733d24ca84ae573e537e,\n  plaintext = 0xd6597fe3687c9dc2f6087ad48bb2ab18},\n  {key = 0x9467df27c2b90ca7416e05f0eebc46e03ec6d6523a296039,\n  ciphertext = 0xd6597fe3687c9dc2f6087ad48bb2ab18,\n  plaintext = 0xfd6abdb2793f849bedea160e34ab1a9d},\n  {key = 0x1ee8f6b4187a87f0bc04b8429783c27bd32cc05c0e827aa4,\n  ciphertext = 0xfd6abdb2793f849bedea160e34ab1a9d,\n  plaintext = 0xfd2ccba255e74b16864ac2ff80894ebb},\n  {key = 0x3f23c25c52d6454c412873e0c264896d556602a38e0b341f,\n  ciphertext = 0xfd2ccba255e74b16864ac2ff80894ebb,\n  plaintext = 0x4571abacb8faa74007702258220b3e19},\n  {key = 0x4eedfc725f3901b80459d84c7a9e2e2d521620fbac000a06,\n  ciphertext = 0x4571abacb8faa74007702258220b3e19,\n  plaintext = 0x941b069f7545d16d24e69a309794a259},\n  {key = 0xad8b4cd042b874d09042ded30fdbff4076f0bacb3b94a85f,\n  ciphertext = 0x941b069f7545d16d24e69a309794a259,\n  plaintext = 0x515ab9b50447ea30e5ab92ddd1498d69},\n  {key = 0xc085e9fde0a60664c11867660b9c1570935b2816eadd2536,\n  ciphertext = 0x515ab9b50447ea30e5ab92ddd1498d69,\n  plaintext = 0x872c0d54b1382c095b1a475fee114cd5},\n  {key = 0x4790a2b2ee108fbb46346a32baa43979c8416f4904cc69e3,\n  ciphertext = 0x872c0d54b1382c095b1a475fee114cd5,\n  plaintext = 0x6aa4b9e4559d2c1de4f59dafbaf0909e},\n  {key = 0x56880340e6eaf2472c90d3d6ef3915642cb4f2e6be3cf97d,\n  ciphertext = 0x6aa4b9e4559d2c1de4f59dafbaf0909e,\n  plaintext = 0xc4ce24dd760b44799d00ce4c5ffdb8c5},\n  {key = 0xd321a216923e2c1de85ef70b9932511db1b43caae1c141b8,\n  ciphertext = 0xc4ce24dd760b44799d00ce4c5ffdb8c5,\n  plaintext = 0xd73e44ee7f75c2fb6696aaba64af9925},\n  {key = 0xa80125606ef3f3953f60b3e5e64793e6d7229610856ed89d,\n  ciphertext = 0xd73e44ee7f75c2fb6696aaba64af9925,\n  plaintext = 0x1add98acb3a31733b3e0a32da14a71cf},\n  {key = 0xfd54730799c76e1e25bd2b4955e484d564c2353d2424a952,\n  ciphertext = 0x1add98acb3a31733b3e0a32da14a71cf,\n  plaintext = 0x6d2201f6268f7c126e4d57375f5ac97b},\n  {key = 0xb07e344619df38e5489f2abf736bf8c70a8f620a7b7e6029,\n  ciphertext = 0x6d2201f6268f7c126e4d57375f5ac97b,\n  plaintext = 0x349daafd5a9676a0bf5e015319a5083b},\n  {key = 0xf66e7702379bbeac7c02804229fd8e67b5d1635962db6812,\n  ciphertext = 0x349daafd5a9676a0bf5e015319a5083b,\n  plaintext = 0xfd6cd698388a46f696da48543a327e10},\n  {key = 0x1aab1a249cb5fa91816e56da1177c891230b2b0d58e91602,\n  ciphertext = 0xfd6cd698388a46f696da48543a327e10,\n  plaintext = 0xbaa9b8a3f9ffa86241bb5abe04b7eea5},\n  {key = 0xdd881f3432073d253bc7ee79e88860f362b071b35c5ef8a7,\n  ciphertext = 0xbaa9b8a3f9ffa86241bb5abe04b7eea5,\n  plaintext = 0x19ad5a0619f1b5eed38fb5fbbbbe1247},\n  {key = 0xd4088261dda8dfc1226ab47ff179d51db13fc448e7e0eae0,\n  ciphertext = 0x19ad5a0619f1b5eed38fb5fbbbbe1247,\n  plaintext = 0x832e01274c6a59b148dc6de3e6ccc037},\n  {key = 0x0ff97f22bdef4005a144b558bd138cacf9e3a9ab012c2ad7,\n  ciphertext = 0x832e01274c6a59b148dc6de3e6ccc037,\n  plaintext = 0x9853ba4a0880449a6344fd0dabfc9e74},\n  {key = 0xa2f2351138f53ed639170f12b593c8369aa754a6aad0b4a3,\n  ciphertext = 0x9853ba4a0880449a6344fd0dabfc9e74,\n  plaintext = 0x89ebc090e07d36670f48a32074c9ca18},\n  {key = 0xb7c564161c5e5061b0fccf8255eefe5195eff786de197ebb,\n  ciphertext = 0x89ebc090e07d36670f48a32074c9ca18,\n  plaintext = 0x5695154c14aeb5d09a516ca802d7fb21},\n  {key = 0x95aa68a5ba0d346be669dace41404b810fbe9b2edcce859a,\n  ciphertext = 0x5695154c14aeb5d09a516ca802d7fb21,\n  plaintext = 0xf49c9100c165c22f16661c23bf46520e},\n  {key = 0x028f06458b3a50ce12f54bce802589ae19d8870d6388d794,\n  ciphertext = 0xf49c9100c165c22f16661c23bf46520e,\n  plaintext = 0x1aec4f3ade3b41dd3d5448dc7e577e67},\n  {key = 0xe0b75db3cfb1e3f6081904f45e1ec873248ccfd11ddfa9f3,\n  ciphertext = 0x1aec4f3ade3b41dd3d5448dc7e577e67,\n  plaintext = 0x5c75fbcaa893326641aa343f40f6ee31},\n  {key = 0xe51161c0ee3bf4fe546cff3ef68dfa156526fbee5d2947c2,\n  ciphertext = 0x5c75fbcaa893326641aa343f40f6ee31,\n  plaintext = 0xa2c953d404212d5da4e98f31d8cc0a5b},\n  {key = 0x1f13dd6e77477337f6a5aceaf2acd748c1cf74df85e54d99,\n  ciphertext = 0xa2c953d404212d5da4e98f31d8cc0a5b,\n  plaintext = 0x17ea5bd0c139ce391240ff701085b060},\n  {key = 0x547e1d3ba5988327e14ff73a33951971d38f8baf9560fdf9,\n  ciphertext = 0x17ea5bd0c139ce391240ff701085b060,\n  plaintext = 0x98d87acaeb843ccf7b6e92a1889ff129},\n  {key = 0xd140d82958fb4d8979978df0d81125bea8e1190e1dff0cd0,\n  ciphertext = 0x98d87acaeb843ccf7b6e92a1889ff129,\n  plaintext = 0x0c2132942034442ea6eb14d23ccdf868},\n  {key = 0xf311ab46bba28f9a75b6bf64f82561900e0a0ddc2132f4b8,\n  ciphertext = 0x0c2132942034442ea6eb14d23ccdf868,\n  plaintext = 0x91341b217d521168251ad3778171e5ba},\n  {key = 0x0abea37884946aa1e482a445857770f82b10deaba0431102,\n  ciphertext = 0x91341b217d521168251ad3778171e5ba,\n  plaintext = 0xb63ef1b79507a62eba3dafcec54a6328}]\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/026_aes256_MCT_vectors_encrypt_correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property aes256_MCT_vectors_encrypt_correct that proves the Monte Carlo Test (MCT) AES-256 ECB encryption generator mct_ecb_encrypt_256 (taking a 256-bit initial key and 128-bit initial plaintext and producing 100 AESTestVector 256 values) exactly matches the given 100 known-answer test vectors aes256_MCT_encrypt_test_vectors for the specified initial key and plaintext."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_encrypt_256 : [256] -> [128] -> [100](AESTestVector 256)\nmct_ecb_encrypt_256 initialKey initialPt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       plaintext = pts @ (i * 1000),\n       ciphertext = cts @ (i * 1000 + 999)})\n    pts : [100 * 1000][128]\n    pts = [initialPt] # take cts\n    cts : [100 * 1000][128]\n    cts =\n      generate (\\i ->\n       aesEncryptBlock (schedules @ (i \/ 1000)) (pts @ i))\n    keys : [100][256]\n    keys =\n      [initialKey] # [k ^ (xs ! 1 # xs ! 0) | xs <- take`{99}\n                                             (groupBy`{1000} cts)\n                                            | k <- keys]\n    schedules : [100](AESEncryptKeySchedule AES256)\n    schedules = map aes256EncryptSchedule keys\n\/* pragma aes256_MCT_vectors_encrypt_correct : property *\/\naes256_MCT_vectors_encrypt_correct =\n  aes256_MCT_encrypt_test_vectors == mct_ecb_encrypt_256\n    0xf9e8389f5b80712e3886cc1fa2d28a3b8c9cd88a2d4a54c6aa86ce0fef944be0\n    0xb379777f9050e2a818f2940cbbd9aba4\naes256_MCT_encrypt_test_vectors : [100](AESTestVector 256)\naes256_MCT_encrypt_test_vectors =\n  [{key = 0xf9e8389f5b80712e3886cc1fa2d28a3b8c9cd88a2d4a54c6aa86ce0fef944be0,\n  plaintext = 0xb379777f9050e2a818f2940cbbd9aba4,\n  ciphertext = 0x6893ebaf0a1fccc704326529fdfb60db},\n  {key = 0xdb9ea5a2284fa17fb63e13bf891c8e42e40f332527559801aeb4ab26126f2b3b,\n  plaintext = 0x6893ebaf0a1fccc704326529fdfb60db,\n  ciphertext = 0xf3c78a5e85e5439bf26d5818718157d6},\n  {key = 0x7099ed88e82744228a5303ae2ef6c0d017c8b97ba2b0db9a5cd9f33e63ee7ced,\n  plaintext = 0xf3c78a5e85e5439bf26d5818718157d6,\n  ciphertext = 0x2326b958b00b3050697eedb08cc20504},\n  {key = 0x5e9e65ea96e78dd4fb78ea1184f6ebde34ee002312bbebca35a71e8eef2c79e9,\n  plaintext = 0x2326b958b00b3050697eedb08cc20504,\n  ciphertext = 0xec4332d5e3cebd3e0f5fc51452f4560d},\n  {key = 0x33acf1cafc822646dc869e905bd26f9ad8ad32f6f17556f43af8db9abdd82fe4,\n  plaintext = 0xec4332d5e3cebd3e0f5fc51452f4560d,\n  ciphertext = 0x5da58b5ef2076340d555f861c3449a77},\n  {key = 0xeb0ae85c1b44d5db4729d268f49be2a08508b9a8037235b4efad23fb7e9cb593,\n  plaintext = 0x5da58b5ef2076340d555f861c3449a77,\n  ciphertext = 0x307d50c18a0b6a08402ff131d72cb7ec},\n  {key = 0xfac93b561a9b6a0e809d71ecdb980afab575e96989795fbcaf82d2caa9b0027f,\n  plaintext = 0x307d50c18a0b6a08402ff131d72cb7ec,\n  ciphertext = 0x92c34165a2963e77e05e2d6fc2d931d5},\n  {key = 0xa0559e41d58af36174a67246df87541b27b6a80c2bef61cb4fdcffa56b6933aa,\n  plaintext = 0x92c34165a2963e77e05e2d6fc2d931d5,\n  ciphertext = 0xcb33d519a1fdb1d5fbb185c47870c1ed},\n  {key = 0xe48824d6c2251d3a27f38fb543c31fc1ec857d158a12d01eb46d7a611319f247,\n  plaintext = 0xcb33d519a1fdb1d5fbb185c47870c1ed,\n  ciphertext = 0x78fb452f384c8f870e572890588f3728},\n  {key = 0x7a33440ad7c69d583355c745e5c88c47947e383ab25e5f99ba3a52f14b96c56f,\n  plaintext = 0x78fb452f384c8f870e572890588f3728,\n  ciphertext = 0x12375e02a8bbc84b00feaab54a66db43},\n  {key = 0x0e6877c7fdc234efb9afcd96b4ebdb83864966381ae597d2bac4f84401f01e2c,\n  plaintext = 0x12375e02a8bbc84b00feaab54a66db43,\n  ciphertext = 0xeab1606610b55c857f2b4bf1cf3feba0},\n  {key = 0xec91d3550c79ab4914a26987725ab1396cf8065e0a50cb57c5efb3b5cecff58c,\n  plaintext = 0xeab1606610b55c857f2b4bf1cf3feba0,\n  ciphertext = 0x6c73381147de97961cc26ad26602a45a},\n  {key = 0x83caed5a49579b3a55a71e5ece5966e5008b3e4f4d8e5cc1d92dd967a8cd51d6,\n  plaintext = 0x6c73381147de97961cc26ad26602a45a,\n  ciphertext = 0xe76c08fd29bf015352003c636fee5ff9},\n  {key = 0x91b9b50908968361dcd8f4ba236fa199e7e736b264315d928b2de504c7230e2f,\n  plaintext = 0xe76c08fd29bf015352003c636fee5ff9,\n  ciphertext = 0x6f26b8191a2b059dcdeb3dbabc437c29},\n  {key = 0x94fc46213c870f7965b88773afe93b1388c18eab7e1a580f46c6d8be7b607206,\n  plaintext = 0x6f26b8191a2b059dcdeb3dbabc437c29,\n  ciphertext = 0xe91e2fcef14dd4251caec97c45223fef},\n  {key = 0xb0deff009aff61f65763b0b9fdd39a9061dfa1658f578c2a5a6811c23e424de9,\n  plaintext = 0xe91e2fcef14dd4251caec97c45223fef,\n  ciphertext = 0x98fb2122912360f07916e4802c0ea1e5},\n  {key = 0x968f3c88d27f1be8decb00c4d464d369f92480471e74ecda237ef542124cec0c,\n  plaintext = 0x98fb2122912360f07916e4802c0ea1e5,\n  ciphertext = 0xb4a15c59976b39da50da8ed393f27a62},\n  {key = 0x35fe06a60309581565a97232140668464d85dc1e891fd50073a47b9181be966e,\n  plaintext = 0xb4a15c59976b39da50da8ed393f27a62,\n  ciphertext = 0xd8b57d7a72ef92409c51d40bb8c4cbc5},\n  {key = 0x4739043d7750bcf4a6f269a3d54083ca9530a164fbf04740eff5af9a397a5dab,\n  plaintext = 0xd8b57d7a72ef92409c51d40bb8c4cbc5,\n  ciphertext = 0x548cc893e80caf5a601c2381517f8c5b},\n  {key = 0x4b065b5195f2ddf6f5d0aed72ff7a1e3c1bc69f713fce81a8fe98c1b6805d1f0,\n  plaintext = 0x548cc893e80caf5a601c2381517f8c5b,\n  ciphertext = 0x1c2238c560d678d40b48cc8034add0c4},\n  {key = 0x1a949129e14c5963d997c86a6352ea53dd9e5132732a90ce84a1409b5ca80134,\n  plaintext = 0x1c2238c560d678d40b48cc8034add0c4,\n  ciphertext = 0x2771ff806e061df8ad4aa877717bf309},\n  {key = 0x91cd3e48f4b42c432bed9848583e6dc7faefaeb21d2c8d3629ebe8ec2dd3f23d,\n  plaintext = 0x2771ff806e061df8ad4aa877717bf309,\n  ciphertext = 0x065593fa1fcdb481bb27f334505543f5},\n  {key = 0x42d6f7b585a0a0d356c59be3d07d4d41fcba3d4802e139b792cc1bd87d86b1c8,\n  plaintext = 0x065593fa1fcdb481bb27f334505543f5,\n  ciphertext = 0xd3f309c0039b15d14eb8b739a94b94fa},\n  {key = 0x72900f0ecbf90fa058805deb430815072f493488017a2c66dc74ace1d4cd2532,\n  plaintext = 0xd3f309c0039b15d14eb8b739a94b94fa,\n  ciphertext = 0x4e441a3fb277d6fbe0ed7c6e080d9a9f},\n  {key = 0x12ef8789b91a8e35fd0ac79457a906f0610d2eb7b30dfa9d3c99d08fdcc0bfad,\n  plaintext = 0x4e441a3fb277d6fbe0ed7c6e080d9a9f,\n  ciphertext = 0xcb9241bc964cbc9823531f68e3a03b7c},\n  {key = 0x2cbe5980ad54c5dbf2ee3db1e9875733aa9f6f0b254146051fcacfe73f6084d1,\n  plaintext = 0xcb9241bc964cbc9823531f68e3a03b7c,\n  ciphertext = 0x70b17c3e869aca6076617a2cf75e9f4a},\n  {key = 0xdc4da3812736a2a603bcc6390763c5c5da2e1335a3db8c6569abb5cbc83e1b9b,\n  plaintext = 0x70b17c3e869aca6076617a2cf75e9f4a,\n  ciphertext = 0xf4b8a6ed6d6d72aff59484314f210bb9},\n  {key = 0x2e4e21a6eb77bb39a1cb5cd20cc5fd3b2e96b5d8ceb6feca9c3f31fa871f1022,\n  plaintext = 0xf4b8a6ed6d6d72aff59484314f210bb9,\n  ciphertext = 0xf56a4597beaeafc0c14ee73988bcbee8},\n  {key = 0x54d5c037e61fd09e5cf57fd34c5e0192dbfcf04f7018510a5d71d6c30fa3aeca,\n  plaintext = 0xf56a4597beaeafc0c14ee73988bcbee8,\n  ciphertext = 0x04333079d5352236e1c79213f3f38dbe},\n  {key = 0x3a5da203e03fa399caeb1fac63679b56dfcfc036a52d733cbcb644d0fc502374,\n  plaintext = 0x04333079d5352236e1c79213f3f38dbe,\n  ciphertext = 0x22c97ecdf4af830f94b11951f41e4d29},\n  {key = 0x5c84147d6ab2051b56b0993a7cbfa306fd06befb5182f03328075d81084e6e5d,\n  plaintext = 0x22c97ecdf4af830f94b11951f41e4d29,\n  ciphertext = 0xdef46a3b39c8048431d2491d97daa6ea},\n  {key = 0x7af77aa155a33f658283ebc3e9eb708923f2d4c0684af4b719d5149c9f94c8b7,\n  plaintext = 0xdef46a3b39c8048431d2491d97daa6ea,\n  ciphertext = 0x4c6367ad8a2190366c3d730fe5eeb6ee},\n  {key = 0xedabba9dc9d87357bb91da6931c743e16f91b36de26b648175e867937a7a7e59,\n  plaintext = 0x4c6367ad8a2190366c3d730fe5eeb6ee,\n  ciphertext = 0x90bd09b4eb0f7d8397c0026cefea8fb3},\n  {key = 0xab7ef1b4a1e43771de88e158ad26a419ff2cbad909641902e22865ff9590f1ea,\n  plaintext = 0x90bd09b4eb0f7d8397c0026cefea8fb3,\n  ciphertext = 0x25aefcfa6ec98fae81b93afad7761711},\n  {key = 0x6b0145c6cbeaae320be86c2909c8d643da82462367ad96ac63915f0542e6e6fb,\n  plaintext = 0x25aefcfa6ec98fae81b93afad7761711,\n  ciphertext = 0x607b26f4eb3585e3e886e75c0f3a01cf},\n  {key = 0xb46d28c20a614b6d986e92795258631cbaf960d78c98134f8b17b8594ddce734,\n  plaintext = 0x607b26f4eb3585e3e886e75c0f3a01cf,\n  ciphertext = 0xfe35fe16a3290042c28c021ee9ede73f},\n  {key = 0x93c5c8403410764717e547e3d07b0ec344cc9ec12fb1130d499bba47a431000b,\n  plaintext = 0xfe35fe16a3290042c28c021ee9ede73f,\n  ciphertext = 0x0141871c357a00ad37ae65597830cac8},\n  {key = 0xcf85ea60e0c94e611fedba48e19e9693458d19dd1acb13a07e35df1edc01cac3,\n  plaintext = 0x0141871c357a00ad37ae65597830cac8,\n  ciphertext = 0xdf8bc7782ae10eb2c1bdfdc8887e4907},\n  {key = 0xd40735932ea269aeb51fa3caf0c176d89a06dea5302a1d12bf8822d6547f83c4,\n  plaintext = 0xdf8bc7782ae10eb2c1bdfdc8887e4907,\n  ciphertext = 0x1ac65c65b6cd8ab751f1d908ebd962ab},\n  {key = 0x9a7120341819fe54fc8a750d17ecf20f80c082c086e797a5ee79fbdebfa6e16f,\n  plaintext = 0x1ac65c65b6cd8ab751f1d908ebd962ab,\n  ciphertext = 0x9f10b53fb6adf7189e277d04e351aa9d},\n  {key = 0x8c19642c172cdb804059f751b3f25cff1fd037ff304a60bd705e86da5cf74bf2,\n  plaintext = 0x9f10b53fb6adf7189e277d04e351aa9d,\n  ciphertext = 0xc94ecc943ddc8d1eeafadd173cf73fdc},\n  {key = 0xe1cc9575e51d6a8240e6f3cd8958e1a6d69efb6b0d96eda39aa45bcd6000742e,\n  plaintext = 0xc94ecc943ddc8d1eeafadd173cf73fdc,\n  ciphertext = 0x5dd513d74b72f9d46b06b4b96a94c3bd},\n  {key = 0xce41ff2d70b2169fad6a5f9ead4471e88b4be8bc46e41477f1a2ef740a94b793,\n  plaintext = 0x5dd513d74b72f9d46b06b4b96a94c3bd,\n  ciphertext = 0x1594a31cc22cdbaf2011a9a317538608},\n  {key = 0x7b467b87180772677903a043bc63c3ef9edf4ba084c8cfd8d1b346d71dc7319b,\n  plaintext = 0x1594a31cc22cdbaf2011a9a317538608,\n  ciphertext = 0x4d5e8d6fa3e2ea343b5afb77124529aa},\n  {key = 0xca068b3afc717d1f6e8dc7e4eca0f56fd381c6cf272a25eceae9bda00f821831,\n  plaintext = 0x4d5e8d6fa3e2ea343b5afb77124529aa,\n  ciphertext = 0x1bbf651cf61c295c96e73a210483d7a1},\n  {key = 0xd04d80998a971ec52d5390fa7eaf78eac83ea3d3d1360cb07c0e87810b01cf90,\n  plaintext = 0x1bbf651cf61c295c96e73a210483d7a1,\n  ciphertext = 0x84b42f75c3b62bbf21707ba66cca399f},\n  {key = 0x2cfb1c71e8cac872e6a6dc90b0195acf4c8a8ca61280270f5d7efc2767cbf60f,\n  plaintext = 0x84b42f75c3b62bbf21707ba66cca399f,\n  ciphertext = 0xa0c514e1e6a9c659f605eff4cf4951a0},\n  {key = 0x405bc450a19e6dae76847b8eac858c8bec4f9847f429e156ab7b13d3a882a7af,\n  plaintext = 0xa0c514e1e6a9c659f605eff4cf4951a0,\n  ciphertext = 0x1dcc38307c6b3c31e25f868b279b3711},\n  {key = 0x35755fe97d9aeb1e67c1f4ca5a40ce1ff183a0778842dd67492495588f1990be,\n  plaintext = 0x1dcc38307c6b3c31e25f868b279b3711,\n  ciphertext = 0xcdd744574664be7b221d7a2921b4f0b2},\n  {key = 0x7e9d8b4bbd2aad70d229247d5880a0cb3c54e420ce26631c6b39ef71aead600c,\n  plaintext = 0xcdd744574664be7b221d7a2921b4f0b2,\n  ciphertext = 0xe602ef85184ad4a86ed339e9403f541c},\n  {key = 0x73be0bb5b74a8f6324f8a5f0acbf5faada560ba5d66cb7b405ead698ee923410,\n  plaintext = 0xe602ef85184ad4a86ed339e9403f541c,\n  ciphertext = 0x7c227f03e605ff14c42fb9f8e8786e84},\n  {key = 0xc82e22faeca51a38045f2a3a04a0e6e2a67474a6306948a0c1c56f6006ea5a94,\n  plaintext = 0x7c227f03e605ff14c42fb9f8e8786e84,\n  ciphertext = 0x94c0466b27aa4d361b19c250329c14a0},\n  {key = 0x7c1dd42bdff414e3733b846cbb00c43432b432cd17c30596dadcad3034764e34,\n  plaintext = 0x94c0466b27aa4d361b19c250329c14a0,\n  ciphertext = 0xfd6b281c93c1fd8e9b83b69ecf722f3b},\n  {key = 0xaa7ec003efbca86fe5ad028d0571cf3acfdf1ad18402f818415f1baefb04610f,\n  plaintext = 0xfd6b281c93c1fd8e9b83b69ecf722f3b,\n  ciphertext = 0xa75b28be92dc53de9d44714918e3c541},\n  {key = 0x14ba26bafb6c8410104d70ec23876db56884326f16deabc6dc1b6ae7e3e7a44e,\n  plaintext = 0xa75b28be92dc53de9d44714918e3c541,\n  ciphertext = 0x48693025ba68f3fa3515e7112b6e32aa},\n  {key = 0x33b40738b39ebe39118938c6461ebd7820ed024aacb6583ce90e8df6c88996e4,\n  plaintext = 0x48693025ba68f3fa3515e7112b6e32aa,\n  ciphertext = 0x6bfa37cc5ed6e5d4ddf40b1301957f73},\n  {key = 0x0d16eab1b56e2a468bf1ba1035129d574b173586f260bde834fa86e5c91ce997,\n  plaintext = 0x6bfa37cc5ed6e5d4ddf40b1301957f73,\n  ciphertext = 0xca18b89c3225877e02e21042af9836a8},\n  {key = 0x44b55514a5b4a5a4294f3cf8e75ff73c810f8d1ac0453a96361896a76684df3f,\n  plaintext = 0xca18b89c3225877e02e21042af9836a8,\n  ciphertext = 0xc3ebc08368be58f8f514cfbd5f98ed52},\n  {key = 0x265f1a7a53151bc51526fe476e8c63ad42e44d99a8fb626ec30c591a391c326d,\n  plaintext = 0xc3ebc08368be58f8f514cfbd5f98ed52,\n  ciphertext = 0x788552397ddf2d5841dbc0e73dd11150},\n  {key = 0x23fa4630937015585ac065e6a7bd93023a611fa0d5244f3682d799fd04cd233d,\n  plaintext = 0x788552397ddf2d5841dbc0e73dd11150,\n  ciphertext = 0xe9d728bc19b50809bc1245552091d0b2},\n  {key = 0x9dd3a2408e5694fced28964c7f442e6ed3b6371ccc91473f3ec5dca8245cf38f,\n  plaintext = 0xe9d728bc19b50809bc1245552091d0b2,\n  ciphertext = 0xce08d78b58179b7957eeab6f74ddb10f},\n  {key = 0x055d53ef574a63f77c0b3a88e7e7cdb01dbee0979486dc46692b77c750814280,\n  plaintext = 0xce08d78b58179b7957eeab6f74ddb10f,\n  ciphertext = 0x33ce33e80fcc262e9e862f5ac50c14df},\n  {key = 0xc1a90cdef5d5daaf7b182d6b409940e62e70d37f9b4afa68f7ad589d958d565f,\n  plaintext = 0x33ce33e80fcc262e9e862f5ac50c14df,\n  ciphertext = 0x5c4d21e6045f11f9f91a8cef130304e0},\n  {key = 0x6a257a4f65bdd7d882ff45ffbb9541e5723df2999f15eb910eb7d472868e52bf,\n  plaintext = 0x5c4d21e6045f11f9f91a8cef130304e0,\n  ciphertext = 0x4f50679c2dbfa63b5e55d031afacd44b},\n  {key = 0x5843bf4d6afc64273d328e1baf7821b03d6d9505b2aa4daa50e20443292286f4,\n  plaintext = 0x4f50679c2dbfa63b5e55d031afacd44b,\n  ciphertext = 0x29f64e79de48f3d3d5dff92aa0b1783b},\n  {key = 0x8915060a33758a300c053d365c304d4e149bdb7c6ce2be79853dfd698993fecf,\n  plaintext = 0x29f64e79de48f3d3d5dff92aa0b1783b,\n  ciphertext = 0x8c5bf92515a92449846593a3bdbe521b},\n  {key = 0xbe2b2a41b3491511c181508b66ec96f798c02259794b9a3001586eca342dacd4,\n  plaintext = 0x8c5bf92515a92449846593a3bdbe521b,\n  ciphertext = 0x5511fef7a2238277aaa9e25f1d097c19},\n  {key = 0x4d6f38935317ffa0cb29bdfa8a43cd19cdd1dcaedb681847abf18c952924d0cd,\n  plaintext = 0x5511fef7a2238277aaa9e25f1d097c19,\n  ciphertext = 0x2ecd75c6a5eace1c541e12db150a2143},\n  {key = 0x1549ea3d167152c85223b0a603d1fa61e31ca9687e82d65bffef9e4e3c2ef18e,\n  plaintext = 0x2ecd75c6a5eace1c541e12db150a2143,\n  ciphertext = 0x6a4cfcb9e8dae9610df99509daac7be0},\n  {key = 0xba593f6731f70edab83f5cdf02527436895055d196583f3af2160b47e6828a6e,\n  plaintext = 0x6a4cfcb9e8dae9610df99509daac7be0,\n  ciphertext = 0x185772deff51807147ac5350249b3e1a},\n  {key = 0x7126a05712f987f1c9249bf9a7c17b4f9107270f6909bf4bb5ba5817c219b474,\n  plaintext = 0x185772deff51807147ac5350249b3e1a,\n  ciphertext = 0xbfb1ce7df706bc972e1b8306d44aa135},\n  {key = 0x3d0fa3983ebc8a3f64c4135d7cd3195e2eb6e9729e0f03dc9ba1db1116531541,\n  plaintext = 0xbfb1ce7df706bc972e1b8306d44aa135,\n  ciphertext = 0xf21df1e99a781dba4a68ff3491848f99},\n  {key = 0x88c88ec4d63eb481cd8d6e8e8d2e2715dcab189b04771e66d1c9242587d79ad8,\n  plaintext = 0xf21df1e99a781dba4a68ff3491848f99,\n  ciphertext = 0xe4e8c9e4963a44f5cf27767e4e42fa61},\n  {key = 0x989b9545625a4025f7725d63847213883843d17f924d5a931eee525bc99560b9,\n  plaintext = 0xe4e8c9e4963a44f5cf27767e4e42fa61,\n  ciphertext = 0x27475121d0e3367d0e0c2d9fb39cfe95},\n  {key = 0xf49b61f190f982aa866d5c8f2e5749781f04805e42ae6cee10e27fc47a099e2c,\n  plaintext = 0x27475121d0e3367d0e0c2d9fb39cfe95,\n  ciphertext = 0xc2990626cb34c5d7fafe0430650ed907},\n  {key = 0x101537d5f633ad8dc7e8cc058ce7fe20dd9d8678899aa939ea1c7bf41f07472b,\n  plaintext = 0xc2990626cb34c5d7fafe0430650ed907,\n  ciphertext = 0x1c5d0cca2845b66c371c1760f81e024a},\n  {key = 0x1f6acaa66674733d28dfec92c43c7e76c1c08ab2a1df1f55dd006c94e7194561,\n  plaintext = 0x1c5d0cca2845b66c371c1760f81e024a,\n  ciphertext = 0x6f5a53addd93c9a136401a804a710419},\n  {key = 0xb55bdefe370646699012062df748b6aaae9ad91f7c4cd6f4eb407614ad684178,\n  plaintext = 0x6f5a53addd93c9a136401a804a710419,\n  ciphertext = 0x8e0c070be7109ead0e8cc0aa0bf95e61},\n  {key = 0xde09c34a85d56a2748559c309f04eb722096de149b5c4859e5ccb6bea6911f19,\n  plaintext = 0x8e0c070be7109ead0e8cc0aa0bf95e61,\n  ciphertext = 0xdb53b5306561db899a635a56c56e7239},\n  {key = 0x2650ecd133a5df3825072a4df2d95d15fbc56b24fe3d93d07fafece863ff6d20,\n  plaintext = 0xdb53b5306561db899a635a56c56e7239,\n  ciphertext = 0x72e5ac05990d3f5508295f95f8973313},\n  {key = 0xa8599f0edd6446b4bb9371e380bf33488920c7216730ac857786b37d9b685e33,\n  plaintext = 0x72e5ac05990d3f5508295f95f8973313,\n  ciphertext = 0x86a8332f16f997bc02af5271c64e7e0f},\n  {key = 0x672e7b0d497458e260084662c566394e0f88f40e71c93b397529e10c5d26203c,\n  plaintext = 0x86a8332f16f997bc02af5271c64e7e0f,\n  ciphertext = 0x8e53858ce7ad0d25410f886eeeca1e0e},\n  {key = 0x73ea41a50cdd5a98644e6f8d974af21381db71829664361c34266962b3ec3e32,\n  plaintext = 0x8e53858ce7ad0d25410f886eeeca1e0e,\n  ciphertext = 0xc6a1d493d607d2cef6aef29ee878c434},\n  {key = 0x14969b3ff78ccdd66c53b8027a79563e477aa5114063e4d2c2889bfc5b94fa06,\n  plaintext = 0xc6a1d493d607d2cef6aef29ee878c434,\n  ciphertext = 0xa4973e0cfaf8d6ac6758615fc81e06df},\n  {key = 0xd09e2741b9480c2166c9c1832654763de3ed9b1dba9b327ea5d0faa3938afcd9,\n  plaintext = 0xa4973e0cfaf8d6ac6758615fc81e06df,\n  ciphertext = 0x67e3243d8bc81887517708a29a5d9ae5},\n  {key = 0x22c65ead303a0395cc9c065ada930ddd840ebf2031532af9f4a7f20109d7663c,\n  plaintext = 0x67e3243d8bc81887517708a29a5d9ae5,\n  ciphertext = 0xde2f35df51644cf5d79984be6c17c14c},\n  {key = 0x8679ef0357516245ec489386419646bc5a218aff6037660c233e76bf65c0a770,\n  plaintext = 0xde2f35df51644cf5d79984be6c17c14c,\n  ciphertext = 0x9eaedabb3bd046ec27a2bdafabdbc861},\n  {key = 0x6043902c115f107639e7c92ba4952301c48f50445be720e0049ccb10ce1b6f11,\n  plaintext = 0x9eaedabb3bd046ec27a2bdafabdbc861,\n  ciphertext = 0x0cde7e6c1aecbbe996865bf30b178de7},\n  {key = 0xaca443a9e31033ea73b1eeda6e7d6ca1c8512e28410b9b09921a90e3c50ce2f6,\n  plaintext = 0x0cde7e6c1aecbbe996865bf30b178de7,\n  ciphertext = 0xba25bf5be1e4c099b9e45eedd7369cb5},\n  {key = 0x60362e2b0bf998c875c087c370c4ca4772749173a0ef5b902bfece0e123a7e43,\n  plaintext = 0xba25bf5be1e4c099b9e45eedd7369cb5,\n  ciphertext = 0x805be62789549ce6af74966467f41135},\n  {key = 0x6d7f0f7584162a1fa4dd6764548f355af22f775429bbc776848a586a75ce6f76,\n  plaintext = 0x805be62789549ce6af74966467f41135,\n  ciphertext = 0xab6001c6c4c56e8ca393c5fd173505ba},\n  {key = 0xd8ecc39ac1d00c53216f6e64e826a7a9594f7692ed7ea9fa27199d9762fb6acc,\n  plaintext = 0xab6001c6c4c56e8ca393c5fd173505ba,\n  ciphertext = 0x3ba3673f4f495dd1541d47c22b7921c5},\n  {key = 0x493108f91caedf714652149a2b2030fe62ec11ada237f42b7304da5549824b09,\n  plaintext = 0x3ba3673f4f495dd1541d47c22b7921c5,\n  ciphertext = 0xb24fe17cdc5c8cfa4260c38691b57bfa},\n  {key = 0x446af6dd5f58755aeaa0a1226d8c584fd0a3f0d17e6b78d1316419d3d83730f3,\n  plaintext = 0xb24fe17cdc5c8cfa4260c38691b57bfa,\n  ciphertext = 0x86d999a63b96f6c9d9aaf3be6202977b},\n  {key = 0x65f92d4e1723d5e58aeb350c79df28de567a697745fd8e18e8ceea6dba35a788,\n  plaintext = 0x86d999a63b96f6c9d9aaf3be6202977b,\n  ciphertext = 0xc4712aa733f9737f91e4ed61609e02f1},\n  {key = 0x915cee6af4ea95623f7122acda5e9040920b43d07604fd67792a070cdaaba579,\n  plaintext = 0xc4712aa733f9737f91e4ed61609e02f1,\n  ciphertext = 0x0e8c1a77b280f4c753682768fd6f3b23},\n  {key = 0x8e9bb2887fe60d42db4d827f00ba68ff9c8759a7c48409a02a42206427c49e5a,\n  plaintext = 0x0e8c1a77b280f4c753682768fd6f3b23,\n  ciphertext = 0xdccb684d47c480cc1317dcaa451234c0},\n  {key = 0xcbf85a6645469e5df882fe840776b6aa404c31ea8340896c3955fcce62d6aa9a,\n  plaintext = 0xdccb684d47c480cc1317dcaa451234c0,\n  ciphertext = 0x9a2c4f07489c14265e33ac031d02b3d8},\n  {key = 0x3ea3c33d7439ab3c478c01907f13cda7da607eedcbdc9d4a676650cd7fd41942,\n  plaintext = 0x9a2c4f07489c14265e33ac031d02b3d8,\n  ciphertext = 0x5c8e622ddbd32ee79c17572e8b3ee61c},\n  {key = 0x312c5b43263c1af8d1e35c0f24d1004386ee1cc0100fb3adfb7107e3f4eaff5e,\n  plaintext = 0x5c8e622ddbd32ee79c17572e8b3ee61c,\n  ciphertext = 0xc5d2cb3d5b7ff0e23e308967ee074825}]\n```"}]}
{"filename":"cryptol\/tests\/suiteb\/aes-mct-ecb\/027_aes256_MCT_vectors_decrypt_correct.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the function `mct_ecb_decrypt_256 : [256] -> [128] -> [100]({key : [256], plaintext : [128], ciphertext : [128]})` implementing the AES-256 Monte Carlo Test (MCT) for ECB decryption using `aesDecryptBlock` and `aes256DecryptSchedule`, and the constant vector `aes256_MCT_decrypt_test_vectors`, and then define a property `aes256_MCT_vectors_decrypt_correct` stating that `aes256_MCT_decrypt_test_vectors == mct_ecb_decrypt_256 0x2b09ba39b834062b9e93f48373b8dd018dedf1e5ba1b8af831ebbacbc92a2643 0x89649bd0115f30bd878567610223a59d` holds."},{"role":"assistant","content":"```cryptol\nimport SuiteB\n\n\ntype AESTestVector n =\n  {key : [n], plaintext : [128], ciphertext : [128]}\nmct_ecb_decrypt_256 : [256] -> [128] -> [100](AESTestVector 256)\nmct_ecb_decrypt_256 initialKey initialCt =\n  vs\n  where\n    vs =\n      generate (\\i ->\n       {key = keys @ i,\n       ciphertext = cts @ (i * 1000),\n       plaintext = pts @ (i * 1000 + 999)})\n    cts : [100 * 1000][128]\n    cts = [initialCt] # take pts\n    pts : [100 * 1000][128]\n    pts =\n      generate (\\i ->\n       aesDecryptBlock (schedules @ (i \/ 1000)) (cts @ i))\n    keys : [100][256]\n    keys =\n      [initialKey] # [k ^ (xs ! 1 # xs ! 0) | xs <- take`{99}\n                                             (groupBy`{1000} pts)\n                                            | k <- keys]\n    schedules : [100](AESDecryptKeySchedule AES256)\n    schedules = map aes256DecryptSchedule keys\n\/* pragma aes256_MCT_vectors_decrypt_correct : property *\/\naes256_MCT_vectors_decrypt_correct =\n  aes256_MCT_decrypt_test_vectors == mct_ecb_decrypt_256\n    0x2b09ba39b834062b9e93f48373b8dd018dedf1e5ba1b8af831ebbacbc92a2643\n    0x89649bd0115f30bd878567610223a59d\naes256_MCT_decrypt_test_vectors : [100](AESTestVector 256)\naes256_MCT_decrypt_test_vectors =\n  [{key = 0x2b09ba39b834062b9e93f48373b8dd018dedf1e5ba1b8af831ebbacbc92a2643,\n  ciphertext = 0x89649bd0115f30bd878567610223a59d,\n  plaintext = 0x1f9b9b213f1884fa98b62dd6639fd33b},\n  {key = 0x58ac71619fdc3ac73a17f285319e1cd492766ac485030e02a95d971daab5f578,\n  ciphertext = 0x1f9b9b213f1884fa98b62dd6639fd33b,\n  plaintext = 0xaecd334ef8fb0c51b6896ae065d8be28},\n  {key = 0xf6e3cca2cd628c10625c62cf08b385743cbb598a7df802531fd4fdfdcf6d4b50,\n  ciphertext = 0xaecd334ef8fb0c51b6896ae065d8be28,\n  plaintext = 0xf1938dd245c055e9c380336ff8450d9d},\n  {key = 0xa9ae3bd7d454f19d69289875ff009d16cd28d458383857badc54ce92372846cd,\n  ciphertext = 0xf1938dd245c055e9c380336ff8450d9d,\n  plaintext = 0x42d5c4a13b748800ebfe0f67781dcff1},\n  {key = 0xe3bc6232865f0476149be7162ef8fc4b8ffd10f9034cdfba37aac1f54f35893c,\n  ciphertext = 0x42d5c4a13b748800ebfe0f67781dcff1,\n  plaintext = 0x469968a00226f0aae7acfda02b2ce0ae},\n  {key = 0x451fbfba7f09b625540822fac8c8e30bc9647859016a2f10d0063c5564196992,\n  ciphertext = 0x469968a00226f0aae7acfda02b2ce0ae,\n  plaintext = 0xeab144d6f80ccfd2fae95d16784718ac},\n  {key = 0xf53e21e46a0ec97c980d49d6f4b81ec423d53c8ff966e0c22aef61431c5e713e,\n  ciphertext = 0xeab144d6f80ccfd2fae95d16784718ac,\n  plaintext = 0xe04b91c3f084d733d3d0c1c7c152695a},\n  {key = 0x5fb3a2cbdbe6971fcd345961bdcba5f6c39ead4c09e237f1f93fa084dd0c1864,\n  ciphertext = 0xe04b91c3f084d733d3d0c1c7c152695a,\n  plaintext = 0xe47db9b8c7fcc9459fa0a7fc84047b5b},\n  {key = 0x6b145436c5ae0dcb2477f94f5bdb037927e314f4ce1efeb4669f07785908633f,\n  ciphertext = 0xe47db9b8c7fcc9459fa0a7fc84047b5b,\n  plaintext = 0xf617d26b55da999d65b2d236358b2e60},\n  {key = 0x126752da3d7f9a0ffc1a46ccaa8a3925d1f4c69f9bc46729032dd54e6c834d5f,\n  ciphertext = 0xf617d26b55da999d65b2d236358b2e60,\n  plaintext = 0x066ffea799ad5f09d03cb868deb1591e},\n  {key = 0xaa3daafbcd647f0a9eaa027146ab7aded79b383802693820d3116d26b2321441,\n  ciphertext = 0x066ffea799ad5f09d03cb868deb1591e,\n  plaintext = 0x6d28dbb55fb10c1c3226609997a4fb38},\n  {key = 0xfed7b5c1f84d3dc185222da3fffac7a1bab3e38d5dd8343ce1370dbf2596ef79,\n  ciphertext = 0x6d28dbb55fb10c1c3226609997a4fb38,\n  plaintext = 0x9dd78987562c9c099d67ccc927fcec13},\n  {key = 0xc36db4af0bee11dad6ea59679cfb988c27646a0a0bf4a8357c50c176026a036a,\n  ciphertext = 0x9dd78987562c9c099d67ccc927fcec13,\n  plaintext = 0xb5cc780ec75b8d8c5128c4d26fa520ea},\n  {key = 0x7b5aebe66f96867504ee9efd2bd56bda92a81204ccaf25b92d7805a46dcf2380,\n  ciphertext = 0xb5cc780ec75b8d8c5128c4d26fa520ea,\n  plaintext = 0xc715bd2f23b98c66bf56e5680c6037f7},\n  {key = 0x81a73bfcacc994f47aeec0d655e0485055bdaf2bef16a9df922ee0cc61af1477,\n  ciphertext = 0xc715bd2f23b98c66bf56e5680c6037f7,\n  plaintext = 0xe00984f9d93551e95ae85cfe4a829b82},\n  {key = 0x2678e4ccda2eb6ad7f0e2843020da2d8b5b42bd23623f836c8c6bc322b2d8ff5,\n  ciphertext = 0xe00984f9d93551e95ae85cfe4a829b82,\n  plaintext = 0xbfa487fcb2331afe3ad82e59064b4aae},\n  {key = 0x03565af5c267a62e0d2500ead06bc7d90a10ac2e8410e2c8f21e926b2d66c55b,\n  ciphertext = 0xbfa487fcb2331afe3ad82e59064b4aae,\n  plaintext = 0x4c278ca418fd1c5718883da0ba4a066f},\n  {key = 0xec719a4ed851c36f806fbc78183026cc4637208a9cedfe9fea96afcb972cc334,\n  ciphertext = 0x4c278ca418fd1c5718883da0ba4a066f,\n  plaintext = 0xceed1c8b96d84951cadf809d3ea1b397},\n  {key = 0xf138ad912201beecd15ebe2049f980e588da3c010a35b7ce20492f56a98d70a3,\n  ciphertext = 0xceed1c8b96d84951cadf809d3ea1b397,\n  plaintext = 0xf88aed84bca42a06647d6504a5c48379},\n  {key = 0x8da22644e1267212742200dbf6b0ba947050d185b6919dc844344a520c49f3da,\n  ciphertext = 0xf88aed84bca42a06647d6504a5c48379,\n  plaintext = 0xc451b75375d0fec1cc1825eefbcc1372},\n  {key = 0x5104213aabaccafe44129632f67cf2dab40166d6c3416309882c6fbcf785e0a8,\n  ciphertext = 0xc451b75375d0fec1cc1825eefbcc1372,\n  plaintext = 0x9a54dfd56bff41ea17bcf08d3761e95b},\n  {key = 0x4c7c62be3f5a9d09934940284565e9c92e55b903a8be22e39f909f31c0e409f3,\n  ciphertext = 0x9a54dfd56bff41ea17bcf08d3761e95b,\n  plaintext = 0x76e074c587f112f3ffd17b390fa8cffc},\n  {key = 0x9871765871b1dae363fca3961224414a58b5cdc62f4f30106041e408cf4cc60f,\n  ciphertext = 0x76e074c587f112f3ffd17b390fa8cffc,\n  plaintext = 0x5b14fd4c40a127733c20cd84648ec287},\n  {key = 0x58e044758e5e4f300eb08f8b6ccd967203a1308a6fee17635c61298cabc20488,\n  ciphertext = 0x5b14fd4c40a127733c20cd84648ec287,\n  plaintext = 0x01c234e2392f42831b1172352f322286},\n  {key = 0xffbb7104e110fdfe689f68ffa48b79590263046856c155e047705bb984f0260e,\n  ciphertext = 0x01c234e2392f42831b1172352f322286,\n  plaintext = 0xab142165cb093648938660fd800d8896},\n  {key = 0x91aefec30a79b2524b19a611c0c4952da977250d9dc863a8d4f63b4404fdae98,\n  ciphertext = 0xab142165cb093648938660fd800d8896,\n  plaintext = 0x5c28ad9b5721edadc30e09b4541fd724},\n  {key = 0x00d0f69c36671a9efeb7b8637e22af38f55f8896cae98e0517f832f050e279bc,\n  ciphertext = 0x5c28ad9b5721edadc30e09b4541fd724,\n  plaintext = 0x5a9ad24fe456f4f766e839a8101373c3},\n  {key = 0xb22571c62ee4e0b4ebd7d776703c1345afc55ad92ebf7af271100b5840f10a7f,\n  ciphertext = 0x5a9ad24fe456f4f766e839a8101373c3,\n  plaintext = 0xa30e9a7730628b560c71967bdb35efce},\n  {key = 0x1431d01006510179dd13e2a83e1b8b7b0ccbc0ae1eddf1a47d619d239bc4e5b1,\n  ciphertext = 0xa30e9a7730628b560c71967bdb35efce,\n  plaintext = 0x7118cc8a057df7ea9b7fb096decf05d9},\n  {key = 0x06104531e2d000fff0cc8336b62e9bb87dd30c241ba0064ee61e2db5450be068,\n  ciphertext = 0x7118cc8a057df7ea9b7fb096decf05d9,\n  plaintext = 0xc550ff93a36fbb8e9a505682e07fb981},\n  {key = 0x8e5ebd5c9bf858f3379bfb88c7c75319b883f3b7b8cfbdc07c4e7b37a57459e9,\n  ciphertext = 0xc550ff93a36fbb8e9a505682e07fb981,\n  plaintext = 0x1375e7b4164adc861bbb77c50aba445c},\n  {key = 0xccc9445c3aab1c03ec8027593d370664abf61403ae85614667f50cf2afce1db5,\n  ciphertext = 0x1375e7b4164adc861bbb77c50aba445c,\n  plaintext = 0x5bc8b411c0fae92bad54b4e5c3a8826e},\n  {key = 0xb804994228d618a9b7a3e0c3d8d2d373f03ea0126e7f886dcaa1b8176c669fdb,\n  ciphertext = 0x5bc8b411c0fae92bad54b4e5c3a8826e,\n  plaintext = 0x36c9de7c01298ff06c5e3ecf12507cd6},\n  {key = 0x8a784f32cdd7e2ed19e85faf04de2015c6f77e6e6f56079da6ff86d87e36e30d,\n  ciphertext = 0x36c9de7c01298ff06c5e3ecf12507cd6,\n  plaintext = 0x35d814c0f6c07ae72bbe7cd1751d7527},\n  {key = 0x71e3cc0f60a2eafd83c3a455eefc4c9cf32f6aae99967d7a8d41fa090b2b962a,\n  ciphertext = 0x35d814c0f6c07ae72bbe7cd1751d7527,\n  plaintext = 0x73c39ce5ea1b5eab18c9c15221e258d1},\n  {key = 0x71bef3d2beffa17d37c6c3b28ef2928280ecf64b738d23d195883b5b2ac9cefb,\n  ciphertext = 0x73c39ce5ea1b5eab18c9c15221e258d1,\n  plaintext = 0xac67508a8bcab69f96ead29121718cd7},\n  {key = 0x9aa1ffa9e175f03a6bcc71fc2aea3a522c8ba6c1f847954e0362e9ca0bb8422c,\n  ciphertext = 0xac67508a8bcab69f96ead29121718cd7,\n  plaintext = 0x49d2cac2ca39a3b66302e5f3650e71d7},\n  {key = 0x4e480b73ab5c659538354b2474c9367b65596c03327e36f860600c396eb633fb,\n  ciphertext = 0x49d2cac2ca39a3b66302e5f3650e71d7,\n  plaintext = 0xe54638674ea0b3e837772a2866723753},\n  {key = 0xaeecd55c38bef76367a21469d08721d2801f54647cde85105717261108c404a8,\n  ciphertext = 0xe54638674ea0b3e837772a2866723753,\n  plaintext = 0x074d933018e9e0558b416e39548994ff},\n  {key = 0xe36c6a30f734a679ab7af2f9ff767cfe8752c75464376545dc5648285c4d9057,\n  ciphertext = 0x074d933018e9e0558b416e39548994ff,\n  plaintext = 0x04825a9ba20646acadb2cbdbd23530c0},\n  {key = 0x124806708fc5fc73a1e50c61e5a76b8783d09dcfc63123e971e483f38e78a097,\n  ciphertext = 0x04825a9ba20646acadb2cbdbd23530c0,\n  plaintext = 0x25b98d2837580f9f3da8f2593f7b1d72},\n  {key = 0x560afb5529a8b433738348a296408cada66910e7f1692c764c4c71aab103bde5,\n  ciphertext = 0x25b98d2837580f9f3da8f2593f7b1d72,\n  plaintext = 0x048b220c70d875cad6901e40f45c5b03},\n  {key = 0x8b7c61dd007d9d0d1937cfc69b63c114a2e232eb81b159bc9adc6fea455fe6e6,\n  ciphertext = 0x048b220c70d875cad6901e40f45c5b03,\n  plaintext = 0x34e2a33412c0e682b29b26d5409d015f},\n  {key = 0x30560ca0a31d8145228d34fbf8415683960091df9371bf3e2847493f05c2e7b9,\n  ciphertext = 0x34e2a33412c0e682b29b26d5409d015f,\n  plaintext = 0x942c057914f3b88fa0a40bb41d02b051},\n  {key = 0x20c7e6e45c08ba0756c379b6cd4d6886022c94a6878207b188e3428b18c057e8,\n  ciphertext = 0x942c057914f3b88fa0a40bb41d02b051,\n  plaintext = 0x6f4e5c40e4135abfdf294b4d8c9304b3},\n  {key = 0x2a6c928bf8c2b32ce82ed0be1bc954b96d62c8e663915d0e57ca09c69453535b,\n  ciphertext = 0x6f4e5c40e4135abfdf294b4d8c9304b3,\n  plaintext = 0xcac032ddc2b27443d70d0f2dfb1a1d87},\n  {key = 0x74994d46526b2e9d5470a0a687f726f2a7a2fa3ba123294d80c706eb6f494edc,\n  ciphertext = 0xcac032ddc2b27443d70d0f2dfb1a1d87,\n  plaintext = 0x6aec33b2c1ae39237b13e86555722d1a},\n  {key = 0x5aaec28d079eef5f1c42df377c7e80accd4ec989608d106efbd4ee8e3a3b63c6,\n  ciphertext = 0x6aec33b2c1ae39237b13e86555722d1a,\n  plaintext = 0x2df34173bbff331488b23687c755f617},\n  {key = 0x9bfa3c08b8f8b8758f0a1f4b0ef86be4e0bd88fadb72237a7366d809fd6e95d1,\n  ciphertext = 0x2df34173bbff331488b23687c755f617,\n  plaintext = 0x07649dd5c1c7b38810cbecbad9c037ed},\n  {key = 0x188e3a027b75fede978c76e70a853f95e7d9152f1ab590f263ad34b324aea23c,\n  ciphertext = 0x07649dd5c1c7b38810cbecbad9c037ed,\n  plaintext = 0xef3d9092321649d9bbb88f6448e3847b},\n  {key = 0xaae2c6363be3dbb71c21f3a2d9f123f108e485bd28a3d92bd815bbd76c4d2647,\n  ciphertext = 0xef3d9092321649d9bbb88f6448e3847b,\n  plaintext = 0x1e5058b3e986d4aad80a11f909af1cca},\n  {key = 0x85a51c6d62ba97564ac955a5409c362916b4dd0ec1250d81001faa2e65e23a8d,\n  ciphertext = 0x1e5058b3e986d4aad80a11f909af1cca,\n  plaintext = 0x9bf81052596b786b50b3f3506c009169},\n  {key = 0x0d09600f108a86cfd58f3c211a40c38d8d4ccd5c984e75ea50ac597e09e2abe4,\n  ciphertext = 0x9bf81052596b786b50b3f3506c009169,\n  plaintext = 0x81bdaf86cf4255e5826294a51d2f9992},\n  {key = 0x14ab478866e1d160311aa8820df354fb0cf162da570c200fd2cecddb14cd3276,\n  ciphertext = 0x81bdaf86cf4255e5826294a51d2f9992,\n  plaintext = 0x1fdc5fee9eb640ff547a98d9e1601b52},\n  {key = 0x39f18405f0b1da647f99479e87d4d153132d3d34c9ba60f086b45502f5ad2924,\n  ciphertext = 0x1fdc5fee9eb640ff547a98d9e1601b52,\n  plaintext = 0x936609876cd6eebf31db5a6af7839844},\n  {key = 0x85a900bc1563b16e01481e45d1125734804b34b3a56c8e4fb76f0f68022eb160,\n  ciphertext = 0x936609876cd6eebf31db5a6af7839844,\n  plaintext = 0x9ea8b6942287f470e9866a48f4dc661a},\n  {key = 0xc43d677fc0a1becbb0214221b866f0be1ee3822787eb7a3f5ee96520f6f2d77a,\n  ciphertext = 0x9ea8b6942287f470e9866a48f4dc661a,\n  plaintext = 0x1dfc2cf82bfaa2732eb525916ef9ef13},\n  {key = 0x584f10659c2d3c41f6a1926de4595eb2031faedfac11d84c705c40b1980b3869,\n  ciphertext = 0x1dfc2cf82bfaa2732eb525916ef9ef13,\n  plaintext = 0xa5d8d1d60281a152b9b76142e3e5a512},\n  {key = 0x8eba336927e18b13eb3858a89709768ba6c77f09ae90791ec9eb21f37bee9d7b,\n  ciphertext = 0xa5d8d1d60281a152b9b76142e3e5a512,\n  plaintext = 0x8ac0278f2ab100a5964173d76934d732},\n  {key = 0x13f1558dcae09062bfdccdd0037e5c432c075886842179bb5faa522412da4a49,\n  ciphertext = 0x8ac0278f2ab100a5964173d76934d732,\n  plaintext = 0x30233b70c4d6fd31b23cc77bc73559ea},\n  {key = 0xd736669842aa88f43f1de421d38f391f1c2463f640f7848aed96955fd5ef13a3,\n  ciphertext = 0x30233b70c4d6fd31b23cc77bc73559ea,\n  plaintext = 0x766630dfd41e4146a827f55cba745b6a},\n  {key = 0x0ca8353df90e73606588a11675bd37a76a42532994e9c5cc45b160036f9b48c9,\n  ciphertext = 0x766630dfd41e4146a827f55cba745b6a,\n  plaintext = 0x177f22d98f009c214a44b08cf40b790d},\n  {key = 0x136ec3a1a65ee7bb0fd09af7364b66607d3d71f01be959ed0ff5d08f9b9031c4,\n  ciphertext = 0x177f22d98f009c214a44b08cf40b790d,\n  plaintext = 0xe9c916a21dec9662bdd91a0f865f8b47},\n  {key = 0xba5c2bd413daca7866de11c11db2926694f467520605cf8fb22cca801dcfba83,\n  ciphertext = 0xe9c916a21dec9662bdd91a0f865f8b47,\n  plaintext = 0x92b3ab3e28f6c606508706e0c3d76d28},\n  {key = 0x0fab4768fa7f104a3579f534508182920647cc6c2ef30989e2abcc60de18d7ab,\n  ciphertext = 0x92b3ab3e28f6c606508706e0c3d76d28,\n  plaintext = 0x3652053dcba591f101944fb1a5eb2b99},\n  {key = 0xe766aa23c075deaa6fae68384f5b205e3015c951e5569878e33f83d17bf3fc32,\n  ciphertext = 0x3652053dcba591f101944fb1a5eb2b99,\n  plaintext = 0x242260d2387c6f1a415834b34e300a7e},\n  {key = 0x9f1941442336bfffa1d6b27dce7845971437a983dd2af762a267b76235c3f64c,\n  ciphertext = 0x242260d2387c6f1a415834b34e300a7e,\n  plaintext = 0xa2a58ed050231b0d15f8cd99f5e171fb},\n  {key = 0x429a3cdc98124fafe33156a66b4e8c2ab69227538d09ec6fb79f7afbc02287b7,\n  ciphertext = 0xa2a58ed050231b0d15f8cd99f5e171fb,\n  plaintext = 0xec6631b17e5c97193fd9651b64feffe7},\n  {key = 0x92764a89e0de63823b9d9a5a001868035af416e2f3557b7688461fe0a4dc7850,\n  ciphertext = 0xec6631b17e5c97193fd9651b64feffe7,\n  plaintext = 0x1eef8afa419a9341085a2d611185e42c},\n  {key = 0x0c0bf13d79d1297e137e6f5995cb0a2c441b9c18b2cfe837801c3281b5599c7c,\n  ciphertext = 0x1eef8afa419a9341085a2d611185e42c,\n  plaintext = 0xd4eb4e591cf856b816e2207264e426e4},\n  {key = 0xde31f995867bb45813d369349cb7434290f0d241ae37be8f96fe12f3d1bdba98,\n  ciphertext = 0xd4eb4e591cf856b816e2207264e426e4,\n  plaintext = 0x401e14b126348e1aedd13662a19c23fb},\n  {key = 0x3b1a02b5600444db09118e99765fa61dd0eec6f0880330957b2f249170219963,\n  ciphertext = 0x401e14b126348e1aedd13662a19c23fb,\n  plaintext = 0x38bfea7e1eece741eb6a9601605129dd},\n  {key = 0x1fbcf4ffb36f76b88323f745b3152947e8512c8e96efd7d49045b2901070b0be,\n  ciphertext = 0x38bfea7e1eece741eb6a9601605129dd,\n  plaintext = 0x71cd66b3b3553b6aa632c338a307e11a},\n  {key = 0xb963bfe1c513f0dba7e24b5cfa1535a3999c4a3d25baecbe367771a8b37751a4,\n  ciphertext = 0x71cd66b3b3553b6aa632c338a307e11a,\n  plaintext = 0x34c2972d43e59eb0c44b7b69a540e7de},\n  {key = 0x23458e2a4332ce00e7967a438cd86448ad5edd10665f720ef23c0ac11637b67a,\n  ciphertext = 0x34c2972d43e59eb0c44b7b69a540e7de,\n  plaintext = 0x8988b878d0c6a84b6262351e033fb1b7},\n  {key = 0xe552b8a0f474a8da502e749e3f0639b124d66568b699da45905e3fdf150807cd,\n  ciphertext = 0x8988b878d0c6a84b6262351e033fb1b7,\n  plaintext = 0x010e24d01c37edca127484c8d8137772},\n  {key = 0x65a0645dd971bdb3b0d3a079ef96f3a925d841b8aaae378f822abb17cd1b70bf,\n  ciphertext = 0x010e24d01c37edca127484c8d8137772,\n  plaintext = 0x6c7b2e83630a8c8b6219839297d7c647},\n  {key = 0x9867d55ae9f56a03c435f4b25f2eee2c49a36f3bc9a4bb04e03338855accb6f8,\n  ciphertext = 0x6c7b2e83630a8c8b6219839297d7c647,\n  plaintext = 0xccba81435ecf162f70d30b3163cb3858},\n  {key = 0xe4a3addb683bbe85ed84b3ce044bcc538519ee78976bad2b90e033b439078ea0,\n  ciphertext = 0xccba81435ecf162f70d30b3163cb3858,\n  plaintext = 0xa0575bc9b8931f34cd6072e2015e7331},\n  {key = 0x6f543088bf24577d55a685e3637d85e8254eb5b12ff8b21f5d8041563859fd91,\n  ciphertext = 0xa0575bc9b8931f34cd6072e2015e7331,\n  plaintext = 0xa44046a87574e6d3e6c6446fb3c324bc},\n  {key = 0x5fff671ca24c3b241ddb92761f02dfe3810ef3195a8c54ccbb4605398b9ad92d,\n  ciphertext = 0xa44046a87574e6d3e6c6446fb3c324bc,\n  plaintext = 0xef6abb8ae007b730be45aa85e39f362d},\n  {key = 0xdb897d48a317f66412a8c52111c3f3b06e644893ba8be3fc0503afbc6805ef00,\n  ciphertext = 0xef6abb8ae007b730be45aa85e39f362d,\n  plaintext = 0xe5bd2edfb7e563f6cd86da757c4c370f},\n  {key = 0x78aec1da8e8e79007af12c05d800a18d8bd9664c0d6e800ac88575c91449d80f,\n  ciphertext = 0xe5bd2edfb7e563f6cd86da757c4c370f,\n  plaintext = 0x33caa267a64fb3cac210271bb8f25369},\n  {key = 0x2c3e5387a51addb0b7789ef0289109b3b813c42bab2133c00a9552d2acbb8b66,\n  ciphertext = 0x33caa267a64fb3cac210271bb8f25369,\n  plaintext = 0x27bb26990ca5e12d387bd659cb7e7860},\n  {key = 0x85685fe6996d514e5928d7196f41b5d29fa8e2b2a784d2ed32ee848b67c5f306,\n  ciphertext = 0x27bb26990ca5e12d387bd659cb7e7860,\n  plaintext = 0xd866ace71916e00c1559bba4149380a0},\n  {key = 0x82abcc9a00bae55087cf5d87413f095547ce4e55be9232e127b73f2f735673a6,\n  ciphertext = 0xd866ace71916e00c1559bba4149380a0,\n  plaintext = 0x8a4d6a0af8488a82a0c31332db3e36de},\n  {key = 0x81d983ce59413e84d7af4558d2e3941ccd83245f46dab86387742c1da8684578,\n  ciphertext = 0x8a4d6a0af8488a82a0c31332db3e36de,\n  plaintext = 0x05f6ff378b837cd375cddfae79ec2a9d},\n  {key = 0xbbe6d0d13a6b146bb23db6885ba66487c875db68cd59c4b0f2b9f3b3d1846fe5,\n  ciphertext = 0x05f6ff378b837cd375cddfae79ec2a9d,\n  plaintext = 0xb706bdb4019d604cc35faa07197c318d},\n  {key = 0x8092df6673b2b77783f2ba73c22e8d3c7f7366dcccc4a4fc31e659b4c8f85e68,\n  ciphertext = 0xb706bdb4019d604cc35faa07197c318d,\n  plaintext = 0xb26354bc77d3ce16909ca505d2381e4c},\n  {key = 0x3118fc57b93677af8e14c1b5961b76f3cd103260bb176aeaa17afcb11ac04024,\n  ciphertext = 0xb26354bc77d3ce16909ca505d2381e4c,\n  plaintext = 0x1515ef6a25cf3943eadadc36a029194a},\n  {key = 0xc4bde4a0c5f80329be6dd515f5bf6dabd805dd0a9ed853a94ba02087bae9596e,\n  ciphertext = 0x1515ef6a25cf3943eadadc36a029194a,\n  plaintext = 0x7b4ad946dfb59c80b1dc5cedb2fa87a0},\n  {key = 0x80b47f9126b0b1f5ab408bb9ea5f349aa34f044c416dcf29fa7c7c6a0813dece,\n  ciphertext = 0x7b4ad946dfb59c80b1dc5cedb2fa87a0,\n  plaintext = 0xfa10a53e14cde5ef1e9a8a5692847aa5},\n  {key = 0x86a43939c8cd243f7ff2a9658524373b595fa17255a02ac6e4e6f63c9a97a46b,\n  ciphertext = 0xfa10a53e14cde5ef1e9a8a5692847aa5,\n  plaintext = 0x4c9bed07308abcd0b09265b5efbe301c},\n  {key = 0x74a8f02a15285153e0ae160fbddcf6bf15c44c75652a96165474938975299477,\n  ciphertext = 0x4c9bed07308abcd0b09265b5efbe301c,\n  plaintext = 0x75b7496c42809a3a592acbd8e069269e},\n  {key = 0x293b40a2f70cc2c4262554663fb6f0986073051927aa0c2c0d5e58519540b2e9,\n  ciphertext = 0x75b7496c42809a3a592acbd8e069269e,\n  plaintext = 0x2dbc01185af7e084d90578468b6b10ef},\n  {key = 0xb04d4f4eb708eef86c5b6b8e08a665084dcf04017d5deca8d45b20171e2ba206,\n  ciphertext = 0x2dbc01185af7e084d90578468b6b10ef,\n  plaintext = 0xc95b3a9f689c9dce4995c24f72dd5162},\n  {key = 0x7cb9f7211815e0cb48b71286f84f80a184943e9e15c171669dcee2586cf6f364,\n  ciphertext = 0xc95b3a9f689c9dce4995c24f72dd5162,\n  plaintext = 0x616e55c3bf113e2c18cae3c61b7eb7d1},\n  {key = 0xb3cdb46cf92aa0b96e87212bc650d5e5e5fa6b5daad04f4a8504019e778844b5,\n  ciphertext = 0x616e55c3bf113e2c18cae3c61b7eb7d1,\n  plaintext = 0x87e8b80767ebbdbad75cb94f4cb54f3b},\n  {key = 0x512c2a3821eb53af613141c71e1076656212d35acd3bf2f05258b8d13b3d0b8e,\n  ciphertext = 0x87e8b80767ebbdbad75cb94f4cb54f3b,\n  plaintext = 0xc83e20e18f2b1457788954b49fd84307},\n  {key = 0x9977c985745bc33954a2ce898bc8febdaa2cf3bb4210e6a72ad1ec65a4e54889,\n  ciphertext = 0xc83e20e18f2b1457788954b49fd84307,\n  plaintext = 0xe3d3868f578caf34e36445bf14cefc68}]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Asymmetric\/Signature\/ECDSA\/Tests\/ECDSA_P224_SHA3_224\/001_testVerification.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `testVerification` for the ECDSA_P224_SHA3_224 instantiation, which checks that a fixed private key `d` produces the expected affine public key `(qx, qy)` and that `ECDSA::verify` successfully verifies each of ten given (msg, r, s) signature test vectors under that public key."},{"role":"assistant","content":"```cryptol\nimport Primitive::Asymmetric::Signature::ECDSA::Instantiations::ECDSA_P224_SHA3_224 as ECDSA\nimport Common::utils(BVtoZ)\nimport Common::EC::PrimeField::Instantiations::P224 as EC\n\n\n\/* pragma testVerification : property *\/\ntestVerification =\n  publicKeyWorks && sigVerWorks\n  where\n    publicKeyWorks =\n      EC::affineEq (ECDSA::publicKey d) (EC::Affine qx qy)\n    d =\n      BVtoZ 0x2f9d814730af0085c942fe8b679b023c0db5afac27613d7cec883405\n    qx =\n      BVtoZ 0x47e1e01bbe0407877c18d7b94acfc690bdcf0af6d6a9ec91ca59f772\n    qy =\n      BVtoZ 0x5da449e730c30be4d65a605f2ba6fcbf390310e02246a9135ece16aa\n    checkSigVer msg r s =\n      ECDSA::verify msg (r, s) (ECDSA::publicKey d)\n    sigVerWorks =\n      and\n        [checkSigVer msg (BVtoZ r) (BVtoZ s) | (msg, r, s) <- [(msg61,\n                                            r61,\n                                            s61),\n                                            (msg62, r62, s62),\n                                            (msg63, r63, s63),\n                                            (msg64, r64, s64),\n                                            (msg65, r65, s65),\n                                            (msg66, r66, s66),\n                                            (msg67, r67, s67),\n                                            (msg68, r68, s68),\n                                            (msg69, r69, s69),\n                                            (msg70, r70, s70)]]\n    msg61 =\n      0x030d2c1918e8473ffceb9a78a4331387757c8808b7d57f06a4a268dfe6178cf7236bebd8c4f49bd73a65796973b64fbed7e38f56b95639efe6f00db4bf82a476540e2ef3f2eb6b05d3425ef1c465f6b25628618b8ee005525eddc32ff96f1999563ece6a68a6e6396e1d37bea898cda91f0723d91bfbb423789799d824d9220a\n    r61 = 0x3612063972b03272569a0a4860948a06544e1d21f19995880acc0afa\n    s61 = 0x0f6e9c94a55155aaafe842637a84ac0c57f6ce67e721fc4cba3fd7fd\n    msg62 =\n      0x56e761977ef6a0c1e08ea96ff909089aa451f0b4b7eeb6b8f978e4d32facdb3158d4c96ad7fde38b387994c1913e5b64ff8c02465137ad1f5239956181d93b744f3bae546d0827a69742eb650e09f18ed966ac6a202a6c06293772fea47bcd23dfa2ca82cc35caabf62371be3dd756c43739dc4ffc1a171abd7a8937b31eca08\n    r62 = 0x2ecb9ade16cc813b56f72538c9223684761316142b6348180765daf3\n    s62 = 0xc22705fc831663a661c2c780986f43afaaa3b0de46066372881d4bca\n    msg63 =\n      0x0ad042754785a6f67d037f5ca4497f8e71653ddb721aa401ad46fe04994a0537effe3356fa5cf8a91c43b1f75309332d3d97bee61c8b5e3e273cd2402ec2392efad266d876bc262f4c5a67d058cc3e7f872cc7d379000a56d6a913208c4403831409c39189ba59056a38e626e235e73b5d5e8531454e38be64f093d0c2916732\n    r63 = 0x454589ad9ec014e14a6f1947d64578b31f81e6e2aa8c69584cd4ee9d\n    s63 = 0x89d832dedc403ee2d9a899e58a556cafac2b236c48210927657609c6\n    msg64 =\n      0x07c9b2eb7ca9b7717521520d1e5ce996a415ffde9e858288167c54b22fbf19cfc982af2e2dd5f12c8b135aea788baff48f08de83730cc2b6f7e0c06ed64385d00ccb99cd51789f839872ea603c7a69d7eb2af5b490259a625000a7cc588a9f75749664e1629a1f85bd6ea90d6f12b69fad19f875b8fa6671acfb6870fe5df141\n    r64 = 0x546ce2f2ee8ec5cff9a3065ef5006f37521fad405a8069863bd4bdeb\n    s64 = 0x58ab96923d3fee1f56d399c33ddb4324b43bc99eac54d5464c5f5a05\n    msg65 =\n      0x4aeb2c6fda5c7da730348816ddb0e3910b2dd91bc8e5d9c34dbf6a8f1b5c8e251f94cc6a6642e1ad3a1b086b075160f9b7bb90bb78cf09165592b1bc0ab7c239a090683eaa9b4d9ce951ebd2fc2e56ff7b7447de962eb687d27705b3decbff25ed059a5e51dc6eff9a26ea2e57db8e5b4690870addb03e3aeeb91a189be7c3d3\n    r65 = 0x9bccd499ed71e53c4a5aa52c357bd10b881be82c35e62b37f99f950f\n    s65 = 0x144722d59c95d2c6a0a161ee58245a04a06f226eec91a26f972b7ff1\n    msg66 =\n      0x19773a3f4941f74b9ab5c304b85a9c11371d63b41ddee0b604358cd2e0a325f627d9a0c7762d5e25e3eeb8f2d276c3796c0c181e07c6d3ba3eb16ca866da3952a7967b7cd3081d4f3b6b7bf0981f6871def2ac1af6cd8da35573cf947c99905ede50123ae7a16c18270eeb956a282d0e46e942f73818a3bad1631d4021455e27\n    r66 = 0xed76263f419c4595b9f688c0dd45a2f58178d37f4bfa03bf485d85aa\n    s66 = 0xa7a96cb96456f5a91db03b430df578af977f6abd89e4126e1ccc08b7\n    msg67 =\n      0xbb62a3cdc9a276156ea316f9b2224710ab35a23befe5e2c0c1835b4bbd4e1a91ff73d5442482c8ce19ded1c88999187dd369fc9f56bf4791a7c850927090f43f6ba092caa01a7aa8d4f9fb367689881115cbdbb18e8632923e755f9f2a9dc71514485111aa2d48ae1a8a258951850706677a2f37a50888bdb23df8e8c99532f9\n    r67 = 0xe92dc7f00699078e5df2a77ad630e5aa49e54dc7723826e2bbf174d4\n    s67 = 0xba09d6dfa3287c280cae0d6482a36c5bbdbe4f60e80e9dd86a8eb685\n    msg68 =\n      0x698e81344c797c92bbaf6d3c6ddf344d379b2036dfd7561a341a1b5e0450fc24a3198fa256fbbb394f96e3d34ddcf148e10541ae3f048bf931d72f07b2cc289e83bb195e271552794a603b6ad087f26422ce2b2cee80e0bd78b7b8a874059a8a01b35b3f4113160c31302f20c103b0e980a40d4d562952defb5a713e2183a979\n    r68 = 0x958cadfbf3bd03ae51701eb69365ca64d2d6ad620a3bde4bd9fce0eb\n    s68 = 0x80c3655c742f372c5162979839bf35f660abdc52c6415e1c320ff204\n    msg69 =\n      0x85fd8580de5605f8569a41d11a53115abbb0d228ca9e5c992725f8392495765fee802665a58826897b8511e4554b07fe0e48930e9b7349ac622b0805e0807e687e971c215120a34ebe6e9c134bbfc4302ad8baa2fdf4f70ba1788549d7e5f717995ca31a7c32d6c9eb9103927feb24e874e0ead79818c422b1985428e98ee0c1\n    r69 = 0xcc4e52755299819099619fa4ec7bda3d9a05ea001bb52e04f3835912\n    s69 = 0x2b809fb7a3260b6756afd0f23a3626bd20d9d96a194ea70a99f61be2\n    msg70 =\n      0xfefe7d84406988e58a370770897ca87ecddb1593bce17358a8837c86d3bca694f9d621db81794a64170a5aae23e6fcaff487672ed5a2851fd9fffe8acda0efe5e62a57862b9d05350aeb3642014d57a60e4a26c3a18dbf515c4d7886ae544f4e4c5cfb7a8d0bf91a4a08bb95f4e26d5286acdf1dee3b41e1a5e49125b84f3ec5\n    r70 = 0xd36fb3d8c67486a2091c8ac6cf1bc28a29f8ccdabe99b5a1f074bebf\n    s70 = 0x385f7a0ea55c01714d2a5bb2f5b07334ae24b2b1e91f0ff91c657639\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Asymmetric\/Signature\/FALCON\/1.2\/falcon_parameterized\/005_while.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the higher-order function `while : {a} (a -> Bit) -> (a -> a) -> a -> a` that repeatedly applies a state-transition function `body` to an initial state while a boolean `condition` on the state holds, and returns the final state when the condition becomes false."},{"role":"assistant","content":"```cryptol\nwhile : {a} (a -> Bit) -> (a -> a) -> a -> a\nwhile condition body initial_state =\n  if (condition initial_state)\n  then while condition body (body initial_state)\n  else initial_state\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Asymmetric\/Signature\/FALCON\/1.2\/falcon_parameterized\/007_dowhile.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the polymorphic functions `while : {a} (a -> Bit) -> (a -> a) -> a -> a` and `dowhile : {a} (a -> Bit) -> (a -> a) -> a -> a` implementing standard while and do-while loop behavior over an abstract state, and include properties that verify `dowhile` followed by `while` is equivalent to at least one execution of the body followed by repeated `while` iterations whenever the condition holds."},{"role":"assistant","content":"```cryptol\nwhile : {a} (a -> Bit) -> (a -> a) -> a -> a\nwhile condition body initial_state =\n  if (condition initial_state)\n  then while condition body (body initial_state)\n  else initial_state\ndowhile : {a} (a -> Bit) -> (a -> a) -> a -> a\ndowhile condition body initial_state =\n  if (condition next_state)\n  then while condition body next_state\n  else next_state\n  where\n    next_state = body initial_state\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Asymmetric\/Signature\/FALCON\/1.2\/falcon_parameterized\/023_resize.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the polymorphic function `resize : {m, n, a} (fin m, fin n, Zero a) => [m]a -> [n]a` that resizes a sequence by padding with `zero` as needed, following the behavior `resize xs = take`{n} (xs # repeat`{inf} zero)`, and include any necessary supporting definitions or constraints."},{"role":"assistant","content":"```cryptol\nresize : {m, n, a} (fin m, fin n, Zero a) => [m]a -> [n]a\nresize xs = take`{n} (xs # repeat`{inf} zero)\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Asymmetric\/Signature\/FALCON\/1.2\/falcon_parameterized\/103_eGCD.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property that verifies this extended Euclidean algorithm function eGCD : (Integer, Integer) -> (Integer, Integer, Integer) always returns (g, s, t) such that g is the greatest common divisor of the two inputs and g == s * a + t * b for all integer inputs a and b."},{"role":"assistant","content":"```cryptol\ntype ZZ = Integer\neGCD : (ZZ, ZZ) -> (ZZ, ZZ, ZZ)\neGCD (a, b) =\n  if a == 0 then (b, 0, 1) else (g, t - (b \/ a) * s, s)\n  where\n    (g, s, t) = eGCD ((b % a), a)\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Asymmetric\/Signature\/FALCON\/1.2\/falcon_parameterized\/125_ApproxExp.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the function `ApproxExp : (Float64, Float64) -> [64]` implementing the Falcon-1024 approximate exponential step using the given coefficient table `C`, fixed-point scaling by `2^^63`, and the fold-based polynomial evaluation with inputs `x` and `ccs` as described, producing the final 64-bit result `y''`."},{"role":"assistant","content":"```cryptol\nimport Float\n\n\nApproxExp : (Float64, Float64) -> [64]\nApproxExp (x, ccs) =\n  y''\n  where\n    C =\n      [0x00000004741183a3,\n      0x00000036548cfc06,\n      0x0000024fdcbf140a,\n      0x0000171d939de045,\n      0x0000d00cf58f6f84,\n      0x000680681cf796e3,\n      0x002d82d8305b0fea,\n      0x011111110e066fd0,\n      0x0555555555070f00,\n      0x155555555581ff00,\n      0x400000000002b400,\n      0x7fffffffffff4800,\n      0x8000000000000000]\n    y = C @ 0\n    z = fromInteger (floor (2 ^^ 63 * x))\n    y' = foldl (\\yy -> \\u -> C @ u - (z * y) >> 63) y [1 .. 12]\n    z' = fromInteger (floor (2 ^^ 63 * ccs))\n    y'' = (z' * y') >> 63\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/014_splitBlock.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type aliases Katan64, KatanBlock, L1Size, and L2Size as given, and implement the function splitBlock : [KatanBlock] -> ([L1Size], [L2Size]) that splits a 64-bit KATAN plaintext block into two bit-vectors of sizes 25 and 39 using take and drop."},{"role":"assistant","content":"```cryptol\ntype Katan64 = 64\ntype KatanBlock = Katan64\ntype L1Size = 25\ntype L2Size = 39\nsplitBlock : [KatanBlock] -> ([L1Size], [L2Size])\nsplitBlock pt =\n  (l1, l2)\n  where\n    l1 = take`{L1Size} pt\n    l2 = drop`{L1Size} pt\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/018_kS.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `kS : {a} (fin a) => ([a], [12]) -> [a + 1]` that, given a key bit vector and a 12-bit round index `i`, returns the key extended by one bit computed as the XOR of bits at positions `i-80`, `i-61`, `i-50`, and `i-13` of the key, and ensure the indexing and concatenation follow Cryptol\u2019s semantics."},{"role":"assistant","content":"```cryptol\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/020_kS10.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for the KATAN block cipher key schedule functions `kS` and `kS10`, where `kS : {a} (fin a) => ([a], [12]) -> [a + 1]` appends one new key bit derived from taps at positions 80, 61, 50, and 13, and `kS10 : {a} (fin a) => ([a], [12]) -> [a + 10]` iteratively applies `kS` ten times, and include properties that verify `kS10` is equivalent to ten successive applications of `kS` for all valid keys and indices."},{"role":"assistant","content":"```cryptol\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/022_kS100.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the key schedule functions `kS`, `kS10`, and `kS100` for the KATAN block cipher, with types `kS : {a} (fin a) => ([a], [12]) -> [a + 1]`, `kS10 : {a} (fin a) => ([a], [12]) -> [a + 10]`, and `kS100 : {a} (fin a) => ([a], [12]) -> [a + 100]`, where each extends the key by XORing taps at indices 80, 61, 50, and 13 and iterating as indicated by their definitions."},{"role":"assistant","content":"```cryptol\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/024_keySchedule'.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `keySchedule' : [80] -> [508] implementing the 80-bit KATAN block cipher key schedule using the helper functions `kS`, `kS10`, and `kS100` as described, and add a property that verifies `keySchedule'` correctly generates the expected 508-bit round key sequence from a given 80-bit key."},{"role":"assistant","content":"```cryptol\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\nkeySchedule' : [80] -> [508]\nkeySchedule' key =\n  key13\n  where\n    key0 = kS100 (key, 80)\n    key1 = kS100 (key0, 180)\n    key2 = kS100 (key1, 280)\n    key3 = kS100 (key2, 380)\n    key4 = kS10 (key3, 480)\n    key5 = kS10 (key4, 490)\n    key6 = kS (key5, 500)\n    key7 = kS (key6, 501)\n    key8 = kS (key7, 502)\n    key9 = kS (key8, 503)\n    key10 = kS (key9, 504)\n    key11 = kS (key10, 505)\n    key12 = kS (key11, 506)\n    key13 = kS (key12, 507)\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/026_funFa.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the KATAN block cipher round function component `funFa : [L1Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit` for the KATAN-26 variant, including the constants `Round`, `xSize`, `Nr`, `L1Size`, the index vector `x`, the round-constant sequence `iR : [1][Nr]`, and the Boolean combination of selected `L1` and `k` bits exactly as in the given definition."},{"role":"assistant","content":"```cryptol\ntype Round = 8\ntype xSize = 5\ntype Nr = 254\ntype L1Size = 25\nx = [24, 15, 20, 11, 9]\niR : [1][Nr]\niR =\n  [0b11111110001101010101111011001100101001000100011000111100001000010100000111110011111101010001010100110000110011101111101110100101011010011100110110001011101101111001011011010111001001001101000111000100111101000011101011000001011001000000110111000000010010]\nfunFa : [L1Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\nfunFa L1 x k i =\n  (L1 ! (x @ 0)) ^ (L1 ! (x @ 1)) ^ ((L1 ! (x @ 2)) && (L1 ! (x @ 3))) ^ ((L1 ! (x @ 4)) && ((iR @ 0) @ i)) ^ (k @ (pmult\n    (2 : [2]) i))\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/028_funFb.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function `funFb : [L2Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit` for the KATAN block cipher, where `Round = 8`, `ySize = 6`, `L2Size = 39`, `y = [38, 25, 33, 21, 14, 9]`, and `funFb L2 y k i = (L2 ! (y @ 0)) ^ (L2 ! (y @ 1)) ^ (L2 ! (y @ 2) && L2 ! (y @ 3)) ^ (L2 ! (y @ 4) && L2 ! (y @ 5)) ^ (k @ ((pmult (2 : [2]) i) + 1)), and then add a property that checks this function\u2019s output against a trusted reference implementation for all valid inputs."},{"role":"assistant","content":"```cryptol\ntype Round = 8\ntype ySize = 6\ntype L2Size = 39\ny = [38, 25, 33, 21, 14, 9]\nfunFb : [L2Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\nfunFb L2 y k i =\n  (L2 ! (y @ 0)) ^ (L2 ! (y @ 1)) ^ (L2 ! (y @ 2) && L2 ! (y @ 3)) ^ (L2 ! (y @ 4) && L2 ! (y @ 5)) ^ (k @ ((pmult\n    (2 : [2]) i) + 1))\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/030_aply_fb.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for the KATAN-32 block cipher key schedule and feedback bit function, defining the constants KatanKeySize, Round, ySize, L1Size, L2Size, the functions kS, kS10, kS100, keySchedule', funFb, and aply_fb with the same types and behavior as in the given description, suitable for use in block cipher verification."},{"role":"assistant","content":"```cryptol\ntype KatanKeySize = 80\ntype Round = 8\ntype ySize = 6\ntype L1Size = 25\ntype L2Size = 39\ny = [38, 25, 33, 21, 14, 9]\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\nkeySchedule' : [80] -> [508]\nkeySchedule' key =\n  key13\n  where\n    key0 = kS100 (key, 80)\n    key1 = kS100 (key0, 180)\n    key2 = kS100 (key1, 280)\n    key3 = kS100 (key2, 380)\n    key4 = kS10 (key3, 480)\n    key5 = kS10 (key4, 490)\n    key6 = kS (key5, 500)\n    key7 = kS (key6, 501)\n    key8 = kS (key7, 502)\n    key9 = kS (key8, 503)\n    key10 = kS (key9, 504)\n    key11 = kS (key10, 505)\n    key12 = kS (key11, 506)\n    key13 = kS (key12, 507)\nfunFb : [L2Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\nfunFb L2 y k i =\n  (L2 ! (y @ 0)) ^ (L2 ! (y @ 1)) ^ (L2 ! (y @ 2) && L2 ! (y @ 3)) ^ (L2 ! (y @ 4) && L2 ! (y @ 5)) ^ (k @ ((pmult\n    (2 : [2]) i) + 1))\naply_fb : [L1Size] ->\n  [L2Size] ->\n  [ySize][ySize] -> [KatanKeySize] -> [Round] -> [L1Size]\naply_fb l1 l2 y key i =\n  (l1 !! [(L1Size - 2), (L1Size - 3) .. 0]) # [(funFb l2 y\n    (keySchedule' key) i)]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/032_aply_fa.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for the KATAN-32 block cipher\u2019s key schedule and round function, including the given constants (KatanKeySize, Round, xSize, Nr, L1Size, L2Size, x, iR), the key schedule functions kS, kS10, kS100, keySchedule', the nonlinear function funFa, and the state update function aply_fa, with the same types and behavior as in the provided code."},{"role":"assistant","content":"```cryptol\ntype KatanKeySize = 80\ntype Round = 8\ntype xSize = 5\ntype Nr = 254\ntype L1Size = 25\ntype L2Size = 39\nx = [24, 15, 20, 11, 9]\niR : [1][Nr]\niR =\n  [0b11111110001101010101111011001100101001000100011000111100001000010100000111110011111101010001010100110000110011101111101110100101011010011100110110001011101101111001011011010111001001001101000111000100111101000011101011000001011001000000110111000000010010]\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\nkeySchedule' : [80] -> [508]\nkeySchedule' key =\n  key13\n  where\n    key0 = kS100 (key, 80)\n    key1 = kS100 (key0, 180)\n    key2 = kS100 (key1, 280)\n    key3 = kS100 (key2, 380)\n    key4 = kS10 (key3, 480)\n    key5 = kS10 (key4, 490)\n    key6 = kS (key5, 500)\n    key7 = kS (key6, 501)\n    key8 = kS (key7, 502)\n    key9 = kS (key8, 503)\n    key10 = kS (key9, 504)\n    key11 = kS (key10, 505)\n    key12 = kS (key11, 506)\n    key13 = kS (key12, 507)\nfunFa : [L1Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\nfunFa L1 x k i =\n  (L1 ! (x @ 0)) ^ (L1 ! (x @ 1)) ^ ((L1 ! (x @ 2)) && (L1 ! (x @ 3))) ^ ((L1 ! (x @ 4)) && ((iR @ 0) @ i)) ^ (k @ (pmult\n    (2 : [2]) i))\naply_fa : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] -> [KatanKeySize] -> [Round] -> [L2Size]\naply_fa l1 l2 x key i =\n  (l2 !! [(L2Size - 2), (L2Size - 3) .. 0]) # [(funFa l1 x\n    (keySchedule' key) i)]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/042_decFunFa.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module that defines the types Round = 8, xSize = 5, Nr = 254, L1Size = 25, L2Size = 39, the constant iR : [1][Nr] with the given 254-bit value, and the function decFunFa : [L1Size] -> [L2Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit implementing the Boolean expression fa ^ (L1 ! ((x @ 1) + 1)) ^ (L1 ! ((x @ 2) + 1) && L1 ! ((x @ 3) + 1)) ^ (L1 ! ((x @ 4) + 1) && ((iR @ 0) @ i)) ^ k @ (2 * i) where fa = L2 ! 0."},{"role":"assistant","content":"```cryptol\ntype Round = 8\ntype xSize = 5\ntype Nr = 254\ntype L1Size = 25\ntype L2Size = 39\nx = [24, 15, 20, 11, 9]\niR : [1][Nr]\niR =\n  [0b11111110001101010101111011001100101001000100011000111100001000010100000111110011111101010001010100110000110011101111101110100101011010011100110110001011101101111001011011010111001001001101000111000100111101000011101011000001011001000000110111000000010010]\ndecFunFa : [L1Size] ->\n  [L2Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\ndecFunFa L1 L2 x k i =\n  fa ^ (L1 ! ((x @ 1) + 1)) ^ (L1 ! ((x @ 2) + 1) && L1 ! ((x @ 3) + 1)) ^ (L1 ! ((x @ 4) + 1) && ((iR @ 0) @ i)) ^ k @ (2 * i)\n  where\n    fa = L2 ! 0\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/044_decFunFb.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `decFunFb : [39] -> [25] -> [6][6] -> [508] -> [8] -> Bit` as the KATAN-44 decryption feedback boolean function using the given tap positions `y = [38, 25, 33, 21, 14, 9]`, and include a property that checks `decFunFb` matches the KATAN-44 round specification for all valid inputs."},{"role":"assistant","content":"```cryptol\ntype Round = 8\ntype ySize = 6\ntype L1Size = 25\ntype L2Size = 39\ny = [38, 25, 33, 21, 14, 9]\ndecFunFb : [L2Size] ->\n  [L1Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\ndecFunFb L2 L1 y k i =\n  fb ^ (L2 ! ((y @ 1) + 1)) ^ ((L2 ! ((y @ 2) + 1)) && L2 ! ((y @ 3) + 1)) ^ ((L2 ! ((y @ 4) + 1)) && L2 ! ((y @ 5) + 1)) ^ k @ (2 * i + 1)\n  where\n    fb = L1 ! 0\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/046_aply_decFa_once.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function `aply_decFa_once : [25] -> [39] -> [5][5] -> [80] -> [8] -> [25]` for the KATAN-46 block cipher that applies one round of the decryption feedback function `decFunFa` using the generated round keys from `keySchedule'`, along with any necessary supporting definitions such as `keySchedule'`, `kS`, `kS10`, `kS100`, and constants (e.g., sizes, `iR`, `x`)."},{"role":"assistant","content":"```cryptol\ntype KatanKeySize = 80\ntype Round = 8\ntype xSize = 5\ntype Nr = 254\ntype L1Size = 25\ntype L2Size = 39\nx = [24, 15, 20, 11, 9]\niR : [1][Nr]\niR =\n  [0b11111110001101010101111011001100101001000100011000111100001000010100000111110011111101010001010100110000110011101111101110100101011010011100110110001011101101111001011011010111001001001101000111000100111101000011101011000001011001000000110111000000010010]\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\nkeySchedule' : [80] -> [508]\nkeySchedule' key =\n  key13\n  where\n    key0 = kS100 (key, 80)\n    key1 = kS100 (key0, 180)\n    key2 = kS100 (key1, 280)\n    key3 = kS100 (key2, 380)\n    key4 = kS10 (key3, 480)\n    key5 = kS10 (key4, 490)\n    key6 = kS (key5, 500)\n    key7 = kS (key6, 501)\n    key8 = kS (key7, 502)\n    key9 = kS (key8, 503)\n    key10 = kS (key9, 504)\n    key11 = kS (key10, 505)\n    key12 = kS (key11, 506)\n    key13 = kS (key12, 507)\ndecFunFa : [L1Size] ->\n  [L2Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\ndecFunFa L1 L2 x k i =\n  fa ^ (L1 ! ((x @ 1) + 1)) ^ (L1 ! ((x @ 2) + 1) && L1 ! ((x @ 3) + 1)) ^ (L1 ! ((x @ 4) + 1) && ((iR @ 0) @ i)) ^ k @ (2 * i)\n  where\n    fa = L2 ! 0\naply_decFa_once : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] -> [KatanKeySize] -> [Round] -> [L1Size]\naply_decFa_once l1 l2 x k i =\n  [(decFunFa l1 l2 x (keySchedule' k) i)] # (l1 !! [(L1Size -\n  1), (L1Size - 2) .. 1])\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/048_aply_decFb_once.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification of the KATAN-48 block cipher\u2019s single-round L2 state update that defines `keySchedule' : [80] -> [508]`, `decFunFb : [39] -> [25] -> [6][6] -> [508] -> [8] -> Bit`, and `aply_decFb_once : [39] -> [25] -> [6][6] -> [80] -> [8] -> [39]`, implementing the given key schedule expansion and one application of the decFb feedback function to update the L2 register."},{"role":"assistant","content":"```cryptol\ntype KatanKeySize = 80\ntype Round = 8\ntype ySize = 6\ntype L1Size = 25\ntype L2Size = 39\ny = [38, 25, 33, 21, 14, 9]\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\nkeySchedule' : [80] -> [508]\nkeySchedule' key =\n  key13\n  where\n    key0 = kS100 (key, 80)\n    key1 = kS100 (key0, 180)\n    key2 = kS100 (key1, 280)\n    key3 = kS100 (key2, 380)\n    key4 = kS10 (key3, 480)\n    key5 = kS10 (key4, 490)\n    key6 = kS (key5, 500)\n    key7 = kS (key6, 501)\n    key8 = kS (key7, 502)\n    key9 = kS (key8, 503)\n    key10 = kS (key9, 504)\n    key11 = kS (key10, 505)\n    key12 = kS (key11, 506)\n    key13 = kS (key12, 507)\ndecFunFb : [L2Size] ->\n  [L1Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\ndecFunFb L2 L1 y k i =\n  fb ^ (L2 ! ((y @ 1) + 1)) ^ ((L2 ! ((y @ 2) + 1)) && L2 ! ((y @ 3) + 1)) ^ ((L2 ! ((y @ 4) + 1)) && L2 ! ((y @ 5) + 1)) ^ k @ (2 * i + 1)\n  where\n    fb = L1 ! 0\naply_decFb_once : [L2Size] ->\n  [L1Size] ->\n  [ySize][ySize] -> [KatanKeySize] -> [Round] -> [L2Size]\naply_decFb_once l2 l1 y k i =\n  [(decFunFb l2 l1 y (keySchedule' k) i)] # (l2 !! [(L2Size -\n  1), (L2Size - 2) .. 1])\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/054_katanCorrect.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `katanCorrect : [KatanKeySize] -> [KatanBlock] -> Bit` that states for all 80-bit keys `key` and 64-bit messages `m`, decrypting with `katanDecrypt` and then encrypting with `katanEncrypt` (i.e., `katanEncrypt (key, katanDecrypt (key, m)) == m`) holds for the KATAN-64 block cipher implementation using the given key schedule and LFSR update functions."},{"role":"assistant","content":"```cryptol\ntype Katan64 = 64\ntype KatanBlock = Katan64\ntype KatanKeySize = 80\ntype Round = 8\ntype xSize = 5\ntype ySize = 6\ntype Nr = 254\ntype L1Size = 25\ntype L2Size = 39\nx = [24, 15, 20, 11, 9]\ny = [38, 25, 33, 21, 14, 9]\nsplitBlock : [KatanBlock] -> ([L1Size], [L2Size])\nsplitBlock pt =\n  (l1, l2)\n  where\n    l1 = take`{L1Size} pt\n    l2 = drop`{L1Size} pt\niR : [1][Nr]\niR =\n  [0b11111110001101010101111011001100101001000100011000111100001000010100000111110011111101010001010100110000110011101111101110100101011010011100110110001011101101111001011011010111001001001101000111000100111101000011101011000001011001000000110111000000010010]\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\nkeySchedule' : [80] -> [508]\nkeySchedule' key =\n  key13\n  where\n    key0 = kS100 (key, 80)\n    key1 = kS100 (key0, 180)\n    key2 = kS100 (key1, 280)\n    key3 = kS100 (key2, 380)\n    key4 = kS10 (key3, 480)\n    key5 = kS10 (key4, 490)\n    key6 = kS (key5, 500)\n    key7 = kS (key6, 501)\n    key8 = kS (key7, 502)\n    key9 = kS (key8, 503)\n    key10 = kS (key9, 504)\n    key11 = kS (key10, 505)\n    key12 = kS (key11, 506)\n    key13 = kS (key12, 507)\nfunFa : [L1Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\nfunFa L1 x k i =\n  (L1 ! (x @ 0)) ^ (L1 ! (x @ 1)) ^ ((L1 ! (x @ 2)) && (L1 ! (x @ 3))) ^ ((L1 ! (x @ 4)) && ((iR @ 0) @ i)) ^ (k @ (pmult\n    (2 : [2]) i))\nfunFb : [L2Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\nfunFb L2 y k i =\n  (L2 ! (y @ 0)) ^ (L2 ! (y @ 1)) ^ (L2 ! (y @ 2) && L2 ! (y @ 3)) ^ (L2 ! (y @ 4) && L2 ! (y @ 5)) ^ (k @ ((pmult\n    (2 : [2]) i) + 1))\naply_fb : [L1Size] ->\n  [L2Size] ->\n  [ySize][ySize] -> [KatanKeySize] -> [Round] -> [L1Size]\naply_fb l1 l2 y key i =\n  (l1 !! [(L1Size - 2), (L1Size - 3) .. 0]) # [(funFb l2 y\n    (keySchedule' key) i)]\naply_fa : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] -> [KatanKeySize] -> [Round] -> [L2Size]\naply_fa l1 l2 x key i =\n  (l2 !! [(L2Size - 2), (L2Size - 3) .. 0]) # [(funFa l1 x\n    (keySchedule' key) i)]\nupdateLfsr : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] ->\n  [ySize][ySize] ->\n  [KatanKeySize] -> [Round] -> ([L1Size], [L2Size])\nupdateLfsr l1 l2 x y key i =\n  if `L1Size == 13\n  then (l1', l2')\n  else if `L1Size == 19 then (l1'', l2'') else (l1''', l2''')\n  where\n    pt = (aply_fb l1 l2 y key i) # (aply_fa l1 l2 x key i)\n    l1' = (splitBlock pt).0\n    l2' = (splitBlock pt).1\n    pt' = (aply_fb l1' l2' y key i) # (aply_fa l1' l2' x key i)\n    l1'' = (splitBlock pt').0\n    l2'' = (splitBlock pt').1\n    pt'' = (aply_fb l1'' l2'' y key i) # (aply_fa l1'' l2'' x key i)\n    l1''' = (splitBlock pt'').0\n    l2''' = (splitBlock pt'').1\nkatanEncrypt : ([KatanKeySize], [KatanBlock]) -> _\nkatanEncrypt (key, pt) =\n  (hs ! 0).0 # (hs ! 0).1\n  where\n    hs =\n      [(l1, l2)] # [((updateLfsr pT.0 pT.1 x y key i).0,\n      (updateLfsr pT.0 pT.1 x y key i).1) | i <- [0, 1 .. 253]\n                                          | pT <- hs]\n    l1 = (splitBlock pt).0\n    l2 = (splitBlock pt).1\ndecFunFa : [L1Size] ->\n  [L2Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\ndecFunFa L1 L2 x k i =\n  fa ^ (L1 ! ((x @ 1) + 1)) ^ (L1 ! ((x @ 2) + 1) && L1 ! ((x @ 3) + 1)) ^ (L1 ! ((x @ 4) + 1) && ((iR @ 0) @ i)) ^ k @ (2 * i)\n  where\n    fa = L2 ! 0\ndecFunFb : [L2Size] ->\n  [L1Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\ndecFunFb L2 L1 y k i =\n  fb ^ (L2 ! ((y @ 1) + 1)) ^ ((L2 ! ((y @ 2) + 1)) && L2 ! ((y @ 3) + 1)) ^ ((L2 ! ((y @ 4) + 1)) && L2 ! ((y @ 5) + 1)) ^ k @ (2 * i + 1)\n  where\n    fb = L1 ! 0\naply_decFa_once : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] -> [KatanKeySize] -> [Round] -> [L1Size]\naply_decFa_once l1 l2 x k i =\n  [(decFunFa l1 l2 x (keySchedule' k) i)] # (l1 !! [(L1Size -\n  1), (L1Size - 2) .. 1])\naply_decFb_once : [L2Size] ->\n  [L1Size] ->\n  [ySize][ySize] -> [KatanKeySize] -> [Round] -> [L2Size]\naply_decFb_once l2 l1 y k i =\n  [(decFunFb l2 l1 y (keySchedule' k) i)] # (l2 !! [(L2Size -\n  1), (L2Size - 2) .. 1])\ndecUpdateLfsr : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] ->\n  [ySize][ySize] ->\n  [KatanKeySize] -> [Round] -> ([L1Size], [L2Size])\ndecUpdateLfsr l1 l2 x y key i =\n  if `L1Size == 13\n  then (l1', l2')\n  else if `L1Size == 19 then (l1'', l2'') else (l1''', l2''')\n  where\n    ct =\n      (aply_decFa_once l1 l2 x key i) # (aply_decFb_once l2 l1 y key i)\n    l1' = (splitBlock ct).0\n    l2' = (splitBlock ct).1\n    ct' =\n      (aply_decFa_once l1' l2' x key i) # (aply_decFb_once l2' l1' y key\n        i)\n    l1'' = (splitBlock ct').0\n    l2'' = (splitBlock ct').1\n    ct'' =\n      (aply_decFa_once l1'' l2'' x key i) # (aply_decFb_once l2'' l1'' y\n        key i)\n    l1''' = (splitBlock ct'').0\n    l2''' = (splitBlock ct'').1\nkatanDecrypt : ([KatanKeySize], [KatanBlock]) -> [KatanBlock]\nkatanDecrypt (key, pt) =\n  (hs ! 0).0 # (hs ! 0).1\n  where\n    hs =\n      [(l1, l2)] # [((decUpdateLfsr pT.0 pT.1 x y key i).0,\n      (decUpdateLfsr pT.0 pT.1 x y key i).1) | i <- [253, 252 .. 0]\n                                             | pT <- hs]\n    l1 = (splitBlock pt).0\n    l2 = (splitBlock pt).1\n\/* pragma katanCorrect : property *\/\nkatanCorrect key m =\n  katanEncrypt (key, katanDecrypt (key, m)) == m\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/073_decTanFa.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a function `decTanFa : [L1Size] -> [L2Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit` for the KATAN block cipher that computes the non-linear feedback bit using the given constants `Round = 8`, `xSize = 5`, `Nr = 254`, `L1Size = 25`, `L2Size = 39`, the tap positions `x = [24, 15, 20, 11, 9]`, the round-dependent input `iR : [1][Nr]` as specified, and the key index table `k_a_index` as given."},{"role":"assistant","content":"```cryptol\ntype Round = 8\ntype xSize = 5\ntype Nr = 254\ntype L1Size = 25\ntype L2Size = 39\nx = [24, 15, 20, 11, 9]\niR : [1][Nr]\niR =\n  [0b11111110001101010101111011001100101001000100011000111100001000010100000111110011111101010001010100110000110011101111101110100101011010011100110110001011101101111001011011010111001001001101000111000100111101000011101011000001011001000000110111000000010010]\nk_a_index =\n  [0x3f,\n  0x1f,\n  0x1f,\n  0x0f,\n  0x0e,\n  0x3c,\n  0x28,\n  0x31,\n  0x23,\n  0x36,\n  0x2d,\n  0x3a,\n  0x25,\n  0x4a,\n  0x45,\n  0x4a,\n  0x35,\n  0x2b,\n  0x47,\n  0x3f,\n  0x1e,\n  0x2d,\n  0x0b,\n  0x36,\n  0x1c,\n  0x29,\n  0x03,\n  0x26,\n  0x3c,\n  0x19,\n  0x22,\n  0x05,\n  0x1a,\n  0x14,\n  0x09,\n  0x02,\n  0x14,\n  0x18,\n  0x01,\n  0x02,\n  0x34,\n  0x18,\n  0x11,\n  0x03,\n  0x06,\n  0x4c,\n  0x48,\n  0x31,\n  0x13,\n  0x17,\n  0x0f,\n  0x0e,\n  0x0c,\n  0x18,\n  0x10,\n  0x01,\n  0x02,\n  0x04,\n  0x28,\n  0x30,\n  0x11,\n  0x12,\n  0x05,\n  0x0a,\n  0x04,\n  0x08,\n  0x40,\n  0x40,\n  0x41,\n  0x33,\n  0x17,\n  0x2f,\n  0x0f,\n  0x4e,\n  0x4c,\n  0x49,\n  0x43,\n  0x37,\n  0x2f,\n  0x3f,\n  0x2f,\n  0x3e,\n  0x1d,\n  0x1a,\n  0x05,\n  0x0a,\n  0x24,\n  0x38,\n  0x21,\n  0x32,\n  0x15,\n  0x2a,\n  0x05,\n  0x3a,\n  0x14,\n  0x19,\n  0x03,\n  0x06,\n  0x0c,\n  0x38,\n  0x10,\n  0x21,\n  0x03,\n  0x46,\n  0x3c,\n  0x29,\n  0x43,\n  0x47,\n  0x4e,\n  0x4d,\n  0x3b,\n  0x27,\n  0x4f,\n  0x4f,\n  0x3e,\n  0x2d,\n  0x3b,\n  0x17,\n  0x2e,\n  0x0d,\n  0x2a,\n  0x34,\n  0x29,\n  0x42,\n  0x35,\n  0x2a,\n  0x35,\n  0x1b,\n  0x26,\n  0x0d,\n  0x4a,\n  0x34,\n  0x19,\n  0x23,\n  0x07,\n  0x3e,\n  0x2c,\n  0x49,\n  0x33,\n  0x16,\n  0x1d,\n  0x0b,\n  0x06,\n  0x2c,\n  0x48,\n  0x41,\n  0x32,\n  0x25,\n  0x4b,\n  0x37,\n  0x2e,\n  0x4d,\n  0x4b,\n  0x46,\n  0x3d,\n  0x1b,\n  0x27,\n  0x0f,\n  0x2e,\n  0x4c,\n  0x39,\n  0x22,\n  0x45,\n  0x3b,\n  0x26,\n  0x3d,\n  0x2b,\n  0x46,\n  0x4d,\n  0x3a,\n  0x15,\n  0x2b,\n  0x07,\n  0x1e,\n  0x2c,\n  0x09,\n  0x12,\n  0x24,\n  0x09,\n  0x32,\n  0x24,\n  0x39,\n  0x13,\n  0x16,\n  0x0d,\n  0x0a,\n  0x44,\n  0x38,\n  0x11,\n  0x13,\n  0x07,\n  0x0e,\n  0x1c,\n  0x28,\n  0x01,\n  0x42,\n  0x44,\n  0x39,\n  0x23,\n  0x37,\n  0x1f,\n  0x1e,\n  0x0d,\n  0x0a,\n  0x04,\n  0x48,\n  0x30,\n  0x21,\n  0x33,\n  0x27,\n  0x4e,\n  0x3d,\n  0x1a,\n  0x15,\n  0x0b,\n  0x06,\n  0x0c,\n  0x08,\n  0x20,\n  0x40,\n  0x31,\n  0x12,\n  0x25,\n  0x0b,\n  0x16,\n  0x1c,\n  0x09,\n  0x02,\n  0x04,\n  0x08,\n  0x00,\n  0x30,\n  0x20,\n  0x41,\n  0x43,\n  0x36,\n  0x1d,\n  0x1b,\n  0x07,\n  0x0e,\n  0x0c,\n  0x08,\n  0x00,\n  0x00,\n  0x10,\n  0x20,\n  0x01,\n  0x22,\n  0x44,\n  0x49,\n  0x42,\n  0x45,\n  0x4b,\n  0x47]\ndecTanFa : [L1Size] ->\n  [L2Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\ndecTanFa L1 L2 x k i =\n  fa ^ (L1 ! ((x @ 1) + 1)) ^ (L1 ! ((x @ 2) + 1) && L1 ! ((x @ 3) + 1)) ^ (L1 ! ((x @ 4) + 1) && ((iR @ 0) @ i)) ^ k @ (k_a_index @ i)\n  where\n    fa = L2 ! 0\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/075_decTanFb.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `decTanFb : [L2Size] -> [L1Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit` for the KATAN block cipher that computes the feedback bit as `fb ^ (L2 ! ((y @ 1) + 1)) ^ ((L2 ! ((y @ 2) + 1)) && L2 ! ((y @ 3) + 1)) ^ ((L2 ! ((y @ 4) + 1)) && L2 ! ((y @ 5) + 1)) ^ k @ (k_b_index @ i)` with `fb = L1 ! 0`, using the given constants `Round = 8`, `ySize = 6`, `L1Size = 25`, `L2Size = 39`, `y = [38, 25, 33, 21, 14, 9]`, and the specified `k_b_index` table."},{"role":"assistant","content":"```cryptol\ntype Round = 8\ntype ySize = 6\ntype L1Size = 25\ntype L2Size = 39\ny = [38, 25, 33, 21, 14, 9]\nk_b_index =\n  [0x1f,\n  0x3f,\n  0x3f,\n  0x2f,\n  0x0e,\n  0x4c,\n  0x28,\n  0x11,\n  0x43,\n  0x16,\n  0x4d,\n  0x1a,\n  0x45,\n  0x0a,\n  0x45,\n  0x0a,\n  0x15,\n  0x2b,\n  0x07,\n  0x4f,\n  0x3e,\n  0x2d,\n  0x0b,\n  0x46,\n  0x3c,\n  0x29,\n  0x13,\n  0x46,\n  0x1c,\n  0x49,\n  0x22,\n  0x15,\n  0x4a,\n  0x34,\n  0x29,\n  0x12,\n  0x44,\n  0x38,\n  0x21,\n  0x02,\n  0x44,\n  0x38,\n  0x31,\n  0x23,\n  0x06,\n  0x4c,\n  0x08,\n  0x11,\n  0x33,\n  0x37,\n  0x3f,\n  0x2e,\n  0x1c,\n  0x48,\n  0x30,\n  0x31,\n  0x22,\n  0x14,\n  0x48,\n  0x10,\n  0x41,\n  0x32,\n  0x35,\n  0x3a,\n  0x24,\n  0x08,\n  0x40,\n  0x00,\n  0x01,\n  0x13,\n  0x37,\n  0x2f,\n  0x0f,\n  0x4e,\n  0x0c,\n  0x09,\n  0x03,\n  0x17,\n  0x2f,\n  0x1f,\n  0x4f,\n  0x1e,\n  0x4d,\n  0x3a,\n  0x25,\n  0x1a,\n  0x44,\n  0x18,\n  0x41,\n  0x12,\n  0x45,\n  0x2a,\n  0x05,\n  0x4a,\n  0x34,\n  0x39,\n  0x33,\n  0x26,\n  0x0c,\n  0x48,\n  0x30,\n  0x21,\n  0x03,\n  0x46,\n  0x1c,\n  0x29,\n  0x03,\n  0x47,\n  0x0e,\n  0x0d,\n  0x1b,\n  0x27,\n  0x0f,\n  0x4f,\n  0x1e,\n  0x2d,\n  0x1b,\n  0x47,\n  0x2e,\n  0x1d,\n  0x4a,\n  0x14,\n  0x49,\n  0x02,\n  0x45,\n  0x2a,\n  0x15,\n  0x4b,\n  0x26,\n  0x0d,\n  0x4a,\n  0x14,\n  0x39,\n  0x23,\n  0x07,\n  0x4e,\n  0x2c,\n  0x09,\n  0x43,\n  0x36,\n  0x3d,\n  0x2b,\n  0x16,\n  0x4c,\n  0x08,\n  0x41,\n  0x12,\n  0x25,\n  0x0b,\n  0x47,\n  0x2e,\n  0x0d,\n  0x4b,\n  0x06,\n  0x1d,\n  0x3b,\n  0x27,\n  0x1f,\n  0x4e,\n  0x0c,\n  0x49,\n  0x22,\n  0x05,\n  0x4b,\n  0x26,\n  0x1d,\n  0x4b,\n  0x06,\n  0x4d,\n  0x1a,\n  0x35,\n  0x2b,\n  0x17,\n  0x4e,\n  0x2c,\n  0x19,\n  0x42,\n  0x24,\n  0x09,\n  0x42,\n  0x24,\n  0x19,\n  0x43,\n  0x36,\n  0x2d,\n  0x0a,\n  0x44,\n  0x18,\n  0x31,\n  0x33,\n  0x27,\n  0x1e,\n  0x4c,\n  0x28,\n  0x01,\n  0x42,\n  0x04,\n  0x19,\n  0x23,\n  0x17,\n  0x4f,\n  0x3e,\n  0x3d,\n  0x2a,\n  0x04,\n  0x48,\n  0x10,\n  0x21,\n  0x13,\n  0x47,\n  0x0e,\n  0x4d,\n  0x3a,\n  0x35,\n  0x3b,\n  0x36,\n  0x2c,\n  0x18,\n  0x40,\n  0x00,\n  0x41,\n  0x32,\n  0x25,\n  0x1b,\n  0x46,\n  0x3c,\n  0x39,\n  0x32,\n  0x34,\n  0x28,\n  0x00,\n  0x40,\n  0x20,\n  0x01,\n  0x43,\n  0x16,\n  0x3d,\n  0x3b,\n  0x37,\n  0x3e,\n  0x3c,\n  0x38,\n  0x20,\n  0x10,\n  0x40,\n  0x20,\n  0x11,\n  0x42,\n  0x04,\n  0x49,\n  0x02,\n  0x05,\n  0x0b,\n  0x07]\ndecTanFb : [L2Size] ->\n  [L1Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\ndecTanFb L2 L1 y k i =\n  fb ^ (L2 ! ((y @ 1) + 1)) ^ ((L2 ! ((y @ 2) + 1)) && L2 ! ((y @ 3) + 1)) ^ ((L2 ! ((y @ 4) + 1)) && L2 ! ((y @ 5) + 1)) ^ k @ (k_b_index @ i)\n  where\n    fb = L1 ! 0\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/077_tanAplydecFa.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that specifies the KATAN-32 block cipher key schedule for an 80-bit key and implements the decTanFa and tanAplydecFa round-update functions for L1 and L2 state registers, given sizes L1Size = 25, L2Size = 39, xSize = 5, Nr = 254, and Round = 8, using the provided iR and k_a_index constants and returning the updated L1 state for a given round."},{"role":"assistant","content":"```cryptol\ntype KatanKeySize = 80\ntype Round = 8\ntype xSize = 5\ntype Nr = 254\ntype L1Size = 25\ntype L2Size = 39\nx = [24, 15, 20, 11, 9]\niR : [1][Nr]\niR =\n  [0b11111110001101010101111011001100101001000100011000111100001000010100000111110011111101010001010100110000110011101111101110100101011010011100110110001011101101111001011011010111001001001101000111000100111101000011101011000001011001000000110111000000010010]\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\nkeySchedule' : [80] -> [508]\nkeySchedule' key =\n  key13\n  where\n    key0 = kS100 (key, 80)\n    key1 = kS100 (key0, 180)\n    key2 = kS100 (key1, 280)\n    key3 = kS100 (key2, 380)\n    key4 = kS10 (key3, 480)\n    key5 = kS10 (key4, 490)\n    key6 = kS (key5, 500)\n    key7 = kS (key6, 501)\n    key8 = kS (key7, 502)\n    key9 = kS (key8, 503)\n    key10 = kS (key9, 504)\n    key11 = kS (key10, 505)\n    key12 = kS (key11, 506)\n    key13 = kS (key12, 507)\nk_a_index =\n  [0x3f,\n  0x1f,\n  0x1f,\n  0x0f,\n  0x0e,\n  0x3c,\n  0x28,\n  0x31,\n  0x23,\n  0x36,\n  0x2d,\n  0x3a,\n  0x25,\n  0x4a,\n  0x45,\n  0x4a,\n  0x35,\n  0x2b,\n  0x47,\n  0x3f,\n  0x1e,\n  0x2d,\n  0x0b,\n  0x36,\n  0x1c,\n  0x29,\n  0x03,\n  0x26,\n  0x3c,\n  0x19,\n  0x22,\n  0x05,\n  0x1a,\n  0x14,\n  0x09,\n  0x02,\n  0x14,\n  0x18,\n  0x01,\n  0x02,\n  0x34,\n  0x18,\n  0x11,\n  0x03,\n  0x06,\n  0x4c,\n  0x48,\n  0x31,\n  0x13,\n  0x17,\n  0x0f,\n  0x0e,\n  0x0c,\n  0x18,\n  0x10,\n  0x01,\n  0x02,\n  0x04,\n  0x28,\n  0x30,\n  0x11,\n  0x12,\n  0x05,\n  0x0a,\n  0x04,\n  0x08,\n  0x40,\n  0x40,\n  0x41,\n  0x33,\n  0x17,\n  0x2f,\n  0x0f,\n  0x4e,\n  0x4c,\n  0x49,\n  0x43,\n  0x37,\n  0x2f,\n  0x3f,\n  0x2f,\n  0x3e,\n  0x1d,\n  0x1a,\n  0x05,\n  0x0a,\n  0x24,\n  0x38,\n  0x21,\n  0x32,\n  0x15,\n  0x2a,\n  0x05,\n  0x3a,\n  0x14,\n  0x19,\n  0x03,\n  0x06,\n  0x0c,\n  0x38,\n  0x10,\n  0x21,\n  0x03,\n  0x46,\n  0x3c,\n  0x29,\n  0x43,\n  0x47,\n  0x4e,\n  0x4d,\n  0x3b,\n  0x27,\n  0x4f,\n  0x4f,\n  0x3e,\n  0x2d,\n  0x3b,\n  0x17,\n  0x2e,\n  0x0d,\n  0x2a,\n  0x34,\n  0x29,\n  0x42,\n  0x35,\n  0x2a,\n  0x35,\n  0x1b,\n  0x26,\n  0x0d,\n  0x4a,\n  0x34,\n  0x19,\n  0x23,\n  0x07,\n  0x3e,\n  0x2c,\n  0x49,\n  0x33,\n  0x16,\n  0x1d,\n  0x0b,\n  0x06,\n  0x2c,\n  0x48,\n  0x41,\n  0x32,\n  0x25,\n  0x4b,\n  0x37,\n  0x2e,\n  0x4d,\n  0x4b,\n  0x46,\n  0x3d,\n  0x1b,\n  0x27,\n  0x0f,\n  0x2e,\n  0x4c,\n  0x39,\n  0x22,\n  0x45,\n  0x3b,\n  0x26,\n  0x3d,\n  0x2b,\n  0x46,\n  0x4d,\n  0x3a,\n  0x15,\n  0x2b,\n  0x07,\n  0x1e,\n  0x2c,\n  0x09,\n  0x12,\n  0x24,\n  0x09,\n  0x32,\n  0x24,\n  0x39,\n  0x13,\n  0x16,\n  0x0d,\n  0x0a,\n  0x44,\n  0x38,\n  0x11,\n  0x13,\n  0x07,\n  0x0e,\n  0x1c,\n  0x28,\n  0x01,\n  0x42,\n  0x44,\n  0x39,\n  0x23,\n  0x37,\n  0x1f,\n  0x1e,\n  0x0d,\n  0x0a,\n  0x04,\n  0x48,\n  0x30,\n  0x21,\n  0x33,\n  0x27,\n  0x4e,\n  0x3d,\n  0x1a,\n  0x15,\n  0x0b,\n  0x06,\n  0x0c,\n  0x08,\n  0x20,\n  0x40,\n  0x31,\n  0x12,\n  0x25,\n  0x0b,\n  0x16,\n  0x1c,\n  0x09,\n  0x02,\n  0x04,\n  0x08,\n  0x00,\n  0x30,\n  0x20,\n  0x41,\n  0x43,\n  0x36,\n  0x1d,\n  0x1b,\n  0x07,\n  0x0e,\n  0x0c,\n  0x08,\n  0x00,\n  0x00,\n  0x10,\n  0x20,\n  0x01,\n  0x22,\n  0x44,\n  0x49,\n  0x42,\n  0x45,\n  0x4b,\n  0x47]\ndecTanFa : [L1Size] ->\n  [L2Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\ndecTanFa L1 L2 x k i =\n  fa ^ (L1 ! ((x @ 1) + 1)) ^ (L1 ! ((x @ 2) + 1) && L1 ! ((x @ 3) + 1)) ^ (L1 ! ((x @ 4) + 1) && ((iR @ 0) @ i)) ^ k @ (k_a_index @ i)\n  where\n    fa = L2 ! 0\ntanAplydecFa : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] -> [KatanKeySize] -> [Round] -> [L1Size]\ntanAplydecFa l1 l2 x k i =\n  [(decTanFa l1 l2 x (keySchedule' k) i)] # (l1 !! [(L1Size -\n  1), (L1Size - 2) .. 1])\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/079_tanAplydecFb.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for the KATAN-32 block cipher\u2019s 80-bit key schedule and the tanAplydecFb round-update function, with external-facing definitions `keySchedule' : [80] -> [508]`, `decTanFb : [39] -> [25] -> [6][6] -> [508] -> [8] -> Bit`, and `tanAplydecFb : [39] -> [25] -> [6][6] -> [80] -> [8] -> [39]`, using the given constant `k_b_index` and parameters `KatanKeySize = 80`, `Round = 8`, `ySize = 6`, `L1Size = 25`, and `L2Size = 39`."},{"role":"assistant","content":"```cryptol\ntype KatanKeySize = 80\ntype Round = 8\ntype ySize = 6\ntype L1Size = 25\ntype L2Size = 39\ny = [38, 25, 33, 21, 14, 9]\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\nkeySchedule' : [80] -> [508]\nkeySchedule' key =\n  key13\n  where\n    key0 = kS100 (key, 80)\n    key1 = kS100 (key0, 180)\n    key2 = kS100 (key1, 280)\n    key3 = kS100 (key2, 380)\n    key4 = kS10 (key3, 480)\n    key5 = kS10 (key4, 490)\n    key6 = kS (key5, 500)\n    key7 = kS (key6, 501)\n    key8 = kS (key7, 502)\n    key9 = kS (key8, 503)\n    key10 = kS (key9, 504)\n    key11 = kS (key10, 505)\n    key12 = kS (key11, 506)\n    key13 = kS (key12, 507)\nk_b_index =\n  [0x1f,\n  0x3f,\n  0x3f,\n  0x2f,\n  0x0e,\n  0x4c,\n  0x28,\n  0x11,\n  0x43,\n  0x16,\n  0x4d,\n  0x1a,\n  0x45,\n  0x0a,\n  0x45,\n  0x0a,\n  0x15,\n  0x2b,\n  0x07,\n  0x4f,\n  0x3e,\n  0x2d,\n  0x0b,\n  0x46,\n  0x3c,\n  0x29,\n  0x13,\n  0x46,\n  0x1c,\n  0x49,\n  0x22,\n  0x15,\n  0x4a,\n  0x34,\n  0x29,\n  0x12,\n  0x44,\n  0x38,\n  0x21,\n  0x02,\n  0x44,\n  0x38,\n  0x31,\n  0x23,\n  0x06,\n  0x4c,\n  0x08,\n  0x11,\n  0x33,\n  0x37,\n  0x3f,\n  0x2e,\n  0x1c,\n  0x48,\n  0x30,\n  0x31,\n  0x22,\n  0x14,\n  0x48,\n  0x10,\n  0x41,\n  0x32,\n  0x35,\n  0x3a,\n  0x24,\n  0x08,\n  0x40,\n  0x00,\n  0x01,\n  0x13,\n  0x37,\n  0x2f,\n  0x0f,\n  0x4e,\n  0x0c,\n  0x09,\n  0x03,\n  0x17,\n  0x2f,\n  0x1f,\n  0x4f,\n  0x1e,\n  0x4d,\n  0x3a,\n  0x25,\n  0x1a,\n  0x44,\n  0x18,\n  0x41,\n  0x12,\n  0x45,\n  0x2a,\n  0x05,\n  0x4a,\n  0x34,\n  0x39,\n  0x33,\n  0x26,\n  0x0c,\n  0x48,\n  0x30,\n  0x21,\n  0x03,\n  0x46,\n  0x1c,\n  0x29,\n  0x03,\n  0x47,\n  0x0e,\n  0x0d,\n  0x1b,\n  0x27,\n  0x0f,\n  0x4f,\n  0x1e,\n  0x2d,\n  0x1b,\n  0x47,\n  0x2e,\n  0x1d,\n  0x4a,\n  0x14,\n  0x49,\n  0x02,\n  0x45,\n  0x2a,\n  0x15,\n  0x4b,\n  0x26,\n  0x0d,\n  0x4a,\n  0x14,\n  0x39,\n  0x23,\n  0x07,\n  0x4e,\n  0x2c,\n  0x09,\n  0x43,\n  0x36,\n  0x3d,\n  0x2b,\n  0x16,\n  0x4c,\n  0x08,\n  0x41,\n  0x12,\n  0x25,\n  0x0b,\n  0x47,\n  0x2e,\n  0x0d,\n  0x4b,\n  0x06,\n  0x1d,\n  0x3b,\n  0x27,\n  0x1f,\n  0x4e,\n  0x0c,\n  0x49,\n  0x22,\n  0x05,\n  0x4b,\n  0x26,\n  0x1d,\n  0x4b,\n  0x06,\n  0x4d,\n  0x1a,\n  0x35,\n  0x2b,\n  0x17,\n  0x4e,\n  0x2c,\n  0x19,\n  0x42,\n  0x24,\n  0x09,\n  0x42,\n  0x24,\n  0x19,\n  0x43,\n  0x36,\n  0x2d,\n  0x0a,\n  0x44,\n  0x18,\n  0x31,\n  0x33,\n  0x27,\n  0x1e,\n  0x4c,\n  0x28,\n  0x01,\n  0x42,\n  0x04,\n  0x19,\n  0x23,\n  0x17,\n  0x4f,\n  0x3e,\n  0x3d,\n  0x2a,\n  0x04,\n  0x48,\n  0x10,\n  0x21,\n  0x13,\n  0x47,\n  0x0e,\n  0x4d,\n  0x3a,\n  0x35,\n  0x3b,\n  0x36,\n  0x2c,\n  0x18,\n  0x40,\n  0x00,\n  0x41,\n  0x32,\n  0x25,\n  0x1b,\n  0x46,\n  0x3c,\n  0x39,\n  0x32,\n  0x34,\n  0x28,\n  0x00,\n  0x40,\n  0x20,\n  0x01,\n  0x43,\n  0x16,\n  0x3d,\n  0x3b,\n  0x37,\n  0x3e,\n  0x3c,\n  0x38,\n  0x20,\n  0x10,\n  0x40,\n  0x20,\n  0x11,\n  0x42,\n  0x04,\n  0x49,\n  0x02,\n  0x05,\n  0x0b,\n  0x07]\ndecTanFb : [L2Size] ->\n  [L1Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\ndecTanFb L2 L1 y k i =\n  fb ^ (L2 ! ((y @ 1) + 1)) ^ ((L2 ! ((y @ 2) + 1)) && L2 ! ((y @ 3) + 1)) ^ ((L2 ! ((y @ 4) + 1)) && L2 ! ((y @ 5) + 1)) ^ k @ (k_b_index @ i)\n  where\n    fb = L1 ! 0\ntanAplydecFb : [L2Size] ->\n  [L1Size] ->\n  [ySize][ySize] -> [KatanKeySize] -> [Round] -> [L2Size]\ntanAplydecFb l2 l1 y k i =\n  [(decTanFb l2 l1 y (keySchedule' k) i)] # (l2 !! [(L2Size -\n  1), (L2Size - 2) .. 1])\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/KATAN\/085_katantanCorrect.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `katantanCorrect : [KatanKeySize] -> [KatanBlock] -> Bit` that states for all 80-bit keys and 64-bit messages, `katantanDecrypt (key, katantanEncrypt (key, m)) == m` for the given KATAN-64 block cipher with 254 rounds, key schedule `keySchedule'`, and the specified update, f-function, and index arrays."},{"role":"assistant","content":"```cryptol\ntype Katan64 = 64\ntype KatanBlock = Katan64\ntype KatanKeySize = 80\ntype Round = 8\ntype xSize = 5\ntype ySize = 6\ntype Nr = 254\ntype L1Size = 25\ntype L2Size = 39\nx = [24, 15, 20, 11, 9]\ny = [38, 25, 33, 21, 14, 9]\nsplitBlock : [KatanBlock] -> ([L1Size], [L2Size])\nsplitBlock pt =\n  (l1, l2)\n  where\n    l1 = take`{L1Size} pt\n    l2 = drop`{L1Size} pt\niR : [1][Nr]\niR =\n  [0b11111110001101010101111011001100101001000100011000111100001000010100000111110011111101010001010100110000110011101111101110100101011010011100110110001011101101111001011011010111001001001101000111000100111101000011101011000001011001000000110111000000010010]\nkS : {a} (fin a) => ([a], [12]) -> [a + 1]\nkS (key, i) =\n  key # [((key @ (i - 80)) ^ (key @ (i - 61)) ^ (key @ (i - 50)) ^ (key @ (i - 13)))]\nkS10 : {a} (fin a) => ([a], [12]) -> [a + 10]\nkS10 (key, i) =\n  key9\n  where\n    key0 = kS (key, i)\n    key1 = kS (key0, i + 1)\n    key2 = kS (key1, i + 2)\n    key3 = kS (key2, i + 3)\n    key4 = kS (key3, i + 4)\n    key5 = kS (key4, i + 5)\n    key6 = kS (key5, i + 6)\n    key7 = kS (key6, i + 7)\n    key8 = kS (key7, i + 8)\n    key9 = kS (key8, i + 9)\nkS100 : {a} (fin a) => ([a], [12]) -> [a + 100]\nkS100 (key, i) =\n  key9\n  where\n    key0 = kS10 (key, i)\n    key1 = kS10 (key0, i + 10)\n    key2 = kS10 (key1, i + 20)\n    key3 = kS10 (key2, i + 30)\n    key4 = kS10 (key3, i + 40)\n    key5 = kS10 (key4, i + 50)\n    key6 = kS10 (key5, i + 60)\n    key7 = kS10 (key6, i + 70)\n    key8 = kS10 (key7, i + 80)\n    key9 = kS10 (key8, i + 90)\nkeySchedule' : [80] -> [508]\nkeySchedule' key =\n  key13\n  where\n    key0 = kS100 (key, 80)\n    key1 = kS100 (key0, 180)\n    key2 = kS100 (key1, 280)\n    key3 = kS100 (key2, 380)\n    key4 = kS10 (key3, 480)\n    key5 = kS10 (key4, 490)\n    key6 = kS (key5, 500)\n    key7 = kS (key6, 501)\n    key8 = kS (key7, 502)\n    key9 = kS (key8, 503)\n    key10 = kS (key9, 504)\n    key11 = kS (key10, 505)\n    key12 = kS (key11, 506)\n    key13 = kS (key12, 507)\nk_a_index =\n  [0x3f,\n  0x1f,\n  0x1f,\n  0x0f,\n  0x0e,\n  0x3c,\n  0x28,\n  0x31,\n  0x23,\n  0x36,\n  0x2d,\n  0x3a,\n  0x25,\n  0x4a,\n  0x45,\n  0x4a,\n  0x35,\n  0x2b,\n  0x47,\n  0x3f,\n  0x1e,\n  0x2d,\n  0x0b,\n  0x36,\n  0x1c,\n  0x29,\n  0x03,\n  0x26,\n  0x3c,\n  0x19,\n  0x22,\n  0x05,\n  0x1a,\n  0x14,\n  0x09,\n  0x02,\n  0x14,\n  0x18,\n  0x01,\n  0x02,\n  0x34,\n  0x18,\n  0x11,\n  0x03,\n  0x06,\n  0x4c,\n  0x48,\n  0x31,\n  0x13,\n  0x17,\n  0x0f,\n  0x0e,\n  0x0c,\n  0x18,\n  0x10,\n  0x01,\n  0x02,\n  0x04,\n  0x28,\n  0x30,\n  0x11,\n  0x12,\n  0x05,\n  0x0a,\n  0x04,\n  0x08,\n  0x40,\n  0x40,\n  0x41,\n  0x33,\n  0x17,\n  0x2f,\n  0x0f,\n  0x4e,\n  0x4c,\n  0x49,\n  0x43,\n  0x37,\n  0x2f,\n  0x3f,\n  0x2f,\n  0x3e,\n  0x1d,\n  0x1a,\n  0x05,\n  0x0a,\n  0x24,\n  0x38,\n  0x21,\n  0x32,\n  0x15,\n  0x2a,\n  0x05,\n  0x3a,\n  0x14,\n  0x19,\n  0x03,\n  0x06,\n  0x0c,\n  0x38,\n  0x10,\n  0x21,\n  0x03,\n  0x46,\n  0x3c,\n  0x29,\n  0x43,\n  0x47,\n  0x4e,\n  0x4d,\n  0x3b,\n  0x27,\n  0x4f,\n  0x4f,\n  0x3e,\n  0x2d,\n  0x3b,\n  0x17,\n  0x2e,\n  0x0d,\n  0x2a,\n  0x34,\n  0x29,\n  0x42,\n  0x35,\n  0x2a,\n  0x35,\n  0x1b,\n  0x26,\n  0x0d,\n  0x4a,\n  0x34,\n  0x19,\n  0x23,\n  0x07,\n  0x3e,\n  0x2c,\n  0x49,\n  0x33,\n  0x16,\n  0x1d,\n  0x0b,\n  0x06,\n  0x2c,\n  0x48,\n  0x41,\n  0x32,\n  0x25,\n  0x4b,\n  0x37,\n  0x2e,\n  0x4d,\n  0x4b,\n  0x46,\n  0x3d,\n  0x1b,\n  0x27,\n  0x0f,\n  0x2e,\n  0x4c,\n  0x39,\n  0x22,\n  0x45,\n  0x3b,\n  0x26,\n  0x3d,\n  0x2b,\n  0x46,\n  0x4d,\n  0x3a,\n  0x15,\n  0x2b,\n  0x07,\n  0x1e,\n  0x2c,\n  0x09,\n  0x12,\n  0x24,\n  0x09,\n  0x32,\n  0x24,\n  0x39,\n  0x13,\n  0x16,\n  0x0d,\n  0x0a,\n  0x44,\n  0x38,\n  0x11,\n  0x13,\n  0x07,\n  0x0e,\n  0x1c,\n  0x28,\n  0x01,\n  0x42,\n  0x44,\n  0x39,\n  0x23,\n  0x37,\n  0x1f,\n  0x1e,\n  0x0d,\n  0x0a,\n  0x04,\n  0x48,\n  0x30,\n  0x21,\n  0x33,\n  0x27,\n  0x4e,\n  0x3d,\n  0x1a,\n  0x15,\n  0x0b,\n  0x06,\n  0x0c,\n  0x08,\n  0x20,\n  0x40,\n  0x31,\n  0x12,\n  0x25,\n  0x0b,\n  0x16,\n  0x1c,\n  0x09,\n  0x02,\n  0x04,\n  0x08,\n  0x00,\n  0x30,\n  0x20,\n  0x41,\n  0x43,\n  0x36,\n  0x1d,\n  0x1b,\n  0x07,\n  0x0e,\n  0x0c,\n  0x08,\n  0x00,\n  0x00,\n  0x10,\n  0x20,\n  0x01,\n  0x22,\n  0x44,\n  0x49,\n  0x42,\n  0x45,\n  0x4b,\n  0x47]\nk_b_index =\n  [0x1f,\n  0x3f,\n  0x3f,\n  0x2f,\n  0x0e,\n  0x4c,\n  0x28,\n  0x11,\n  0x43,\n  0x16,\n  0x4d,\n  0x1a,\n  0x45,\n  0x0a,\n  0x45,\n  0x0a,\n  0x15,\n  0x2b,\n  0x07,\n  0x4f,\n  0x3e,\n  0x2d,\n  0x0b,\n  0x46,\n  0x3c,\n  0x29,\n  0x13,\n  0x46,\n  0x1c,\n  0x49,\n  0x22,\n  0x15,\n  0x4a,\n  0x34,\n  0x29,\n  0x12,\n  0x44,\n  0x38,\n  0x21,\n  0x02,\n  0x44,\n  0x38,\n  0x31,\n  0x23,\n  0x06,\n  0x4c,\n  0x08,\n  0x11,\n  0x33,\n  0x37,\n  0x3f,\n  0x2e,\n  0x1c,\n  0x48,\n  0x30,\n  0x31,\n  0x22,\n  0x14,\n  0x48,\n  0x10,\n  0x41,\n  0x32,\n  0x35,\n  0x3a,\n  0x24,\n  0x08,\n  0x40,\n  0x00,\n  0x01,\n  0x13,\n  0x37,\n  0x2f,\n  0x0f,\n  0x4e,\n  0x0c,\n  0x09,\n  0x03,\n  0x17,\n  0x2f,\n  0x1f,\n  0x4f,\n  0x1e,\n  0x4d,\n  0x3a,\n  0x25,\n  0x1a,\n  0x44,\n  0x18,\n  0x41,\n  0x12,\n  0x45,\n  0x2a,\n  0x05,\n  0x4a,\n  0x34,\n  0x39,\n  0x33,\n  0x26,\n  0x0c,\n  0x48,\n  0x30,\n  0x21,\n  0x03,\n  0x46,\n  0x1c,\n  0x29,\n  0x03,\n  0x47,\n  0x0e,\n  0x0d,\n  0x1b,\n  0x27,\n  0x0f,\n  0x4f,\n  0x1e,\n  0x2d,\n  0x1b,\n  0x47,\n  0x2e,\n  0x1d,\n  0x4a,\n  0x14,\n  0x49,\n  0x02,\n  0x45,\n  0x2a,\n  0x15,\n  0x4b,\n  0x26,\n  0x0d,\n  0x4a,\n  0x14,\n  0x39,\n  0x23,\n  0x07,\n  0x4e,\n  0x2c,\n  0x09,\n  0x43,\n  0x36,\n  0x3d,\n  0x2b,\n  0x16,\n  0x4c,\n  0x08,\n  0x41,\n  0x12,\n  0x25,\n  0x0b,\n  0x47,\n  0x2e,\n  0x0d,\n  0x4b,\n  0x06,\n  0x1d,\n  0x3b,\n  0x27,\n  0x1f,\n  0x4e,\n  0x0c,\n  0x49,\n  0x22,\n  0x05,\n  0x4b,\n  0x26,\n  0x1d,\n  0x4b,\n  0x06,\n  0x4d,\n  0x1a,\n  0x35,\n  0x2b,\n  0x17,\n  0x4e,\n  0x2c,\n  0x19,\n  0x42,\n  0x24,\n  0x09,\n  0x42,\n  0x24,\n  0x19,\n  0x43,\n  0x36,\n  0x2d,\n  0x0a,\n  0x44,\n  0x18,\n  0x31,\n  0x33,\n  0x27,\n  0x1e,\n  0x4c,\n  0x28,\n  0x01,\n  0x42,\n  0x04,\n  0x19,\n  0x23,\n  0x17,\n  0x4f,\n  0x3e,\n  0x3d,\n  0x2a,\n  0x04,\n  0x48,\n  0x10,\n  0x21,\n  0x13,\n  0x47,\n  0x0e,\n  0x4d,\n  0x3a,\n  0x35,\n  0x3b,\n  0x36,\n  0x2c,\n  0x18,\n  0x40,\n  0x00,\n  0x41,\n  0x32,\n  0x25,\n  0x1b,\n  0x46,\n  0x3c,\n  0x39,\n  0x32,\n  0x34,\n  0x28,\n  0x00,\n  0x40,\n  0x20,\n  0x01,\n  0x43,\n  0x16,\n  0x3d,\n  0x3b,\n  0x37,\n  0x3e,\n  0x3c,\n  0x38,\n  0x20,\n  0x10,\n  0x40,\n  0x20,\n  0x11,\n  0x42,\n  0x04,\n  0x49,\n  0x02,\n  0x05,\n  0x0b,\n  0x07]\ntanFa : [L1Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\ntanFa L1 x k i =\n  (L1 ! (x @ 0)) ^ (L1 ! (x @ 1)) ^ ((L1 ! (x @ 2)) && (L1 ! (x @ 3))) ^ ((L1 ! (x @ 4)) && ((iR @ 0) @ i)) ^ (k @ (k_a_index @ i))\ntanFb : [L2Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\ntanFb L2 y k i =\n  (L2 ! (y @ 0)) ^ (L2 ! (y @ 1)) ^ (L2 ! (y @ 2) && L2 ! (y @ 3)) ^ (L2 ! (y @ 4) && L2 ! (y @ 5)) ^ (k @ (k_b_index @ i))\ntanAplyFb : [L1Size] ->\n  [L2Size] ->\n  [ySize][ySize] -> [KatanKeySize] -> [Round] -> [L1Size]\ntanAplyFb l1 l2 y key i =\n  (l1 !! [(L1Size - 2), (L1Size - 3) .. 0]) # [(tanFb l2 y\n    (keySchedule' key) i)]\ntanAplyFa : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] -> [KatanKeySize] -> [Round] -> [L2Size]\ntanAplyFa l1 l2 x key i =\n  (l2 !! [(L2Size - 2), (L2Size - 3) .. 0]) # [(tanFa l1 x\n    (keySchedule' key) i)]\nupdateLfsrTan : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] ->\n  [ySize][ySize] ->\n  [KatanKeySize] -> [Round] -> ([L1Size], [L2Size])\nupdateLfsrTan l1 l2 x y key i =\n  if `L1Size == 13\n  then (l1', l2')\n  else if `L1Size == 19 then (l1'', l2'') else (l1''', l2''')\n  where\n    pt = (tanAplyFb l1 l2 y key i) # (tanAplyFa l1 l2 x key i)\n    l1' = (splitBlock pt).0\n    l2' = (splitBlock pt).1\n    pt' = (tanAplyFb l1' l2' y key i) # (tanAplyFa l1' l2' x key i)\n    l1'' = (splitBlock pt').0\n    l2'' = (splitBlock pt').1\n    pt'' =\n      (tanAplyFb l1'' l2'' y key i) # (tanAplyFa l1'' l2'' x key i)\n    l1''' = (splitBlock pt'').0\n    l2''' = (splitBlock pt'').1\nkatantanEncrypt : ([KatanKeySize], [KatanBlock]) -> [KatanBlock]\nkatantanEncrypt (key, pt) =\n  (hs ! 0).0 # (hs ! 0).1\n  where\n    hs =\n      [(l1, l2)] # [((updateLfsrTan pT.0 pT.1 x y key i).0,\n      (updateLfsrTan pT.0 pT.1 x y key i).1) | i <- [0, 1 .. 253]\n                                             | pT <- hs]\n    l1 = (splitBlock pt).0\n    l2 = (splitBlock pt).1\ndecTanFa : [L1Size] ->\n  [L2Size] -> [xSize][xSize] -> [508] -> [Round] -> Bit\ndecTanFa L1 L2 x k i =\n  fa ^ (L1 ! ((x @ 1) + 1)) ^ (L1 ! ((x @ 2) + 1) && L1 ! ((x @ 3) + 1)) ^ (L1 ! ((x @ 4) + 1) && ((iR @ 0) @ i)) ^ k @ (k_a_index @ i)\n  where\n    fa = L2 ! 0\ndecTanFb : [L2Size] ->\n  [L1Size] -> [ySize][ySize] -> [508] -> [Round] -> Bit\ndecTanFb L2 L1 y k i =\n  fb ^ (L2 ! ((y @ 1) + 1)) ^ ((L2 ! ((y @ 2) + 1)) && L2 ! ((y @ 3) + 1)) ^ ((L2 ! ((y @ 4) + 1)) && L2 ! ((y @ 5) + 1)) ^ k @ (k_b_index @ i)\n  where\n    fb = L1 ! 0\ntanAplydecFa : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] -> [KatanKeySize] -> [Round] -> [L1Size]\ntanAplydecFa l1 l2 x k i =\n  [(decTanFa l1 l2 x (keySchedule' k) i)] # (l1 !! [(L1Size -\n  1), (L1Size - 2) .. 1])\ntanAplydecFb : [L2Size] ->\n  [L1Size] ->\n  [ySize][ySize] -> [KatanKeySize] -> [Round] -> [L2Size]\ntanAplydecFb l2 l1 y k i =\n  [(decTanFb l2 l1 y (keySchedule' k) i)] # (l2 !! [(L2Size -\n  1), (L2Size - 2) .. 1])\ndecUpdateLfsrTan : [L1Size] ->\n  [L2Size] ->\n  [xSize][xSize] ->\n  [ySize][ySize] ->\n  [KatanKeySize] -> [Round] -> ([L1Size], [L2Size])\ndecUpdateLfsrTan l1 l2 x y key i =\n  if `L1Size == 13\n  then (l1', l2')\n  else if `L1Size == 19 then (l1'', l2'') else (l1''', l2''')\n  where\n    ct = (tanAplydecFa l1 l2 x key i) # (tanAplydecFb l2 l1 y key i)\n    l1' = (splitBlock ct).0\n    l2' = (splitBlock ct).1\n    ct' =\n      (tanAplydecFa l1' l2' x key i) # (tanAplydecFb l2' l1' y key i)\n    l1'' = (splitBlock ct').0\n    l2'' = (splitBlock ct').1\n    ct'' =\n      (tanAplydecFa l1'' l2'' x key i) # (tanAplydecFb l2'' l1'' y key\n        i)\n    l1''' = (splitBlock ct'').0\n    l2''' = (splitBlock ct'').1\nkatantanDecrypt : ([KatanKeySize], [KatanBlock]) -> [KatanBlock]\nkatantanDecrypt (key, pt) =\n  (hs ! 0).0 # (hs ! 0).1\n  where\n    hs =\n      [(l1, l2)] # [((decUpdateLfsrTan pT.0 pT.1 x y key i).0,\n      (decUpdateLfsrTan pT.0 pT.1 x y key i).1) | i <- [253, 252 .. 0]\n                                                | pT <- hs]\n    l1 = (splitBlock pt).0\n    l2 = (splitBlock pt).1\n\/* pragma katantanCorrect : property *\/\nkatantanCorrect key m =\n  katantanDecrypt (key, katantanEncrypt (key, m)) == m\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/002_tcId1001.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1001` that checks the AES-256 Key Wrap with Padding AE instantiation `KWP_AE` maps the given 256-bit key, 8-bit plaintext `0x8d`, and expected ciphertext `0x35a739a8a322805b94deb3cb1a56a008` such that `check_KWP_AE key pt expected_ct = (KWP_AE key pt == expected_ct)` holds and evaluates to `True`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1001 : property *\/\ntcId1001 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x39fa276b26b762599aa1070192987d0cf8184ddb1c98eea23f06ff81b63481e0\n    pt = 0x8d\n    ct = 0x35a739a8a322805b94deb3cb1a56a008\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/003_tcId1002.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1002` that verifies the AES-256 Key Wrap with Padding authenticated encryption function `KWP_AE` maps the given 256-bit key and plaintext `0xc5` to the expected ciphertext `0x9581cb7e06c38d57c5262a7bd4bd8840`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and asserting `testPassed == check_KWP_AE key pt ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1002 : property *\/\ntcId1002 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xf80e0bdd0d1b3407f241522045574e3c80ca99d3a6854706047942eb694cdbf3\n    pt = 0xc5\n    ct = 0x9581cb7e06c38d57c5262a7bd4bd8840\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/004_tcId1003.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1003` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation against the given known-answer test vector, using key `0xc93821958b2a3ac969ffca59ef5623e609f38585a6c9a9ade41d546578de141d`, plaintext `0x1e`, and expected ciphertext `0xdd6dc03e825f2e77480f998902fa6be8`, such that `tcId1003` holds iff `KWP_AE key pt` equals the expected ciphertext."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1003 : property *\/\ntcId1003 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xc93821958b2a3ac969ffca59ef5623e609f38585a6c9a9ade41d546578de141d\n    pt = 0x1e\n    ct = 0xdd6dc03e825f2e77480f998902fa6be8\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/005_tcId1004.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1004` that checks the AES-256 Key Wrap with Padding with Authenticated Encryption (`KWP_AE`) instantiation returns ciphertext `0x56f07fa0f5512b159f5e70a50c442b0b` for key `0xf6c4018216bc7eab22d57893be5e9e3a2a7189813e37d26bfd8a866bade775f8` and plaintext `0xe3`, using the helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1004 : property *\/\ntcId1004 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xf6c4018216bc7eab22d57893be5e9e3a2a7189813e37d26bfd8a866bade775f8\n    pt = 0xe3\n    ct = 0x56f07fa0f5512b159f5e70a50c442b0b\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/006_tcId1005.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation produces ciphertext 0x686de8abffbedf79aafd4432ecd4cf50 when encrypting plaintext 0x3f under key 0xdc426450a27ccad9b7890661b13480d2225918aac7c03829512492865763abdc, analogous to property tcId1005."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1005 : property *\/\ntcId1005 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xdc426450a27ccad9b7890661b13480d2225918aac7c03829512492865763abdc\n    pt = 0x3f\n    ct = 0x686de8abffbedf79aafd4432ecd4cf50\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/007_tcId1006.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a property `tcId1006` that checks the AES-256 Key Wrap with Padding authenticated-encryption instantiation `KWP_AE` maps the given 256-bit key and 8-bit plaintext `0xda` to the expected 128-bit ciphertext `0xe4b9bc2ce14293eaf05955a42627269d`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1006 : property *\/\ntcId1006 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x44f2de705c848a3448ff6ffcbd221c0dc2119351d384ce21d5ac2606fe21b6f8\n    pt = 0xda\n    ct = 0xe4b9bc2ce14293eaf05955a42627269d\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/008_tcId1007.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1007` that verifies the AES256 Key Wrap with Padding and Alternative Endianness (`KWP_AE`) instantiation encrypts the 1-byte plaintext `0x1e` under the 256-bit key `0xc933e2e4ee7d519fa406aa70eac833ccd50fbb044427b1d25624254a555edc43` to the expected ciphertext `0x901b3ce56e12f8c188039535eba61996`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1007 : property *\/\ntcId1007 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xc933e2e4ee7d519fa406aa70eac833ccd50fbb044427b1d25624254a555edc43\n    pt = 0x1e\n    ct = 0x901b3ce56e12f8c188039535eba61996\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/009_tcId1008.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1008` that verifies the AES-256 Key Wrap With Padding and AE variant (`KWP_AE`) encrypts the 1-byte plaintext `0x15` under key `0x6e0627242e7c51b204db46a58d6a411b96514555cf8c21dd8b2dc37cda95f9cd` to the expected ciphertext `0x2ad76f428813b950d099c10105a29fb5`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1008 : property *\/\ntcId1008 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x6e0627242e7c51b204db46a58d6a411b96514555cf8c21dd8b2dc37cda95f9cd\n    pt = 0x15\n    ct = 0x2ad76f428813b950d099c10105a29fb5\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/010_tcId1009.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a property `tcId1009` that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation encrypts the 1-byte plaintext `0x02` under the 256-bit key `0x1fd3508e9533ec697e4b8f59fffe4b98857919a4def918426d068f70f3b2948e` to the 64-bit ciphertext `0x530967e906fd940c887a6ad9f37ac42d`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1009 : property *\/\ntcId1009 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x1fd3508e9533ec697e4b8f59fffe4b98857919a4def918426d068f70f3b2948e\n    pt = 0x02\n    ct = 0x530967e906fd940c887a6ad9f37ac42d\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/011_tcId1010.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property tcId1010 that verifies the AES-256 Key Wrap with Padding authenticated-encryption instantiation KWP_AE correctly maps the given 256-bit key and plaintext 0x94 to the expected ciphertext 0xefc758a879a703d39b7b85f7bb7b2d44, using a helper function check_KWP_AE key pt expected_ct = (KWP_AE key pt == expected_ct)."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1010 : property *\/\ntcId1010 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x85bfd16f7b562ad251329106a3d7a184c5c96cce489b2dd797a084a72404376d\n    pt = 0x94\n    ct = 0xefc758a879a703d39b7b85f7bb7b2d44\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/012_tcId1011.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1011` that checks the AES-256 Key Wrap with Padding AE instantiation `KWP_AE` encrypts the 0x86 plaintext under the key 0xddd6fab4c49dd7ff2985ae928bd5ea87cc70a31163074f1fb1bc02f7f969d418 to the expected ciphertext 0xbd96d9c865a87be05a306ab3d6bba3a5, using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1011 : property *\/\ntcId1011 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xddd6fab4c49dd7ff2985ae928bd5ea87cc70a31163074f1fb1bc02f7f969d418\n    pt = 0x86\n    ct = 0xbd96d9c865a87be05a306ab3d6bba3a5\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/013_tcId1012.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property tcId1012 that checks AES-256 Key Wrap with Padding (KWP_AE) produces the expected ciphertext for the given key 0xda37f25b6ebe88c9db9e03a5e126d5ae55f632b1686115c956228326a0dbc789 and plaintext 0xa9, verifying that KWP_AE key pt == 0xac58cfa83697e911cd09bea23ca4cd45."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1012 : property *\/\ntcId1012 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xda37f25b6ebe88c9db9e03a5e126d5ae55f632b1686115c956228326a0dbc789\n    pt = 0xa9\n    ct = 0xac58cfa83697e911cd09bea23ca4cd45\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/014_tcId1013.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property tcId1013 that verifies the AES-256 Key Wrap with Padding (AES256_KeyWrap.KWP_AE) encrypts the 8-bit plaintext 0x1d under the 256-bit key 0x1bb566fe462a27901d86eef8558f53e505e47d81a66f2918aade08ea347201b3 to the 64-bit ciphertext 0x8a51e6b709cb04f59981f7ffdb783d0b, using a helper function check_KWP_AE key pt expected_ct = (KWP_AE key pt == expected_ct)."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1013 : property *\/\ntcId1013 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x1bb566fe462a27901d86eef8558f53e505e47d81a66f2918aade08ea347201b3\n    pt = 0x1d\n    ct = 0x8a51e6b709cb04f59981f7ffdb783d0b\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/015_tcId1014.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1014` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation `KWP_AE` encrypts the 8-byte key `0x73b2ab98ddc2a3557ac51c1976d43f2997d4305d6c1d8de38b393161de44a1ba` and plaintext `0x54` to the expected ciphertext `0x281900a08220b5f74cf06d739f7c5dc6`, returning `True` when `KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1014 : property *\/\ntcId1014 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x73b2ab98ddc2a3557ac51c1976d43f2997d4305d6c1d8de38b393161de44a1ba\n    pt = 0x54\n    ct = 0x281900a08220b5f74cf06d739f7c5dc6\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/016_tcId1015.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property `tcId1015` that checks the AES-256 Key Wrap with Padding and Alternative Endianness (`KWP_AE`) instantiation, verifying that wrapping the plaintext value `0xe2` with the 256-bit key `0xcacf12ae11477b1254437ca92d329f1c7ee6b2c022e4f12c3eac649621ab0137` produces the ciphertext `0x6dcc8657ec2a2443dd056ef73dbbfb7b`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1015 : property *\/\ntcId1015 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xcacf12ae11477b1254437ca92d329f1c7ee6b2c022e4f12c3eac649621ab0137\n    pt = 0xe2\n    ct = 0x6dcc8657ec2a2443dd056ef73dbbfb7b\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/017_tcId1016.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1016` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation, verifying that `KWP_AE key pt` equals the expected ciphertext `ct` for key `0x3e7517ae08da6b2b027ac829d0d96fb0d2b27c611d217174fff385eea51abc9f`, plaintext `0x7e`, and ciphertext `0x542a995d5beb0fef0ca3b56db914e0df`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1016 : property *\/\ntcId1016 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x3e7517ae08da6b2b027ac829d0d96fb0d2b27c611d217174fff385eea51abc9f\n    pt = 0x7e\n    ct = 0x542a995d5beb0fef0ca3b56db914e0df\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/018_tcId1017.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1017` that checks the AES-256 Key Wrap with Padding authenticated encryption instantiation `KWP_AE` maps the 256-bit key `0x636062eaf492c67b4e98dc4653031942ce29fb1b81462a31fca2a40df760ed1f` and plaintext `0x9c` to the expected ciphertext `0x9f24ed46467485d4ed54d232e50e8885`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1017 : property *\/\ntcId1017 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x636062eaf492c67b4e98dc4653031942ce29fb1b81462a31fca2a40df760ed1f\n    pt = 0x9c\n    ct = 0x9f24ed46467485d4ed54d232e50e8885\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/019_tcId1018.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a property `tcId1018` that checks the AES-256 Key Wrap with padding encrypt function `KWP_AE` maps the 256-bit key `0x86cf07cc35a7624129a9390b14ee6fa8b8d7a9f613050e7ce3e3af3cad54abb3` and plaintext `0x75` to the expected ciphertext `0x76a00b69214577bad18ccdc983c8bafd`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1018 : property *\/\ntcId1018 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x86cf07cc35a7624129a9390b14ee6fa8b8d7a9f613050e7ce3e3af3cad54abb3\n    pt = 0x75\n    ct = 0x76a00b69214577bad18ccdc983c8bafd\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/020_tcId1019.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the property `tcId1019` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation `KWP_AE` satisfies `KWP_AE key pt == ct` for the given test vector key = 0xc4c825e849ae1c195748979d8821711590403e3ac47984c526df896d120e7396, pt = 0x9e, and ct = 0x5808672a0f4eedd81328d99819993eb7, returning `True` when the test passes."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1019 : property *\/\ntcId1019 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xc4c825e849ae1c195748979d8821711590403e3ac47984c526df896d120e7396\n    pt = 0x9e\n    ct = 0x5808672a0f4eedd81328d99819993eb7\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/021_tcId1020.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1020` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation produces ciphertext `0xda9785c2adc2ce92eff5e3523d469235` when encrypting plaintext `0xc9` with key `0xff84bc98909d273b28f0ac9d0c44386533bfe6a0586294d57df370ffeccddb3f`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1020 : property *\/\ntcId1020 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xff84bc98909d273b28f0ac9d0c44386533bfe6a0586294d57df370ffeccddb3f\n    pt = 0xc9\n    ct = 0xda9785c2adc2ce92eff5e3523d469235\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/022_tcId1021.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a property `tcId1021` that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation encrypts the 8-bit plaintext `0xf0` under the 256-bit key `0x8670fb10b54781839b56c7a14c660412fe2e48f3655acc55553b794d9ffa32b7` to the 72-bit ciphertext `0x8850ef6cb7396e775d4f330c6e01edce`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1021 : property *\/\ntcId1021 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x8670fb10b54781839b56c7a14c660412fe2e48f3655acc55553b794d9ffa32b7\n    pt = 0xf0\n    ct = 0x8850ef6cb7396e775d4f330c6e01edce\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/023_tcId1022.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1022` that verifies AES-256 Key Wrap with padding (KWP_AE) produces the expected ciphertext for the given key and 0x19 plaintext, using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and asserting `testPassed == check_KWP_AE key pt ct` where `testPassed = True`, `key = 0x211a909a1c1b0f56bebbf3362dc2cd75ab14bb2cb4eb191557b5abac7ef9e4e4`, `pt = 0x19`, and `ct = 0xc76400b498aeb0023e266aff9ee30fe8`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1022 : property *\/\ntcId1022 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x211a909a1c1b0f56bebbf3362dc2cd75ab14bb2cb4eb191557b5abac7ef9e4e4\n    pt = 0x19\n    ct = 0xc76400b498aeb0023e266aff9ee30fe8\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/024_tcId1023.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1023` that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation `KWP_AE` encrypts the plaintext `0xc0` under the key `0xb77eba3e4e1fd9d5989a233e66bfc9cbb8cf245c9dcf7c59af1d5fdd4811d76a` to the expected ciphertext `0xc8869a194252053d69cb3700b519b400` using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1023 : property *\/\ntcId1023 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xb77eba3e4e1fd9d5989a233e66bfc9cbb8cf245c9dcf7c59af1d5fdd4811d76a\n    pt = 0xc0\n    ct = 0xc8869a194252053d69cb3700b519b400\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/025_tcId1024.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1024` that verifies the AES-256 Key Wrap with Padding authenticated-encryption instantiation `KWP_AE` maps the given key `0x96a325d96df23193f21c409b20b83b157e4bc00e7b872a96d57ea7791575b797` and plaintext `0x60` to the expected ciphertext `0x9c5c1dcbfe8cea38ded462dc2268d090`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1024 : property *\/\ntcId1024 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x96a325d96df23193f21c409b20b83b157e4bc00e7b872a96d57ea7791575b797\n    pt = 0x60\n    ct = 0x9c5c1dcbfe8cea38ded462dc2268d090\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/026_tcId1025.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property tcId1025 that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation, using key 0x67ba246d02cbbbedde0b24c8dd8ee9ecf80dc34ecf0a211b1967bc141265f099 and plaintext 0x00, produces the expected ciphertext 0x38ae876f1e45933c75d8b57531b59075 by checking that check_KWP_AE key pt ct evaluates to True."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1025 : property *\/\ntcId1025 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x67ba246d02cbbbedde0b24c8dd8ee9ecf80dc34ecf0a211b1967bc141265f099\n    pt = 0x00\n    ct = 0x38ae876f1e45933c75d8b57531b59075\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/027_tcId1026.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1026` that verifies the AES256 Key Wrap Padded with AE (`KWP_AE`) instantiation encrypts the 0xc2 plaintext under key 0x81c3403f359326663b025c16865e245808c4848a54011f6b88385a1a64fbecbc to the ciphertext 0x8c0dec2fd4b6ab0231ec56bd50852d84, using a helper function `check_KWP_AE` that checks `KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1026 : property *\/\ntcId1026 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x81c3403f359326663b025c16865e245808c4848a54011f6b88385a1a64fbecbc\n    pt = 0xc2\n    ct = 0x8c0dec2fd4b6ab0231ec56bd50852d84\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/028_tcId1027.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the property `tcId1027` that verifies the AES-256 Key Wrap with Padding authenticated-encryption instantiation `KWP_AE` maps the given 256-bit key and 8-bit plaintext `0x1d` to the expected ciphertext `0x48d46e384ae3aa2bdcec10399a82be37`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1027 : property *\/\ntcId1027 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x428666365ffae2b604a71e3ea61d1ab85cfcdedef5d40cfe8e53fdb96ac27630\n    pt = 0x1d\n    ct = 0x48d46e384ae3aa2bdcec10399a82be37\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/029_tcId1028.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1028` that checks the AES-256 Key Wrap with padding authenticated-encryption instantiation `KWP_AE` maps the 8-bit plaintext `0x91` under the key `0x859857f302d7b4becf1220b55857a1df064355ab306e9e9c3fec3dc86fafcc3a` to the expected ciphertext `0x7e0cf4c530ed36b947ca4c5d7de0097a`, using a helper predicate `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1028 : property *\/\ntcId1028 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x859857f302d7b4becf1220b55857a1df064355ab306e9e9c3fec3dc86fafcc3a\n    pt = 0x91\n    ct = 0x7e0cf4c530ed36b947ca4c5d7de0097a\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/030_tcId1029.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property tcId1029 that checks the AES256_KeyWrap padded authenticated-encryption instantiation KWP_AE maps the 256-bit key 0xfc304be2eba8e1cd41680f2228e150718d829821f99994ac44d59c7494bdb6a8 and plaintext 0xc2 to the expected ciphertext 0xf125384dee677c7923697f5a3bfc6184, using check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct and asserting testPassed == check_KWP_AE key pt ct."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1029 : property *\/\ntcId1029 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xfc304be2eba8e1cd41680f2228e150718d829821f99994ac44d59c7494bdb6a8\n    pt = 0xc2\n    ct = 0xf125384dee677c7923697f5a3bfc6184\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/031_tcId1030.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1030` that checks the AES-256 Key Wrap with padding algorithm `KWP_AE` (imported from `Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap`) correctly maps the given key and plaintext `0x3d` to the expected ciphertext `0x8435a5cb88740badec2c57fe0bba0da8`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and setting `testPassed = True`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1030 : property *\/\ntcId1030 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x5d124c781d08a9a1ef74b9bfc5b92c093f47b6c20e566b12ecbc361813688f01\n    pt = 0x3d\n    ct = 0x8435a5cb88740badec2c57fe0bba0da8\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/032_tcId1031.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1031` that checks the AES-256 Key Wrap with Padding (KWP_AE) implementation `KWP_AE` maps the given 256-bit key and plaintext 0x19 to ciphertext 0xf3e526b2d27dcae85e3b603219079b17, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1031 : property *\/\ntcId1031 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xaa5ab62d3df457e141f244ecb7a1b02b7c849535f6114ee43fe5474fa7934d3e\n    pt = 0x19\n    ct = 0xf3e526b2d27dcae85e3b603219079b17\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/033_tcId1032.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1032` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation encrypts the 8-bit plaintext `0x7f` under the 256-bit key `0x5b2b4903c7f4febfe9600d357c043e891bc2659aa21694810ad9df8de2c5d87b` to the expected ciphertext `0x9ae5b26b28514b2e02866f655689d8a2`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1032 : property *\/\ntcId1032 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x5b2b4903c7f4febfe9600d357c043e891bc2659aa21694810ad9df8de2c5d87b\n    pt = 0x7f\n    ct = 0x9ae5b26b28514b2e02866f655689d8a2\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/034_tcId1033.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1033` that verifies the AES-256 Key Wrap with padding encrypt function `KWP_AE` maps the given 256-bit key, plaintext `0x5e`, and expected ciphertext `0x2e94cb8dffcda2399bc422b24928a91a`, using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and asserting `testPassed == check_KWP_AE key pt ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1033 : property *\/\ntcId1033 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x5b7572593c032234a0047a9d2a92e9f7323226fd9879b8f8bf73631c16560922\n    pt = 0x5e\n    ct = 0x2e94cb8dffcda2399bc422b24928a91a\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/035_tcId1034.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1034` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation by asserting `KWP_AE key pt` equals the expected ciphertext `ct` for key `0x68380612eb8e22dc776e8d05be01b619d0c1cb99ebc7947c8444cb26feac0e91`, plaintext `0xbb`, and ciphertext `0xaa6abd32ea59851afe3ad836727e5dc6`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1034 : property *\/\ntcId1034 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x68380612eb8e22dc776e8d05be01b619d0c1cb99ebc7947c8444cb26feac0e91\n    pt = 0xbb\n    ct = 0xaa6abd32ea59851afe3ad836727e5dc6\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/036_tcId1035.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1035` that verifies the AES-256 Key Wrap with Padding authenticated-encryption instantiation `KWP_AE` produces ciphertext `0xc3dc9ea6773ba6b254156bca2d6ccdc4` for key `0xed0580c7dab265d63dccfeb165778ba3adcc9c92d807b0da7d08f05a2d1e0ef1` and plaintext `0xab`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1035 : property *\/\ntcId1035 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xed0580c7dab265d63dccfeb165778ba3adcc9c92d807b0da7d08f05a2d1e0ef1\n    pt = 0xab\n    ct = 0xc3dc9ea6773ba6b254156bca2d6ccdc4\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/037_tcId1036.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `check_KWP_AE : [256] -> [8] -> [128] -> Bit` for AES-256 Key Wrap with Padding authenticated encryption, and the property `tcId1036` that asserts `check_KWP_AE key pt ct` holds for the fixed test vector key `0x512e2d54d84820280efec1286247d6a17dc5a23f33fc1c32d5a023d38ee43b8e`, plaintext `0xf5`, and ciphertext `0x4e50faef7fedf00a97744d1e50180d29`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1036 : property *\/\ntcId1036 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x512e2d54d84820280efec1286247d6a17dc5a23f33fc1c32d5a023d38ee43b8e\n    pt = 0xf5\n    ct = 0x4e50faef7fedf00a97744d1e50180d29\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/038_tcId1037.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1037` that checks the AES-256 Key Wrap with padding encrypt function `KWP_AE` maps the 1-byte plaintext `0x9c` under the 256-bit key `0xcddd9a61ee554e27e75d9d2a6905763363abfda1a2e0d1351cfac3b870e72ab7` to the ciphertext `0x13865e5da697b608016326560370fc34`, using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1037 : property *\/\ntcId1037 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xcddd9a61ee554e27e75d9d2a6905763363abfda1a2e0d1351cfac3b870e72ab7\n    pt = 0x9c\n    ct = 0x13865e5da697b608016326560370fc34\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/039_tcId1038.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1038` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation by verifying that `KWP_AE key pt` equals the expected ciphertext `ct` for the given 256-bit key `0xbcda299791df47efefa436000a4234f9f1ddb2959f7f5cecd7d114da1555df39`, plaintext `0x23`, and ciphertext `0x957a898cf5ca014fa0bc445fa0411b8e`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1038 : property *\/\ntcId1038 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xbcda299791df47efefa436000a4234f9f1ddb2959f7f5cecd7d114da1555df39\n    pt = 0x23\n    ct = 0x957a898cf5ca014fa0bc445fa0411b8e\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/040_tcId1039.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1039` that checks the AES-256 Key Wrap with padding (KWP_AE) instantiation `KWP_AE` encrypts the 1-byte plaintext `0x27` under the 256-bit key `0x14ac4e2d21736edcc6d423e3af1e2bc4e8115a9c190afd7c5a764cb7fdefe222` to the ciphertext `0x47f8738ae025cb323aa904bb8fc94d5a`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1039 : property *\/\ntcId1039 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x14ac4e2d21736edcc6d423e3af1e2bc4e8115a9c190afd7c5a764cb7fdefe222\n    pt = 0x27\n    ct = 0x47f8738ae025cb323aa904bb8fc94d5a\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/041_tcId1040.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a property tcId1040 that verifies the AES256 key wrap with padding (KWP_AE) instantiation encrypts the 8-bit plaintext 0xa4 under the 256-bit key 0xd780739a8a8f203e593dfa988c4beddad17ec65e32ff9420e8b7b094ad3504ce to the 32-bit ciphertext 0x0aca7980aa5d91e7cf8a7ff32acfb820, using a helper function check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1040 : property *\/\ntcId1040 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xd780739a8a8f203e593dfa988c4beddad17ec65e32ff9420e8b7b094ad3504ce\n    pt = 0xa4\n    ct = 0x0aca7980aa5d91e7cf8a7ff32acfb820\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/042_tcId1041.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property `tcId1041` that verifies the AES-256 Key Wrap with padding authenticated encryption instantiation `KWP_AE` produces ciphertext `0x4bef98a1a912c5ccfb44398501393a5b` when applied to key `0xfe9e71ce3f0372783d47d1219919a9176dbba7e1e7bb0e6bd94599da51f616ea` and plaintext `0x18`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1041 : property *\/\ntcId1041 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xfe9e71ce3f0372783d47d1219919a9176dbba7e1e7bb0e6bd94599da51f616ea\n    pt = 0x18\n    ct = 0x4bef98a1a912c5ccfb44398501393a5b\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/043_tcId1042.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1042` that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation encrypts the 1-byte plaintext `0x87` under the given 256-bit key to the expected ciphertext `0x1622f42c6eb932c9c3ba6ee528f5ee2e`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1042 : property *\/\ntcId1042 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xd067989158b5c486d6cb2317dc4a1f174eda232a5d0572313666b602f80faa82\n    pt = 0x87\n    ct = 0x1622f42c6eb932c9c3ba6ee528f5ee2e\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/044_tcId1043.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1043` that verifies the AES-256 Key Wrap with Padding encrypt (`KWP_AE`) of the 256-bit key `0xf08ead0cdbbcc69ef06549faed6989e5177678a31cde24081e962c06f80dfff1` over the 8-bit plaintext `0xb6` equals the 128-bit expected ciphertext `0xa164fe1aac233a7b292190106242bc35`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1043 : property *\/\ntcId1043 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xf08ead0cdbbcc69ef06549faed6989e5177678a31cde24081e962c06f80dfff1\n    pt = 0xb6\n    ct = 0xa164fe1aac233a7b292190106242bc35\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/045_tcId1044.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1044` that checks the AES-256 Key Wrap with Padding (AES256_KeyWrapPadded_AE) instantiation by asserting that `KWP_AE key pt` equals the expected ciphertext `ct` for the given 256-bit key `0x6ffa0b069567d8b8cf189e1e651126e16432f4b1df14d28c7930f167d90e71dc`, plaintext `0xbc`, and ciphertext `0x81af399406890408830494067b975dc3`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1044 : property *\/\ntcId1044 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x6ffa0b069567d8b8cf189e1e651126e16432f4b1df14d28c7930f167d90e71dc\n    pt = 0xbc\n    ct = 0x81af399406890408830494067b975dc3\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/046_tcId1045.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1045` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation by asserting that `KWP_AE key pt` equals the expected ciphertext `ct` for the given 256-bit key `0xf0d9a00431bfc37776632dce8392fb668738b8e7e87b32fe6970aede141dbb12`, plaintext `0x15`, and ciphertext `0x21a2e83460738d67e274de0231f5db08`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1045 : property *\/\ntcId1045 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xf0d9a00431bfc37776632dce8392fb668738b8e7e87b32fe6970aede141dbb12\n    pt = 0x15\n    ct = 0x21a2e83460738d67e274de0231f5db08\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/047_tcId1046.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1046` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation using key `0x8758e274d03de0037eb638671bf7a5762262cd81fa4710612f0f8c00dd544fd2`, plaintext `0x10`, and expected ciphertext `0xb58ef1c43ef4fb8d25c53d673c074a9f`, by asserting that `KWP_AE key pt == expected_ct` evaluates to `True`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1046 : property *\/\ntcId1046 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x8758e274d03de0037eb638671bf7a5762262cd81fa4710612f0f8c00dd544fd2\n    pt = 0x10\n    ct = 0xb58ef1c43ef4fb8d25c53d673c074a9f\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/048_tcId1047.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1047` that checks the AES-256 Key Wrap with padding and AE variant (`KWP_AE`) encrypts the 8-bit plaintext `0xae` under the 256-bit key `0x611cb910e6f3554891709be3269311caeea4167646770c93b1eb24150b08e7ff` to the expected 64-bit ciphertext `0xc4d38071b0325a7dbae7b8c97e140567`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1047 : property *\/\ntcId1047 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x611cb910e6f3554891709be3269311caeea4167646770c93b1eb24150b08e7ff\n    pt = 0xae\n    ct = 0xc4d38071b0325a7dbae7b8c97e140567\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/049_tcId1048.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1048` that verifies the AES-256 Key Wrap with Padding encryption function `KWP_AE` maps the given key and plaintext `0x8a` to the expected ciphertext `0x291c122b76ff48eb7a9b1a25c20ff3e9`, using the helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and constant key `0x595d643fee1b9da657e5e0dd89bea95fba9d60a9f569e5bd2263ecda865b6397`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1048 : property *\/\ntcId1048 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x595d643fee1b9da657e5e0dd89bea95fba9d60a9f569e5bd2263ecda865b6397\n    pt = 0x8a\n    ct = 0x291c122b76ff48eb7a9b1a25c20ff3e9\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/050_tcId1049.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the property tcId1049 asserting that AES256_KeyWrap padded authenticated-encryption (KWP_AE) applied to the given 256-bit key 0xf66827a982352fb10d7bd294a6da6661b9593e850d9aee8c7e2c2f0662b66609 and plaintext 0x1a produces the expected ciphertext 0x8320e7cde94090ddb0afa279f71cf86c, using a helper function check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1049 : property *\/\ntcId1049 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xf66827a982352fb10d7bd294a6da6661b9593e850d9aee8c7e2c2f0662b66609\n    pt = 0x1a\n    ct = 0x8320e7cde94090ddb0afa279f71cf86c\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/051_tcId1050.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation `KWP_AE : [256] -> [8] -> [72]` encrypts the 8-bit plaintext `0x62` under the 256-bit key `0x927b27d5b50ba9d198e9eecd1317fd659a80f9e061a2703e797b61d420c7164d` to the 72-bit ciphertext `0xef84de1f6c508958f7adc6d11c606db8`, and that this test property holds."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1050 : property *\/\ntcId1050 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x927b27d5b50ba9d198e9eecd1317fd659a80f9e061a2703e797b61d420c7164d\n    pt = 0x62\n    ct = 0xef84de1f6c508958f7adc6d11c606db8\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/052_tcId1051.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property `tcId1051` that verifies the AES-256 Key Wrap with padding (KWP_AE) instantiation encrypts the 8-bit plaintext `0x10` under the 256-bit key `0xf416a4c6552b4e2e2d5f88c6af5494c4ea1d04bb22a377c0806611418475f1f8` to the 128-bit ciphertext `0x562adb01ea14439ce1d8a6fba46515f4`, using a helper function `check_KWP_AE : [256] -> [8] -> [128] -> Bit` that compares `KWP_AE key pt` to an expected ciphertext."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1051 : property *\/\ntcId1051 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xf416a4c6552b4e2e2d5f88c6af5494c4ea1d04bb22a377c0806611418475f1f8\n    pt = 0x10\n    ct = 0x562adb01ea14439ce1d8a6fba46515f4\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/053_tcId1052.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1052` that checks the AES-256 Key Wrap with Padding encrypt function `KWP_AE` (imported from `Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap`) maps the 320-bit key `0x42ee175cb7a7f28620500ae8856c7cde3c4052fba5abf91c9e91e20857af5066` and plaintext `0x29` to the expected ciphertext `0xb5465699dd3dc2969dcf8b1da3c0dfcc`, using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and asserting `testPassed == check_KWP_AE key pt ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1052 : property *\/\ntcId1052 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x42ee175cb7a7f28620500ae8856c7cde3c4052fba5abf91c9e91e20857af5066\n    pt = 0x29\n    ct = 0xb5465699dd3dc2969dcf8b1da3c0dfcc\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/054_tcId1053.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1053` that checks the AES-256 Key Wrap with Padding authenticated encryption instantiation `KWP_AE` maps the given 256-bit key `0xd9c652fa5e6a16e51dc513b53afbc7e6624b8c3e4e3c58cd223320228eee5dfd` and plaintext `0x55` to the expected ciphertext `0x0ad61a07db5ec915c16f1a320bf0eaed`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1053 : property *\/\ntcId1053 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xd9c652fa5e6a16e51dc513b53afbc7e6624b8c3e4e3c58cd223320228eee5dfd\n    pt = 0x55\n    ct = 0x0ad61a07db5ec915c16f1a320bf0eaed\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/055_tcId1054.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property tcId1054 that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation encrypts the 8-bit plaintext 0xa4 under the 256-bit key 0x070fdee3c8e60c382e9efb3e61ad9b84620f2513f25de9a535c344774f14bbc0 to the 128-bit ciphertext 0x906b0fa922e825b9375863fca511b446, using a helper function check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct and asserting testPassed == check_KWP_AE key pt ct."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1054 : property *\/\ntcId1054 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x070fdee3c8e60c382e9efb3e61ad9b84620f2513f25de9a535c344774f14bbc0\n    pt = 0xa4\n    ct = 0x906b0fa922e825b9375863fca511b446\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/056_tcId1055.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `check_KWP_AE : [256] -> [8] -> [32] -> Bit` for AES-256 Key Wrap with Padding (AES256_KeyWrapPadded_AE) and the property `tcId1055` that asserts `check_KWP_AE key pt ct` evaluates to `True` for the specific 256-bit key, 8-bit plaintext, and 32-bit ciphertext constants given in the test vector (tcId1055)."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1055 : property *\/\ntcId1055 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x965b12ba6f405a1c99a702ac08084090fd80854bf5c09d00d1cbf8020e1fc853\n    pt = 0xee\n    ct = 0x338c2d6ef2a4f0215f32117a6999e2fe\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/057_tcId1056.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the property `tcId1056` that verifies the AES-256 Key Wrap with Padding encrypt function `KWP_AE` maps the given 256-bit key and plaintext `0x51` to the expected ciphertext `0xfe89db7ab88a6a50dbc7b4bbfd7c7d19`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1056 : property *\/\ntcId1056 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x16e8974b487171a030ab25fe03e5789772a2a91e4fbbefa62a2c3957ac69dac3\n    pt = 0x51\n    ct = 0xfe89db7ab88a6a50dbc7b4bbfd7c7d19\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/058_tcId1057.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1057` that checks the AES-256 Key Wrap with padding authenticated encryption (`KWP_AE`) instantiation using the given 256-bit key, 8-bit plaintext `0xfd`, and expected ciphertext `0xbc7ed8e326f929cd1cf2939519972db5`, such that `tcId1057` holds exactly when `KWP_AE key pt` equals `ct` and `testPassed` is `True`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1057 : property *\/\ntcId1057 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x9a729225a773f82968d4e4a61f67f7fefa1c1eb951506220d2b44fb4ef06c54a\n    pt = 0xfd\n    ct = 0xbc7ed8e326f929cd1cf2939519972db5\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/059_tcId1058.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1058` that checks the AES-256 Key Wrap with Padding encrypt function `KWP_AE` maps the 256-bit key `0x41472533f605b84462ad4c8fd062fc9b24b9ee7eba935d0eca424d2ab503def8` and plaintext `0xf9` to the expected ciphertext `0x32746f33ec7a049b4a3c48bd0ed21ce8`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1058 : property *\/\ntcId1058 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x41472533f605b84462ad4c8fd062fc9b24b9ee7eba935d0eca424d2ab503def8\n    pt = 0xf9\n    ct = 0x32746f33ec7a049b4a3c48bd0ed21ce8\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/060_tcId1059.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1059` that checks the AES-256 Key Wrap with Padding authenticated-encryption instantiation `KWP_AE` maps the given 256-bit key and plaintext `0x29` to the expected ciphertext `0xf34cacf3816972c90a4af0e67e7aed85`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1059 : property *\/\ntcId1059 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x80f14dd8f5f9ef689a6840363ad88f58de0edcdb74700ba33a7dd923fdcb5dad\n    pt = 0x29\n    ct = 0xf34cacf3816972c90a4af0e67e7aed85\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/061_tcId1060.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1060` that checks the AES-256 Key Wrap with Padding authenticated encryption instantiation `KWP_AE` maps the 8-bit plaintext `0xd7` under the 256-bit key `0xbd62f4f0449f892825008928d877a7543fadfad05d3877033ffbd343eb83e622` to the 72-bit ciphertext `0x54f7ef87c184a81009ebf9bf6688cd7c`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1060 : property *\/\ntcId1060 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xbd62f4f0449f892825008928d877a7543fadfad05d3877033ffbd343eb83e622\n    pt = 0xd7\n    ct = 0x54f7ef87c184a81009ebf9bf6688cd7c\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/062_tcId1061.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a property `tcId1061` that verifies AES-256 Key Wrap with padding in AE mode (`KWP_AE`) wraps the 1-byte plaintext `0xd2` under the 256-bit key `0x44d2b78f5fd38a5f681da45f2fd177afc122b7e780bb516af29d928f3a17daf5` to the expected ciphertext `0x286f752b981ce6847661e0dcdd4d5f49`, using a helper predicate `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1061 : property *\/\ntcId1061 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x44d2b78f5fd38a5f681da45f2fd177afc122b7e780bb516af29d928f3a17daf5\n    pt = 0xd2\n    ct = 0x286f752b981ce6847661e0dcdd4d5f49\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/063_tcId1062.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1062` that verifies the AES-256 Key Wrap with padding encryption function `KWP_AE` maps the 8-bit plaintext `0xef` under the 256-bit key `0x19556188e0349531f56d4144dad2e5e0f6ffd349e017efd31a05db09291ed515` to the 128-bit ciphertext `0xe6dfa16f00fa7241f84e614649045b40`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1062 : property *\/\ntcId1062 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x19556188e0349531f56d4144dad2e5e0f6ffd349e017efd31a05db09291ed515\n    pt = 0xef\n    ct = 0xe6dfa16f00fa7241f84e614649045b40\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/064_tcId1063.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property tcId1063 that checks the AES-256 Key Wrap with Padding authenticated encryption instantiation KWP_AE maps the key 0xc2df0f8ec128ac630349fa9e452a2a8a10b500e00b9524e146518780ee62b117 and plaintext 0x81 to the expected ciphertext 0xdf68cb42ed2761d74bebce73e590a4df, using check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct and asserting testPassed == check_KWP_AE key pt ct."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1063 : property *\/\ntcId1063 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xc2df0f8ec128ac630349fa9e452a2a8a10b500e00b9524e146518780ee62b117\n    pt = 0x81\n    ct = 0xdf68cb42ed2761d74bebce73e590a4df\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/065_tcId1064.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1064` that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation maps the given 256-bit key and plaintext value `0x2d` to the expected ciphertext `0x52d5a548c2e4d287dcaafe03e016ad79`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1064 : property *\/\ntcId1064 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x4e88503c08ad7ef21832b200f39489d3c5457cdb45912daa380a6df414b125c8\n    pt = 0x2d\n    ct = 0x52d5a548c2e4d287dcaafe03e016ad79\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/066_tcId1065.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1065` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation `KWP_AE` correctly encrypts the 1-byte plaintext 0x42 under the 256-bit key 0xa45afb02bf762298f315e033b04325127e9dc8f237261ddb114d384b44571929 to the ciphertext 0xcd487595dfe7f933fef5b10587ac8981, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1065 : property *\/\ntcId1065 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xa45afb02bf762298f315e033b04325127e9dc8f237261ddb114d384b44571929\n    pt = 0x42\n    ct = 0xcd487595dfe7f933fef5b10587ac8981\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/067_tcId1066.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1066` that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation encrypts the 1-byte plaintext `0x77` under the key `0x7fb2623ebf05dbaebd5122920e97dfff06f57c838da933538c97fad59e25eb8a` to the expected ciphertext `0x8a5f782fbed1132d0636f53a51cdbf79` using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1066 : property *\/\ntcId1066 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x7fb2623ebf05dbaebd5122920e97dfff06f57c838da933538c97fad59e25eb8a\n    pt = 0x77\n    ct = 0x8a5f782fbed1132d0636f53a51cdbf79\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/068_tcId1067.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1067` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation using key `0x150f4fb634bac25de6992583f54dd734173e93ab43f63594832d9287778ad0ee`, plaintext `0x7a`, and expected ciphertext `0x799c8243ef5ef87891e005b506bf2f64`, by asserting that `KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1067 : property *\/\ntcId1067 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x150f4fb634bac25de6992583f54dd734173e93ab43f63594832d9287778ad0ee\n    pt = 0x7a\n    ct = 0x799c8243ef5ef87891e005b506bf2f64\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/069_tcId1068.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1068` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation encrypts the 0x4d plaintext under key 0x5b6cf52b74c43964097b6e38d37e01d673fb71f23c3329581f6409d8ed32a16e to the expected ciphertext 0xf293ce2d1f9c6725e1f9f107421ac396, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1068 : property *\/\ntcId1068 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x5b6cf52b74c43964097b6e38d37e01d673fb71f23c3329581f6409d8ed32a16e\n    pt = 0x4d\n    ct = 0xf293ce2d1f9c6725e1f9f107421ac396\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/070_tcId1069.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property tcId1069 that verifies the AES256_KeyWrap padded authenticated-encryption function KWP_AE, instantiated from Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap, maps the 8-bit plaintext 0xe0 under the 256-bit key 0x2644ccf9d7c419a437c954c8141cbb2d60f57de10a5393554a14ccc72229e286 to the ciphertext 0xda510b1d9a10255380655980a3a73536, using a helper predicate check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct and asserting testPassed == check_KWP_AE key pt ct."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1069 : property *\/\ntcId1069 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x2644ccf9d7c419a437c954c8141cbb2d60f57de10a5393554a14ccc72229e286\n    pt = 0xe0\n    ct = 0xda510b1d9a10255380655980a3a73536\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/071_tcId1070.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1070` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation `KWP_AE` maps the given 256-bit key, plaintext `0x11`, to the expected ciphertext `0x19b164efc41f5fff402a1097cd89259c` (i.e., `KWP_AE key pt == ct`) and that this test passes."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1070 : property *\/\ntcId1070 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x5a2bf1a5098964eec4d82f7e7c2d5723a5777f202e5cf729b506a5dc9775f1de\n    pt = 0x11\n    ct = 0x19b164efc41f5fff402a1097cd89259c\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/072_tcId1071.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1071` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation encrypts the 8-bit plaintext `0x71` under the 256-bit key `0x9b35b7f2ab8eeba30101bc8d0bf94b09c8ea02114ed9912f7659967dc3c7d841` to the expected ciphertext `0xc788ab3ce96444554bba805a1e3a8f91`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1071 : property *\/\ntcId1071 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x9b35b7f2ab8eeba30101bc8d0bf94b09c8ea02114ed9912f7659967dc3c7d841\n    pt = 0x71\n    ct = 0xc788ab3ce96444554bba805a1e3a8f91\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/073_tcId1072.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1072` that checks the AES-256 Key Wrap with Padding authenticated-encryption instantiation `KWP_AE` maps the given key `0x5b7783ad07911fc6d685e60fcb1213edff5dcd7eac1d73da2685585ae4c39177` and plaintext `0x3e` to the expected ciphertext `0x0ea7ab3b26cda9612a508ef9b41db7c8`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1072 : property *\/\ntcId1072 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x5b7783ad07911fc6d685e60fcb1213edff5dcd7eac1d73da2685585ae4c39177\n    pt = 0x3e\n    ct = 0x0ea7ab3b26cda9612a508ef9b41db7c8\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/074_tcId1073.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a property `tcId1073` that verifies the AES-256 Key Wrap with Padding encrypt function `KWP_AE` maps the given 256-bit key and plaintext block `0xc1` to the expected ciphertext `0x2c713f375fdd12469e753c68baeac6d4`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and a `testPassed` flag set to `True`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1073 : property *\/\ntcId1073 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xfb56787ec73a1eed0c9061d023a305ac301e2455e349b2e573f2afe326709add\n    pt = 0xc1\n    ct = 0x2c713f375fdd12469e753c68baeac6d4\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/075_tcId1074.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a property `tcId1074` that checks the AES-256 Key Wrap with padding algorithm (`KWP_AE`) produces the expected ciphertext `0x24b65c239b23d8c8f44ec2721ed03b15` when encrypting the plaintext `0x73` under the key `0x1ac45d1db5e960decd86aea2507f1cd51eac9bd3ea8b6093d4a795efca7187b0`, by comparing `KWP_AE key pt` to the expected ciphertext and requiring the result to be `True`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1074 : property *\/\ntcId1074 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x1ac45d1db5e960decd86aea2507f1cd51eac9bd3ea8b6093d4a795efca7187b0\n    pt = 0x73\n    ct = 0x24b65c239b23d8c8f44ec2721ed03b15\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/076_tcId1075.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property tcId1075 that verifies the AES-256 Key Wrap with padding and AE conventions (KWP_AE) produces the expected ciphertext 0x708d55d92db692a62cba3ca4d009c8ce for key 0xde8a1521277486d6fcda3a24031dee8647344f88a051a4da7f452a7036daa8c0 and plaintext 0x5e, using a helper function check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1075 : property *\/\ntcId1075 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xde8a1521277486d6fcda3a24031dee8647344f88a051a4da7f452a7036daa8c0\n    pt = 0x5e\n    ct = 0x708d55d92db692a62cba3ca4d009c8ce\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/077_tcId1076.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1076` that checks the AES-256 Key Wrap with Padding (KWP_AE) mode, verifying that wrapping the plaintext `0xd3` under the key `0xa66e6da21d52fc24733c303a121ad10626a5194884054cf8b73e7a71aa49380b` produces the ciphertext `0x7ad507b5fa5cd4a98c797a8dd824923f` using the helper function `check_KWP_AE` from `AES256_KeyWrap`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1076 : property *\/\ntcId1076 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xa66e6da21d52fc24733c303a121ad10626a5194884054cf8b73e7a71aa49380b\n    pt = 0xd3\n    ct = 0x7ad507b5fa5cd4a98c797a8dd824923f\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/078_tcId1077.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol property tcId1077 that checks the AES-256 Key Wrap with padding and AE variant (KWP_AE) produces ciphertext 0xf02a71952c7f74d6f509d0da905b5e44 when encrypting plaintext 0x02 under key 0xcc3710fd1c78a8b019ae0e8608e5c60f614d1f043196a3d87a67074a267b5542, using a helper function check_KWP_AE key pt expected_ct = (KWP_AE key pt == expected_ct)."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1077 : property *\/\ntcId1077 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xcc3710fd1c78a8b019ae0e8608e5c60f614d1f043196a3d87a67074a267b5542\n    pt = 0x02\n    ct = 0xf02a71952c7f74d6f509d0da905b5e44\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/079_tcId1078.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a property `tcId1078` that checks AES-256 Key Wrap with padding in AE mode (`KWP_AE`) encrypts the 8-bit plaintext `0x74` under the 256-bit key `0x371eeff5acec4e980ca59e9d91bebf9b1b8013b3340bc45d624f0aa0943118da` to the 72-bit ciphertext `0x7bd179c985a426cd4ff9bfbef858436e` by asserting `KWP_AE key pt == ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1078 : property *\/\ntcId1078 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x371eeff5acec4e980ca59e9d91bebf9b1b8013b3340bc45d624f0aa0943118da\n    pt = 0x74\n    ct = 0x7bd179c985a426cd4ff9bfbef858436e\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/080_tcId1079.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property tcId1079 that checks the AES256_KeyWrap padded authenticated-encryption mode (KWP_AE) maps the given 256-bit key and 1-byte plaintext 0x7f to the expected ciphertext 0xff0061fc09d685215c4b22be822405fd, using check_KWP_AE key pt expected_ct = (KWP_AE key pt == expected_ct) and asserting tcId1079 = (True == check_KWP_AE key pt ct)."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1079 : property *\/\ntcId1079 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x54d9324535dac6090439406626141312cb4a61adc61189947d5572fbd326cb57\n    pt = 0x7f\n    ct = 0xff0061fc09d685215c4b22be822405fd\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/081_tcId1080.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1080` that checks, for AES-256 Key Wrap with padding in AE mode, that encrypting the plaintext `0x06` under the key `0x3ea9325069ed93a96c331bdd6dd766ec64bbba83a72c69ed75df55043fb0bfd1` with `KWP_AE` produces the expected ciphertext `0x40a9c42012ba38211b800e6e313b6876`, using the helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1080 : property *\/\ntcId1080 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x3ea9325069ed93a96c331bdd6dd766ec64bbba83a72c69ed75df55043fb0bfd1\n    pt = 0x06\n    ct = 0x40a9c42012ba38211b800e6e313b6876\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/082_tcId1081.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property that checks AES-256 Key Wrap with padding (KWP_AE) maps the 1-byte plaintext 0x06 under the 256-bit key 0x2c0cd8480e0768fb9e33a9929f3991a0de0b0ac1f35d0cb7e58757a9d28d49d4 to the expected ciphertext 0xcadad5cfd536f7ba6897ef398483f38f, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1081 : property *\/\ntcId1081 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x2c0cd8480e0768fb9e33a9929f3991a0de0b0ac1f35d0cb7e58757a9d28d49d4\n    pt = 0x06\n    ct = 0xcadad5cfd536f7ba6897ef398483f38f\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/083_tcId1082.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1082` that verifies the AES-256 Key Wrap with Padding (AES256_KeyWrapPadded_AE) instantiation produces ciphertext `0x85427703fbc3be25be88765dc8791554` for key `0x2bb319f216dbba31eb4bb3265ff85d13abd8b12083dc0cd48c40372c946f70d5` and plaintext `0xe5`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1082 : property *\/\ntcId1082 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x2bb319f216dbba31eb4bb3265ff85d13abd8b12083dc0cd48c40372c946f70d5\n    pt = 0xe5\n    ct = 0x85427703fbc3be25be88765dc8791554\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/084_tcId1083.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1083` that checks the AES-256 Key Wrap with padding (function `KWP_AE`) produces the expected ciphertext for the given 256-bit key, 8-bit plaintext, and 72-bit ciphertext, using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and asserting `testPassed == check_KWP_AE key pt ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1083 : property *\/\ntcId1083 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xd393149c58fdb23c4abdf43ee03d603deb1fd06cd625f821ff93b27376458c9e\n    pt = 0x1b\n    ct = 0x3d737a3a014abdda0be2696c8097ee95\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/085_tcId1084.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1084` that checks the AES-256 Key Wrap with padding algorithm `KWP_AE` maps the key `0x03353deab5d9cd40338e8ecc8d810de4e29b6d34cf158f68db5ae356a4225266` and plaintext `0x8d` to the expected ciphertext `0x9313d7d59e08024181c2146f9123a78f`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1084 : property *\/\ntcId1084 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x03353deab5d9cd40338e8ecc8d810de4e29b6d34cf158f68db5ae356a4225266\n    pt = 0x8d\n    ct = 0x9313d7d59e08024181c2146f9123a78f\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/086_tcId1085.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1085` that verifies the AES-256 Key Wrap with Padding (KWP_AE) implementation encrypts the 8-bit plaintext `0xfc` under the 256-bit key `0x0cfd3a3b0540e5b3f044eb60050feafc80bac758db99016f79f0f5bf80307779` to the 128-bit ciphertext `0x02ec669fb26bdcdcc398545d7bdbdec7` using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1085 : property *\/\ntcId1085 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x0cfd3a3b0540e5b3f044eb60050feafc80bac758db99016f79f0f5bf80307779\n    pt = 0xfc\n    ct = 0x02ec669fb26bdcdcc398545d7bdbdec7\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/087_tcId1086.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In the existing AES256_KeyWrapPadded authenticated-encryption test suite, define the Cryptol property `tcId1086` (marked with pragma `tcId1086 : property`) asserting that `check_KWP_AE key pt ct` holds, where `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and the constants are `key = 0x4cbc12cee939c4f915dae23a4b6f30b8b45734686067b27bf592bcf929c7e75e`, `pt = 0x34`, and `ct = 0x5965d7f3ee0a4940badddffa05a30bf4`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1086 : property *\/\ntcId1086 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x4cbc12cee939c4f915dae23a4b6f30b8b45734686067b27bf592bcf929c7e75e\n    pt = 0x34\n    ct = 0x5965d7f3ee0a4940badddffa05a30bf4\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/088_tcId1087.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1087` that checks AES-256 Key Wrap with Padding (KWP_AE) using the imported `KWP_AE` function, verifying that wrapping the 1-byte plaintext `0x2a` with the 256-bit key `0x1bad340abb934070c9b7662815bb7baa652a056ccf246a375b6d959add5d7dec` yields the ciphertext `0xeed916d3195f9c39406802285ca665d3` via a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1087 : property *\/\ntcId1087 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x1bad340abb934070c9b7662815bb7baa652a056ccf246a375b6d959add5d7dec\n    pt = 0x2a\n    ct = 0xeed916d3195f9c39406802285ca665d3\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/089_tcId1088.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a property `tcId1088` that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation produces ciphertext 0xfe2a001cb35f00eaf85614ec594e2d9f when encrypting the 0x8a plaintext under the key 0xb0d6764b9b604a44d6a201a07e1f3cfcd0da1a322daa1251efa19c12a8488d0e, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1088 : property *\/\ntcId1088 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xb0d6764b9b604a44d6a201a07e1f3cfcd0da1a322daa1251efa19c12a8488d0e\n    pt = 0x8a\n    ct = 0xfe2a001cb35f00eaf85614ec594e2d9f\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/090_tcId1089.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1089` that checks the AES-256 Key Wrap with padding encrypt function `KWP_AE` maps the given 256-bit key and 8-bit plaintext `0xb0` to the expected ciphertext `0x4ae1cf2a3bbd5bc2573d8a13212e445a`, using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and `testPassed == check_KWP_AE key pt ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1089 : property *\/\ntcId1089 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x59bb9a295c7263842521d5f1edd2db92d9f09a607f758e2e3ef8ca6137616c93\n    pt = 0xb0\n    ct = 0x4ae1cf2a3bbd5bc2573d8a13212e445a\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/091_tcId1090.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1090` that verifies the AES-256 Key Wrap with Padding authenticated encryption function `KWP_AE` maps the given 256-bit key `0x07e0c27a362dfb87ede1b5e0a1790fa3fb09a99e12a6a71eb0a41b6356c9cc92` and plaintext `0xac` to the expected ciphertext `0x70d749e0c9c77a0edd98f8bce3753733`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1090 : property *\/\ntcId1090 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x07e0c27a362dfb87ede1b5e0a1790fa3fb09a99e12a6a71eb0a41b6356c9cc92\n    pt = 0xac\n    ct = 0x70d749e0c9c77a0edd98f8bce3753733\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/092_tcId1091.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1091` that checks the AES-256 Key Wrap with padding authenticated-encryption instantiation `KWP_AE` maps the given 256-bit key and 8-bit plaintext `0xfb` to the expected ciphertext `0x4faa8357f2f3ef340a5e8b7aa74dd290`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1091 : property *\/\ntcId1091 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x50e530ef3eb1a1bae45b8263ba7e30f6f5a7d2418f3611e30830c87d741647cd\n    pt = 0xfb\n    ct = 0x4faa8357f2f3ef340a5e8b7aa74dd290\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/093_tcId1092.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `check_KWP_AE` and the property `tcId1092` that verifies AES-256 Key Wrap with Padding (AES256_KeyWrapPadded_AE) produces the expected ciphertext `0xc686dc8fe198f9d36374f5c56b99e3df` when wrapping the plaintext `0x17` with the key `0xe1de28540953aaf2afb9eef0ddbd08b5a1aab73eecdd2f0e85f8915c94699e4a`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1092 : property *\/\ntcId1092 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xe1de28540953aaf2afb9eef0ddbd08b5a1aab73eecdd2f0e85f8915c94699e4a\n    pt = 0x17\n    ct = 0xc686dc8fe198f9d36374f5c56b99e3df\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/094_tcId1093.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `tcId1093` that checks the AES-256 Key Wrap with padding instantiation (`KWP_AE`) correctly encrypts the 8-bit plaintext `0xc8` under the 256-bit key `0xfbdcabf978959c69724c63165a17db5f1fa7fc2871f9bdfc799391c908f78f6c` to produce the 128-bit ciphertext `0xb6b5d8288dafe8f8584514b5193eeefe`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1093 : property *\/\ntcId1093 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xfbdcabf978959c69724c63165a17db5f1fa7fc2871f9bdfc799391c908f78f6c\n    pt = 0xc8\n    ct = 0xb6b5d8288dafe8f8584514b5193eeefe\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/095_tcId1094.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a property `tcId1094` that verifies the AES-256 Key Wrap with padding authenticated encryption function `KWP_AE` maps the given 256-bit key and 8-bit plaintext value 0x72 to the expected ciphertext 0x5b0b9fab5479528f87eb3c91225bb64d, using `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct` and asserting `testPassed == check_KWP_AE key pt ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1094 : property *\/\ntcId1094 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x417887e598a05e102e6c651f6900c22412deb49140585a650deca9b1ba211b1e\n    pt = 0x72\n    ct = 0x5b0b9fab5479528f87eb3c91225bb64d\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/096_tcId1095.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a property `tcId1095` that verifies the AES-256 Key Wrap with Padding (KWP_AE) instantiation encrypts the 8-bit plaintext `0xfa` under the 256-bit key `0x3bdba3053cc76471ea0d78531bba04a9584995be194a348185698fe4d1338bbe` to the expected 72-bit ciphertext `0xf56924ce90ed7c0a79b8caa4101d1dbc`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1095 : property *\/\ntcId1095 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x3bdba3053cc76471ea0d78531bba04a9584995be194a348185698fe4d1338bbe\n    pt = 0xfa\n    ct = 0xf56924ce90ed7c0a79b8caa4101d1dbc\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/097_tcId1096.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a property `tcId1096` that verifies the AES-256 Key Wrap with Padding authenticated-encryption function `KWP_AE` produces the expected ciphertext for the given 256-bit key, 8-bit plaintext `0x58`, and ciphertext `0x01f0962438250aaeedf8069d7cfd1f95`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1096 : property *\/\ntcId1096 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x9ddfea3da8ff9f5401d5bdbbe520e4d47263e5b268bb15dc6fd62939ffa49377\n    pt = 0x58\n    ct = 0x01f0962438250aaeedf8069d7cfd1f95\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/098_tcId1097.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `tcId1097` that checks the AES-256 Key Wrap with Padding authenticated-encryption instantiation `KWP_AE` encrypts the 1-byte plaintext `0x0e` under the 32-byte key `0x59de802dc7805f487e4537941c71a24317b585bd58cc1ff9b5ac18ffa78e74a3` to the expected ciphertext `0x2b7e6acda4967f644662a58ce8077917`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1097 : property *\/\ntcId1097 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x59de802dc7805f487e4537941c71a24317b585bd58cc1ff9b5ac18ffa78e74a3\n    pt = 0x0e\n    ct = 0x2b7e6acda4967f644662a58ce8077917\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/099_tcId1098.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a property `tcId1098` that checks the AES-256 Key Wrap with Padding authenticated-encryption instantiation `KWP_AE` maps the given 256-bit key and 8-bit plaintext `0x1e` to the expected ciphertext `0x8a4dbd736974c2e73dd27c5e47955d94`, using a helper `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1098 : property *\/\ntcId1098 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x35f2322e2999aaa3beba5e33a237e9d84df0da5bb732370aaef97316f78dd413\n    pt = 0x1e\n    ct = 0x8a4dbd736974c2e73dd27c5e47955d94\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/100_tcId1099.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a property tcId1099 that checks the AES-256 Key Wrap with Padding (KWP_AE) instantiation satisfies KWP_AE key pt == ct for key = 0x45d780cfd96b54cf1ab425faa701645b0fc5f84aa385b1372771bd7ad6109f0f, pt = 0xfc, and ct = 0xa2e47585d0d8f81ba155324417ec2571."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1099 : property *\/\ntcId1099 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0x45d780cfd96b54cf1ab425faa701645b0fc5f84aa385b1372771bd7ad6109f0f\n    pt = 0xfc\n    ct = 0xa2e47585d0d8f81ba155324417ec2571\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Modes\/Tests\/AES256_KeyWrapPadded_AE\/101_tcId1100.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property `tcId1100` that verifies the AES-256 Key Wrap with Padding authenticated-encryption instantiation `KWP_AE` produces the expected ciphertext `0xf6b6398ca55ace0222a9391fd81cd276` when applied to key `0xdf9f0529dbbaba0d2a925ad2e0b81e01a0386dfc2033d3d6d446845957c02a15` and plaintext `0x0a`, using a helper function `check_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct`."},{"role":"assistant","content":"```cryptol\nimport Primitive::Symmetric::Cipher::Block::Modes::Instantiations::AES256_KeyWrap\n\n\ncheck_KWP_AE key pt expected_ct = KWP_AE key pt == expected_ct\n\/* pragma tcId1100 : property *\/\ntcId1100 =\n  testPassed == check_KWP_AE key pt ct\n  where\n    testPassed = True\n    key =\n      0xdf9f0529dbbaba0d2a925ad2e0b81e01a0386dfc2033d3d6d446845957c02a15\n    pt = 0x0a\n    ct = 0xf6b6398ca55ace0222a9391fd81cd276\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/005_BytesToWords.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the functions `ToInt : {n} (fin n) => [n][8] -> [8 * n]` as `join (reverse bytes)` and `BytesToWords : {n} (fin n) => [8 * n][8] -> [n][64]` as mapping `ToInt` over 8-byte chunks of the input using `split` with `each = 8`, to convert sequences of bytes into 64-bit words."},{"role":"assistant","content":"```cryptol\nToInt : {n} (fin n) => [n][8] -> [8 * n]\nToInt bytes = join (reverse bytes)\nBytesToWords : {n} (fin n) => [8 * n][8] -> [n][64]\nBytesToWords bytes = [ToInt bs | bs <- split`{each = 8} bytes]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/007_WordsToBytes.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the functions `ToBytes : {n} (fin n) => [8 * n] -> [n][8]` and `WordsToBytes : {n} (fin n) => [n][64] -> [8 * n][8]` that convert a big-endian bit vector into an array of bytes and then convert an array of 64-bit words into a flat array of bytes, respectively, matching the semantics of the given Threefish block-cipher helper."},{"role":"assistant","content":"```cryptol\nToBytes : {n} (fin n) => [8 * n] -> [n][8]\nToBytes bits = reverse (split`{each = 8} bits)\nWordsToBytes : {n} (fin n) => [n][64] -> [8 * n][8]\nWordsToBytes words = join [ToBytes w | w <- words]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/023_pi8.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `pi8 : [8][64] -> [8][64]` that permutes an 8-word Threefish state according to the index order `[2, 1, 4, 7, 6, 5, 0, 3]` using Cryptol\u2019s array indexing and concatenation operators."},{"role":"assistant","content":"```cryptol\npi8 : [8][64] -> [8][64]\npi8 xs = xs @@ [2, 1, 4, 7, 6, 5, 0, 3 : [3]]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/025_pi16.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the permutation function `pi16 : [16][64] -> [16][64]` for the Threefish-256 cipher key\/word ordering, where `pi16 xs = xs @@ [0, 9, 2, 13, 6, 11, 4, 15, 10, 7, 12, 3, 14, 5, 8, 1 : [4]]`, and add a property that checks this permutation equals the given index-based reordering for all 16-word 64-bit input vectors."},{"role":"assistant","content":"```cryptol\npi16 : [16][64] -> [16][64]\npi16 xs =\n  xs @@ [0, 9, 2, 13, 6, 11, 4, 15, 10, 7, 12, 3, 14, 5, 8, 1 : [4]]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/030_R4.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias Rot = [6] and the constant R4 : [8][2]Rot initialized to the 8\u00d72 table of rotation constants [[14,16],[52,57],[23,40],[5,37],[25,33],[46,12],[58,22],[32,32]] used in the Threefish block cipher round-4 schedule."},{"role":"assistant","content":"```cryptol\ntype Rot = [6]\nR4 : [8][2]Rot\nR4 =\n  [[14, 16],\n  [52, 57],\n  [23, 40],\n  [5, 37],\n  [25, 33],\n  [46, 12],\n  [58, 22],\n  [32, 32]]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/032_R8.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias `Rot = [6]` and the constant rotation schedule matrix `R8 : [8][4]Rot` for the 32-bit Threefish block cipher exactly as specified, preserving the given 8\u00d74 table of rotation values."},{"role":"assistant","content":"```cryptol\ntype Rot = [6]\nR8 : [8][4]Rot\nR8 =\n  [[46, 36, 19, 37],\n  [33, 27, 14, 42],\n  [17, 49, 36, 39],\n  [44, 9, 54, 56],\n  [39, 30, 34, 24],\n  [13, 50, 10, 17],\n  [25, 29, 39, 43],\n  [8, 35, 56, 22]]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/034_R16.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the constant rotation schedule table `R16 : [8][8][6]` for the Threefish block cipher so that it is equal to the 8\u00d78 matrix of 6\u2011bit rotation values shown here, preserving the given type alias `type Rot = [6]` and the exact numeric entries."},{"role":"assistant","content":"```cryptol\ntype Rot = [6]\nR16 : [8][8]Rot\nR16 =\n  [[24, 13, 8, 47, 8, 17, 22, 37],\n  [38, 19, 10, 55, 49, 18, 23, 52],\n  [33, 4, 51, 13, 34, 41, 59, 17],\n  [5, 20, 48, 41, 47, 28, 16, 25],\n  [41, 9, 37, 31, 12, 47, 44, 30],\n  [16, 34, 56, 51, 4, 53, 42, 41],\n  [31, 44, 47, 46, 19, 42, 44, 25],\n  [9, 48, 35, 52, 23, 31, 37, 20]]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/036_KeySchedule.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that specifies the Threefish block cipher key schedule, including the constant C240 : [64], the function KeySchedule : {Nw, r} (fin Nw, fin r, Nw >= 3) => [Nw][64] -> [2][64] -> [r][Nw][64], and its internal helper functions and tweak handling exactly as in the Threefish specification."},{"role":"assistant","content":"```cryptol\nKeySchedule : {Nw, r}\n  (fin Nw, fin r, Nw >= 3) =>\n    [Nw][64] -> [2][64] -> [r][Nw][64]\nKeySchedule k [t0, t1] =\n  take`{r} [subkey s | s <- [0 ...]]\n  where\n    k' = k # [foldl (^) C240 k]\n    t' = [t0, t1, t0 ^ t1]\n    subkey : [64] -> [Nw][64]\n    subkey s = take`{Nw} (k' <<< s) + tweak s\n    tweak : [64] -> [Nw][64]\n    tweak s = zero # take`{2} (t' <<< s) # [s]\nC240 : [64]\nC240 = 0x1bd11bdaa9fc1a22\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/056_pi8'.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `pi8' : [8][64] -> [8][64]` that permutes an 8-word (64-bit each) state according to the fixed index order `[6, 1, 0, 7, 2, 5, 4, 3 : [3]]`, matching the given Threefish block cipher permutation."},{"role":"assistant","content":"```cryptol\npi8' : [8][64] -> [8][64]\npi8' xs = xs @@ [6, 1, 0, 7, 2, 5, 4, 3 : [3]]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/058_pi16'.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol function `pi16' : [16][64] -> [16][64]` that permutes a 16-word (64-bit each) Threefish state using the index order `[0, 15, 2, 11, 6, 13, 4, 9, 14, 1, 8, 5, 10, 3, 12, 7 : [4]]`, and add a property that this permutation is bijective (has an inverse)."},{"role":"assistant","content":"```cryptol\npi16' : [16][64] -> [16][64]\npi16' xs =\n  xs @@ [0, 15, 2, 11, 6, 13, 4, 9, 14, 1, 8, 5, 10, 3, 12, 7 : [4]]\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/061_pi4_inv.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `pi4 : [4][64] -> [4][64]` with permutation indexing `xs @@ [0, 3, 2, 1 : [2]]`, the identical function `pi4' : [4][64] -> [4][64]`, and the property `pi4_inv` stating that for all `xs`, `pi4' (pi4 xs) == xs` holds, showing that `pi4'` is the inverse of `pi4`."},{"role":"assistant","content":"```cryptol\npi4 : [4][64] -> [4][64]\npi4 xs = xs @@ [0, 3, 2, 1 : [2]]\npi4' : [4][64] -> [4][64]\npi4' xs = xs @@ [0, 3, 2, 1 : [2]]\n\/* pragma pi4_inv : property *\/\npi4_inv xs = pi4' (pi4 xs) == xs\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/062_pi8_inv.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `pi8_inv : [8][64] -> Bit` (or equivalent) that states and verifies that `pi8'` is the inverse permutation of `pi8` on 8\u00d764-bit blocks, i.e., `pi8' (pi8 xs) == xs` for all `xs : [8][64]`."},{"role":"assistant","content":"```cryptol\npi8 : [8][64] -> [8][64]\npi8 xs = xs @@ [2, 1, 4, 7, 6, 5, 0, 3 : [3]]\npi8' : [8][64] -> [8][64]\npi8' xs = xs @@ [6, 1, 0, 7, 2, 5, 4, 3 : [3]]\n\/* pragma pi8_inv : property *\/\npi8_inv xs = pi8' (pi8 xs) == xs\n```"}]}
{"filename":"cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/Threefish\/063_pi16_inv.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `pi16 : [16][64] -> [16][64]` and its inverse `pi16' : [16][64] -> [16][64]` as specific index permutations, and define a property `pi16_inv` stating that `pi16' (pi16 xs) == xs` for all `xs` of type `[16][64]`."},{"role":"assistant","content":"```cryptol\npi16 : [16][64] -> [16][64]\npi16 xs =\n  xs @@ [0, 9, 2, 13, 6, 11, 4, 15, 10, 7, 12, 3, 14, 5, 8, 1 : [4]]\npi16' : [16][64] -> [16][64]\npi16' xs =\n  xs @@ [0, 15, 2, 11, 6, 13, 4, 9, 14, 1, 8, 5, 10, 3, 12, 7 : [4]]\n\/* pragma pi16_inv : property *\/\npi16_inv xs = pi16' (pi16 xs) == xs\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/011_KeySchedule.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that specifies the AES-128 key schedule, including the given type synonyms AES128, Nk, Nb, Nr, GF28, State, RoundKey, and KeySchedule, and provide a function that, given a 128-bit key, returns a value of type KeySchedule."},{"role":"assistant","content":"```cryptol\ntype AES128 = 4\ntype Nk = AES128\ntype Nb = 4\ntype Nr = 6 + Nk\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ntype RoundKey = State\ntype KeySchedule = (RoundKey, [Nr - 1]RoundKey, RoundKey)\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/012_gf28Add.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias GF28 = [8] and the function gf28Add : {n} (fin n) => [n]GF28 -> GF28 that computes the XOR-sum (over GF(2^8)) of a sequence of GF28 elements using a running prefix-XOR list and returning its final element, matching the behavior in the given specification."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/015_gf28Mult.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol a complete finite-field multiplication specification over GF(2^8) using the irreducible polynomial x^8 + x^4 + x^3 + x + 1, including the type synonym GF28 = [8], the function gf28Mult : (GF28, GF28) -> GF28 implementing polynomial multiplication modulo this polynomial, and a property that gf28Mult makes GF28 a finite field (associative, commutative, with identity, and each nonzero element having a multiplicative inverse)."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/023_gf28VectorMult.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type alias GF28 = [8] and the functions gf28Add, gf28Mult, gf28DotProduct, and gf28VectorMult implementing addition, multiplication modulo the irreducible polynomial x^^8 + x^^4 + x^^3 + x + 1, vector dot product over GF(2^8), and multiplication of a GF(2^8) row vector by a matrix of GF(2^8) elements, respectively."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28DotProduct : {n} (fin n) => ([n]GF28, [n]GF28) -> GF28\ngf28DotProduct (xs, ys) =\n  gf28Add [gf28Mult (x, y) | x <- xs | y <- ys]\ngf28VectorMult : {n, m}\n  (fin n) =>\n    ([n]GF28, [m][n]GF28) -> [m]GF28\ngf28VectorMult (v, ms) = [gf28DotProduct (v, m) | m <- ms]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/027_xformByte.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `xformByte : [8] -> [8]` that implements the AES S-box byte transformation over GF(2^8), using `gf28Add : {n} (fin n) => [n][8] -> [8]` to XOR the input byte, its right-rotated versions, and the constant `0x63` as in the AES affine transformation step."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nxformByte : GF28 -> GF28\nxformByte b =\n  gf28Add [b, (b >>> 4), (b >>> 5), (b >>> 6), (b >>> 7), c]\n  where\n    c = 0x63\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/029_xformByte'.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define a module for the AES S-box affine transformation over GF(2^8) that includes the type alias GF28 = [8], the helper function gf28Add : {n} (fin n) => [n]GF28 -> GF28 for XOR-summing lists of bytes, and the function xformByte' : GF28 -> GF28 implementing the affine transform xformByte' b = gf28Add [(b >>> 2), (b >>> 5), (b >>> 7), 0x05]."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nxformByte' : GF28 -> GF28\nxformByte' b =\n  gf28Add [(b >>> 2), (b >>> 5), (b >>> 7), d]\n  where\n    d = 0x05\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/031_SubByte.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the AES SubBytes operation over GF(2^8), including the GF(2^8) addition, multiplication modulo the irreducible polynomial x^8 + x^4 + x^3 + x + 1, exponentiation, multiplicative inverse, the affine byte transformation, and the top-level function `SubByte : [8] -> [8]` implementing the S-box."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28Pow : (GF28, [8]) -> GF28\ngf28Pow (n, k) =\n  pow k\n  where\n    sq x = gf28Mult (x, x)\n    odd x = x ! 0\n    pow i =\n      if i == 0\n      then 1\n      else if odd i\n      then gf28Mult (n, sq (pow (i >> 1)))\n      else sq (pow (i >> 1))\ngf28Inverse : GF28 -> GF28\ngf28Inverse x = gf28Pow (x, 254)\nxformByte : GF28 -> GF28\nxformByte b =\n  gf28Add [b, (b >>> 4), (b >>> 5), (b >>> 6), (b >>> 7), c]\n  where\n    c = 0x63\nSubByte : GF28 -> GF28\nSubByte b = xformByte (gf28Inverse b)\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/039_InvSubBytes.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module that specifies the AES inverse SubBytes transformation by defining the GF(2^8) arithmetic used here, the byte-wise inverse S-box function InvSubByte : [8] -> [8], and the state-wise InvSubBytes : [4][4][8] -> [4][4][8], and include a property that InvSubBytes is the inverse of the standard AES SubBytes for all 4x4 byte states."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28Pow : (GF28, [8]) -> GF28\ngf28Pow (n, k) =\n  pow k\n  where\n    sq x = gf28Mult (x, x)\n    odd x = x ! 0\n    pow i =\n      if i == 0\n      then 1\n      else if odd i\n      then gf28Mult (n, sq (pow (i >> 1)))\n      else sq (pow (i >> 1))\ngf28Inverse : GF28 -> GF28\ngf28Inverse x = gf28Pow (x, 254)\nxformByte' : GF28 -> GF28\nxformByte' b =\n  gf28Add [(b >>> 2), (b >>> 5), (b >>> 7), d]\n  where\n    d = 0x05\nInvSubByte : GF28 -> GF28\nInvSubByte b = gf28Inverse (xformByte' b)\nInvSubBytes : State -> State\nInvSubBytes state = [[InvSubByte b | b <- row] | row <- state]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/041_ShiftRows.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define a complete specification for the AES ShiftRows transformation on the AES state type `State = [4][4][8]`, including the function `ShiftRows : State -> State` that cyclically left-shifts each row by its row index (0,1,2,3) and any necessary supporting types or properties to verify its correctness against the AES standard."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype GF28 = [8]\ntype State = [4][Nb]GF28\nShiftRows : State -> State\nShiftRows state =\n  [row <<< shiftAmount | row <- state\n                       | shiftAmount <- [0 .. 3]]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/043_InvShiftRows.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the AES inverse ShiftRows transformation in Cryptol with type `InvShiftRows : [4][4][8] -> [4][4][8]`, where each row of the 4x4 byte state is rotated right by its row index (0..3) bytes, and provide a property that checks this behavior for all possible states."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype GF28 = [8]\ntype State = [4][Nb]GF28\nInvShiftRows : State -> State\nInvShiftRows state =\n  [row >>> shiftAmount | row <- state\n                       | shiftAmount <- [0 .. 3]]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/047_InvMixColumns.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that implements the AES InvMixColumns transformation over GF(2^8) using the given Nb, GF28, and State types, including gf28Add, gf28Mult with the irreducible polynomial x^8 + x^4 + x^3 + x + 1, gf28DotProduct, gf28VectorMult, gf28MatrixMult, and the InvMixColumns : State -> State function using the standard AES inverse MixColumns matrix."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28DotProduct : {n} (fin n) => ([n]GF28, [n]GF28) -> GF28\ngf28DotProduct (xs, ys) =\n  gf28Add [gf28Mult (x, y) | x <- xs | y <- ys]\ngf28VectorMult : {n, m}\n  (fin n) =>\n    ([n]GF28, [m][n]GF28) -> [m]GF28\ngf28VectorMult (v, ms) = [gf28DotProduct (v, m) | m <- ms]\ngf28MatrixMult : {n, m, k}\n  (fin m) =>\n    ([n][m]GF28, [m][k]GF28) -> [n][k]GF28\ngf28MatrixMult (xss, yss) =\n  [gf28VectorMult (xs, yss') | xs <- xss]\n  where\n    yss' = transpose yss\nInvMixColumns : State -> State\nInvMixColumns state =\n  gf28MatrixMult (m, state)\n  where\n    m =\n      [[0x0e, 0x0b, 0x0d, 0x09],\n      [0x09, 0x0e, 0x0b, 0x0d],\n      [0x0d, 0x09, 0x0e, 0x0b],\n      [0x0b, 0x0d, 0x09, 0x0e]]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/049_AddRoundKey.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type synonyms `Nb = 4`, `GF28 = [8]`, `State = [4][Nb]GF28`, `RoundKey = State`, and the function `AddRoundKey : (RoundKey, State) -> State` implementing the AES AddRoundKey step as bitwise XOR of the round key and state (`AddRoundKey (rk, s) = rk ^ s`)."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ntype RoundKey = State\nAddRoundKey : (RoundKey, State) -> State\nAddRoundKey (rk, s) = rk ^ s\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/051_Rcon.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that specifies the AES key schedule round constant function Rcon : [8] -> [4][8], using GF(2^8) arithmetic over the irreducible polynomial x^8 + x^4 + x^3 + x + 1, and ensure it computes the standard AES Rcon values for all valid round indices."},{"role":"assistant","content":"```cryptol\ntype GF28 = [8]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28Pow : (GF28, [8]) -> GF28\ngf28Pow (n, k) =\n  pow k\n  where\n    sq x = gf28Mult (x, x)\n    odd x = x ! 0\n    pow i =\n      if i == 0\n      then 1\n      else if odd i\n      then gf28Mult (n, sq (pow (i >> 1)))\n      else sq (pow (i >> 1))\nRcon : [8] -> [4]GF28\nRcon i = [(gf28Pow (<| x |>, i - 1)), 0, 0, 0]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/063_ExpandKey.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol module that implements the AES-128 key expansion (key schedule) using GF(2^8) arithmetic, the provided AES S-box, and functions like SubWord, RotWord, Rcon, NextWord, ExpandKeyForever, and ExpandKey : [AESKeySize] -> KeySchedule, matching the standard AES round key derivation for 10 rounds (Nr = 6 + Nk with Nk = 4)."},{"role":"assistant","content":"```cryptol\ntype AES128 = 4\ntype Nk = AES128\ntype Nb = 4\ntype Nr = 6 + Nk\ntype AESKeySize = (Nk * 32)\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ntype RoundKey = State\ntype KeySchedule = (RoundKey, [Nr - 1]RoundKey, RoundKey)\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28Pow : (GF28, [8]) -> GF28\ngf28Pow (n, k) =\n  pow k\n  where\n    sq x = gf28Mult (x, x)\n    odd x = x ! 0\n    pow i =\n      if i == 0\n      then 1\n      else if odd i\n      then gf28Mult (n, sq (pow (i >> 1)))\n      else sq (pow (i >> 1))\nSubByte' : GF28 -> GF28\nSubByte' b = sbox @ b\nRcon : [8] -> [4]GF28\nRcon i = [(gf28Pow (<| x |>, i - 1)), 0, 0, 0]\nSubWord : [4]GF28 -> [4]GF28\nSubWord bs = [SubByte' b | b <- bs]\nRotWord : [4]GF28 -> [4]GF28\nRotWord [a0, a1, a2, a3] = [a1, a2, a3, a0]\nNextWord : ([8], [4][8], [4][8]) -> [4][8]\nNextWord (i, prev, old) =\n  old ^ mask\n  where\n    mask =\n      if i % `Nk == 0\n      then SubWord (RotWord (prev)) ^ Rcon (i \/ `Nk)\n      else if (`Nk > 6) \/\\ (i % `Nk == 4) then SubWord (prev) else prev\nExpandKeyForever : [Nk][4][8] -> [inf]RoundKey\nExpandKeyForever seed =\n  [transpose g | g <- groupBy`{4} (keyWS seed)]\nkeyWS : [Nk][4][8] -> [inf][4][8]\nkeyWS seed =\n  xs\n  where\n    xs =\n      seed # [NextWord (i, prev, old) | i <- [`Nk ...]\n                                      | prev <- drop`{Nk - 1} xs\n                                      | old <- xs]\nExpandKey : [AESKeySize] -> KeySchedule\nExpandKey key =\n  (keys @ 0, keys @@ [1 .. (Nr - 1)], keys @ `Nr)\n  where\n    seed : [Nk][4][8]\n    seed = split (split key)\n    keys = ExpandKeyForever seed\nsbox : [256]GF28\nsbox =\n  [0x63,\n  0x7c,\n  0x77,\n  0x7b,\n  0xf2,\n  0x6b,\n  0x6f,\n  0xc5,\n  0x30,\n  0x01,\n  0x67,\n  0x2b,\n  0xfe,\n  0xd7,\n  0xab,\n  0x76,\n  0xca,\n  0x82,\n  0xc9,\n  0x7d,\n  0xfa,\n  0x59,\n  0x47,\n  0xf0,\n  0xad,\n  0xd4,\n  0xa2,\n  0xaf,\n  0x9c,\n  0xa4,\n  0x72,\n  0xc0,\n  0xb7,\n  0xfd,\n  0x93,\n  0x26,\n  0x36,\n  0x3f,\n  0xf7,\n  0xcc,\n  0x34,\n  0xa5,\n  0xe5,\n  0xf1,\n  0x71,\n  0xd8,\n  0x31,\n  0x15,\n  0x04,\n  0xc7,\n  0x23,\n  0xc3,\n  0x18,\n  0x96,\n  0x05,\n  0x9a,\n  0x07,\n  0x12,\n  0x80,\n  0xe2,\n  0xeb,\n  0x27,\n  0xb2,\n  0x75,\n  0x09,\n  0x83,\n  0x2c,\n  0x1a,\n  0x1b,\n  0x6e,\n  0x5a,\n  0xa0,\n  0x52,\n  0x3b,\n  0xd6,\n  0xb3,\n  0x29,\n  0xe3,\n  0x2f,\n  0x84,\n  0x53,\n  0xd1,\n  0x00,\n  0xed,\n  0x20,\n  0xfc,\n  0xb1,\n  0x5b,\n  0x6a,\n  0xcb,\n  0xbe,\n  0x39,\n  0x4a,\n  0x4c,\n  0x58,\n  0xcf,\n  0xd0,\n  0xef,\n  0xaa,\n  0xfb,\n  0x43,\n  0x4d,\n  0x33,\n  0x85,\n  0x45,\n  0xf9,\n  0x02,\n  0x7f,\n  0x50,\n  0x3c,\n  0x9f,\n  0xa8,\n  0x51,\n  0xa3,\n  0x40,\n  0x8f,\n  0x92,\n  0x9d,\n  0x38,\n  0xf5,\n  0xbc,\n  0xb6,\n  0xda,\n  0x21,\n  0x10,\n  0xff,\n  0xf3,\n  0xd2,\n  0xcd,\n  0x0c,\n  0x13,\n  0xec,\n  0x5f,\n  0x97,\n  0x44,\n  0x17,\n  0xc4,\n  0xa7,\n  0x7e,\n  0x3d,\n  0x64,\n  0x5d,\n  0x19,\n  0x73,\n  0x60,\n  0x81,\n  0x4f,\n  0xdc,\n  0x22,\n  0x2a,\n  0x90,\n  0x88,\n  0x46,\n  0xee,\n  0xb8,\n  0x14,\n  0xde,\n  0x5e,\n  0x0b,\n  0xdb,\n  0xe0,\n  0x32,\n  0x3a,\n  0x0a,\n  0x49,\n  0x06,\n  0x24,\n  0x5c,\n  0xc2,\n  0xd3,\n  0xac,\n  0x62,\n  0x91,\n  0x95,\n  0xe4,\n  0x79,\n  0xe7,\n  0xc8,\n  0x37,\n  0x6d,\n  0x8d,\n  0xd5,\n  0x4e,\n  0xa9,\n  0x6c,\n  0x56,\n  0xf4,\n  0xea,\n  0x65,\n  0x7a,\n  0xae,\n  0x08,\n  0xba,\n  0x78,\n  0x25,\n  0x2e,\n  0x1c,\n  0xa6,\n  0xb4,\n  0xc6,\n  0xe8,\n  0xdd,\n  0x74,\n  0x1f,\n  0x4b,\n  0xbd,\n  0x8b,\n  0x8a,\n  0x70,\n  0x3e,\n  0xb5,\n  0x66,\n  0x48,\n  0x03,\n  0xf6,\n  0x0e,\n  0x61,\n  0x35,\n  0x57,\n  0xb9,\n  0x86,\n  0xc1,\n  0x1d,\n  0x9e,\n  0xe1,\n  0xf8,\n  0x98,\n  0x11,\n  0x69,\n  0xd9,\n  0x8e,\n  0x94,\n  0x9b,\n  0x1e,\n  0x87,\n  0xe9,\n  0xce,\n  0x55,\n  0x28,\n  0xdf,\n  0x8c,\n  0xa1,\n  0x89,\n  0x0d,\n  0xbf,\n  0xe6,\n  0x42,\n  0x68,\n  0x41,\n  0x99,\n  0x2d,\n  0x0f,\n  0xb0,\n  0x54,\n  0xbb,\n  0x16]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/065_fromKS.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the AES-128 type aliases, the State, RoundKey, and KeySchedule types, and the function fromKS : KeySchedule -> [Nr + 1][4][32] which constructs an array of round keys by concatenating the initial, middle, and final round keys and converting each round key state into four 32-bit words using transpose and join as in the given type definitions."},{"role":"assistant","content":"```cryptol\ntype AES128 = 4\ntype Nk = AES128\ntype Nb = 4\ntype Nr = 6 + Nk\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ntype RoundKey = State\ntype KeySchedule = (RoundKey, [Nr - 1]RoundKey, RoundKey)\nfromKS : KeySchedule -> [Nr + 1][4][32]\nfromKS (f, ms, l) =\n  [formKeyWords (transpose k) | k <- [f] # ms # [l]]\n  where\n    formKeyWords bbs = [join bs | bs <- bbs]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/067_AESRound.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the AES round function AESRound : (RoundKey, State) -> State over GF(2^8), including the SubBytes, ShiftRows, MixColumns, AddRoundKey operations and the sbox constant as shown in the AES standard, suitable for use in formal verification of AES block cipher implementations."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ntype RoundKey = State\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28DotProduct : {n} (fin n) => ([n]GF28, [n]GF28) -> GF28\ngf28DotProduct (xs, ys) =\n  gf28Add [gf28Mult (x, y) | x <- xs | y <- ys]\ngf28VectorMult : {n, m}\n  (fin n) =>\n    ([n]GF28, [m][n]GF28) -> [m]GF28\ngf28VectorMult (v, ms) = [gf28DotProduct (v, m) | m <- ms]\ngf28MatrixMult : {n, m, k}\n  (fin m) =>\n    ([n][m]GF28, [m][k]GF28) -> [n][k]GF28\ngf28MatrixMult (xss, yss) =\n  [gf28VectorMult (xs, yss') | xs <- xss]\n  where\n    yss' = transpose yss\nSubByte' : GF28 -> GF28\nSubByte' b = sbox @ b\nSubBytes : State -> State\nSubBytes state = [[SubByte' b | b <- row] | row <- state]\nShiftRows : State -> State\nShiftRows state =\n  [row <<< shiftAmount | row <- state\n                       | shiftAmount <- [0 .. 3]]\nMixColumns : State -> State\nMixColumns state =\n  gf28MatrixMult (m, state)\n  where\n    m = [[2, 3, 1, 1], [1, 2, 3, 1], [1, 1, 2, 3], [3, 1, 1, 2]]\nAddRoundKey : (RoundKey, State) -> State\nAddRoundKey (rk, s) = rk ^ s\nAESRound : (RoundKey, State) -> State\nAESRound (rk, s) =\n  AddRoundKey (rk, MixColumns (ShiftRows (SubBytes s)))\nsbox : [256]GF28\nsbox =\n  [0x63,\n  0x7c,\n  0x77,\n  0x7b,\n  0xf2,\n  0x6b,\n  0x6f,\n  0xc5,\n  0x30,\n  0x01,\n  0x67,\n  0x2b,\n  0xfe,\n  0xd7,\n  0xab,\n  0x76,\n  0xca,\n  0x82,\n  0xc9,\n  0x7d,\n  0xfa,\n  0x59,\n  0x47,\n  0xf0,\n  0xad,\n  0xd4,\n  0xa2,\n  0xaf,\n  0x9c,\n  0xa4,\n  0x72,\n  0xc0,\n  0xb7,\n  0xfd,\n  0x93,\n  0x26,\n  0x36,\n  0x3f,\n  0xf7,\n  0xcc,\n  0x34,\n  0xa5,\n  0xe5,\n  0xf1,\n  0x71,\n  0xd8,\n  0x31,\n  0x15,\n  0x04,\n  0xc7,\n  0x23,\n  0xc3,\n  0x18,\n  0x96,\n  0x05,\n  0x9a,\n  0x07,\n  0x12,\n  0x80,\n  0xe2,\n  0xeb,\n  0x27,\n  0xb2,\n  0x75,\n  0x09,\n  0x83,\n  0x2c,\n  0x1a,\n  0x1b,\n  0x6e,\n  0x5a,\n  0xa0,\n  0x52,\n  0x3b,\n  0xd6,\n  0xb3,\n  0x29,\n  0xe3,\n  0x2f,\n  0x84,\n  0x53,\n  0xd1,\n  0x00,\n  0xed,\n  0x20,\n  0xfc,\n  0xb1,\n  0x5b,\n  0x6a,\n  0xcb,\n  0xbe,\n  0x39,\n  0x4a,\n  0x4c,\n  0x58,\n  0xcf,\n  0xd0,\n  0xef,\n  0xaa,\n  0xfb,\n  0x43,\n  0x4d,\n  0x33,\n  0x85,\n  0x45,\n  0xf9,\n  0x02,\n  0x7f,\n  0x50,\n  0x3c,\n  0x9f,\n  0xa8,\n  0x51,\n  0xa3,\n  0x40,\n  0x8f,\n  0x92,\n  0x9d,\n  0x38,\n  0xf5,\n  0xbc,\n  0xb6,\n  0xda,\n  0x21,\n  0x10,\n  0xff,\n  0xf3,\n  0xd2,\n  0xcd,\n  0x0c,\n  0x13,\n  0xec,\n  0x5f,\n  0x97,\n  0x44,\n  0x17,\n  0xc4,\n  0xa7,\n  0x7e,\n  0x3d,\n  0x64,\n  0x5d,\n  0x19,\n  0x73,\n  0x60,\n  0x81,\n  0x4f,\n  0xdc,\n  0x22,\n  0x2a,\n  0x90,\n  0x88,\n  0x46,\n  0xee,\n  0xb8,\n  0x14,\n  0xde,\n  0x5e,\n  0x0b,\n  0xdb,\n  0xe0,\n  0x32,\n  0x3a,\n  0x0a,\n  0x49,\n  0x06,\n  0x24,\n  0x5c,\n  0xc2,\n  0xd3,\n  0xac,\n  0x62,\n  0x91,\n  0x95,\n  0xe4,\n  0x79,\n  0xe7,\n  0xc8,\n  0x37,\n  0x6d,\n  0x8d,\n  0xd5,\n  0x4e,\n  0xa9,\n  0x6c,\n  0x56,\n  0xf4,\n  0xea,\n  0x65,\n  0x7a,\n  0xae,\n  0x08,\n  0xba,\n  0x78,\n  0x25,\n  0x2e,\n  0x1c,\n  0xa6,\n  0xb4,\n  0xc6,\n  0xe8,\n  0xdd,\n  0x74,\n  0x1f,\n  0x4b,\n  0xbd,\n  0x8b,\n  0x8a,\n  0x70,\n  0x3e,\n  0xb5,\n  0x66,\n  0x48,\n  0x03,\n  0xf6,\n  0x0e,\n  0x61,\n  0x35,\n  0x57,\n  0xb9,\n  0x86,\n  0xc1,\n  0x1d,\n  0x9e,\n  0xe1,\n  0xf8,\n  0x98,\n  0x11,\n  0x69,\n  0xd9,\n  0x8e,\n  0x94,\n  0x9b,\n  0x1e,\n  0x87,\n  0xe9,\n  0xce,\n  0x55,\n  0x28,\n  0xdf,\n  0x8c,\n  0xa1,\n  0x89,\n  0x0d,\n  0xbf,\n  0xe6,\n  0x42,\n  0x68,\n  0x41,\n  0x99,\n  0x2d,\n  0x0f,\n  0xb0,\n  0x54,\n  0xbb,\n  0x16]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/069_AESFinalRound.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that specifies the AES encryption final round for AES-128, including the types Nb, GF28, State, RoundKey, the sbox constant, the SubBytes, ShiftRows, AddRoundKey, and AESFinalRound functions, and add a property that AESFinalRound correctly applies SubBytes, ShiftRows, and AddRoundKey in order to a given State and RoundKey."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ntype RoundKey = State\nSubByte' : GF28 -> GF28\nSubByte' b = sbox @ b\nSubBytes : State -> State\nSubBytes state = [[SubByte' b | b <- row] | row <- state]\nShiftRows : State -> State\nShiftRows state =\n  [row <<< shiftAmount | row <- state\n                       | shiftAmount <- [0 .. 3]]\nAddRoundKey : (RoundKey, State) -> State\nAddRoundKey (rk, s) = rk ^ s\nAESFinalRound : (RoundKey, State) -> State\nAESFinalRound (rk, s) = AddRoundKey (rk, ShiftRows (SubBytes s))\nsbox : [256]GF28\nsbox =\n  [0x63,\n  0x7c,\n  0x77,\n  0x7b,\n  0xf2,\n  0x6b,\n  0x6f,\n  0xc5,\n  0x30,\n  0x01,\n  0x67,\n  0x2b,\n  0xfe,\n  0xd7,\n  0xab,\n  0x76,\n  0xca,\n  0x82,\n  0xc9,\n  0x7d,\n  0xfa,\n  0x59,\n  0x47,\n  0xf0,\n  0xad,\n  0xd4,\n  0xa2,\n  0xaf,\n  0x9c,\n  0xa4,\n  0x72,\n  0xc0,\n  0xb7,\n  0xfd,\n  0x93,\n  0x26,\n  0x36,\n  0x3f,\n  0xf7,\n  0xcc,\n  0x34,\n  0xa5,\n  0xe5,\n  0xf1,\n  0x71,\n  0xd8,\n  0x31,\n  0x15,\n  0x04,\n  0xc7,\n  0x23,\n  0xc3,\n  0x18,\n  0x96,\n  0x05,\n  0x9a,\n  0x07,\n  0x12,\n  0x80,\n  0xe2,\n  0xeb,\n  0x27,\n  0xb2,\n  0x75,\n  0x09,\n  0x83,\n  0x2c,\n  0x1a,\n  0x1b,\n  0x6e,\n  0x5a,\n  0xa0,\n  0x52,\n  0x3b,\n  0xd6,\n  0xb3,\n  0x29,\n  0xe3,\n  0x2f,\n  0x84,\n  0x53,\n  0xd1,\n  0x00,\n  0xed,\n  0x20,\n  0xfc,\n  0xb1,\n  0x5b,\n  0x6a,\n  0xcb,\n  0xbe,\n  0x39,\n  0x4a,\n  0x4c,\n  0x58,\n  0xcf,\n  0xd0,\n  0xef,\n  0xaa,\n  0xfb,\n  0x43,\n  0x4d,\n  0x33,\n  0x85,\n  0x45,\n  0xf9,\n  0x02,\n  0x7f,\n  0x50,\n  0x3c,\n  0x9f,\n  0xa8,\n  0x51,\n  0xa3,\n  0x40,\n  0x8f,\n  0x92,\n  0x9d,\n  0x38,\n  0xf5,\n  0xbc,\n  0xb6,\n  0xda,\n  0x21,\n  0x10,\n  0xff,\n  0xf3,\n  0xd2,\n  0xcd,\n  0x0c,\n  0x13,\n  0xec,\n  0x5f,\n  0x97,\n  0x44,\n  0x17,\n  0xc4,\n  0xa7,\n  0x7e,\n  0x3d,\n  0x64,\n  0x5d,\n  0x19,\n  0x73,\n  0x60,\n  0x81,\n  0x4f,\n  0xdc,\n  0x22,\n  0x2a,\n  0x90,\n  0x88,\n  0x46,\n  0xee,\n  0xb8,\n  0x14,\n  0xde,\n  0x5e,\n  0x0b,\n  0xdb,\n  0xe0,\n  0x32,\n  0x3a,\n  0x0a,\n  0x49,\n  0x06,\n  0x24,\n  0x5c,\n  0xc2,\n  0xd3,\n  0xac,\n  0x62,\n  0x91,\n  0x95,\n  0xe4,\n  0x79,\n  0xe7,\n  0xc8,\n  0x37,\n  0x6d,\n  0x8d,\n  0xd5,\n  0x4e,\n  0xa9,\n  0x6c,\n  0x56,\n  0xf4,\n  0xea,\n  0x65,\n  0x7a,\n  0xae,\n  0x08,\n  0xba,\n  0x78,\n  0x25,\n  0x2e,\n  0x1c,\n  0xa6,\n  0xb4,\n  0xc6,\n  0xe8,\n  0xdd,\n  0x74,\n  0x1f,\n  0x4b,\n  0xbd,\n  0x8b,\n  0x8a,\n  0x70,\n  0x3e,\n  0xb5,\n  0x66,\n  0x48,\n  0x03,\n  0xf6,\n  0x0e,\n  0x61,\n  0x35,\n  0x57,\n  0xb9,\n  0x86,\n  0xc1,\n  0x1d,\n  0x9e,\n  0xe1,\n  0xf8,\n  0x98,\n  0x11,\n  0x69,\n  0xd9,\n  0x8e,\n  0x94,\n  0x9b,\n  0x1e,\n  0x87,\n  0xe9,\n  0xce,\n  0x55,\n  0x28,\n  0xdf,\n  0x8c,\n  0xa1,\n  0x89,\n  0x0d,\n  0xbf,\n  0xe6,\n  0x42,\n  0x68,\n  0x41,\n  0x99,\n  0x2d,\n  0x0f,\n  0xb0,\n  0x54,\n  0xbb,\n  0x16]\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/071_AESInvRound.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for an AES inverse round over GF(2^8) that defines the types Nb = 4, GF28 = [8], State = [4][Nb]GF28, RoundKey = State, implements gf28Add, gf28Mult with irreducible polynomial x^8 + x^4 + x^3 + x + 1, gf28Pow, gf28Inverse, gf28DotProduct, gf28VectorMult, gf28MatrixMult, InvSubByte\/InvSubBytes, InvShiftRows, InvMixColumns, AddRoundKey, and the top-level function AESInvRound : (RoundKey, State) -> State, and include suitable properties to validate the GF(2^8) arithmetic and AES inverse round transformations."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ntype RoundKey = State\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28Pow : (GF28, [8]) -> GF28\ngf28Pow (n, k) =\n  pow k\n  where\n    sq x = gf28Mult (x, x)\n    odd x = x ! 0\n    pow i =\n      if i == 0\n      then 1\n      else if odd i\n      then gf28Mult (n, sq (pow (i >> 1)))\n      else sq (pow (i >> 1))\ngf28Inverse : GF28 -> GF28\ngf28Inverse x = gf28Pow (x, 254)\ngf28DotProduct : {n} (fin n) => ([n]GF28, [n]GF28) -> GF28\ngf28DotProduct (xs, ys) =\n  gf28Add [gf28Mult (x, y) | x <- xs | y <- ys]\ngf28VectorMult : {n, m}\n  (fin n) =>\n    ([n]GF28, [m][n]GF28) -> [m]GF28\ngf28VectorMult (v, ms) = [gf28DotProduct (v, m) | m <- ms]\ngf28MatrixMult : {n, m, k}\n  (fin m) =>\n    ([n][m]GF28, [m][k]GF28) -> [n][k]GF28\ngf28MatrixMult (xss, yss) =\n  [gf28VectorMult (xs, yss') | xs <- xss]\n  where\n    yss' = transpose yss\nxformByte' : GF28 -> GF28\nxformByte' b =\n  gf28Add [(b >>> 2), (b >>> 5), (b >>> 7), d]\n  where\n    d = 0x05\nInvSubByte : GF28 -> GF28\nInvSubByte b = gf28Inverse (xformByte' b)\nInvSubBytes : State -> State\nInvSubBytes state = [[InvSubByte b | b <- row] | row <- state]\nInvShiftRows : State -> State\nInvShiftRows state =\n  [row >>> shiftAmount | row <- state\n                       | shiftAmount <- [0 .. 3]]\nInvMixColumns : State -> State\nInvMixColumns state =\n  gf28MatrixMult (m, state)\n  where\n    m =\n      [[0x0e, 0x0b, 0x0d, 0x09],\n      [0x09, 0x0e, 0x0b, 0x0d],\n      [0x0d, 0x09, 0x0e, 0x0b],\n      [0x0b, 0x0d, 0x09, 0x0e]]\nAddRoundKey : (RoundKey, State) -> State\nAddRoundKey (rk, s) = rk ^ s\nAESInvRound : (RoundKey, State) -> State\nAESInvRound (rk, s) =\n  InvMixColumns (AddRoundKey (rk, InvSubBytes (InvShiftRows s)))\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/073_AESFinalInvRound.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define a Cryptol module that specifies the AES decryption final inverse round for 128-bit AES, including the GF(2^8) arithmetic, InvSubBytes, InvShiftRows, AddRoundKey, and the function AESFinalInvRound : (RoundKey, State) -> State, and add a property stating that applying the AES final encryption round followed by AESFinalInvRound recovers the original state for any round key and state."},{"role":"assistant","content":"```cryptol\ntype Nb = 4\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ntype RoundKey = State\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28Pow : (GF28, [8]) -> GF28\ngf28Pow (n, k) =\n  pow k\n  where\n    sq x = gf28Mult (x, x)\n    odd x = x ! 0\n    pow i =\n      if i == 0\n      then 1\n      else if odd i\n      then gf28Mult (n, sq (pow (i >> 1)))\n      else sq (pow (i >> 1))\ngf28Inverse : GF28 -> GF28\ngf28Inverse x = gf28Pow (x, 254)\nxformByte' : GF28 -> GF28\nxformByte' b =\n  gf28Add [(b >>> 2), (b >>> 5), (b >>> 7), d]\n  where\n    d = 0x05\nInvSubByte : GF28 -> GF28\nInvSubByte b = gf28Inverse (xformByte' b)\nInvSubBytes : State -> State\nInvSubBytes state = [[InvSubByte b | b <- row] | row <- state]\nInvShiftRows : State -> State\nInvShiftRows state =\n  [row >>> shiftAmount | row <- state\n                       | shiftAmount <- [0 .. 3]]\nAddRoundKey : (RoundKey, State) -> State\nAddRoundKey (rk, s) = rk ^ s\nAESFinalInvRound : (RoundKey, State) -> State\nAESFinalInvRound (rk, s) =\n  AddRoundKey (rk, InvSubBytes (InvShiftRows s))\n```"}]}
{"filename":"saw-demos\/cryptol-specs\/Primitive\/Symmetric\/Cipher\/Block\/AES\/085_AESCorrect.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the property `AESCorrect` stating that for all 128-bit messages `msg` and 128-bit AES keys `key`, the provided `aesEncrypt : ([128], [AESKeySize]) -> [128]` and `aesDecrypt : ([128], [AESKeySize]) -> [128]` functions are inverses, i.e., `aesDecrypt (aesEncrypt (msg, key), key) == msg` for AES-128 as specified by the given S-box, key schedule, and round transformations."},{"role":"assistant","content":"```cryptol\ntype AES128 = 4\ntype Nk = AES128\ntype Nb = 4\ntype Nr = 6 + Nk\ntype AESKeySize = (Nk * 32)\ntype GF28 = [8]\ntype State = [4][Nb]GF28\ntype RoundKey = State\ntype KeySchedule = (RoundKey, [Nr - 1]RoundKey, RoundKey)\ngf28Add : {n} (fin n) => [n]GF28 -> GF28\ngf28Add ps =\n  sums ! 0\n  where\n    sums = [zero] # [p ^ s | p <- ps | s <- sums]\nirreducible = <| x^^8 + x^^4 + x^^3 + x + 1 |>\ngf28Mult : (GF28, GF28) -> GF28\ngf28Mult (x, y) = pmod (pmult x y) irreducible\ngf28Pow : (GF28, [8]) -> GF28\ngf28Pow (n, k) =\n  pow k\n  where\n    sq x = gf28Mult (x, x)\n    odd x = x ! 0\n    pow i =\n      if i == 0\n      then 1\n      else if odd i\n      then gf28Mult (n, sq (pow (i >> 1)))\n      else sq (pow (i >> 1))\ngf28Inverse : GF28 -> GF28\ngf28Inverse x = gf28Pow (x, 254)\ngf28DotProduct : {n} (fin n) => ([n]GF28, [n]GF28) -> GF28\ngf28DotProduct (xs, ys) =\n  gf28Add [gf28Mult (x, y) | x <- xs | y <- ys]\ngf28VectorMult : {n, m}\n  (fin n) =>\n    ([n]GF28, [m][n]GF28) -> [m]GF28\ngf28VectorMult (v, ms) = [gf28DotProduct (v, m) | m <- ms]\ngf28MatrixMult : {n, m, k}\n  (fin m) =>\n    ([n][m]GF28, [m][k]GF28) -> [n][k]GF28\ngf28MatrixMult (xss, yss) =\n  [gf28VectorMult (xs, yss') | xs <- xss]\n  where\n    yss' = transpose yss\nxformByte' : GF28 -> GF28\nxformByte' b =\n  gf28Add [(b >>> 2), (b >>> 5), (b >>> 7), d]\n  where\n    d = 0x05\nSubByte' : GF28 -> GF28\nSubByte' b = sbox @ b\nSubBytes : State -> State\nSubBytes state = [[SubByte' b | b <- row] | row <- state]\nInvSubByte : GF28 -> GF28\nInvSubByte b = gf28Inverse (xformByte' b)\nInvSubBytes : State -> State\nInvSubBytes state = [[InvSubByte b | b <- row] | row <- state]\nShiftRows : State -> State\nShiftRows state =\n  [row <<< shiftAmount | row <- state\n                       | shiftAmount <- [0 .. 3]]\nInvShiftRows : State -> State\nInvShiftRows state =\n  [row >>> shiftAmount | row <- state\n                       | shiftAmount <- [0 .. 3]]\nMixColumns : State -> State\nMixColumns state =\n  gf28MatrixMult (m, state)\n  where\n    m = [[2, 3, 1, 1], [1, 2, 3, 1], [1, 1, 2, 3], [3, 1, 1, 2]]\nInvMixColumns : State -> State\nInvMixColumns state =\n  gf28MatrixMult (m, state)\n  where\n    m =\n      [[0x0e, 0x0b, 0x0d, 0x09],\n      [0x09, 0x0e, 0x0b, 0x0d],\n      [0x0d, 0x09, 0x0e, 0x0b],\n      [0x0b, 0x0d, 0x09, 0x0e]]\nAddRoundKey : (RoundKey, State) -> State\nAddRoundKey (rk, s) = rk ^ s\nRcon : [8] -> [4]GF28\nRcon i = [(gf28Pow (<| x |>, i - 1)), 0, 0, 0]\nSubWord : [4]GF28 -> [4]GF28\nSubWord bs = [SubByte' b | b <- bs]\nRotWord : [4]GF28 -> [4]GF28\nRotWord [a0, a1, a2, a3] = [a1, a2, a3, a0]\nNextWord : ([8], [4][8], [4][8]) -> [4][8]\nNextWord (i, prev, old) =\n  old ^ mask\n  where\n    mask =\n      if i % `Nk == 0\n      then SubWord (RotWord (prev)) ^ Rcon (i \/ `Nk)\n      else if (`Nk > 6) \/\\ (i % `Nk == 4) then SubWord (prev) else prev\nExpandKeyForever : [Nk][4][8] -> [inf]RoundKey\nExpandKeyForever seed =\n  [transpose g | g <- groupBy`{4} (keyWS seed)]\nkeyWS : [Nk][4][8] -> [inf][4][8]\nkeyWS seed =\n  xs\n  where\n    xs =\n      seed # [NextWord (i, prev, old) | i <- [`Nk ...]\n                                      | prev <- drop`{Nk - 1} xs\n                                      | old <- xs]\nExpandKey : [AESKeySize] -> KeySchedule\nExpandKey key =\n  (keys @ 0, keys @@ [1 .. (Nr - 1)], keys @ `Nr)\n  where\n    seed : [Nk][4][8]\n    seed = split (split key)\n    keys = ExpandKeyForever seed\nAESRound : (RoundKey, State) -> State\nAESRound (rk, s) =\n  AddRoundKey (rk, MixColumns (ShiftRows (SubBytes s)))\nAESFinalRound : (RoundKey, State) -> State\nAESFinalRound (rk, s) = AddRoundKey (rk, ShiftRows (SubBytes s))\nAESInvRound : (RoundKey, State) -> State\nAESInvRound (rk, s) =\n  InvMixColumns (AddRoundKey (rk, InvSubBytes (InvShiftRows s)))\nAESFinalInvRound : (RoundKey, State) -> State\nAESFinalInvRound (rk, s) =\n  AddRoundKey (rk, InvSubBytes (InvShiftRows s))\nmsgToState : [128] -> State\nmsgToState msg = transpose (split (split msg))\nstateToMsg : State -> [128]\nstateToMsg st = join (join (transpose st))\naesEncrypt : ([128], [AESKeySize]) -> [128]\naesEncrypt (pt, key) =\n  stateToMsg (AESFinalRound (kFinal, rounds ! 0))\n  where\n    (kInit, ks, kFinal) = ExpandKey key\n    state0 = AddRoundKey (kInit, msgToState pt)\n    rounds = [state0] # [AESRound (rk, s) | rk <- ks | s <- rounds]\naesDecrypt : ([128], [AESKeySize]) -> [128]\naesDecrypt (ct, key) =\n  stateToMsg (AESFinalInvRound (kFinal, rounds ! 0))\n  where\n    (kFinal, ks, kInit) = ExpandKey key\n    state0 = AddRoundKey (kInit, msgToState ct)\n    rounds =\n      [state0] # [AESInvRound (rk, s) | rk <- reverse ks\n                                      | s <- rounds]\nsbox : [256]GF28\nsbox =\n  [0x63,\n  0x7c,\n  0x77,\n  0x7b,\n  0xf2,\n  0x6b,\n  0x6f,\n  0xc5,\n  0x30,\n  0x01,\n  0x67,\n  0x2b,\n  0xfe,\n  0xd7,\n  0xab,\n  0x76,\n  0xca,\n  0x82,\n  0xc9,\n  0x7d,\n  0xfa,\n  0x59,\n  0x47,\n  0xf0,\n  0xad,\n  0xd4,\n  0xa2,\n  0xaf,\n  0x9c,\n  0xa4,\n  0x72,\n  0xc0,\n  0xb7,\n  0xfd,\n  0x93,\n  0x26,\n  0x36,\n  0x3f,\n  0xf7,\n  0xcc,\n  0x34,\n  0xa5,\n  0xe5,\n  0xf1,\n  0x71,\n  0xd8,\n  0x31,\n  0x15,\n  0x04,\n  0xc7,\n  0x23,\n  0xc3,\n  0x18,\n  0x96,\n  0x05,\n  0x9a,\n  0x07,\n  0x12,\n  0x80,\n  0xe2,\n  0xeb,\n  0x27,\n  0xb2,\n  0x75,\n  0x09,\n  0x83,\n  0x2c,\n  0x1a,\n  0x1b,\n  0x6e,\n  0x5a,\n  0xa0,\n  0x52,\n  0x3b,\n  0xd6,\n  0xb3,\n  0x29,\n  0xe3,\n  0x2f,\n  0x84,\n  0x53,\n  0xd1,\n  0x00,\n  0xed,\n  0x20,\n  0xfc,\n  0xb1,\n  0x5b,\n  0x6a,\n  0xcb,\n  0xbe,\n  0x39,\n  0x4a,\n  0x4c,\n  0x58,\n  0xcf,\n  0xd0,\n  0xef,\n  0xaa,\n  0xfb,\n  0x43,\n  0x4d,\n  0x33,\n  0x85,\n  0x45,\n  0xf9,\n  0x02,\n  0x7f,\n  0x50,\n  0x3c,\n  0x9f,\n  0xa8,\n  0x51,\n  0xa3,\n  0x40,\n  0x8f,\n  0x92,\n  0x9d,\n  0x38,\n  0xf5,\n  0xbc,\n  0xb6,\n  0xda,\n  0x21,\n  0x10,\n  0xff,\n  0xf3,\n  0xd2,\n  0xcd,\n  0x0c,\n  0x13,\n  0xec,\n  0x5f,\n  0x97,\n  0x44,\n  0x17,\n  0xc4,\n  0xa7,\n  0x7e,\n  0x3d,\n  0x64,\n  0x5d,\n  0x19,\n  0x73,\n  0x60,\n  0x81,\n  0x4f,\n  0xdc,\n  0x22,\n  0x2a,\n  0x90,\n  0x88,\n  0x46,\n  0xee,\n  0xb8,\n  0x14,\n  0xde,\n  0x5e,\n  0x0b,\n  0xdb,\n  0xe0,\n  0x32,\n  0x3a,\n  0x0a,\n  0x49,\n  0x06,\n  0x24,\n  0x5c,\n  0xc2,\n  0xd3,\n  0xac,\n  0x62,\n  0x91,\n  0x95,\n  0xe4,\n  0x79,\n  0xe7,\n  0xc8,\n  0x37,\n  0x6d,\n  0x8d,\n  0xd5,\n  0x4e,\n  0xa9,\n  0x6c,\n  0x56,\n  0xf4,\n  0xea,\n  0x65,\n  0x7a,\n  0xae,\n  0x08,\n  0xba,\n  0x78,\n  0x25,\n  0x2e,\n  0x1c,\n  0xa6,\n  0xb4,\n  0xc6,\n  0xe8,\n  0xdd,\n  0x74,\n  0x1f,\n  0x4b,\n  0xbd,\n  0x8b,\n  0x8a,\n  0x70,\n  0x3e,\n  0xb5,\n  0x66,\n  0x48,\n  0x03,\n  0xf6,\n  0x0e,\n  0x61,\n  0x35,\n  0x57,\n  0xb9,\n  0x86,\n  0xc1,\n  0x1d,\n  0x9e,\n  0xe1,\n  0xf8,\n  0x98,\n  0x11,\n  0x69,\n  0xd9,\n  0x8e,\n  0x94,\n  0x9b,\n  0x1e,\n  0x87,\n  0xe9,\n  0xce,\n  0x55,\n  0x28,\n  0xdf,\n  0x8c,\n  0xa1,\n  0x89,\n  0x0d,\n  0xbf,\n  0xe6,\n  0x42,\n  0x68,\n  0x41,\n  0x99,\n  0x2d,\n  0x0f,\n  0xb0,\n  0x54,\n  0xbb,\n  0x16]\n\/* pragma AESCorrect : property *\/\nAESCorrect msg key =\n  aesDecrypt (aesEncrypt (msg, key), key) == msg\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/016_range.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias `Dom n = {lo : [n], sz : [n]}` and the functions `interval : {n} (fin n) => [n] -> [n] -> Dom n` and `range : {n} (fin n) => [n] -> [n] -> Dom n` where `interval l s = {lo = l, sz = s}` and `range lo hi = interval lo (hi - lo)`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nrange : {n} (fin n) => [n] -> [n] -> Dom n\nrange lo hi = interval lo (hi - lo)\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/018_mem.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type `Dom n = { lo : [n], sz : [n] }` and the function `mem : {n} (fin n) => Dom n -> [n] -> Bit` with body `mem a x = x - a.lo <= a.sz`, and add a property that verifies `mem` correctly characterizes whether a value `x` lies within the half-open interval starting at `a.lo` of length `a.sz` over `[n]` using modular arithmetic."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/020_umem.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `umem : {n} (fin n) => ([n], [n]) -> [n] -> Bit` that returns `True` exactly when its third argument lies within the inclusive unsigned range given by the first two arguments, implementing the condition `lo <= x \/\\, x <= hi`."},{"role":"assistant","content":"```cryptol\numem : {n} (fin n) => ([n], [n]) -> [n] -> Bit\numem (lo, hi) x = lo <= x \/\\ x <= hi\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/022_smem.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `smem : {n} (fin n, n >= 1) => ([n], [n]) -> [n] -> Bit` that returns `True` exactly when its third argument lies between the given low and high bounds (inclusive) using unsigned comparison (`<=$`)."},{"role":"assistant","content":"```cryptol\nsmem : {n} (fin n, n >= 1) => ([n], [n]) -> [n] -> Bit\nsmem (lo, hi) x = lo <=$ x \/\\ x <=$ hi\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/024_top.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias `Dom n = {lo : [n], sz : [n]}`, the function `interval : {n} (fin n) => [n] -> [n] -> Dom n` with `interval l s = {lo = l, sz = s}`, and the constant `top : {n} (fin n) => Dom n` defined as `top = interval 0 (~0)`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\ntop : {n} (fin n) => Dom n\ntop = interval 0 (~0)\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/028_isSingleton.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the record type `Dom n = {lo : [n], sz : [n]}` and the function `isSingleton : {n} (fin n) => Dom n -> Bit` such that `isSingleton a = a.sz == 0`, which returns `True` exactly when the domain has singleton size."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nisSingleton : {n} (fin n) => Dom n -> Bit\nisSingleton a = a.sz == 0\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/034_rbounds.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type `Dom n = {lo : [n], sz : [n]}` and the function `rbounds : {n} (fin n, n >= 1) => Dom n -> ([n], [n])` as given, and include properties that specify and can verify the intended behavior of `rbounds` for all valid inputs (e.g., handling cases where `a.lo == 0`, `a_hi == 0`, and `a_hi < a.lo`)."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nrbounds : {n} (fin n, n >= 1) => Dom n -> ([n], [n])\nrbounds a =\n  if a.lo == 0\n  then (a_hi, 1)\n  else if a_hi == 0\n  then (-1, a.lo)\n  else if a_hi < a.lo then (-1, 1) else (a_hi, a.lo)\n  where\n    a_hi = a.lo + a.sz\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/036_overlap.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias `Dom n = { lo : [n], sz : [n] }` and the function `overlap : {n} (fin n) => Dom n -> Dom n -> Bit` that returns whether two such intervals overlap, using the condition `diff <= b.sz \\\/ carry diff a.sz` where `diff = a.lo - b.lo`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\noverlap : {n} (fin n) => Dom n -> Dom n -> Bit\noverlap a b =\n  diff <= b.sz \\\/ carry diff a.sz\n  where\n    diff = a.lo - b.lo\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/048_trunc.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the types `Dom`, the helper functions `mask` and `interval`, the constant `top`, and the function `trunc : {m, n} (fin m, fin n) => Dom (m + n) -> Dom n` which truncates a (m+n)-bit interval domain to its low n bits by either returning `top` when the size exceeds `mask` for width `n`, or returning an `interval` with `drop`ped low and size fields otherwise."},{"role":"assistant","content":"```cryptol\nmask : {i, n} (fin n, n >= i) => [n]\nmask = 0 # (~0 : [i])\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\ntop : {n} (fin n) => Dom n\ntop = interval 0 (~0)\ntrunc : {m, n} (fin m, fin n) => Dom (m + n) -> Dom n\ntrunc a =\n  if a.sz > mask`{n}\n  then top\n  else interval (drop`{m} a.lo) (drop`{m} a.sz)\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/052_neg.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type alias `Dom n = {lo : [n], sz : [n]}`, the function `interval : {n} (fin n) => [n] -> [n] -> Dom n` that constructs a domain from a lower bound and size, and the function `neg : {n} (fin n) => Dom n -> Dom n` that returns the negation of a domain as `interval (-(a.lo + a.sz)) a.sz` for input `a` of type `Dom n`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nneg : {n} (fin n) => Dom n -> Dom n\nneg a = interval (-(a.lo + a.sz)) a.sz\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/054_bnot.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define in Cryptol the type Dom, the function interval, and the function bnot : {n} (fin n) => Dom n -> Dom n that maps an interval\u2019s domain to its bitwise complement by computing the new lower bound as (~(a.lo + a.sz)) while preserving the original size, matching the given behavior."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nbnot : {n} (fin n) => Dom n -> Dom n\nbnot a = interval (~ah) a.sz where ah = a.lo + a.sz\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/062_scaleRange.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `scaleRange : {m, n} (fin m, fin n, m >= 1, n >= 1) => [m] -> ([n], [n]) -> ([m + n], [m + n])` that multiplies a signed scalar `k` by a signed range `(lo, hi)` using sign extension (`sext`) and returns the scaled range in the correct order depending on the sign of `k`."},{"role":"assistant","content":"```cryptol\nscaleRange : {m, n}\n  (fin m, fin n, m >= 1, n >= 1) =>\n    [m] -> ([n], [n]) -> ([m + n], [m + n])\nscaleRange k (lo, hi) =\n  if k <$ 0 then (hi', lo') else (lo', hi')\n  where\n    lo' = sext k * sext lo\n    hi' = sext k * sext hi\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/082_ult.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type `Dom n = {lo : [n], sz : [n]}`, the function `ubounds : {n} (fin n) => Dom n -> ([n], [n])` with the same semantics using `carry`, and the function `ult : {n} (fin n) => Dom n -> Dom n -> Bit` that returns `True` when the upper bound of `a` is strictly less than the lower bound of `b`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nult : {n} (fin n) => Dom n -> Dom n -> Bit\nult a b = (ubounds a).1 < (ubounds b).0\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/084_ule.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the types, functions, and properties needed to model the unsigned interval domain `Dom n = {lo : [n], sz : [n]}`, implement `ubounds : {n} (fin n) => Dom n -> ([n], [n])` and `ule : {n} (fin n) => Dom n -> Dom n -> Bit` as an unsigned-less-or-equal comparison based on `ubounds`, and include a property that checks `ule` agrees with comparing the upper bound of the first domain to the lower bound of the second for all `Dom n` values."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nule : {n} (fin n) => Dom n -> Dom n -> Bit\nule a b = (ubounds a).1 <= (ubounds b).0\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/090_ult_sum_common_equiv.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type Dom n = {lo : [n], sz : [n]}, the helper functions mask : {i, n} (fin n, n >= i) => [n] and ubounds : {n} (fin n) => Dom n -> ([n], [n]), and the property ult_sum_common_equiv : {n} (fin n) => Dom n -> Dom n -> Dom n -> Bit that checks when three wrapped intervals defined by these domains have equivalent unsigned-less-than sum behavior."},{"role":"assistant","content":"```cryptol\nmask : {i, n} (fin n, n >= i) => [n]\nmask = 0 # (~0 : [i])\ntype Dom n = {lo : [n], sz : [n]}\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nult_sum_common_equiv : {n}\n  (fin n) =>\n    Dom n -> Dom n -> Dom n -> Bit\nult_sum_common_equiv a b c =\n  if al == ah \/\\ bl == bh \/\\ al == bl\n  then True\n  else if ~(carry cl c.sz)\n  then check_same_wrap_interval cl ch\n  else check_same_wrap_interval cl\n    mask`{n} \/\\ check_same_wrap_interval 0 ch\n  where\n    (cl, ch) = (c.lo, c.lo + c.sz)\n    (al, ah) = ubounds a\n    (bl, bh) = ubounds b\n    check_same_wrap_interval lo hi =\n      ~(carry ah hi) \/\\ ~(carry bh hi) \\\/ carry al lo \/\\ carry bl lo\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/092_unknowns.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type alias `Dom n = {lo : [n], sz : [n]}`, the function `fillright : {n} (fin n, n >= 1) => [n] -> [n]` implemented as `fillright x = tail (scanl (||) False x)`, and the function `unknowns : {n} (fin n, n >= 1) => Dom n -> [n]` implemented as `unknowns a = if carry a.lo a.sz then ~0 else bits` with `bits = fillright diff` and `diff = a.lo ^ (a.lo + a.sz)`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nunknowns : {n} (fin n, n >= 1) => Dom n -> [n]\nunknowns a =\n  if carry a.lo a.sz then ~0 else bits\n  where\n    bits = fillright diff\n    diff = a.lo ^ (a.lo + a.sz)\nfillright : {n} (fin n, n >= 1) => [n] -> [n]\nfillright x = tail (scanl (||) False x)\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/098_fillright_equiv.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the functions fillright and fillright_alt as given, and a property fillright_equiv stating that for 16-bit inputs x, fillright`{16} x == fillright_alt x holds for all x."},{"role":"assistant","content":"```cryptol\nfillright : {n} (fin n, n >= 1) => [n] -> [n]\nfillright x = tail (scanl (||) False x)\nfillright_alt : {n} (fin n, n >= 1) => [n] -> [n]\nfillright_alt x = x || ((1 << lg2 x) - 1)\n\/* pragma fillright_equiv : property *\/\nfillright_equiv x = fillright`{16} x == fillright_alt x\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/133_correct_mulRange.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the functions smin, smax, smem, scaleRange, and mulRange with the given polymorphic signed comparison and range semantics, and define the property correct_mulRange that states: for all inputs a, b, x, y, if x is in range a and y is in range b (using smem), then the signed product sext x * sext y lies within the range produced by mulRange a b."},{"role":"assistant","content":"```cryptol\nsmin : {a} (SignedCmp a) => a -> a -> a\nsmin x y = if x <$ y then x else y\nsmax : {a} (SignedCmp a) => a -> a -> a\nsmax x y = if x >$ y then x else y\nsmem : {n} (fin n, n >= 1) => ([n], [n]) -> [n] -> Bit\nsmem (lo, hi) x = lo <=$ x \/\\ x <=$ hi\nmulRange : {m, n}\n  (fin m, fin n, m >= 1, n >= 1) =>\n    ([m], [m]) -> ([n], [n]) -> ([m + n], [m + n])\nmulRange (xl, xh) (yl, yh) =\n  (zl, zh)\n  where\n    (xlyl, xlyh) = scaleRange xl (yl, yh)\n    (xhyl, xhyh) = scaleRange xh (yl, yh)\n    zl = smin xlyl xhyl\n    zh = smax xlyh xhyh\nscaleRange : {m, n}\n  (fin m, fin n, m >= 1, n >= 1) =>\n    [m] -> ([n], [n]) -> ([m + n], [m + n])\nscaleRange k (lo, hi) =\n  if k <$ 0 then (hi', lo') else (lo', hi')\n  where\n    lo' = sext k * sext lo\n    hi' = sext k * sext hi\ncorrect_mulRange : {n}\n  (fin n, n >= 1) =>\n    ([n], [n]) -> ([n], [n]) -> [n] -> [n] -> Bit\ncorrect_mulRange a b x y =\n  smem a x ==> smem b y ==> smem (mulRange a b) (sext x * sext y)\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/169_p1.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines a type alias `Dom n = {lo : [n], sz : [n]}`, functions `interval`, `mem`, and `top` as given, along with a function `correct_top : {n} (fin n) => [n] -> Bit` and a property `p1` asserting that `correct_top` instantiated at `n = 16` holds for all 16-bit inputs."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\ntop : {n} (fin n) => Dom n\ntop = interval 0 (~0)\ncorrect_top : {n} (fin n) => [n] -> Bit\ncorrect_top x = mem top x\n\/* pragma p1 : property *\/\np1 = correct_top`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/170_p2.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type Dom n = {lo : [n], sz : [n]}, the functions mem, umem, ubounds, correct_ubounds as given, and the property p2 : property that instantiates correct_ubounds at width 16 (p2 = correct_ubounds`{16}) so it can be checked by a SAT solver."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\numem : {n} (fin n) => ([n], [n]) -> [n] -> Bit\numem (lo, hi) x = lo <= x \/\\ x <= hi\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\ncorrect_ubounds : {n} (fin n) => Dom n -> [n] -> Bit\ncorrect_ubounds a x = mem a x ==> umem (ubounds a) x\n\/* pragma p2 : property *\/\np2 = correct_ubounds`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/171_p3.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the types and functions Dom, interval, mem, smem, ubounds, sbounds, and correct_sbounds as in the excerpt, and declare the property p3 : property that instantiates correct_sbounds at word size 16 (i.e., p3 = correct_sbounds`{16})."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nsmem : {n} (fin n, n >= 1) => ([n], [n]) -> [n] -> Bit\nsmem (lo, hi) x = lo <=$ x \/\\ x <=$ hi\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nsbounds : {n} (fin n, n >= 1) => Dom n -> ([n], [n])\nsbounds a =\n  (lo - delta, hi - delta)\n  where\n    delta = reverse 1\n    (lo, hi) = ubounds (interval (a.lo + delta) a.sz)\ncorrect_sbounds : {n} (fin n, n >= 1) => Dom n -> [n] -> Bit\ncorrect_sbounds a x = mem a x ==> smem (sbounds a) x\n\/* pragma p3 : property *\/\np3 = correct_sbounds`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/173_p5.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type Dom n = {lo : [n], sz : [n]}, the functions mem, overlap, and correct_overlap as given, and the property p5 : property that instantiates correct_overlap at width 16, so that p5 asserts for all 16-bit domains a, b and 16-bit value x that if x is in both a and b (via mem) then a and b must overlap (via overlap)."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\noverlap : {n} (fin n) => Dom n -> Dom n -> Bit\noverlap a b =\n  diff <= b.sz \\\/ carry diff a.sz\n  where\n    diff = a.lo - b.lo\ncorrect_overlap : {n} (fin n) => Dom n -> Dom n -> [n] -> Bit\ncorrect_overlap a b x = mem a x ==> mem b x ==> overlap a b\n\/* pragma p5 : property *\/\np5 = correct_overlap`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/174_p5_inv.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type Dom n = {lo : [n], sz : [n]}, the functions mem : {n} (fin n) => Dom n -> [n] -> Bit, overlap : {n} (fin n) => Dom n -> Dom n -> Bit, correct_overlap_inv : {n} (fin n) => Dom n -> Dom n -> Bit as in the given semantics over integer-like n-bit words, and the property p5_inv : property asserting correct_overlap_inv`{16} holds for all Dom 16 values."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\noverlap : {n} (fin n) => Dom n -> Dom n -> Bit\noverlap a b =\n  diff <= b.sz \\\/ carry diff a.sz\n  where\n    diff = a.lo - b.lo\ncorrect_overlap_inv : {n} (fin n) => Dom n -> Dom n -> Bit\ncorrect_overlap_inv a b =\n  overlap a b ==> (mem a witness \/\\ mem b witness)\n  where\n    witness = if mem a b.lo then b.lo else a.lo\n\/* pragma p5_inv : property *\/\np5_inv = correct_overlap_inv`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/177_p8.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the types, functions, and property needed to model unsigned intervals `Dom n`, membership `mem`, unsigned and signed bounds (`ubounds`, `sbounds`), sign-extension of an interval `sign_ext`, and the property `p8 : property` that states `correct_sign_ext {32,16} a x` holds (i.e., for all `a` and `x`, if `x` is in `a` then `sext x` is in `sign_ext a`)."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nsbounds : {n} (fin n, n >= 1) => Dom n -> ([n], [n])\nsbounds a =\n  (lo - delta, hi - delta)\n  where\n    delta = reverse 1\n    (lo, hi) = ubounds (interval (a.lo + delta) a.sz)\nsign_ext : {m, n} (fin m, m >= n, n >= 1) => Dom n -> Dom m\nsign_ext a =\n  interval (sext lo) (zext (hi - lo))\n  where\n    (lo, hi) = sbounds a\ncorrect_sign_ext : {m, n}\n  (fin m, m >= n, n >= 1) =>\n    Dom n -> [n] -> Bit\ncorrect_sign_ext a x =\n  mem a x ==> mem (sign_ext`{m} a) (sext`{m} x)\n\/* pragma p8 : property *\/\np8 = correct_sign_ext`{32, 16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/180_p11.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the types and functions `mask : {i, n} (fin n, n >= i) => [n]`, `type Dom n = {lo : [n], sz : [n]}`, `interval : {n} (fin n) => [n] -> [n] -> Dom n`, `mem : {n} (fin n) => Dom n -> [n] -> Bit`, `top : {n} (fin n) => Dom n`, `trunc : {m, n} (fin m, fin n) => Dom (m + n) -> Dom n`, and a property `p11 : {m, n} (fin m, fin n) => Dom (m + n) -> [m + n] -> Bit` stating that `correct_trunc a x = mem a x ==> mem (trunc`{m} a) (drop`{m} x)` holds, then instantiate this property as `p11 = correct_trunc`{8, 8}."},{"role":"assistant","content":"```cryptol\nmask : {i, n} (fin n, n >= i) => [n]\nmask = 0 # (~0 : [i])\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\ntop : {n} (fin n) => Dom n\ntop = interval 0 (~0)\ntrunc : {m, n} (fin m, fin n) => Dom (m + n) -> Dom n\ntrunc a =\n  if a.sz > mask`{n}\n  then top\n  else interval (drop`{m} a.lo) (drop`{m} a.sz)\ncorrect_trunc : {m, n}\n  (fin m, fin n) =>\n    Dom (m + n) -> [m + n] -> Bit\ncorrect_trunc a x = mem a x ==> mem (trunc`{m} a) (drop`{m} x)\n\/* pragma p11 : property *\/\np11 = correct_trunc`{8, 8}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/181_p12.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type Dom n = {lo : [n], sz : [n]}, the functions mem, unknowns, and fillright as given, the predicate correct_unknowns : {n} (fin n, n >= 1) => Dom n -> [n] -> [n] -> Bit capturing that (x || unknowns a) equals (y || unknowns a) whenever x and y are in the interval represented by a, and a property p12 : property that instantiates correct_unknowns at n = 16."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nunknowns : {n} (fin n, n >= 1) => Dom n -> [n]\nunknowns a =\n  if carry a.lo a.sz then ~0 else bits\n  where\n    bits = fillright diff\n    diff = a.lo ^ (a.lo + a.sz)\nfillright : {n} (fin n, n >= 1) => [n] -> [n]\nfillright x = tail (scanl (||) False x)\ncorrect_unknowns : {n}\n  (fin n, n >= 1) =>\n    Dom n -> [n] -> [n] -> Bit\ncorrect_unknowns a x y =\n  mem a x ==> mem a y ==> (x || unknowns a) == (y || unknowns a)\n\/* pragma p12 : property *\/\np12 = correct_unknowns`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/182_p13.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the `Dom` type and the functions `interval`, `singleton`, `isSingleton`, and the property `correct_isSingleton`, and then instantiate this property as `p13 = correct_isSingleton` specialized to 16-bit words, so that `p13` can be checked as a property."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nsingleton : {n} (fin n) => [n] -> Dom n\nsingleton x = interval x 0\nisSingleton : {n} (fin n) => Dom n -> Bit\nisSingleton a = a.sz == 0\ncorrect_isSingleton : {n} (fin n) => Dom n -> Bit\ncorrect_isSingleton a = isSingleton a ==> a == singleton a.lo\n\/* pragma p13 : property *\/\np13 = correct_isSingleton`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/184_a2.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, write the necessary definitions and a property so that `a2 : property` specializes `correct_neg` to 16-bit words, where `Dom n` is a record `{lo : [n], sz : [n]}`, `interval : {n} (fin n) => [n] -> [n] -> Dom n`, `mem : {n} (fin n) => Dom n -> [n] -> Bit` is defined as `mem a x = x - a.lo <= a.sz`, `neg : {n} (fin n) => Dom n -> Dom n` is defined as `neg a = interval (-(a.lo + a.sz)) a.sz`, `<==> : Bit -> Bit -> Bit` is logical equivalence defined as `(==)`, and `correct_neg : {n} (fin n) => Dom n -> [n] -> Bit` asserts `mem a x <==> mem (neg a) (-x)`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nneg : {n} (fin n) => Dom n -> Dom n\nneg a = interval (-(a.lo + a.sz)) a.sz\n(<==>) : Bit -> Bit -> Bit\n(<==>) = (==)\ncorrect_neg : {n} (fin n) => Dom n -> [n] -> Bit\ncorrect_neg a x = mem a x <==> mem (neg a) (-x)\n\/* pragma a2 : property *\/\na2 = correct_neg`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/186_a4.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the type Dom, the functions interval, range, mem, ubounds, and udiv as in an unsigned interval arithmetic domain over n-bit words, and define the property a4 : property that instantiates correct_udiv at width 8, where correct_udiv states that for all a, b : Dom n and x, y : [n], if x and y are in their respective domains and y \u2260 0, then x \/ y is in the domain udiv a b."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nrange : {n} (fin n) => [n] -> [n] -> Dom n\nrange lo hi = interval lo (hi - lo)\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nudiv : {n} (fin n, n >= 1) => Dom n -> Dom n -> Dom n\nudiv a b =\n  range cl ch\n  where\n    (al, ah) = ubounds a\n    (bl, bh) = ubounds b\n    bl' = max 1 bl\n    bh' = max 1 bh\n    cl = al \/ bh'\n    ch = ah \/ bl'\ncorrect_udiv : {n}\n  (fin n, n >= 1) =>\n    Dom n -> Dom n -> [n] -> [n] -> Bit\ncorrect_udiv a b x y =\n  mem a x ==> mem b y ==> y != 0 ==> mem (udiv a b) (x \/ y)\n\/* pragma a4 : property *\/\na4 = correct_udiv`{8}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/187_a5.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the Dom type and the functions interval, range, mem, ubounds, and urem as interval-domain operations over n-bit unsigned integers, and includes the property a5 : property asserting that for n = 6, correct_urem (stating that for all x, y, if x is in Dom a, y is in Dom b, and y != 0, then x % y is in Dom (urem a b)) holds for all Dom 6 inputs a and b and all 6-bit values x and y."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nrange : {n} (fin n) => [n] -> [n] -> Dom n\nrange lo hi = interval lo (hi - lo)\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nurem : {n} (fin n, n >= 1) => Dom n -> Dom n -> Dom n\nurem a b =\n  if ql == qh then range rl rh else interval 0 (bh - 1)\n  where\n    (al, ah) = ubounds a\n    (bl, bh) = ubounds b\n    bl' = max 1 bl\n    bh' = max 1 bh\n    (ql, rl) = (al \/ bh', al % bh')\n    (qh, rh) = (ah \/ bl', ah % bl')\ncorrect_urem : {n}\n  (fin n, n >= 1) =>\n    Dom n -> Dom n -> [n] -> [n] -> Bit\ncorrect_urem a b x y =\n  mem a x ==> mem b y ==> y != 0 ==> mem (urem a b) (x % y)\n\/* pragma a5 : property *\/\na5 = correct_urem`{6}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/190_a8.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the types, functions, and property needed so that `type Dom n = {lo : [n], sz : [n]}`, `interval`, `mem`, `bnot`, logical equivalence `(<==>)`, and the property `a8 : property` together specify and prove for 16-bit words that `correct_bnot a x = mem a x <==> mem (bnot a) (~x)` holds for all domains `a` and values `x`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nbnot : {n} (fin n) => Dom n -> Dom n\nbnot a = interval (~ah) a.sz where ah = a.lo + a.sz\n(<==>) : Bit -> Bit -> Bit\n(<==>) = (==)\ncorrect_bnot : {n} (fin n) => Dom n -> [n] -> Bit\ncorrect_bnot a x = mem a x <==> mem (bnot a) (~x)\n\/* pragma a8 : property *\/\na8 = correct_bnot`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/193_s2.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the Dom type and the functions interval, mem, ubounds, and lshr over n-bit words, together with the property correct_lshr : {n} (fin n) => Dom n -> Dom n -> [n] -> [n] -> Bit stating that if x is in domain a and y is in domain b, then x >> y is in domain lshr a b, and finally instantiate this property as s2 = correct_lshr`{8}."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nlshr : {n} (fin n) => Dom n -> Dom n -> Dom n\nlshr a b =\n  interval cl (ch - cl)\n  where\n    (al, ah) = ubounds a\n    (bl, bh) = ubounds b\n    cl = al >> bh\n    ch = ah >> bl\ncorrect_lshr : {n} (fin n) => Dom n -> Dom n -> [n] -> [n] -> Bit\ncorrect_lshr a b x y =\n  mem a x ==> mem b y ==> mem (lshr a b) (x >> y)\n\/* pragma s2 : property *\/\ns2 = correct_lshr`{8}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/194_s3.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the Dom type and the interval, mem, ubounds, sbounds, and ashr functions for n-bit arithmetic domains, and a property correct_ashr : {n} (fin n, n >= 1) => Dom n -> Dom n -> [n] -> [n] -> Bit that states: if x is in a and y is in b, then x >>$ y is in ashr a b, and then instantiate this property as s3 = correct_ashr`{8}."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nsbounds : {n} (fin n, n >= 1) => Dom n -> ([n], [n])\nsbounds a =\n  (lo - delta, hi - delta)\n  where\n    delta = reverse 1\n    (lo, hi) = ubounds (interval (a.lo + delta) a.sz)\nashr : {n} (fin n, n >= 1) => Dom n -> Dom n -> Dom n\nashr a b =\n  interval cl (ch - cl)\n  where\n    (al, ah) = sbounds a\n    (bl, bh) = ubounds b\n    cl = al >>$ (if al <$ 0 then bl else bh)\n    ch = ah >>$ (if ah <$ 0 then bh else bl)\ncorrect_ashr : {n}\n  (fin n, n >= 1) =>\n    Dom n -> Dom n -> [n] -> [n] -> Bit\ncorrect_ashr a b x y =\n  mem a x ==> mem b y ==> mem (ashr a b) (x >>$ y)\n\/* pragma s3 : property *\/\ns3 = correct_ashr`{8}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/195_o1.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the domain type Dom, interval, mem, ubounds, sbounds, slt, and the property correct_slt as in the excerpt, and then instantiate o1 as the property correct_slt`{16} suitable for verification that slt correctly preserves signed less-than for all 16-bit values in the given domains."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nsbounds : {n} (fin n, n >= 1) => Dom n -> ([n], [n])\nsbounds a =\n  (lo - delta, hi - delta)\n  where\n    delta = reverse 1\n    (lo, hi) = ubounds (interval (a.lo + delta) a.sz)\nslt : {n} (fin n, n >= 1) => Dom n -> Dom n -> Bit\nslt a b = (sbounds a).1 <$ (sbounds b).0\ncorrect_slt : {n}\n  (fin n, n >= 1) =>\n    Dom n -> Dom n -> [n] -> [n] -> Bit\ncorrect_slt a b x y = slt a b ==> mem a x ==> mem b y ==> x <$ y\n\/* pragma o1 : property *\/\no1 = correct_slt`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/197_o3.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type Dom and functions mem, ubounds, and ult for n-bit intervals as in the excerpt, and then define the property o3 : property that instantiates correct_ult at n = 16, where correct_ult states that if ult a b holds and x is in a and y is in b, then x < y for all 16-bit values a, b, x, and y."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nult : {n} (fin n) => Dom n -> Dom n -> Bit\nult a b = (ubounds a).1 < (ubounds b).0\ncorrect_ult : {n}\n  (fin n, n >= 1) =>\n    Dom n -> Dom n -> [n] -> [n] -> Bit\ncorrect_ult a b x y = ult a b ==> mem a x ==> mem b y ==> x < y\n\/* pragma o3 : property *\/\no3 = correct_ult`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/198_o4.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type `Dom n = {lo : [n], sz : [n]}`, the functions `mem : {n} (fin n) => Dom n -> [n] -> Bit`, `ubounds : {n} (fin n) => Dom n -> ([n], [n])`, `ule : {n} (fin n) => Dom n -> Dom n -> Bit`, the property `correct_ule : {n} (fin n, n >= 1) => Dom n -> Dom n -> [n] -> [n] -> Bit` expressing that `ule a b` implies `x <= y` for all `x` and `y` in the respective domains, and a property instance `o4 = correct_ule` specialized to `n = 16`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\nmem : {n} (fin n) => Dom n -> [n] -> Bit\nmem a x = x - a.lo <= a.sz\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nule : {n} (fin n) => Dom n -> Dom n -> Bit\nule a b = (ubounds a).1 <= (ubounds b).0\ncorrect_ule : {n}\n  (fin n, n >= 1) =>\n    Dom n -> Dom n -> [n] -> [n] -> Bit\ncorrect_ule a b x y = ule a b ==> mem a x ==> mem b y ==> x <= y\n\/* pragma o4 : property *\/\no4 = correct_ule`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/242_i01.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the types and functions `Dom`, `interval`, `singleton`, `overlap`, and `singleton_overlap` as given, and define the property `i01` (specialized to 16-bit words) asserting that `singleton_overlap` correctly characterizes when two singleton intervals overlap, i.e., that two singletons overlap if and only if their underlying values are equal."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nsingleton : {n} (fin n) => [n] -> Dom n\nsingleton x = interval x 0\noverlap : {n} (fin n) => Dom n -> Dom n -> Bit\noverlap a b =\n  diff <= b.sz \\\/ carry diff a.sz\n  where\n    diff = a.lo - b.lo\nsingleton_overlap : {n} (fin n) => [n] -> [n] -> Bit\nsingleton_overlap x y =\n  overlap (singleton x) (singleton y) == (x == y)\n\/* pragma i01 : property *\/\ni01 = singleton_overlap`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/247_i06.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the types, functions, and property shown\u2014`mask`, `Dom`, `interval`, `top`, `singleton`, `trunc`, and `singleton_trunc`\u2014and then define the property `i06` which asserts that `singleton_trunc` holds for the specific size parameters `{8, 8}`."},{"role":"assistant","content":"```cryptol\nmask : {i, n} (fin n, n >= i) => [n]\nmask = 0 # (~0 : [i])\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\ntop : {n} (fin n) => Dom n\ntop = interval 0 (~0)\nsingleton : {n} (fin n) => [n] -> Dom n\nsingleton x = interval x 0\ntrunc : {m, n} (fin m, fin n) => Dom (m + n) -> Dom n\ntrunc a =\n  if a.sz > mask`{n}\n  then top\n  else interval (drop`{m} a.lo) (drop`{m} a.sz)\nsingleton_trunc : {m, n} (fin m, fin n) => [m + n] -> Bit\nsingleton_trunc x =\n  trunc`{m} (singleton x) == singleton (drop`{m} x)\n\/* pragma i06 : property *\/\ni06 = singleton_trunc`{8, 8}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/249_i08.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the type `Dom n = {lo : [n], sz : [n]}`, functions `interval`, `singleton`, `neg`, `singleton_neg` as in the excerpt, and the property `i08` that asserts `singleton_neg` instantiated at width 16 (i.e., `singleton_neg`{16}) holds for all 16-bit inputs, suitable for verification with a solver."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nsingleton : {n} (fin n) => [n] -> Dom n\nsingleton x = interval x 0\nneg : {n} (fin n) => Dom n -> Dom n\nneg a = interval (-(a.lo + a.sz)) a.sz\nsingleton_neg : {n} (fin n) => [n] -> Bit\nsingleton_neg x = neg (singleton x) == singleton (-x)\n\/* pragma i08 : property *\/\ni08 = singleton_neg`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/256_i15.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the Dom type and functions interval, singleton, ubounds, and lshr as interval-based bit-vector domains, and includes the property i15 asserting that for 8-bit inputs x and y, lshr (singleton x) (singleton y) equals singleton (x >> y)."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nsingleton : {n} (fin n) => [n] -> Dom n\nsingleton x = interval x 0\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nlshr : {n} (fin n) => Dom n -> Dom n -> Dom n\nlshr a b =\n  interval cl (ch - cl)\n  where\n    (al, ah) = ubounds a\n    (bl, bh) = ubounds b\n    cl = al >> bh\n    ch = ah >> bl\nsingleton_lshr : {n} (fin n) => [n] -> [n] -> Bit\nsingleton_lshr x y =\n  lshr (singleton x) (singleton y) == singleton (x >> y)\n\/* pragma i15 : property *\/\ni15 = singleton_lshr`{8}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/260_i19.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the type Dom n = {lo : [n], sz : [n]}, the functions interval, singleton, ubounds, ult, and the function singleton_ult : {n} (fin n, n >= 1) => [n] -> [n] -> Bit, and a property i19 asserting singleton_ult`{16} holds for all 16-bit inputs."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nsingleton : {n} (fin n) => [n] -> Dom n\nsingleton x = interval x 0\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nult : {n} (fin n) => Dom n -> Dom n -> Bit\nult a b = (ubounds a).1 < (ubounds b).0\nsingleton_ult : {n} (fin n, n >= 1) => [n] -> [n] -> Bit\nsingleton_ult x y = ult (singleton x) (singleton y) == (x < y)\n\/* pragma i19 : property *\/\ni19 = singleton_ult`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/261_i20.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the types, functions, and property shown here\u2014`type Dom n = {lo : [n], sz : [n]}`, `interval`, `singleton`, `ubounds`, `ule`, and `singleton_ule`\u2014and define the property `i20 : property` as the 16-bit instance `i20 = singleton_ule`{16}, so that `i20` checks that comparing singleton intervals with `ule` is equivalent to comparing their underlying 16-bit values with `<=`."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\ninterval : {n} (fin n) => [n] -> [n] -> Dom n\ninterval l s = {lo = l, sz = s}\nsingleton : {n} (fin n) => [n] -> Dom n\nsingleton x = interval x 0\nubounds : {n} (fin n) => Dom n -> ([n], [n])\nubounds a =\n  if carry a.lo a.sz then (0, ~0) else (a.lo, a.lo + a.sz)\nule : {n} (fin n) => Dom n -> Dom n -> Bit\nule a b = (ubounds a).1 <= (ubounds b).0\nsingleton_ule : {n} (fin n, n >= 1) => [n] -> [n] -> Bit\nsingleton_ule x y = ule (singleton x) (singleton y) == (x <= y)\n\/* pragma i20 : property *\/\ni20 = singleton_ule`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/276_c1.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the record type `Dom n = {lo : [n], sz : [n]}`, the function `overlap : {n} (fin n) => Dom n -> Dom n -> Bit` that detects interval overlap using the difference of `lo` fields and possible carry with `sz`, and a property `c1` (specialized to `n = 16`) stating that overlap is commutative, i.e., `comm_overlap a b = overlap a b <==> overlap b a` holds for all domains."},{"role":"assistant","content":"```cryptol\ntype Dom n = {lo : [n], sz : [n]}\noverlap : {n} (fin n) => Dom n -> Dom n -> Bit\noverlap a b =\n  diff <= b.sz \\\/ carry diff a.sz\n  where\n    diff = a.lo - b.lo\n(<==>) : Bit -> Bit -> Bit\n(<==>) = (==)\ncomm_overlap : {n} (fin n) => Dom n -> Dom n -> Bit\ncomm_overlap a b = overlap a b <==> overlap b a\n\/* pragma c1 : property *\/\nc1 = comm_overlap`{16}\n```"}]}
{"filename":"saw-script\/deps\/what4\/what4\/doc\/arithdomain\/281_c6.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines smin, smax, scaleRange, and mulRange as range operations on signed bit-vector intervals, and a property assoc_mulRange : {i, j, k} (fin i, fin j, fin k, i >= 1, j >= 1, k >= 1) => ([i], [i]) -> ([j], [j]) -> ([k], [k]) -> Bit that proves mulRange is associative over well-formed intervals (low <= high), then instantiate this as c6 = assoc_mulRange`{3,3,3}."},{"role":"assistant","content":"```cryptol\nsmin : {a} (SignedCmp a) => a -> a -> a\nsmin x y = if x <$ y then x else y\nsmax : {a} (SignedCmp a) => a -> a -> a\nsmax x y = if x >$ y then x else y\nmulRange : {m, n}\n  (fin m, fin n, m >= 1, n >= 1) =>\n    ([m], [m]) -> ([n], [n]) -> ([m + n], [m + n])\nmulRange (xl, xh) (yl, yh) =\n  (zl, zh)\n  where\n    (xlyl, xlyh) = scaleRange xl (yl, yh)\n    (xhyl, xhyh) = scaleRange xh (yl, yh)\n    zl = smin xlyl xhyl\n    zh = smax xlyh xhyh\nscaleRange : {m, n}\n  (fin m, fin n, m >= 1, n >= 1) =>\n    [m] -> ([n], [n]) -> ([m + n], [m + n])\nscaleRange k (lo, hi) =\n  if k <$ 0 then (hi', lo') else (lo', hi')\n  where\n    lo' = sext k * sext lo\n    hi' = sext k * sext hi\nassoc_mulRange : {i, j, k}\n  (fin i, fin j, fin k, i >= 1, j >= 1, k >= 1) =>\n    ([i], [i]) -> ([j], [j]) -> ([k], [k]) -> Bit\nassoc_mulRange a b c =\n  a.0 <=$ a.1 ==> b.0 <=$ b.1 ==> c.0 <=$ c.1 ==> mulRange a\n    (mulRange b c) == mulRange (mulRange a b) c\n\/* pragma c6 : property *\/\nc6 = assoc_mulRange`{3, 3, 3}\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/001_quarterround.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the Salsa20 quarterround function with the given type `quarterround : [4][32] -> [4][32]` and confirms, via a `property`, that this implementation matches the standard Salsa20 quarterround transformation defined in the original Salsa20 specification for all 4-word (32-bit each) inputs."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/006_rowround_passes_tests.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the Cryptol property `rowround_passes_tests` that asserts the Salsa20 `rowround : [16][32] -> [16][32]` function (built from `quarterround : [4][32] -> [4][32]`) produces the two given known-good 16-word outputs for the two specified 16-word test vectors, matching the standard Salsa20 test vectors."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\nrowround : [16][32] -> [16][32]\nrowround\n  [y0, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13, y14,\n   y15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [z0, z1, z2, z3] = quarterround [y0, y1, y2, y3]\n    [z5, z6, z7, z4] = quarterround [y5, y6, y7, y4]\n    [z10, z11, z8, z9] = quarterround [y10, y11, y8, y9]\n    [z15, z12, z13, z14] = quarterround [y15, y12, y13, y14]\n\/* pragma rowround_passes_tests : property *\/\nrowround_passes_tests =\n  (rowround\n    [0x00000001,\n    0x00000000,\n    0x00000000,\n    0x00000000,\n    0x00000001,\n    0x00000000,\n    0x00000000,\n    0x00000000,\n    0x00000001,\n    0x00000000,\n    0x00000000,\n    0x00000000,\n    0x00000001,\n    0x00000000,\n    0x00000000,\n    0x00000000] == [0x08008145,\n  0x00000080,\n  0x00010200,\n  0x20500000,\n  0x20100001,\n  0x00048044,\n  0x00000080,\n  0x00010000,\n  0x00000001,\n  0x00002000,\n  0x80040000,\n  0x00000000,\n  0x00000001,\n  0x00000200,\n  0x00402000,\n  0x88000100]) \/\\ (rowround\n    [0x08521bd6,\n    0x1fe88837,\n    0xbb2aa576,\n    0x3aa26365,\n    0xc54c6a5b,\n    0x2fc74c2f,\n    0x6dd39cc3,\n    0xda0a64f6,\n    0x90a2f23d,\n    0x067f95a6,\n    0x06b35f61,\n    0x41e4732e,\n    0xe859c100,\n    0xea4d84b7,\n    0x0f619bff,\n    0xbc6e965a] == [0xa890d39d,\n  0x65d71596,\n  0xe9487daa,\n  0xc8ca6a86,\n  0x949d2192,\n  0x764b7754,\n  0xe408d9b9,\n  0x7a41b4d1,\n  0x3402e183,\n  0x3c3af432,\n  0x50669f96,\n  0xd89ef0a8,\n  0x0040ede5,\n  0xb545fbce,\n  0xd257ed4f,\n  0x1818882d])\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/007_rowround_opt.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification and associated properties for the Salsa20 stream cipher\u2019s optimized rowround function, using the given quarterround definition over 32-bit words (state as [16][32]), and include a property that proves rowround_opt is functionally equivalent to the standard Salsa20 rowround transformation on the 4\u00d74 word state matrix."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\nrowround_opt : [16][32] -> [16][32]\nrowround_opt ys =\n  join\n    [(quarterround (yi <<< i)) >>> i | yi <- split ys\n                                     | i <- [0 .. 3]]\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/009_rowround_opt_is_rowround.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the functions quarterround, rowround, and rowround_opt for Salsa20 as given, and define a property rowround_opt_is_rowround : [16][32] -> Bit that states rowround ys == rowround_opt ys for all inputs ys."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\nrowround : [16][32] -> [16][32]\nrowround\n  [y0, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13, y14,\n   y15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [z0, z1, z2, z3] = quarterround [y0, y1, y2, y3]\n    [z5, z6, z7, z4] = quarterround [y5, y6, y7, y4]\n    [z10, z11, z8, z9] = quarterround [y10, y11, y8, y9]\n    [z15, z12, z13, z14] = quarterround [y15, y12, y13, y14]\nrowround_opt : [16][32] -> [16][32]\nrowround_opt ys =\n  join\n    [(quarterround (yi <<< i)) >>> i | yi <- split ys\n                                     | i <- [0 .. 3]]\n\/* pragma rowround_opt_is_rowround : property *\/\nrowround_opt_is_rowround ys = rowround ys == rowround_opt ys\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/012_columnround_passes_tests.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the Salsa20 quarterround and columnround functions over [4][32] and [16][32] words respectively, and a property columnround_passes_tests that checks columnround on the two given 16-word test vectors produces the specified 16-word outputs (bit-vectors in hex)."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\ncolumnround : [16][32] -> [16][32]\ncolumnround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [y0,\n  y1,\n  y2,\n  y3,\n  y4,\n  y5,\n  y6,\n  y7,\n  y8,\n  y9,\n  y10,\n  y11,\n  y12,\n  y13,\n  y14,\n  y15]\n  where\n    [y0, y4, y8, y12] = quarterround [x0, x4, x8, x12]\n    [y5, y9, y13, y1] = quarterround [x5, x9, x13, x1]\n    [y10, y14, y2, y6] = quarterround [x10, x14, x2, x6]\n    [y15, y3, y7, y11] = quarterround [x15, x3, x7, x11]\n\/* pragma columnround_passes_tests : property *\/\ncolumnround_passes_tests =\n  (columnround\n    [0x00000001,\n    0x00000000,\n    0x00000000,\n    0x00000000,\n    0x00000001,\n    0x00000000,\n    0x00000000,\n    0x00000000,\n    0x00000001,\n    0x00000000,\n    0x00000000,\n    0x00000000,\n    0x00000001,\n    0x00000000,\n    0x00000000,\n    0x00000000] == [0x10090288,\n  0x00000000,\n  0x00000000,\n  0x00000000,\n  0x00000101,\n  0x00000000,\n  0x00000000,\n  0x00000000,\n  0x00020401,\n  0x00000000,\n  0x00000000,\n  0x00000000,\n  0x40a04001,\n  0x00000000,\n  0x00000000,\n  0x00000000]) \/\\ (columnround\n    [0x08521bd6,\n    0x1fe88837,\n    0xbb2aa576,\n    0x3aa26365,\n    0xc54c6a5b,\n    0x2fc74c2f,\n    0x6dd39cc3,\n    0xda0a64f6,\n    0x90a2f23d,\n    0x067f95a6,\n    0x06b35f61,\n    0x41e4732e,\n    0xe859c100,\n    0xea4d84b7,\n    0x0f619bff,\n    0xbc6e965a] == [0x8c9d190a,\n  0xce8e4c90,\n  0x1ef8e9d3,\n  0x1326a71a,\n  0x90a20123,\n  0xead3c4f3,\n  0x63a091a0,\n  0xf0708d69,\n  0x789b010c,\n  0xd195a681,\n  0xeb7d5504,\n  0xa774135c,\n  0x481c2027,\n  0x53a8e4b5,\n  0x4c1f89c5,\n  0x3f78c9c8])\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/013_columnround_opt.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification for the Salsa20 cipher\u2019s optimized columnround step, including the given quarterround : [4][32] -> [4][32] and columnround_opt : [16][32] -> [16][32] functions, and define properties that show columnround_opt is functionally equivalent to the standard Salsa20 columnround transformation on 16 32-bit words."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\ncolumnround_opt : [16][32] -> [16][32]\ncolumnround_opt xs =\n  join\n    (transpose\n      [(quarterround (xi <<< i)) >>> i | xi <- transpose (split xs)\n                                       | i <- [0 .. 3]])\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/015_columnround_opt_is_columnround.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the property `columnround_opt_is_columnround` asserting that for all 16-word 32-bit input blocks `xs`, the optimized Salsa20 `columnround_opt` implementation produces the same output as the reference `columnround` function, i.e., `columnround xs == columnround_opt xs`, and structure the specification so it can be checked with Cryptol\/SawScript."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\ncolumnround : [16][32] -> [16][32]\ncolumnround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [y0,\n  y1,\n  y2,\n  y3,\n  y4,\n  y5,\n  y6,\n  y7,\n  y8,\n  y9,\n  y10,\n  y11,\n  y12,\n  y13,\n  y14,\n  y15]\n  where\n    [y0, y4, y8, y12] = quarterround [x0, x4, x8, x12]\n    [y5, y9, y13, y1] = quarterround [x5, x9, x13, x1]\n    [y10, y14, y2, y6] = quarterround [x10, x14, x2, x6]\n    [y15, y3, y7, y11] = quarterround [x15, x3, x7, x11]\ncolumnround_opt : [16][32] -> [16][32]\ncolumnround_opt xs =\n  join\n    (transpose\n      [(quarterround (xi <<< i)) >>> i | xi <- transpose (split xs)\n                                       | i <- [0 .. 3]])\ncolumnround_opt_is_columnround xs =\n  columnround xs == columnround_opt xs\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/022_littleendian_passes_tests.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function `littleendian : [4][8] -> [32]` as `littleendian b = join (reverse b)` and the property `littleendian_passes_tests` stating that it holds when `littleendian [0, 0, 0, 0] == 0x00000000`, `littleendian [86, 75, 30, 9] == 0x091e4b56`, and `littleendian [255, 255, 255, 250] == 0xfaffffff`."},{"role":"assistant","content":"```cryptol\nlittleendian : [4][8] -> [32]\nlittleendian b = join (reverse b)\n\/* pragma littleendian_passes_tests : property *\/\nlittleendian_passes_tests =\n  (littleendian [0, 0, 0, 0] == 0x00000000) \/\\ (littleendian\n    [86, 75, 30, 9] == 0x091e4b56) \/\\ (littleendian\n    [255, 255, 255, 250] == 0xfaffffff)\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/025_littleendian_is_invertable.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the function signatures for `littleendian : [4][8] -> [32]` and `littleendian_inverse : {n} (fin n) => [8 * n] -> [n][8]`, and the property `littleendian_is_invertable b = littleendian_inverse (littleendian b) == b` that proves `littleendian` is invertible for all valid inputs `b`."},{"role":"assistant","content":"```cryptol\nlittleendian : [4][8] -> [32]\nlittleendian b = join (reverse b)\nlittleendian_inverse : {n} (fin n) => [8 * n] -> [n][8]\nlittleendian_inverse b = reverse (split b)\n\/* pragma littleendian_is_invertable : property *\/\nlittleendian_is_invertable b =\n  littleendian_inverse (littleendian b) == b\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/026_littleendian_state.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the functions `littleendian : [4][8] -> [32]` and `littleendian_state : [64][8] -> [16][32]` that implement the specified little-endian byte-to-word and state conversion for Salsa20, using `littleendian b = join (reverse b)` and `littleendian_state b = [ littleendian xi | xi <- split b ]`."},{"role":"assistant","content":"```cryptol\nlittleendian : [4][8] -> [32]\nlittleendian b = join (reverse b)\nlittleendian_state : [64][8] -> [16][32]\nlittleendian_state b = [littleendian xi | xi <- split b]\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/028_littleendian_state_inverse.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the functions `littleendian_inverse : {n} (fin n) => [8 * n] -> [n][8]` and `littleendian_state_inverse : [16][32] -> [64][8]` that reconstruct the little-endian word\/state representation by splitting and reversing bytes as in the given types, suitable for use in a Salsa20 verification, and include a property that checks `littleendian_state_inverse` is the inverse of the corresponding `littleendian_state` function when composed appropriately over all valid inputs."},{"role":"assistant","content":"```cryptol\nlittleendian_inverse : {n} (fin n) => [8 * n] -> [n][8]\nlittleendian_inverse b = reverse (split b)\nlittleendian_state_inverse : [16][32] -> [64][8]\nlittleendian_state_inverse w = join (map littleendian_inverse w)\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/030_littleendian_state_is_invertable.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"In Cryptol, define the functions `littleendian`, `littleendian_inverse`, `littleendian_state`, and `littleendian_state_inverse` with the given types, and the property `littleendian_state_is_invertable : [64][8] -> Bit` stating that `littleendian_state_inverse (littleendian_state b) == b` holds for all `b` of type `[64][8]`."},{"role":"assistant","content":"```cryptol\nlittleendian : [4][8] -> [32]\nlittleendian b = join (reverse b)\nlittleendian_inverse : {n} (fin n) => [8 * n] -> [n][8]\nlittleendian_inverse b = reverse (split b)\nlittleendian_state : [64][8] -> [16][32]\nlittleendian_state b = [littleendian xi | xi <- split b]\nlittleendian_state_inverse : [16][32] -> [64][8]\nlittleendian_state_inverse w = join (map littleendian_inverse w)\n\/* pragma littleendian_state_is_invertable : property *\/\nlittleendian_state_is_invertable b =\n  littleendian_state_inverse (littleendian_state b) == b\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/035_Salsa20_passes_tests.cry","filetype":"cryptol","set":"holdout","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol property `Salsa20_passes_tests` that checks the given Salsa20 core implementation (using `quarterround`, `rowround`, `columnround`, `doubleround`, `littleendian`, `littleendian_state`, `littleendian_state_inverse`, `Salsa20_rounds`, and `Salsa20 : [32] -> [64][8] -> [64][8]`) satisfies the three specified 20-round test vectors by equating its outputs to the provided 64-byte expected sequences and conjoining the results."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\nrowround : [16][32] -> [16][32]\nrowround\n  [y0, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13, y14,\n   y15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [z0, z1, z2, z3] = quarterround [y0, y1, y2, y3]\n    [z5, z6, z7, z4] = quarterround [y5, y6, y7, y4]\n    [z10, z11, z8, z9] = quarterround [y10, y11, y8, y9]\n    [z15, z12, z13, z14] = quarterround [y15, y12, y13, y14]\ncolumnround : [16][32] -> [16][32]\ncolumnround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [y0,\n  y1,\n  y2,\n  y3,\n  y4,\n  y5,\n  y6,\n  y7,\n  y8,\n  y9,\n  y10,\n  y11,\n  y12,\n  y13,\n  y14,\n  y15]\n  where\n    [y0, y4, y8, y12] = quarterround [x0, x4, x8, x12]\n    [y5, y9, y13, y1] = quarterround [x5, x9, x13, x1]\n    [y10, y14, y2, y6] = quarterround [x10, x14, x2, x6]\n    [y15, y3, y7, y11] = quarterround [x15, x3, x7, x11]\ndoubleround : [16][32] -> [16][32]\ndoubleround xs = rowround (columnround (xs))\nlittleendian : [4][8] -> [32]\nlittleendian b = join (reverse b)\nlittleendian_inverse : {n} (fin n) => [8 * n] -> [n][8]\nlittleendian_inverse b = reverse (split b)\nlittleendian_state : [64][8] -> [16][32]\nlittleendian_state b = [littleendian xi | xi <- split b]\nlittleendian_state_inverse : [16][32] -> [64][8]\nlittleendian_state_inverse w = join (map littleendian_inverse w)\nSalsa20 : [32] -> [64][8] -> [64][8]\nSalsa20 count xs =\n  littleendian_state_inverse (Salsa20_rounds count xw xw)\n  where\n    xw = littleendian_state xs\nSalsa20_rounds : [32] -> [16][32] -> [16][32] -> [16][32]\nSalsa20_rounds count xw xw' =\n  xw + zs @ (count \/ 2)\n  where\n    zs = [xw'] # [doubleround zi | zi <- zs]\n\/* pragma Salsa20_passes_tests : property *\/\nSalsa20_passes_tests =\n  (Salsa20 20\n    [0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    0] == [0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0,\n  0]) \/\\ (Salsa20 20\n    [211,\n    159,\n    13,\n    115,\n    76,\n    55,\n    82,\n    183,\n    3,\n    117,\n    222,\n    37,\n    191,\n    187,\n    234,\n    136,\n    49,\n    237,\n    179,\n    48,\n    1,\n    106,\n    178,\n    219,\n    175,\n    199,\n    166,\n    48,\n    86,\n    16,\n    179,\n    207,\n    31,\n    240,\n    32,\n    63,\n    15,\n    83,\n    93,\n    161,\n    116,\n    147,\n    48,\n    113,\n    238,\n    55,\n    204,\n    36,\n    79,\n    201,\n    235,\n    79,\n    3,\n    81,\n    156,\n    47,\n    203,\n    26,\n    244,\n    243,\n    88,\n    118,\n    104,\n    54] == [109,\n  42,\n  178,\n  168,\n  156,\n  240,\n  248,\n  238,\n  168,\n  196,\n  190,\n  203,\n  26,\n  110,\n  170,\n  154,\n  29,\n  29,\n  150,\n  26,\n  150,\n  30,\n  235,\n  249,\n  190,\n  163,\n  251,\n  48,\n  69,\n  144,\n  51,\n  57,\n  118,\n  40,\n  152,\n  157,\n  180,\n  57,\n  27,\n  94,\n  107,\n  42,\n  236,\n  35,\n  27,\n  111,\n  114,\n  114,\n  219,\n  236,\n  232,\n  135,\n  111,\n  155,\n  110,\n  18,\n  24,\n  232,\n  95,\n  158,\n  179,\n  19,\n  48,\n  202]) \/\\ (Salsa20 20\n    [88,\n    118,\n    104,\n    54,\n    79,\n    201,\n    235,\n    79,\n    3,\n    81,\n    156,\n    47,\n    203,\n    26,\n    244,\n    243,\n    191,\n    187,\n    234,\n    136,\n    211,\n    159,\n    13,\n    115,\n    76,\n    55,\n    82,\n    183,\n    3,\n    117,\n    222,\n    37,\n    86,\n    16,\n    179,\n    207,\n    49,\n    237,\n    179,\n    48,\n    1,\n    106,\n    178,\n    219,\n    175,\n    199,\n    166,\n    48,\n    238,\n    55,\n    204,\n    36,\n    31,\n    240,\n    32,\n    63,\n    15,\n    83,\n    93,\n    161,\n    116,\n    147,\n    48,\n    113] == [179,\n  19,\n  48,\n  202,\n  219,\n  236,\n  232,\n  135,\n  111,\n  155,\n  110,\n  18,\n  24,\n  232,\n  95,\n  158,\n  26,\n  110,\n  170,\n  154,\n  109,\n  42,\n  178,\n  168,\n  156,\n  240,\n  248,\n  238,\n  168,\n  196,\n  190,\n  203,\n  69,\n  144,\n  51,\n  57,\n  29,\n  29,\n  150,\n  26,\n  150,\n  30,\n  235,\n  249,\n  190,\n  163,\n  251,\n  48,\n  27,\n  111,\n  114,\n  114,\n  118,\n  40,\n  152,\n  157,\n  180,\n  57,\n  27,\n  94,\n  107,\n  42,\n  236,\n  35])\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/039_Salsa20_init.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Define the function `Salsa20_init : {a} (a >= 1, 2 >= a) => ([16 * a][8], [16][8]) -> [64][8]` that constructs the 64-byte Salsa20 state from a 16- or 32-byte key and a 16-byte nonce using the appropriate \"expand 16-byte k\" or \"expand 32-byte k\" constants, and ensure its behavior matches the standard Salsa20 initialization described in the specification."},{"role":"assistant","content":"```cryptol\nSalsa20_init : {a}\n  (a >= 1, 2 >= a) =>\n    ([16 * a][8], [16][8]) -> [64][8]\nSalsa20_init (k, n) =\n  x\n  where\n    [s0, s1, s2, s3] = split \"expand 32-byte k\" : [4][4][8]\n    [t0, t1, t2, t3] = split \"expand 16-byte k\" : [4][4][8]\n    x =\n      if (`a == 2)\n      then s0 # k0 # s1 # n # s2 # k1 # s3\n      else t0 # k0 # t1 # n # t2 # k0 # t3\n    [k0, k1] = (split (k # zero)) : [2][16][8]\n```"}]}
{"filename":"saw-script\/doc\/rust-verification-with-saw\/code\/salsa20\/Salsa20\/041_Salsa20_encrypt_with_offset.cry","filetype":"cryptol","set":"supervised","variant":"slices","messages":[{"role":"system","content":"Return exactly ONE fenced code block labeled `cryptol` and nothing else (no prose before\/after).\n"},{"role":"user","content":"Write a Cryptol specification that defines the function `Salsa20_encrypt_with_offset : {a, l} (a >= 1, 2 >= a, l <= 2 ^^ 70) => ([32], [16 * a][8], [8][8], [64], [l][8]) -> [l][8]` implementing Salsa20 stream encryption with a 32-bit block counter, 16- or 32-byte key, 64-bit nonce, 64-bit offset added to the counter (in little-endian), and XOR with the plaintext message to produce the ciphertext, using the given `quarterround`, `rowround`, `columnround`, `doubleround`, `littleendian`\/`littleendian_inverse`, `littleendian_state`\/`littleendian_state_inverse`, `Salsa20`, `Salsa20_rounds`, `Salsa20_init`, and `Salsa20_expansion` definitions."},{"role":"assistant","content":"```cryptol\nquarterround : [4][32] -> [4][32]\nquarterround [y0, y1, y2, y3] =\n  [z0, z1, z2, z3]\n  where\n    z1 = y1 ^ ((y0 + y3) <<< 0x7)\n    z2 = y2 ^ ((z1 + y0) <<< 0x9)\n    z3 = y3 ^ ((z2 + z1) <<< 0xd)\n    z0 = y0 ^ ((z3 + z2) <<< 0x12)\nrowround : [16][32] -> [16][32]\nrowround\n  [y0, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13, y14,\n   y15] =\n  [z0,\n  z1,\n  z2,\n  z3,\n  z4,\n  z5,\n  z6,\n  z7,\n  z8,\n  z9,\n  z10,\n  z11,\n  z12,\n  z13,\n  z14,\n  z15]\n  where\n    [z0, z1, z2, z3] = quarterround [y0, y1, y2, y3]\n    [z5, z6, z7, z4] = quarterround [y5, y6, y7, y4]\n    [z10, z11, z8, z9] = quarterround [y10, y11, y8, y9]\n    [z15, z12, z13, z14] = quarterround [y15, y12, y13, y14]\ncolumnround : [16][32] -> [16][32]\ncolumnround\n  [x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14,\n   x15] =\n  [y0,\n  y1,\n  y2,\n  y3,\n  y4,\n  y5,\n  y6,\n  y7,\n  y8,\n  y9,\n  y10,\n  y11,\n  y12,\n  y13,\n  y14,\n  y15]\n  where\n    [y0, y4, y8, y12] = quarterround [x0, x4, x8, x12]\n    [y5, y9, y13, y1] = quarterround [x5, x9, x13, x1]\n    [y10, y14, y2, y6] = quarterround [x10, x14, x2, x6]\n    [y15, y3, y7, y11] = quarterround [x15, x3, x7, x11]\ndoubleround : [16][32] -> [16][32]\ndoubleround xs = rowround (columnround (xs))\nlittleendian : [4][8] -> [32]\nlittleendian b = join (reverse b)\nlittleendian_inverse : {n} (fin n) => [8 * n] -> [n][8]\nlittleendian_inverse b = reverse (split b)\nlittleendian_state : [64][8] -> [16][32]\nlittleendian_state b = [littleendian xi | xi <- split b]\nlittleendian_state_inverse : [16][32] -> [64][8]\nlittleendian_state_inverse w = join (map littleendian_inverse w)\nSalsa20 : [32] -> [64][8] -> [64][8]\nSalsa20 count xs =\n  littleendian_state_inverse (Salsa20_rounds count xw xw)\n  where\n    xw = littleendian_state xs\nSalsa20_rounds : [32] -> [16][32] -> [16][32] -> [16][32]\nSalsa20_rounds count xw xw' =\n  xw + zs @ (count \/ 2)\n  where\n    zs = [xw'] # [doubleround zi | zi <- zs]\nSalsa20_expansion : {a}\n  (a >= 1, 2 >= a) =>\n    ([32], [16 * a][8], [16][8]) -> [64][8]\nSalsa20_expansion (count, k, n) =\n  Salsa20 count (Salsa20_init (k, n))\nSalsa20_init : {a}\n  (a >= 1, 2 >= a) =>\n    ([16 * a][8], [16][8]) -> [64][8]\nSalsa20_init (k, n) =\n  x\n  where\n    [s0, s1, s2, s3] = split \"expand 32-byte k\" : [4][4][8]\n    [t0, t1, t2, t3] = split \"expand 16-byte k\" : [4][4][8]\n    x =\n      if (`a == 2)\n      then s0 # k0 # s1 # n # s2 # k1 # s3\n      else t0 # k0 # t1 # n # t2 # k0 # t3\n    [k0, k1] = (split (k # zero)) : [2][16][8]\nSalsa20_encrypt_with_offset : {a, l}\n  (a >= 1, 2 >= a, l <= 2 ^^ 70) =>\n    ([32], [16 * a][8], [8][8], [64], [l][8]) -> [l][8]\nSalsa20_encrypt_with_offset (count, k, v, o, m) =\n  c\n  where\n    salsa =\n      take\n        (join\n          [Salsa20_expansion\n            (count, k, v # (littleendian_inverse (o + i))) | i <- [0, 1 ...]])\n    c = m ^ salsa\n```"}]}
